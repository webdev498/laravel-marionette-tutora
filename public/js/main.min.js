!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function i(e){var t=!!e&&"length"in e&&e.length,i=oe.type(e);return"function"===i||oe.isWindow(e)?!1:"array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e}function n(e,t,i){if(oe.isFunction(t))return oe.grep(e,function(e,n){return!!t.call(e,n,e)!==i});if(t.nodeType)return oe.grep(e,function(e){return e===t!==i});if("string"==typeof t){if(me.test(t))return oe.filter(t,e,i);t=oe.filter(t,e)}return oe.grep(e,function(e){return Z.call(t,e)>-1!==i})}function s(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function o(e){var t={};return oe.each(e.match(we)||[],function(e,i){t[i]=!0}),t}function r(){J.removeEventListener("DOMContentLoaded",r),e.removeEventListener("load",r),oe.ready()}function a(){this.expando=oe.expando+a.uid++}function l(e,t,i){var n;if(void 0===i&&1===e.nodeType)if(n="data-"+t.replace(Ee,"-$&").toLowerCase(),i=e.getAttribute(n),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:je.test(i)?oe.parseJSON(i):i}catch(s){}Te.set(e,t,i)}else i=void 0;return i}function u(e,t,i,n){var s,o=1,r=20,a=n?function(){return n.cur()}:function(){return oe.css(e,t,"")},l=a(),u=i&&i[3]||(oe.cssNumber[t]?"":"px"),c=(oe.cssNumber[t]||"px"!==u&&+l)&&Ae.exec(oe.css(e,t));if(c&&c[3]!==u){u=u||c[3],i=i||[],c=+l||1;do o=o||".5",c/=o,oe.style(e,t,c+u);while(o!==(o=a()/l)&&1!==o&&--r)}return i&&(c=+c||+l||0,s=i[1]?c+(i[1]+1)*i[2]:+i[2],n&&(n.unit=u,n.start=c,n.end=s)),s}function c(e,t){var i="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&oe.nodeName(e,t)?oe.merge([e],i):i}function d(e,t){for(var i=0,n=e.length;n>i;i++)Se.set(e[i],"globalEval",!t||Se.get(t[i],"globalEval"))}function h(e,t,i,n,s){for(var o,r,a,l,u,h,p=t.createDocumentFragment(),f=[],m=0,g=e.length;g>m;m++)if(o=e[m],o||0===o)if("object"===oe.type(o))oe.merge(f,o.nodeType?[o]:o);else if(Ie.test(o)){for(r=r||p.appendChild(t.createElement("div")),a=(Re.exec(o)||["",""])[1].toLowerCase(),l=$e[a]||$e._default,r.innerHTML=l[1]+oe.htmlPrefilter(o)+l[2],h=l[0];h--;)r=r.lastChild;oe.merge(f,r.childNodes),r=p.firstChild,r.textContent=""}else f.push(t.createTextNode(o));for(p.textContent="",m=0;o=f[m++];)if(n&&oe.inArray(o,n)>-1)s&&s.push(o);else if(u=oe.contains(o.ownerDocument,o),r=c(p.appendChild(o),"script"),u&&d(r),i)for(h=0;o=r[h++];)Oe.test(o.type||"")&&i.push(o);return p}function p(){return!0}function f(){return!1}function m(){try{return J.activeElement}catch(e){}}function g(e,t,i,n,s,o){var r,a;if("object"==typeof t){"string"!=typeof i&&(n=n||i,i=void 0);for(a in t)g(e,a,i,n,t[a],o);return e}if(null==n&&null==s?(s=i,n=i=void 0):null==s&&("string"==typeof i?(s=n,n=void 0):(s=n,n=i,i=void 0)),s===!1)s=f;else if(!s)return e;return 1===o&&(r=s,s=function(e){return oe().off(e),r.apply(this,arguments)},s.guid=r.guid||(r.guid=oe.guid++)),e.each(function(){oe.event.add(this,t,s,n,i)})}function v(e,t){return oe.nodeName(e,"table")&&oe.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function _(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function b(e){var t=Ve.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function y(e,t){var i,n,s,o,r,a,l,u;if(1===t.nodeType){if(Se.hasData(e)&&(o=Se.access(e),r=Se.set(t,o),u=o.events)){delete r.handle,r.events={};for(s in u)for(i=0,n=u[s].length;n>i;i++)oe.event.add(t,s,u[s][i])}Te.hasData(e)&&(a=Te.access(e),l=oe.extend({},a),Te.set(t,l))}}function w(e,t){var i=t.nodeName.toLowerCase();"input"===i&&De.test(e.type)?t.checked=e.checked:("input"===i||"textarea"===i)&&(t.defaultValue=e.defaultValue)}function x(e,t,i,n){t=Y.apply([],t);var s,o,r,a,l,u,d=0,p=e.length,f=p-1,m=t[0],g=oe.isFunction(m);if(g||p>1&&"string"==typeof m&&!ne.checkClone&&Be.test(m))return e.each(function(s){var o=e.eq(s);g&&(t[0]=m.call(this,s,o.html())),x(o,t,i,n)});if(p&&(s=h(t,e[0].ownerDocument,!1,e,n),o=s.firstChild,1===s.childNodes.length&&(s=o),o||n)){for(r=oe.map(c(s,"script"),_),a=r.length;p>d;d++)l=s,d!==f&&(l=oe.clone(l,!0,!0),a&&oe.merge(r,c(l,"script"))),i.call(e[d],l,d);if(a)for(u=r[r.length-1].ownerDocument,oe.map(r,b),d=0;a>d;d++)l=r[d],Oe.test(l.type||"")&&!Se.access(l,"globalEval")&&oe.contains(u,l)&&(l.src?oe._evalUrl&&oe._evalUrl(l.src):oe.globalEval(l.textContent.replace(Ue,"")))}return e}function k(e,t,i){for(var n,s=t?oe.filter(t,e):e,o=0;null!=(n=s[o]);o++)i||1!==n.nodeType||oe.cleanData(c(n)),n.parentNode&&(i&&oe.contains(n.ownerDocument,n)&&d(c(n,"script")),n.parentNode.removeChild(n));return e}function C(e,t){var i=oe(t.createElement(e)).appendTo(t.body),n=oe.css(i[0],"display");return i.detach(),n}function S(e){var t=J,i=Ge[e];return i||(i=C(e,t),"none"!==i&&i||(We=(We||oe("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=We[0].contentDocument,t.write(),t.close(),i=C(e,t),We.detach()),Ge[e]=i),i}function T(e,t,i){var n,s,o,r,a=e.style;return i=i||Qe(e),r=i?i.getPropertyValue(t)||i[t]:void 0,""!==r&&void 0!==r||oe.contains(e.ownerDocument,e)||(r=oe.style(e,t)),i&&!ne.pixelMarginRight()&&Je.test(r)&&Xe.test(t)&&(n=a.width,s=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=r,r=i.width,a.width=n,a.minWidth=s,a.maxWidth=o),void 0!==r?r+"":r}function j(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function E(e){if(e in nt)return e;for(var t=e[0].toUpperCase()+e.slice(1),i=it.length;i--;)if(e=it[i]+t,e in nt)return e}function q(e,t,i){var n=Ae.exec(t);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):t}function A(e,t,i,n,s){for(var o=i===(n?"border":"content")?4:"width"===t?1:0,r=0;4>o;o+=2)"margin"===i&&(r+=oe.css(e,i+Pe[o],!0,s)),n?("content"===i&&(r-=oe.css(e,"padding"+Pe[o],!0,s)),"margin"!==i&&(r-=oe.css(e,"border"+Pe[o]+"Width",!0,s))):(r+=oe.css(e,"padding"+Pe[o],!0,s),"padding"!==i&&(r+=oe.css(e,"border"+Pe[o]+"Width",!0,s)));return r}function P(e,t,i){var n=!0,s="width"===t?e.offsetWidth:e.offsetHeight,o=Qe(e),r="border-box"===oe.css(e,"boxSizing",!1,o);if(0>=s||null==s){if(s=T(e,t,o),(0>s||null==s)&&(s=e.style[t]),Je.test(s))return s;n=r&&(ne.boxSizingReliable()||s===e.style[t]),s=parseFloat(s)||0}return s+A(e,t,i||(r?"border":"content"),n,o)+"px"}function F(e,t){for(var i,n,s,o=[],r=0,a=e.length;a>r;r++)n=e[r],n.style&&(o[r]=Se.get(n,"olddisplay"),i=n.style.display,t?(o[r]||"none"!==i||(n.style.display=""),""===n.style.display&&Fe(n)&&(o[r]=Se.access(n,"olddisplay",S(n.nodeName)))):(s=Fe(n),"none"===i&&s||Se.set(n,"olddisplay",s?i:oe.css(n,"display"))));for(r=0;a>r;r++)n=e[r],n.style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?o[r]||"":"none"));return e}function D(e,t,i,n,s){return new D.prototype.init(e,t,i,n,s)}function R(){return e.setTimeout(function(){st=void 0}),st=oe.now()}function O(e,t){var i,n=0,s={height:e};for(t=t?1:0;4>n;n+=2-t)i=Pe[n],s["margin"+i]=s["padding"+i]=e;return t&&(s.opacity=s.width=e),s}function $(e,t,i){for(var n,s=(L.tweeners[t]||[]).concat(L.tweeners["*"]),o=0,r=s.length;r>o;o++)if(n=s[o].call(i,t,e))return n}function I(e,t,i){var n,s,o,r,a,l,u,c,d=this,h={},p=e.style,f=e.nodeType&&Fe(e),m=Se.get(e,"fxshow");i.queue||(a=oe._queueHooks(e,"fx"),null==a.unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,d.always(function(){d.always(function(){a.unqueued--,oe.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],u=oe.css(e,"display"),c="none"===u?Se.get(e,"olddisplay")||S(e.nodeName):u,"inline"===c&&"none"===oe.css(e,"float")&&(p.display="inline-block")),i.overflow&&(p.overflow="hidden",d.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(n in t)if(s=t[n],rt.exec(s)){if(delete t[n],o=o||"toggle"===s,s===(f?"hide":"show")){if("show"!==s||!m||void 0===m[n])continue;f=!0}h[n]=m&&m[n]||oe.style(e,n)}else u=void 0;if(oe.isEmptyObject(h))"inline"===("none"===u?S(e.nodeName):u)&&(p.display=u);else{m?"hidden"in m&&(f=m.hidden):m=Se.access(e,"fxshow",{}),o&&(m.hidden=!f),f?oe(e).show():d.done(function(){oe(e).hide()}),d.done(function(){var t;Se.remove(e,"fxshow");for(t in h)oe.style(e,t,h[t])});for(n in h)r=$(f?m[n]:0,n,d),n in m||(m[n]=r.start,f&&(r.end=r.start,r.start="width"===n||"height"===n?1:0))}}function z(e,t){var i,n,s,o,r;for(i in e)if(n=oe.camelCase(i),s=t[n],o=e[i],oe.isArray(o)&&(s=o[1],o=e[i]=o[0]),i!==n&&(e[n]=o,delete e[i]),r=oe.cssHooks[n],r&&"expand"in r){o=r.expand(o),delete e[n];for(i in o)i in e||(e[i]=o[i],t[i]=s)}else t[n]=s}function L(e,t,i){var n,s,o=0,r=L.prefilters.length,a=oe.Deferred().always(function(){delete l.elem}),l=function(){if(s)return!1;for(var t=st||R(),i=Math.max(0,u.startTime+u.duration-t),n=i/u.duration||0,o=1-n,r=0,l=u.tweens.length;l>r;r++)u.tweens[r].run(o);return a.notifyWith(e,[u,o,i]),1>o&&l?i:(a.resolveWith(e,[u]),!1)},u=a.promise({elem:e,props:oe.extend({},t),opts:oe.extend(!0,{specialEasing:{},easing:oe.easing._default},i),originalProperties:t,originalOptions:i,startTime:st||R(),duration:i.duration,tweens:[],createTween:function(t,i){var n=oe.Tween(e,u.opts,t,i,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(n),n},stop:function(t){var i=0,n=t?u.tweens.length:0;if(s)return this;for(s=!0;n>i;i++)u.tweens[i].run(1);return t?(a.notifyWith(e,[u,1,0]),a.resolveWith(e,[u,t])):a.rejectWith(e,[u,t]),this}}),c=u.props;for(z(c,u.opts.specialEasing);r>o;o++)if(n=L.prefilters[o].call(u,e,c,u.opts))return oe.isFunction(n.stop)&&(oe._queueHooks(u.elem,u.opts.queue).stop=oe.proxy(n.stop,n)),n;return oe.map(c,$,u),oe.isFunction(u.opts.start)&&u.opts.start.call(e,u),oe.fx.timer(oe.extend(l,{elem:e,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}function M(e){return e.getAttribute&&e.getAttribute("class")||""}function H(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,s=0,o=t.toLowerCase().match(we)||[];if(oe.isFunction(i))for(;n=o[s++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function N(e,t,i,n){function s(a){var l;return o[a]=!0,oe.each(e[a]||[],function(e,a){var u=a(t,i,n);return"string"!=typeof u||r||o[u]?r?!(l=u):void 0:(t.dataTypes.unshift(u),s(u),!1)}),l}var o={},r=e===Tt;return s(t.dataTypes[0])||!o["*"]&&s("*")}function B(e,t){var i,n,s=oe.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((s[i]?e:n||(n={}))[i]=t[i]);return n&&oe.extend(!0,e,n),e}function V(e,t,i){for(var n,s,o,r,a=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(s in a)if(a[s]&&a[s].test(n)){l.unshift(s);break}if(l[0]in i)o=l[0];else{for(s in i){if(!l[0]||e.converters[s+" "+l[0]]){o=s;break}r||(r=s)}o=o||r}return o?(o!==l[0]&&l.unshift(o),i[o]):void 0}function U(e,t,i,n){var s,o,r,a,l,u={},c=e.dataTypes.slice();if(c[1])for(r in e.converters)u[r.toLowerCase()]=e.converters[r];for(o=c.shift();o;)if(e.responseFields[o]&&(i[e.responseFields[o]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=c.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(r=u[l+" "+o]||u["* "+o],!r)for(s in u)if(a=s.split(" "),a[1]===o&&(r=u[l+" "+a[0]]||u["* "+a[0]])){r===!0?r=u[s]:u[s]!==!0&&(o=a[0],c.unshift(a[1]));break}if(r!==!0)if(r&&e["throws"])t=r(t);else try{t=r(t)}catch(d){return{state:"parsererror",error:r?d:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}function W(e,t,i,n){var s;if(oe.isArray(t))oe.each(t,function(t,s){i||At.test(e)?n(e,s):W(e+"["+("object"==typeof s&&null!=s?t:"")+"]",s,i,n)});else if(i||"object"!==oe.type(t))n(e,t);else for(s in t)W(e+"["+s+"]",t[s],i,n)}function G(e){return oe.isWindow(e)?e:9===e.nodeType&&e.defaultView}var X=[],J=e.document,Q=X.slice,Y=X.concat,K=X.push,Z=X.indexOf,ee={},te=ee.toString,ie=ee.hasOwnProperty,ne={},se="2.2.4",oe=function(e,t){return new oe.fn.init(e,t)},re=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ae=/^-ms-/,le=/-([\da-z])/gi,ue=function(e,t){return t.toUpperCase()};oe.fn=oe.prototype={jquery:se,constructor:oe,selector:"",length:0,toArray:function(){return Q.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:Q.call(this)},pushStack:function(e){var t=oe.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e){return oe.each(this,e)},map:function(e){return this.pushStack(oe.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return this.pushStack(Q.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(0>e?t:0);return this.pushStack(i>=0&&t>i?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:K,sort:X.sort,splice:X.splice},oe.extend=oe.fn.extend=function(){var e,t,i,n,s,o,r=arguments[0]||{},a=1,l=arguments.length,u=!1;for("boolean"==typeof r&&(u=r,r=arguments[a]||{},a++),"object"==typeof r||oe.isFunction(r)||(r={}),a===l&&(r=this,a--);l>a;a++)if(null!=(e=arguments[a]))for(t in e)i=r[t],n=e[t],r!==n&&(u&&n&&(oe.isPlainObject(n)||(s=oe.isArray(n)))?(s?(s=!1,o=i&&oe.isArray(i)?i:[]):o=i&&oe.isPlainObject(i)?i:{},r[t]=oe.extend(u,o,n)):void 0!==n&&(r[t]=n));return r},oe.extend({expando:"jQuery"+(se+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===oe.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){var t=e&&e.toString();return!oe.isArray(e)&&t-parseFloat(t)+1>=0},isPlainObject:function(e){var t;if("object"!==oe.type(e)||e.nodeType||oe.isWindow(e))return!1;if(e.constructor&&!ie.call(e,"constructor")&&!ie.call(e.constructor.prototype||{},"isPrototypeOf"))return!1;for(t in e);return void 0===t||ie.call(e,t)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?ee[te.call(e)]||"object":typeof e},globalEval:function(e){var t,i=eval;e=oe.trim(e),e&&(1===e.indexOf("use strict")?(t=J.createElement("script"),t.text=e,J.head.appendChild(t).parentNode.removeChild(t)):i(e))},camelCase:function(e){return e.replace(ae,"ms-").replace(le,ue)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var n,s=0;if(i(e))for(n=e.length;n>s&&t.call(e[s],s,e[s])!==!1;s++);else for(s in e)if(t.call(e[s],s,e[s])===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(re,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(i(Object(e))?oe.merge(n,"string"==typeof e?[e]:e):K.call(n,e)),n},inArray:function(e,t,i){return null==t?-1:Z.call(t,e,i)},merge:function(e,t){for(var i=+t.length,n=0,s=e.length;i>n;n++)e[s++]=t[n];return e.length=s,e},grep:function(e,t,i){for(var n,s=[],o=0,r=e.length,a=!i;r>o;o++)n=!t(e[o],o),n!==a&&s.push(e[o]);return s},map:function(e,t,n){var s,o,r=0,a=[];if(i(e))for(s=e.length;s>r;r++)o=t(e[r],r,n),null!=o&&a.push(o);else for(r in e)o=t(e[r],r,n),null!=o&&a.push(o);return Y.apply([],a)},guid:1,proxy:function(e,t){var i,n,s;return"string"==typeof t&&(i=e[t],t=e,e=i),oe.isFunction(e)?(n=Q.call(arguments,2),s=function(){return e.apply(t||this,n.concat(Q.call(arguments)))},s.guid=e.guid=e.guid||oe.guid++,s):void 0},now:Date.now,support:ne}),"function"==typeof Symbol&&(oe.fn[Symbol.iterator]=X[Symbol.iterator]),oe.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){ee["[object "+t+"]"]=t.toLowerCase()});var ce=function(e){function t(e,t,i,n){var s,o,r,a,l,u,d,p,f=t&&t.ownerDocument,m=t?t.nodeType:9;if(i=i||[],"string"!=typeof e||!e||1!==m&&9!==m&&11!==m)return i;if(!n&&((t?t.ownerDocument||t:M)!==F&&P(t),t=t||F,R)){if(11!==m&&(u=ve.exec(e)))if(s=u[1]){if(9===m){if(!(r=t.getElementById(s)))return i;if(r.id===s)return i.push(r),i}else if(f&&(r=f.getElementById(s))&&z(t,r)&&r.id===s)return i.push(r),i}else{if(u[2])return K.apply(i,t.getElementsByTagName(e)),i;if((s=u[3])&&w.getElementsByClassName&&t.getElementsByClassName)return K.apply(i,t.getElementsByClassName(s)),i}if(w.qsa&&!U[e+" "]&&(!O||!O.test(e))){if(1!==m)f=t,p=e;else if("object"!==t.nodeName.toLowerCase()){for((a=t.getAttribute("id"))?a=a.replace(be,"\\$&"):t.setAttribute("id",a=L),d=S(e),o=d.length,l=he.test(a)?"#"+a:"[id='"+a+"']";o--;)d[o]=l+" "+h(d[o]);p=d.join(","),f=_e.test(e)&&c(t.parentNode)||t}if(p)try{return K.apply(i,f.querySelectorAll(p)),i}catch(g){}finally{a===L&&t.removeAttribute("id")}}}return j(e.replace(ae,"$1"),t,i,n)}function i(){function e(i,n){return t.push(i+" ")>x.cacheLength&&delete e[t.shift()],e[i+" "]=n}var t=[];return e}function n(e){return e[L]=!0,e}function s(e){var t=F.createElement("div");try{return!!e(t)}catch(i){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var i=e.split("|"),n=i.length;n--;)x.attrHandle[i[n]]=t}function r(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||G)-(~e.sourceIndex||G);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function a(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function l(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function u(e){return n(function(t){return t=+t,n(function(i,n){for(var s,o=e([],i.length,t),r=o.length;r--;)i[s=o[r]]&&(i[s]=!(n[s]=i[s]))})})}function c(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function d(){}function h(e){for(var t=0,i=e.length,n="";i>t;t++)n+=e[t].value;return n}function p(e,t,i){var n=t.dir,s=i&&"parentNode"===n,o=N++;return t.first?function(t,i,o){for(;t=t[n];)if(1===t.nodeType||s)return e(t,i,o)}:function(t,i,r){var a,l,u,c=[H,o];if(r){for(;t=t[n];)if((1===t.nodeType||s)&&e(t,i,r))return!0}else for(;t=t[n];)if(1===t.nodeType||s){if(u=t[L]||(t[L]={}),l=u[t.uniqueID]||(u[t.uniqueID]={}),(a=l[n])&&a[0]===H&&a[1]===o)return c[2]=a[2];if(l[n]=c,c[2]=e(t,i,r))return!0}}}function f(e){return e.length>1?function(t,i,n){for(var s=e.length;s--;)if(!e[s](t,i,n))return!1;return!0}:e[0]}function m(e,i,n){for(var s=0,o=i.length;o>s;s++)t(e,i[s],n);return n}function g(e,t,i,n,s){for(var o,r=[],a=0,l=e.length,u=null!=t;l>a;a++)(o=e[a])&&(!i||i(o,n,s))&&(r.push(o),u&&t.push(a));return r}function v(e,t,i,s,o,r){return s&&!s[L]&&(s=v(s)),o&&!o[L]&&(o=v(o,r)),n(function(n,r,a,l){var u,c,d,h=[],p=[],f=r.length,v=n||m(t||"*",a.nodeType?[a]:a,[]),_=!e||!n&&t?v:g(v,h,e,a,l),b=i?o||(n?e:f||s)?[]:r:_;if(i&&i(_,b,a,l),s)for(u=g(b,p),s(u,[],a,l),c=u.length;c--;)(d=u[c])&&(b[p[c]]=!(_[p[c]]=d));if(n){if(o||e){if(o){for(u=[],c=b.length;c--;)(d=b[c])&&u.push(_[c]=d);o(null,b=[],u,l)}for(c=b.length;c--;)(d=b[c])&&(u=o?ee(n,d):h[c])>-1&&(n[u]=!(r[u]=d))}}else b=g(b===r?b.splice(f,b.length):b),o?o(null,r,b,l):K.apply(r,b)})}function _(e){for(var t,i,n,s=e.length,o=x.relative[e[0].type],r=o||x.relative[" "],a=o?1:0,l=p(function(e){return e===t},r,!0),u=p(function(e){return ee(t,e)>-1},r,!0),c=[function(e,i,n){var s=!o&&(n||i!==E)||((t=i).nodeType?l(e,i,n):u(e,i,n));return t=null,s}];s>a;a++)if(i=x.relative[e[a].type])c=[p(f(c),i)];else{if(i=x.filter[e[a].type].apply(null,e[a].matches),i[L]){for(n=++a;s>n&&!x.relative[e[n].type];n++);return v(a>1&&f(c),a>1&&h(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(ae,"$1"),i,n>a&&_(e.slice(a,n)),s>n&&_(e=e.slice(n)),s>n&&h(e))}c.push(i)}return f(c)}function b(e,i){var s=i.length>0,o=e.length>0,r=function(n,r,a,l,u){var c,d,h,p=0,f="0",m=n&&[],v=[],_=E,b=n||o&&x.find.TAG("*",u),y=H+=null==_?1:Math.random()||.1,w=b.length;for(u&&(E=r===F||r||u);f!==w&&null!=(c=b[f]);f++){if(o&&c){for(d=0,r||c.ownerDocument===F||(P(c),a=!R);h=e[d++];)if(h(c,r||F,a)){l.push(c);break}u&&(H=y)}s&&((c=!h&&c)&&p--,n&&m.push(c))}if(p+=f,s&&f!==p){for(d=0;h=i[d++];)h(m,v,r,a);if(n){if(p>0)for(;f--;)m[f]||v[f]||(v[f]=Q.call(l));v=g(v)}K.apply(l,v),u&&!n&&v.length>0&&p+i.length>1&&t.uniqueSort(l)}return u&&(H=y,E=_),m};return s?n(r):r}var y,w,x,k,C,S,T,j,E,q,A,P,F,D,R,O,$,I,z,L="sizzle"+1*new Date,M=e.document,H=0,N=0,B=i(),V=i(),U=i(),W=function(e,t){return e===t&&(A=!0),0},G=1<<31,X={}.hasOwnProperty,J=[],Q=J.pop,Y=J.push,K=J.push,Z=J.slice,ee=function(e,t){for(var i=0,n=e.length;n>i;i++)if(e[i]===t)return i;return-1},te="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ie="[\\x20\\t\\r\\n\\f]",ne="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",se="\\["+ie+"*("+ne+")(?:"+ie+"*([*^$|!~]?=)"+ie+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ne+"))|)"+ie+"*\\]",oe=":("+ne+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+se+")*)|.*)\\)|)",re=new RegExp(ie+"+","g"),ae=new RegExp("^"+ie+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ie+"+$","g"),le=new RegExp("^"+ie+"*,"+ie+"*"),ue=new RegExp("^"+ie+"*([>+~]|"+ie+")"+ie+"*"),ce=new RegExp("="+ie+"*([^\\]'\"]*?)"+ie+"*\\]","g"),de=new RegExp(oe),he=new RegExp("^"+ne+"$"),pe={ID:new RegExp("^#("+ne+")"),CLASS:new RegExp("^\\.("+ne+")"),TAG:new RegExp("^("+ne+"|[*])"),ATTR:new RegExp("^"+se),PSEUDO:new RegExp("^"+oe),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ie+"*(even|odd|(([+-]|)(\\d*)n|)"+ie+"*(?:([+-]|)"+ie+"*(\\d+)|))"+ie+"*\\)|)","i"),bool:new RegExp("^(?:"+te+")$","i"),needsContext:new RegExp("^"+ie+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ie+"*((?:-\\d)?\\d*)"+ie+"*\\)|)(?=[^-]|$)","i")},fe=/^(?:input|select|textarea|button)$/i,me=/^h\d$/i,ge=/^[^{]+\{\s*\[native \w/,ve=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,_e=/[+~]/,be=/'|\\/g,ye=new RegExp("\\\\([\\da-f]{1,6}"+ie+"?|("+ie+")|.)","ig"),we=function(e,t,i){var n="0x"+t-65536;return n!==n||i?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},xe=function(){P()};try{K.apply(J=Z.call(M.childNodes),M.childNodes),J[M.childNodes.length].nodeType}catch(ke){K={apply:J.length?function(e,t){Y.apply(e,Z.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}w=t.support={},C=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},P=t.setDocument=function(e){var t,i,n=e?e.ownerDocument||e:M;return n!==F&&9===n.nodeType&&n.documentElement?(F=n,D=F.documentElement,R=!C(F),(i=F.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",xe,!1):i.attachEvent&&i.attachEvent("onunload",xe)),w.attributes=s(function(e){return e.className="i",!e.getAttribute("className")}),w.getElementsByTagName=s(function(e){return e.appendChild(F.createComment("")),!e.getElementsByTagName("*").length}),w.getElementsByClassName=ge.test(F.getElementsByClassName),w.getById=s(function(e){return D.appendChild(e).id=L,!F.getElementsByName||!F.getElementsByName(L).length}),w.getById?(x.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&R){var i=t.getElementById(e);return i?[i]:[]}},x.filter.ID=function(e){var t=e.replace(ye,we);return function(e){return e.getAttribute("id")===t}}):(delete x.find.ID,x.filter.ID=function(e){var t=e.replace(ye,we);return function(e){var i="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}}),x.find.TAG=w.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):w.qsa?t.querySelectorAll(e):void 0}:function(e,t){var i,n=[],s=0,o=t.getElementsByTagName(e);if("*"===e){for(;i=o[s++];)1===i.nodeType&&n.push(i);return n}return o},x.find.CLASS=w.getElementsByClassName&&function(e,t){return"undefined"!=typeof t.getElementsByClassName&&R?t.getElementsByClassName(e):void 0},$=[],O=[],(w.qsa=ge.test(F.querySelectorAll))&&(s(function(e){D.appendChild(e).innerHTML="<a id='"+L+"'></a><select id='"+L+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&O.push("[*^$]="+ie+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||O.push("\\["+ie+"*(?:value|"+te+")"),e.querySelectorAll("[id~="+L+"-]").length||O.push("~="),e.querySelectorAll(":checked").length||O.push(":checked"),e.querySelectorAll("a#"+L+"+*").length||O.push(".#.+[+~]")}),s(function(e){var t=F.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&O.push("name"+ie+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||O.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),O.push(",.*:")})),(w.matchesSelector=ge.test(I=D.matches||D.webkitMatchesSelector||D.mozMatchesSelector||D.oMatchesSelector||D.msMatchesSelector))&&s(function(e){w.disconnectedMatch=I.call(e,"div"),I.call(e,"[s!='']:x"),$.push("!=",oe)}),O=O.length&&new RegExp(O.join("|")),$=$.length&&new RegExp($.join("|")),t=ge.test(D.compareDocumentPosition),z=t||ge.test(D.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},W=t?function(e,t){if(e===t)return A=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i?i:(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&i||!w.sortDetached&&t.compareDocumentPosition(e)===i?e===F||e.ownerDocument===M&&z(M,e)?-1:t===F||t.ownerDocument===M&&z(M,t)?1:q?ee(q,e)-ee(q,t):0:4&i?-1:1)}:function(e,t){if(e===t)return A=!0,0;var i,n=0,s=e.parentNode,o=t.parentNode,a=[e],l=[t];if(!s||!o)return e===F?-1:t===F?1:s?-1:o?1:q?ee(q,e)-ee(q,t):0;if(s===o)return r(e,t);for(i=e;i=i.parentNode;)a.unshift(i);for(i=t;i=i.parentNode;)l.unshift(i);for(;a[n]===l[n];)n++;return n?r(a[n],l[n]):a[n]===M?-1:l[n]===M?1:0},F):F},t.matches=function(e,i){return t(e,null,null,i)},t.matchesSelector=function(e,i){if((e.ownerDocument||e)!==F&&P(e),i=i.replace(ce,"='$1']"),w.matchesSelector&&R&&!U[i+" "]&&(!$||!$.test(i))&&(!O||!O.test(i)))try{var n=I.call(e,i);if(n||w.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(s){}return t(i,F,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==F&&P(e),z(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==F&&P(e);var i=x.attrHandle[t.toLowerCase()],n=i&&X.call(x.attrHandle,t.toLowerCase())?i(e,t,!R):void 0;return void 0!==n?n:w.attributes||!R?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,i=[],n=0,s=0;if(A=!w.detectDuplicates,q=!w.sortStable&&e.slice(0),e.sort(W),A){for(;t=e[s++];)t===e[s]&&(n=i.push(s));for(;n--;)e.splice(i[n],1)}return q=null,e},k=t.getText=function(e){var t,i="",n=0,s=e.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=k(e)}else if(3===s||4===s)return e.nodeValue}else for(;t=e[n++];)i+=k(t);return i},x=t.selectors={cacheLength:50,createPseudo:n,match:pe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ye,we),e[3]=(e[3]||e[4]||e[5]||"").replace(ye,we),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return pe.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&de.test(i)&&(t=S(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ye,we).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=B[e+" "];return t||(t=new RegExp("(^|"+ie+")"+e+"("+ie+"|$)"))&&B(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,i,n){return function(s){var o=t.attr(s,e);return null==o?"!="===i:i?(o+="","="===i?o===n:"!="===i?o!==n:"^="===i?n&&0===o.indexOf(n):"*="===i?n&&o.indexOf(n)>-1:"$="===i?n&&o.slice(-n.length)===n:"~="===i?(" "+o.replace(re," ")+" ").indexOf(n)>-1:"|="===i?o===n||o.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,i,n,s){var o="nth"!==e.slice(0,3),r="last"!==e.slice(-4),a="of-type"===t;return 1===n&&0===s?function(e){return!!e.parentNode}:function(t,i,l){var u,c,d,h,p,f,m=o!==r?"nextSibling":"previousSibling",g=t.parentNode,v=a&&t.nodeName.toLowerCase(),_=!l&&!a,b=!1;if(g){if(o){for(;m;){for(h=t;h=h[m];)if(a?h.nodeName.toLowerCase()===v:1===h.nodeType)return!1;f=m="only"===e&&!f&&"nextSibling"}return!0}if(f=[r?g.firstChild:g.lastChild],r&&_){for(h=g,d=h[L]||(h[L]={}),c=d[h.uniqueID]||(d[h.uniqueID]={}),u=c[e]||[],p=u[0]===H&&u[1],b=p&&u[2],h=p&&g.childNodes[p];h=++p&&h&&h[m]||(b=p=0)||f.pop();)if(1===h.nodeType&&++b&&h===t){c[e]=[H,p,b];break}}else if(_&&(h=t,d=h[L]||(h[L]={}),c=d[h.uniqueID]||(d[h.uniqueID]={}),u=c[e]||[],p=u[0]===H&&u[1],b=p),b===!1)for(;(h=++p&&h&&h[m]||(b=p=0)||f.pop())&&((a?h.nodeName.toLowerCase()!==v:1!==h.nodeType)||!++b||(_&&(d=h[L]||(h[L]={}),c=d[h.uniqueID]||(d[h.uniqueID]={}),c[e]=[H,b]),h!==t)););return b-=s,b===n||b%n===0&&b/n>=0}}},PSEUDO:function(e,i){var s,o=x.pseudos[e]||x.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return o[L]?o(i):o.length>1?(s=[e,e,"",i],x.setFilters.hasOwnProperty(e.toLowerCase())?n(function(e,t){for(var n,s=o(e,i),r=s.length;r--;)n=ee(e,s[r]),e[n]=!(t[n]=s[r])}):function(e){return o(e,0,s)}):o}},pseudos:{not:n(function(e){var t=[],i=[],s=T(e.replace(ae,"$1"));return s[L]?n(function(e,t,i,n){for(var o,r=s(e,null,n,[]),a=e.length;a--;)(o=r[a])&&(e[a]=!(t[a]=o))}):function(e,n,o){return t[0]=e,s(t,null,o,i),t[0]=null,!i.pop()}}),has:n(function(e){return function(i){return t(e,i).length>0}}),contains:n(function(e){return e=e.replace(ye,we),function(t){return(t.textContent||t.innerText||k(t)).indexOf(e)>-1}}),lang:n(function(e){return he.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(ye,we).toLowerCase(),function(t){var i;do if(i=R?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===D},focus:function(e){return e===F.activeElement&&(!F.hasFocus||F.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!x.pseudos.empty(e)},header:function(e){return me.test(e.nodeName)},input:function(e){return fe.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:u(function(){return[0]}),last:u(function(e,t){return[t-1]}),eq:u(function(e,t,i){return[0>i?i+t:i]}),even:u(function(e,t){for(var i=0;t>i;i+=2)e.push(i);return e}),odd:u(function(e,t){
for(var i=1;t>i;i+=2)e.push(i);return e}),lt:u(function(e,t,i){for(var n=0>i?i+t:i;--n>=0;)e.push(n);return e}),gt:u(function(e,t,i){for(var n=0>i?i+t:i;++n<t;)e.push(n);return e})}},x.pseudos.nth=x.pseudos.eq;for(y in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})x.pseudos[y]=a(y);for(y in{submit:!0,reset:!0})x.pseudos[y]=l(y);return d.prototype=x.filters=x.pseudos,x.setFilters=new d,S=t.tokenize=function(e,i){var n,s,o,r,a,l,u,c=V[e+" "];if(c)return i?0:c.slice(0);for(a=e,l=[],u=x.preFilter;a;){(!n||(s=le.exec(a)))&&(s&&(a=a.slice(s[0].length)||a),l.push(o=[])),n=!1,(s=ue.exec(a))&&(n=s.shift(),o.push({value:n,type:s[0].replace(ae," ")}),a=a.slice(n.length));for(r in x.filter)!(s=pe[r].exec(a))||u[r]&&!(s=u[r](s))||(n=s.shift(),o.push({value:n,type:r,matches:s}),a=a.slice(n.length));if(!n)break}return i?a.length:a?t.error(e):V(e,l).slice(0)},T=t.compile=function(e,t){var i,n=[],s=[],o=U[e+" "];if(!o){for(t||(t=S(e)),i=t.length;i--;)o=_(t[i]),o[L]?n.push(o):s.push(o);o=U(e,b(s,n)),o.selector=e}return o},j=t.select=function(e,t,i,n){var s,o,r,a,l,u="function"==typeof e&&e,d=!n&&S(e=u.selector||e);if(i=i||[],1===d.length){if(o=d[0]=d[0].slice(0),o.length>2&&"ID"===(r=o[0]).type&&w.getById&&9===t.nodeType&&R&&x.relative[o[1].type]){if(t=(x.find.ID(r.matches[0].replace(ye,we),t)||[])[0],!t)return i;u&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(s=pe.needsContext.test(e)?0:o.length;s--&&(r=o[s],!x.relative[a=r.type]);)if((l=x.find[a])&&(n=l(r.matches[0].replace(ye,we),_e.test(o[0].type)&&c(t.parentNode)||t))){if(o.splice(s,1),e=n.length&&h(o),!e)return K.apply(i,n),i;break}}return(u||T(e,d))(n,t,!R,i,!t||_e.test(e)&&c(t.parentNode)||t),i},w.sortStable=L.split("").sort(W).join("")===L,w.detectDuplicates=!!A,P(),w.sortDetached=s(function(e){return 1&e.compareDocumentPosition(F.createElement("div"))}),s(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,t,i){return i?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),w.attributes&&s(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,t,i){return i||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),s(function(e){return null==e.getAttribute("disabled")})||o(te,function(e,t,i){var n;return i?void 0:e[t]===!0?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),t}(e);oe.find=ce,oe.expr=ce.selectors,oe.expr[":"]=oe.expr.pseudos,oe.uniqueSort=oe.unique=ce.uniqueSort,oe.text=ce.getText,oe.isXMLDoc=ce.isXML,oe.contains=ce.contains;var de=function(e,t,i){for(var n=[],s=void 0!==i;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(s&&oe(e).is(i))break;n.push(e)}return n},he=function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i},pe=oe.expr.match.needsContext,fe=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,me=/^.[^:#\[\.,]*$/;oe.filter=function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?oe.find.matchesSelector(n,e)?[n]:[]:oe.find.matches(e,oe.grep(t,function(e){return 1===e.nodeType}))},oe.fn.extend({find:function(e){var t,i=this.length,n=[],s=this;if("string"!=typeof e)return this.pushStack(oe(e).filter(function(){for(t=0;i>t;t++)if(oe.contains(s[t],this))return!0}));for(t=0;i>t;t++)oe.find(e,s[t],n);return n=this.pushStack(i>1?oe.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(n(this,e||[],!1))},not:function(e){return this.pushStack(n(this,e||[],!0))},is:function(e){return!!n(this,"string"==typeof e&&pe.test(e)?oe(e):e||[],!1).length}});var ge,ve=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,_e=oe.fn.init=function(e,t,i){var n,s;if(!e)return this;if(i=i||ge,"string"==typeof e){if(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:ve.exec(e),!n||!n[1]&&t)return!t||t.jquery?(t||i).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof oe?t[0]:t,oe.merge(this,oe.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:J,!0)),fe.test(n[1])&&oe.isPlainObject(t))for(n in t)oe.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return s=J.getElementById(n[2]),s&&s.parentNode&&(this.length=1,this[0]=s),this.context=J,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):oe.isFunction(e)?void 0!==i.ready?i.ready(e):e(oe):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),oe.makeArray(e,this))};_e.prototype=oe.fn,ge=oe(J);var be=/^(?:parents|prev(?:Until|All))/,ye={children:!0,contents:!0,next:!0,prev:!0};oe.fn.extend({has:function(e){var t=oe(e,this),i=t.length;return this.filter(function(){for(var e=0;i>e;e++)if(oe.contains(this,t[e]))return!0})},closest:function(e,t){for(var i,n=0,s=this.length,o=[],r=pe.test(e)||"string"!=typeof e?oe(e,t||this.context):0;s>n;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(r?r.index(i)>-1:1===i.nodeType&&oe.find.matchesSelector(i,e))){o.push(i);break}return this.pushStack(o.length>1?oe.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?Z.call(oe(e),this[0]):Z.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(oe.uniqueSort(oe.merge(this.get(),oe(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),oe.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return de(e,"parentNode")},parentsUntil:function(e,t,i){return de(e,"parentNode",i)},next:function(e){return s(e,"nextSibling")},prev:function(e){return s(e,"previousSibling")},nextAll:function(e){return de(e,"nextSibling")},prevAll:function(e){return de(e,"previousSibling")},nextUntil:function(e,t,i){return de(e,"nextSibling",i)},prevUntil:function(e,t,i){return de(e,"previousSibling",i)},siblings:function(e){return he((e.parentNode||{}).firstChild,e)},children:function(e){return he(e.firstChild)},contents:function(e){return e.contentDocument||oe.merge([],e.childNodes)}},function(e,t){oe.fn[e]=function(i,n){var s=oe.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(s=oe.filter(n,s)),this.length>1&&(ye[e]||oe.uniqueSort(s),be.test(e)&&s.reverse()),this.pushStack(s)}});var we=/\S+/g;oe.Callbacks=function(e){e="string"==typeof e?o(e):oe.extend({},e);var t,i,n,s,r=[],a=[],l=-1,u=function(){for(s=e.once,n=t=!0;a.length;l=-1)for(i=a.shift();++l<r.length;)r[l].apply(i[0],i[1])===!1&&e.stopOnFalse&&(l=r.length,i=!1);e.memory||(i=!1),t=!1,s&&(r=i?[]:"")},c={add:function(){return r&&(i&&!t&&(l=r.length-1,a.push(i)),function n(t){oe.each(t,function(t,i){oe.isFunction(i)?e.unique&&c.has(i)||r.push(i):i&&i.length&&"string"!==oe.type(i)&&n(i)})}(arguments),i&&!t&&u()),this},remove:function(){return oe.each(arguments,function(e,t){for(var i;(i=oe.inArray(t,r,i))>-1;)r.splice(i,1),l>=i&&l--}),this},has:function(e){return e?oe.inArray(e,r)>-1:r.length>0},empty:function(){return r&&(r=[]),this},disable:function(){return s=a=[],r=i="",this},disabled:function(){return!r},lock:function(){return s=a=[],i||(r=i=""),this},locked:function(){return!!s},fireWith:function(e,i){return s||(i=i||[],i=[e,i.slice?i.slice():i],a.push(i),t||u()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!n}};return c},oe.extend({Deferred:function(e){var t=[["resolve","done",oe.Callbacks("once memory"),"resolved"],["reject","fail",oe.Callbacks("once memory"),"rejected"],["notify","progress",oe.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var e=arguments;return oe.Deferred(function(i){oe.each(t,function(t,o){var r=oe.isFunction(e[t])&&e[t];s[o[1]](function(){var e=r&&r.apply(this,arguments);e&&oe.isFunction(e.promise)?e.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[o[0]+"With"](this===n?i.promise():this,r?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?oe.extend(e,n):n}},s={};return n.pipe=n.then,oe.each(t,function(e,o){var r=o[2],a=o[3];n[o[1]]=r.add,a&&r.add(function(){i=a},t[1^e][2].disable,t[2][2].lock),s[o[0]]=function(){return s[o[0]+"With"](this===s?n:this,arguments),this},s[o[0]+"With"]=r.fireWith}),n.promise(s),e&&e.call(s,s),s},when:function(e){var t,i,n,s=0,o=Q.call(arguments),r=o.length,a=1!==r||e&&oe.isFunction(e.promise)?r:0,l=1===a?e:oe.Deferred(),u=function(e,i,n){return function(s){i[e]=this,n[e]=arguments.length>1?Q.call(arguments):s,n===t?l.notifyWith(i,n):--a||l.resolveWith(i,n)}};if(r>1)for(t=new Array(r),i=new Array(r),n=new Array(r);r>s;s++)o[s]&&oe.isFunction(o[s].promise)?o[s].promise().progress(u(s,i,t)).done(u(s,n,o)).fail(l.reject):--a;return a||l.resolveWith(n,o),l.promise()}});var xe;oe.fn.ready=function(e){return oe.ready.promise().done(e),this},oe.extend({isReady:!1,readyWait:1,holdReady:function(e){e?oe.readyWait++:oe.ready(!0)},ready:function(e){(e===!0?--oe.readyWait:oe.isReady)||(oe.isReady=!0,e!==!0&&--oe.readyWait>0||(xe.resolveWith(J,[oe]),oe.fn.triggerHandler&&(oe(J).triggerHandler("ready"),oe(J).off("ready"))))}}),oe.ready.promise=function(t){return xe||(xe=oe.Deferred(),"complete"===J.readyState||"loading"!==J.readyState&&!J.documentElement.doScroll?e.setTimeout(oe.ready):(J.addEventListener("DOMContentLoaded",r),e.addEventListener("load",r))),xe.promise(t)},oe.ready.promise();var ke=function(e,t,i,n,s,o,r){var a=0,l=e.length,u=null==i;if("object"===oe.type(i)){s=!0;for(a in i)ke(e,t,a,i[a],!0,o,r)}else if(void 0!==n&&(s=!0,oe.isFunction(n)||(r=!0),u&&(r?(t.call(e,n),t=null):(u=t,t=function(e,t,i){return u.call(oe(e),i)})),t))for(;l>a;a++)t(e[a],i,r?n:n.call(e[a],a,t(e[a],i)));return s?e:u?t.call(e):l?t(e[0],i):o},Ce=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};a.uid=1,a.prototype={register:function(e,t){var i=t||{};return e.nodeType?e[this.expando]=i:Object.defineProperty(e,this.expando,{value:i,writable:!0,configurable:!0}),e[this.expando]},cache:function(e){if(!Ce(e))return{};var t=e[this.expando];return t||(t={},Ce(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,i){var n,s=this.cache(e);if("string"==typeof t)s[t]=i;else for(n in t)s[n]=t[n];return s},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][t]},access:function(e,t,i){var n;return void 0===t||t&&"string"==typeof t&&void 0===i?(n=this.get(e,t),void 0!==n?n:this.get(e,oe.camelCase(t))):(this.set(e,t,i),void 0!==i?i:t)},remove:function(e,t){var i,n,s,o=e[this.expando];if(void 0!==o){if(void 0===t)this.register(e);else{oe.isArray(t)?n=t.concat(t.map(oe.camelCase)):(s=oe.camelCase(t),t in o?n=[t,s]:(n=s,n=n in o?[n]:n.match(we)||[])),i=n.length;for(;i--;)delete o[n[i]]}(void 0===t||oe.isEmptyObject(o))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!oe.isEmptyObject(t)}};var Se=new a,Te=new a,je=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ee=/[A-Z]/g;oe.extend({hasData:function(e){return Te.hasData(e)||Se.hasData(e)},data:function(e,t,i){return Te.access(e,t,i)},removeData:function(e,t){Te.remove(e,t)},_data:function(e,t,i){return Se.access(e,t,i)},_removeData:function(e,t){Se.remove(e,t)}}),oe.fn.extend({data:function(e,t){var i,n,s,o=this[0],r=o&&o.attributes;if(void 0===e){if(this.length&&(s=Te.get(o),1===o.nodeType&&!Se.get(o,"hasDataAttrs"))){for(i=r.length;i--;)r[i]&&(n=r[i].name,0===n.indexOf("data-")&&(n=oe.camelCase(n.slice(5)),l(o,n,s[n])));Se.set(o,"hasDataAttrs",!0)}return s}return"object"==typeof e?this.each(function(){Te.set(this,e)}):ke(this,function(t){var i,n;if(o&&void 0===t){if(i=Te.get(o,e)||Te.get(o,e.replace(Ee,"-$&").toLowerCase()),void 0!==i)return i;if(n=oe.camelCase(e),i=Te.get(o,n),void 0!==i)return i;if(i=l(o,n,void 0),void 0!==i)return i}else n=oe.camelCase(e),this.each(function(){var i=Te.get(this,n);Te.set(this,n,t),e.indexOf("-")>-1&&void 0!==i&&Te.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){Te.remove(this,e)})}}),oe.extend({queue:function(e,t,i){var n;return e?(t=(t||"fx")+"queue",n=Se.get(e,t),i&&(!n||oe.isArray(i)?n=Se.access(e,t,oe.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(e,t){t=t||"fx";var i=oe.queue(e,t),n=i.length,s=i.shift(),o=oe._queueHooks(e,t),r=function(){oe.dequeue(e,t)};"inprogress"===s&&(s=i.shift(),n--),s&&("fx"===t&&i.unshift("inprogress"),delete o.stop,s.call(e,r,o)),!n&&o&&o.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return Se.get(e,i)||Se.access(e,i,{empty:oe.Callbacks("once memory").add(function(){Se.remove(e,[t+"queue",i])})})}}),oe.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?oe.queue(this[0],e):void 0===t?this:this.each(function(){var i=oe.queue(this,e,t);oe._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&oe.dequeue(this,e)})},dequeue:function(e){return this.each(function(){oe.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,s=oe.Deferred(),o=this,r=this.length,a=function(){--n||s.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";r--;)i=Se.get(o[r],e+"queueHooks"),i&&i.empty&&(n++,i.empty.add(a));return a(),s.promise(t)}});var qe=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ae=new RegExp("^(?:([+-])=|)("+qe+")([a-z%]*)$","i"),Pe=["Top","Right","Bottom","Left"],Fe=function(e,t){return e=t||e,"none"===oe.css(e,"display")||!oe.contains(e.ownerDocument,e)},De=/^(?:checkbox|radio)$/i,Re=/<([\w:-]+)/,Oe=/^$|\/(?:java|ecma)script/i,$e={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};$e.optgroup=$e.option,$e.tbody=$e.tfoot=$e.colgroup=$e.caption=$e.thead,$e.th=$e.td;var Ie=/<|&#?\w+;/;!function(){var e=J.createDocumentFragment(),t=e.appendChild(J.createElement("div")),i=J.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),t.appendChild(i),ne.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",ne.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var ze=/^key/,Le=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Me=/^([^.]*)(?:\.(.+)|)/;oe.event={global:{},add:function(e,t,i,n,s){var o,r,a,l,u,c,d,h,p,f,m,g=Se.get(e);if(g)for(i.handler&&(o=i,i=o.handler,s=o.selector),i.guid||(i.guid=oe.guid++),(l=g.events)||(l=g.events={}),(r=g.handle)||(r=g.handle=function(t){return"undefined"!=typeof oe&&oe.event.triggered!==t.type?oe.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(we)||[""],u=t.length;u--;)a=Me.exec(t[u])||[],p=m=a[1],f=(a[2]||"").split(".").sort(),p&&(d=oe.event.special[p]||{},p=(s?d.delegateType:d.bindType)||p,d=oe.event.special[p]||{},c=oe.extend({type:p,origType:m,data:n,handler:i,guid:i.guid,selector:s,needsContext:s&&oe.expr.match.needsContext.test(s),namespace:f.join(".")},o),(h=l[p])||(h=l[p]=[],h.delegateCount=0,d.setup&&d.setup.call(e,n,f,r)!==!1||e.addEventListener&&e.addEventListener(p,r)),d.add&&(d.add.call(e,c),c.handler.guid||(c.handler.guid=i.guid)),s?h.splice(h.delegateCount++,0,c):h.push(c),oe.event.global[p]=!0)},remove:function(e,t,i,n,s){var o,r,a,l,u,c,d,h,p,f,m,g=Se.hasData(e)&&Se.get(e);if(g&&(l=g.events)){for(t=(t||"").match(we)||[""],u=t.length;u--;)if(a=Me.exec(t[u])||[],p=m=a[1],f=(a[2]||"").split(".").sort(),p){for(d=oe.event.special[p]||{},p=(n?d.delegateType:d.bindType)||p,h=l[p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),r=o=h.length;o--;)c=h[o],!s&&m!==c.origType||i&&i.guid!==c.guid||a&&!a.test(c.namespace)||n&&n!==c.selector&&("**"!==n||!c.selector)||(h.splice(o,1),c.selector&&h.delegateCount--,d.remove&&d.remove.call(e,c));r&&!h.length&&(d.teardown&&d.teardown.call(e,f,g.handle)!==!1||oe.removeEvent(e,p,g.handle),delete l[p])}else for(p in l)oe.event.remove(e,p+t[u],i,n,!0);oe.isEmptyObject(l)&&Se.remove(e,"handle events")}},dispatch:function(e){e=oe.event.fix(e);var t,i,n,s,o,r=[],a=Q.call(arguments),l=(Se.get(this,"events")||{})[e.type]||[],u=oe.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!u.preDispatch||u.preDispatch.call(this,e)!==!1){for(r=oe.event.handlers.call(this,e,l),t=0;(s=r[t++])&&!e.isPropagationStopped();)for(e.currentTarget=s.elem,i=0;(o=s.handlers[i++])&&!e.isImmediatePropagationStopped();)(!e.rnamespace||e.rnamespace.test(o.namespace))&&(e.handleObj=o,e.data=o.data,n=((oe.event.special[o.origType]||{}).handle||o.handler).apply(s.elem,a),void 0!==n&&(e.result=n)===!1&&(e.preventDefault(),e.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,e),e.result}},handlers:function(e,t){var i,n,s,o,r=[],a=t.delegateCount,l=e.target;if(a&&l.nodeType&&("click"!==e.type||isNaN(e.button)||e.button<1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&(l.disabled!==!0||"click"!==e.type)){for(n=[],i=0;a>i;i++)o=t[i],s=o.selector+" ",void 0===n[s]&&(n[s]=o.needsContext?oe(s,this).index(l)>-1:oe.find(s,this,null,[l]).length),n[s]&&n.push(o);n.length&&r.push({elem:l,handlers:n})}return a<t.length&&r.push({elem:this,handlers:t.slice(a)}),r},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var i,n,s,o=t.button;return null==e.pageX&&null!=t.clientX&&(i=e.target.ownerDocument||J,n=i.documentElement,s=i.body,e.pageX=t.clientX+(n&&n.scrollLeft||s&&s.scrollLeft||0)-(n&&n.clientLeft||s&&s.clientLeft||0),e.pageY=t.clientY+(n&&n.scrollTop||s&&s.scrollTop||0)-(n&&n.clientTop||s&&s.clientTop||0)),e.which||void 0===o||(e.which=1&o?1:2&o?3:4&o?2:0),e}},fix:function(e){if(e[oe.expando])return e;var t,i,n,s=e.type,o=e,r=this.fixHooks[s];for(r||(this.fixHooks[s]=r=Le.test(s)?this.mouseHooks:ze.test(s)?this.keyHooks:{}),n=r.props?this.props.concat(r.props):this.props,e=new oe.Event(o),t=n.length;t--;)i=n[t],e[i]=o[i];return e.target||(e.target=J),3===e.target.nodeType&&(e.target=e.target.parentNode),r.filter?r.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==m()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===m()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&oe.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return oe.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},oe.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i)},oe.Event=function(e,t){return this instanceof oe.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?p:f):this.type=e,t&&oe.extend(this,t),this.timeStamp=e&&e.timeStamp||oe.now(),void(this[oe.expando]=!0)):new oe.Event(e,t)},oe.Event.prototype={constructor:oe.Event,isDefaultPrevented:f,isPropagationStopped:f,isImmediatePropagationStopped:f,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=p,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=p,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=p,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},oe.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){oe.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,s=e.relatedTarget,o=e.handleObj;return(!s||s!==n&&!oe.contains(n,s))&&(e.type=o.origType,i=o.handler.apply(this,arguments),e.type=t),i}}}),oe.fn.extend({on:function(e,t,i,n){return g(this,e,t,i,n)},one:function(e,t,i,n){return g(this,e,t,i,n,1)},off:function(e,t,i){var n,s;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,oe(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(s in e)this.off(s,t,e[s]);return this}return(t===!1||"function"==typeof t)&&(i=t,t=void 0),i===!1&&(i=f),this.each(function(){oe.event.remove(this,e,i,t)})}});var He=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,Ne=/<script|<style|<link/i,Be=/checked\s*(?:[^=]|=\s*.checked.)/i,Ve=/^true\/(.*)/,Ue=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;oe.extend({htmlPrefilter:function(e){return e.replace(He,"<$1></$2>")},clone:function(e,t,i){var n,s,o,r,a=e.cloneNode(!0),l=oe.contains(e.ownerDocument,e);if(!(ne.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||oe.isXMLDoc(e)))for(r=c(a),o=c(e),n=0,s=o.length;s>n;n++)w(o[n],r[n]);if(t)if(i)for(o=o||c(e),r=r||c(a),n=0,s=o.length;s>n;n++)y(o[n],r[n]);else y(e,a);return r=c(a,"script"),r.length>0&&d(r,!l&&c(e,"script")),a},cleanData:function(e){for(var t,i,n,s=oe.event.special,o=0;void 0!==(i=e[o]);o++)if(Ce(i)){if(t=i[Se.expando]){if(t.events)for(n in t.events)s[n]?oe.event.remove(i,n):oe.removeEvent(i,n,t.handle);i[Se.expando]=void 0}i[Te.expando]&&(i[Te.expando]=void 0)}}}),oe.fn.extend({domManip:x,detach:function(e){return k(this,e,!0)},remove:function(e){return k(this,e)},text:function(e){return ke(this,function(e){return void 0===e?oe.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=e)})},null,e,arguments.length)},append:function(){return x(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=v(this,e);t.appendChild(e)}})},prepend:function(){return x(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=v(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return x(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return x(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(oe.cleanData(c(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return oe.clone(this,e,t)})},html:function(e){return ke(this,function(e){var t=this[0]||{},i=0,n=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ne.test(e)&&!$e[(Re.exec(e)||["",""])[1].toLowerCase()]){e=oe.htmlPrefilter(e);try{for(;n>i;i++)t=this[i]||{},1===t.nodeType&&(oe.cleanData(c(t,!1)),t.innerHTML=e);t=0}catch(s){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return x(this,arguments,function(t){var i=this.parentNode;oe.inArray(this,e)<0&&(oe.cleanData(c(this)),i&&i.replaceChild(t,this))},e)}}),oe.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){oe.fn[e]=function(e){for(var i,n=[],s=oe(e),o=s.length-1,r=0;o>=r;r++)i=r===o?this:this.clone(!0),oe(s[r])[t](i),K.apply(n,i.get());return this.pushStack(n)}});var We,Ge={HTML:"block",BODY:"block"},Xe=/^margin/,Je=new RegExp("^("+qe+")(?!px)[a-z%]+$","i"),Qe=function(t){var i=t.ownerDocument.defaultView;return i&&i.opener||(i=e),i.getComputedStyle(t)},Ye=function(e,t,i,n){var s,o,r={};for(o in t)r[o]=e.style[o],e.style[o]=t[o];s=i.apply(e,n||[]);for(o in t)e.style[o]=r[o];return s},Ke=J.documentElement;!function(){function t(){a.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",a.innerHTML="",Ke.appendChild(r);var t=e.getComputedStyle(a);i="1%"!==t.top,o="2px"===t.marginLeft,n="4px"===t.width,a.style.marginRight="50%",s="4px"===t.marginRight,Ke.removeChild(r)}var i,n,s,o,r=J.createElement("div"),a=J.createElement("div");a.style&&(a.style.backgroundClip="content-box",a.cloneNode(!0).style.backgroundClip="",ne.clearCloneStyle="content-box"===a.style.backgroundClip,r.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",r.appendChild(a),oe.extend(ne,{pixelPosition:function(){return t(),i},boxSizingReliable:function(){return null==n&&t(),n},pixelMarginRight:function(){return null==n&&t(),s},reliableMarginLeft:function(){return null==n&&t(),o},reliableMarginRight:function(){var t,i=a.appendChild(J.createElement("div"));return i.style.cssText=a.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",a.style.width="1px",Ke.appendChild(r),t=!parseFloat(e.getComputedStyle(i).marginRight),Ke.removeChild(r),a.removeChild(i),t}}))}();var Ze=/^(none|table(?!-c[ea]).+)/,et={position:"absolute",visibility:"hidden",display:"block"},tt={letterSpacing:"0",fontWeight:"400"},it=["Webkit","O","Moz","ms"],nt=J.createElement("div").style;oe.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=T(e,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var s,o,r,a=oe.camelCase(t),l=e.style;return t=oe.cssProps[a]||(oe.cssProps[a]=E(a)||a),r=oe.cssHooks[t]||oe.cssHooks[a],void 0===i?r&&"get"in r&&void 0!==(s=r.get(e,!1,n))?s:l[t]:(o=typeof i,"string"===o&&(s=Ae.exec(i))&&s[1]&&(i=u(e,t,s),o="number"),null!=i&&i===i&&("number"===o&&(i+=s&&s[3]||(oe.cssNumber[a]?"":"px")),ne.clearCloneStyle||""!==i||0!==t.indexOf("background")||(l[t]="inherit"),r&&"set"in r&&void 0===(i=r.set(e,i,n))||(l[t]=i)),void 0)}},css:function(e,t,i,n){var s,o,r,a=oe.camelCase(t);return t=oe.cssProps[a]||(oe.cssProps[a]=E(a)||a),r=oe.cssHooks[t]||oe.cssHooks[a],r&&"get"in r&&(s=r.get(e,!0,i)),void 0===s&&(s=T(e,t,n)),"normal"===s&&t in tt&&(s=tt[t]),""===i||i?(o=parseFloat(s),i===!0||isFinite(o)?o||0:s):s}}),oe.each(["height","width"],function(e,t){oe.cssHooks[t]={get:function(e,i,n){return i?Ze.test(oe.css(e,"display"))&&0===e.offsetWidth?Ye(e,et,function(){return P(e,t,n)}):P(e,t,n):void 0},set:function(e,i,n){var s,o=n&&Qe(e),r=n&&A(e,t,n,"border-box"===oe.css(e,"boxSizing",!1,o),o);return r&&(s=Ae.exec(i))&&"px"!==(s[3]||"px")&&(e.style[t]=i,i=oe.css(e,t)),q(e,i,r)}}}),oe.cssHooks.marginLeft=j(ne.reliableMarginLeft,function(e,t){return t?(parseFloat(T(e,"marginLeft"))||e.getBoundingClientRect().left-Ye(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px":void 0}),oe.cssHooks.marginRight=j(ne.reliableMarginRight,function(e,t){return t?Ye(e,{display:"inline-block"},T,[e,"marginRight"]):void 0}),oe.each({margin:"",padding:"",border:"Width"},function(e,t){oe.cssHooks[e+t]={expand:function(i){for(var n=0,s={},o="string"==typeof i?i.split(" "):[i];4>n;n++)s[e+Pe[n]+t]=o[n]||o[n-2]||o[0];return s}},Xe.test(e)||(oe.cssHooks[e+t].set=q)}),oe.fn.extend({css:function(e,t){return ke(this,function(e,t,i){var n,s,o={},r=0;if(oe.isArray(t)){for(n=Qe(e),s=t.length;s>r;r++)o[t[r]]=oe.css(e,t[r],!1,n);return o}return void 0!==i?oe.style(e,t,i):oe.css(e,t)},e,t,arguments.length>1)},show:function(){return F(this,!0)},hide:function(){return F(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Fe(this)?oe(this).show():oe(this).hide()})}}),oe.Tween=D,D.prototype={constructor:D,init:function(e,t,i,n,s,o){this.elem=e,this.prop=i,this.easing=s||oe.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=o||(oe.cssNumber[i]?"":"px")},cur:function(){var e=D.propHooks[this.prop];return e&&e.get?e.get(this):D.propHooks._default.get(this)},run:function(e){var t,i=D.propHooks[this.prop];return this.options.duration?this.pos=t=oe.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):D.propHooks._default.set(this),this}},D.prototype.init.prototype=D.prototype,D.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=oe.css(e.elem,e.prop,""),t&&"auto"!==t?t:0)},set:function(e){oe.fx.step[e.prop]?oe.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[oe.cssProps[e.prop]]&&!oe.cssHooks[e.prop]?e.elem[e.prop]=e.now:oe.style(e.elem,e.prop,e.now+e.unit)}}},D.propHooks.scrollTop=D.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},oe.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},oe.fx=D.prototype.init,oe.fx.step={};var st,ot,rt=/^(?:toggle|show|hide)$/,at=/queueHooks$/;oe.Animation=oe.extend(L,{tweeners:{"*":[function(e,t){var i=this.createTween(e,t);return u(i.elem,e,Ae.exec(t),i),i}]},tweener:function(e,t){oe.isFunction(e)?(t=e,e=["*"]):e=e.match(we);for(var i,n=0,s=e.length;s>n;n++)i=e[n],L.tweeners[i]=L.tweeners[i]||[],L.tweeners[i].unshift(t)},prefilters:[I],prefilter:function(e,t){t?L.prefilters.unshift(e):L.prefilters.push(e)}}),oe.speed=function(e,t,i){var n=e&&"object"==typeof e?oe.extend({},e):{complete:i||!i&&t||oe.isFunction(e)&&e,duration:e,easing:i&&t||t&&!oe.isFunction(t)&&t};return n.duration=oe.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in oe.fx.speeds?oe.fx.speeds[n.duration]:oe.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){oe.isFunction(n.old)&&n.old.call(this),n.queue&&oe.dequeue(this,n.queue)},n},oe.fn.extend({fadeTo:function(e,t,i,n){return this.filter(Fe).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var s=oe.isEmptyObject(e),o=oe.speed(t,i,n),r=function(){var t=L(this,oe.extend({},e),o);(s||Se.get(this,"finish"))&&t.stop(!0)};return r.finish=r,s||o.queue===!1?this.each(r):this.queue(o.queue,r)},stop:function(e,t,i){var n=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,s=null!=e&&e+"queueHooks",o=oe.timers,r=Se.get(this);if(s)r[s]&&r[s].stop&&n(r[s]);else for(s in r)r[s]&&r[s].stop&&at.test(s)&&n(r[s]);for(s=o.length;s--;)o[s].elem!==this||null!=e&&o[s].queue!==e||(o[s].anim.stop(i),t=!1,o.splice(s,1));(t||!i)&&oe.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=Se.get(this),n=i[e+"queue"],s=i[e+"queueHooks"],o=oe.timers,r=n?n.length:0;for(i.finish=!0,oe.queue(this,e,[]),s&&s.stop&&s.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;r>t;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish})}}),oe.each(["toggle","show","hide"],function(e,t){var i=oe.fn[t];oe.fn[t]=function(e,n,s){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(O(t,!0),e,n,s)}}),oe.each({slideDown:O("show"),slideUp:O("hide"),slideToggle:O("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){oe.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),oe.timers=[],oe.fx.tick=function(){var e,t=0,i=oe.timers;for(st=oe.now();t<i.length;t++)e=i[t],
e()||i[t]!==e||i.splice(t--,1);i.length||oe.fx.stop(),st=void 0},oe.fx.timer=function(e){oe.timers.push(e),e()?oe.fx.start():oe.timers.pop()},oe.fx.interval=13,oe.fx.start=function(){ot||(ot=e.setInterval(oe.fx.tick,oe.fx.interval))},oe.fx.stop=function(){e.clearInterval(ot),ot=null},oe.fx.speeds={slow:600,fast:200,_default:400},oe.fn.delay=function(t,i){return t=oe.fx?oe.fx.speeds[t]||t:t,i=i||"fx",this.queue(i,function(i,n){var s=e.setTimeout(i,t);n.stop=function(){e.clearTimeout(s)}})},function(){var e=J.createElement("input"),t=J.createElement("select"),i=t.appendChild(J.createElement("option"));e.type="checkbox",ne.checkOn=""!==e.value,ne.optSelected=i.selected,t.disabled=!0,ne.optDisabled=!i.disabled,e=J.createElement("input"),e.value="t",e.type="radio",ne.radioValue="t"===e.value}();var lt,ut=oe.expr.attrHandle;oe.fn.extend({attr:function(e,t){return ke(this,oe.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){oe.removeAttr(this,e)})}}),oe.extend({attr:function(e,t,i){var n,s,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?oe.prop(e,t,i):(1===o&&oe.isXMLDoc(e)||(t=t.toLowerCase(),s=oe.attrHooks[t]||(oe.expr.match.bool.test(t)?lt:void 0)),void 0!==i?null===i?void oe.removeAttr(e,t):s&&"set"in s&&void 0!==(n=s.set(e,i,t))?n:(e.setAttribute(t,i+""),i):s&&"get"in s&&null!==(n=s.get(e,t))?n:(n=oe.find.attr(e,t),null==n?void 0:n))},attrHooks:{type:{set:function(e,t){if(!ne.radioValue&&"radio"===t&&oe.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},removeAttr:function(e,t){var i,n,s=0,o=t&&t.match(we);if(o&&1===e.nodeType)for(;i=o[s++];)n=oe.propFix[i]||i,oe.expr.match.bool.test(i)&&(e[n]=!1),e.removeAttribute(i)}}),lt={set:function(e,t,i){return t===!1?oe.removeAttr(e,i):e.setAttribute(i,i),i}},oe.each(oe.expr.match.bool.source.match(/\w+/g),function(e,t){var i=ut[t]||oe.find.attr;ut[t]=function(e,t,n){var s,o;return n||(o=ut[t],ut[t]=s,s=null!=i(e,t,n)?t.toLowerCase():null,ut[t]=o),s}});var ct=/^(?:input|select|textarea|button)$/i,dt=/^(?:a|area)$/i;oe.fn.extend({prop:function(e,t){return ke(this,oe.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[oe.propFix[e]||e]})}}),oe.extend({prop:function(e,t,i){var n,s,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&oe.isXMLDoc(e)||(t=oe.propFix[t]||t,s=oe.propHooks[t]),void 0!==i?s&&"set"in s&&void 0!==(n=s.set(e,i,t))?n:e[t]=i:s&&"get"in s&&null!==(n=s.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){var t=oe.find.attr(e,"tabindex");return t?parseInt(t,10):ct.test(e.nodeName)||dt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),ne.optSelected||(oe.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),oe.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){oe.propFix[this.toLowerCase()]=this});var ht=/[\t\r\n\f]/g;oe.fn.extend({addClass:function(e){var t,i,n,s,o,r,a,l=0;if(oe.isFunction(e))return this.each(function(t){oe(this).addClass(e.call(this,t,M(this)))});if("string"==typeof e&&e)for(t=e.match(we)||[];i=this[l++];)if(s=M(i),n=1===i.nodeType&&(" "+s+" ").replace(ht," ")){for(r=0;o=t[r++];)n.indexOf(" "+o+" ")<0&&(n+=o+" ");a=oe.trim(n),s!==a&&i.setAttribute("class",a)}return this},removeClass:function(e){var t,i,n,s,o,r,a,l=0;if(oe.isFunction(e))return this.each(function(t){oe(this).removeClass(e.call(this,t,M(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(we)||[];i=this[l++];)if(s=M(i),n=1===i.nodeType&&(" "+s+" ").replace(ht," ")){for(r=0;o=t[r++];)for(;n.indexOf(" "+o+" ")>-1;)n=n.replace(" "+o+" "," ");a=oe.trim(n),s!==a&&i.setAttribute("class",a)}return this},toggleClass:function(e,t){var i=typeof e;return"boolean"==typeof t&&"string"===i?t?this.addClass(e):this.removeClass(e):oe.isFunction(e)?this.each(function(i){oe(this).toggleClass(e.call(this,i,M(this),t),t)}):this.each(function(){var t,n,s,o;if("string"===i)for(n=0,s=oe(this),o=e.match(we)||[];t=o[n++];)s.hasClass(t)?s.removeClass(t):s.addClass(t);else(void 0===e||"boolean"===i)&&(t=M(this),t&&Se.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||e===!1?"":Se.get(this,"__className__")||""))})},hasClass:function(e){var t,i,n=0;for(t=" "+e+" ";i=this[n++];)if(1===i.nodeType&&(" "+M(i)+" ").replace(ht," ").indexOf(t)>-1)return!0;return!1}});var pt=/\r/g,ft=/[\x20\t\r\n\f]+/g;oe.fn.extend({val:function(e){var t,i,n,s=this[0];{if(arguments.length)return n=oe.isFunction(e),this.each(function(i){var s;1===this.nodeType&&(s=n?e.call(this,i,oe(this).val()):e,null==s?s="":"number"==typeof s?s+="":oe.isArray(s)&&(s=oe.map(s,function(e){return null==e?"":e+""})),t=oe.valHooks[this.type]||oe.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,s,"value")||(this.value=s))});if(s)return t=oe.valHooks[s.type]||oe.valHooks[s.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(i=t.get(s,"value"))?i:(i=s.value,"string"==typeof i?i.replace(pt,""):null==i?"":i)}}}),oe.extend({valHooks:{option:{get:function(e){var t=oe.find.attr(e,"value");return null!=t?t:oe.trim(oe.text(e)).replace(ft," ")}},select:{get:function(e){for(var t,i,n=e.options,s=e.selectedIndex,o="select-one"===e.type||0>s,r=o?null:[],a=o?s+1:n.length,l=0>s?a:o?s:0;a>l;l++)if(i=n[l],(i.selected||l===s)&&(ne.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!oe.nodeName(i.parentNode,"optgroup"))){if(t=oe(i).val(),o)return t;r.push(t)}return r},set:function(e,t){for(var i,n,s=e.options,o=oe.makeArray(t),r=s.length;r--;)n=s[r],(n.selected=oe.inArray(oe.valHooks.option.get(n),o)>-1)&&(i=!0);return i||(e.selectedIndex=-1),o}}}}),oe.each(["radio","checkbox"],function(){oe.valHooks[this]={set:function(e,t){return oe.isArray(t)?e.checked=oe.inArray(oe(e).val(),t)>-1:void 0}},ne.checkOn||(oe.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var mt=/^(?:focusinfocus|focusoutblur)$/;oe.extend(oe.event,{trigger:function(t,i,n,s){var o,r,a,l,u,c,d,h=[n||J],p=ie.call(t,"type")?t.type:t,f=ie.call(t,"namespace")?t.namespace.split("."):[];if(r=a=n=n||J,3!==n.nodeType&&8!==n.nodeType&&!mt.test(p+oe.event.triggered)&&(p.indexOf(".")>-1&&(f=p.split("."),p=f.shift(),f.sort()),u=p.indexOf(":")<0&&"on"+p,t=t[oe.expando]?t:new oe.Event(p,"object"==typeof t&&t),t.isTrigger=s?2:3,t.namespace=f.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),i=null==i?[t]:oe.makeArray(i,[t]),d=oe.event.special[p]||{},s||!d.trigger||d.trigger.apply(n,i)!==!1)){if(!s&&!d.noBubble&&!oe.isWindow(n)){for(l=d.delegateType||p,mt.test(l+p)||(r=r.parentNode);r;r=r.parentNode)h.push(r),a=r;a===(n.ownerDocument||J)&&h.push(a.defaultView||a.parentWindow||e)}for(o=0;(r=h[o++])&&!t.isPropagationStopped();)t.type=o>1?l:d.bindType||p,c=(Se.get(r,"events")||{})[t.type]&&Se.get(r,"handle"),c&&c.apply(r,i),c=u&&r[u],c&&c.apply&&Ce(r)&&(t.result=c.apply(r,i),t.result===!1&&t.preventDefault());return t.type=p,s||t.isDefaultPrevented()||d._default&&d._default.apply(h.pop(),i)!==!1||!Ce(n)||u&&oe.isFunction(n[p])&&!oe.isWindow(n)&&(a=n[u],a&&(n[u]=null),oe.event.triggered=p,n[p](),oe.event.triggered=void 0,a&&(n[u]=a)),t.result}},simulate:function(e,t,i){var n=oe.extend(new oe.Event,i,{type:e,isSimulated:!0});oe.event.trigger(n,null,t)}}),oe.fn.extend({trigger:function(e,t){return this.each(function(){oe.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];return i?oe.event.trigger(e,t,i,!0):void 0}}),oe.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){oe.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),oe.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),ne.focusin="onfocusin"in e,ne.focusin||oe.each({focus:"focusin",blur:"focusout"},function(e,t){var i=function(e){oe.event.simulate(t,e.target,oe.event.fix(e))};oe.event.special[t]={setup:function(){var n=this.ownerDocument||this,s=Se.access(n,t);s||n.addEventListener(e,i,!0),Se.access(n,t,(s||0)+1)},teardown:function(){var n=this.ownerDocument||this,s=Se.access(n,t)-1;s?Se.access(n,t,s):(n.removeEventListener(e,i,!0),Se.remove(n,t))}}});var gt=e.location,vt=oe.now(),_t=/\?/;oe.parseJSON=function(e){return JSON.parse(e+"")},oe.parseXML=function(t){var i;if(!t||"string"!=typeof t)return null;try{i=(new e.DOMParser).parseFromString(t,"text/xml")}catch(n){i=void 0}return(!i||i.getElementsByTagName("parsererror").length)&&oe.error("Invalid XML: "+t),i};var bt=/#.*$/,yt=/([?&])_=[^&]*/,wt=/^(.*?):[ \t]*([^\r\n]*)$/gm,xt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,kt=/^(?:GET|HEAD)$/,Ct=/^\/\//,St={},Tt={},jt="*/".concat("*"),Et=J.createElement("a");Et.href=gt.href,oe.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:gt.href,type:"GET",isLocal:xt.test(gt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":jt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":oe.parseJSON,"text xml":oe.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?B(B(e,oe.ajaxSettings),t):B(oe.ajaxSettings,e)},ajaxPrefilter:H(St),ajaxTransport:H(Tt),ajax:function(t,i){function n(t,i,n,a){var u,d,_,b,w,k=i;2!==y&&(y=2,l&&e.clearTimeout(l),s=void 0,r=a||"",x.readyState=t>0?4:0,u=t>=200&&300>t||304===t,n&&(b=V(h,x,n)),b=U(h,b,x,u),u?(h.ifModified&&(w=x.getResponseHeader("Last-Modified"),w&&(oe.lastModified[o]=w),w=x.getResponseHeader("etag"),w&&(oe.etag[o]=w)),204===t||"HEAD"===h.type?k="nocontent":304===t?k="notmodified":(k=b.state,d=b.data,_=b.error,u=!_)):(_=k,(t||!k)&&(k="error",0>t&&(t=0))),x.status=t,x.statusText=(i||k)+"",u?m.resolveWith(p,[d,k,x]):m.rejectWith(p,[x,k,_]),x.statusCode(v),v=void 0,c&&f.trigger(u?"ajaxSuccess":"ajaxError",[x,h,u?d:_]),g.fireWith(p,[x,k]),c&&(f.trigger("ajaxComplete",[x,h]),--oe.active||oe.event.trigger("ajaxStop")))}"object"==typeof t&&(i=t,t=void 0),i=i||{};var s,o,r,a,l,u,c,d,h=oe.ajaxSetup({},i),p=h.context||h,f=h.context&&(p.nodeType||p.jquery)?oe(p):oe.event,m=oe.Deferred(),g=oe.Callbacks("once memory"),v=h.statusCode||{},_={},b={},y=0,w="canceled",x={readyState:0,getResponseHeader:function(e){var t;if(2===y){if(!a)for(a={};t=wt.exec(r);)a[t[1].toLowerCase()]=t[2];t=a[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===y?r:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return y||(e=b[i]=b[i]||e,_[e]=t),this},overrideMimeType:function(e){return y||(h.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>y)for(t in e)v[t]=[v[t],e[t]];else x.always(e[x.status]);return this},abort:function(e){var t=e||w;return s&&s.abort(t),n(0,t),this}};if(m.promise(x).complete=g.add,x.success=x.done,x.error=x.fail,h.url=((t||h.url||gt.href)+"").replace(bt,"").replace(Ct,gt.protocol+"//"),h.type=i.method||i.type||h.method||h.type,h.dataTypes=oe.trim(h.dataType||"*").toLowerCase().match(we)||[""],null==h.crossDomain){u=J.createElement("a");try{u.href=h.url,u.href=u.href,h.crossDomain=Et.protocol+"//"+Et.host!=u.protocol+"//"+u.host}catch(k){h.crossDomain=!0}}if(h.data&&h.processData&&"string"!=typeof h.data&&(h.data=oe.param(h.data,h.traditional)),N(St,h,i,x),2===y)return x;c=oe.event&&h.global,c&&0===oe.active++&&oe.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!kt.test(h.type),o=h.url,h.hasContent||(h.data&&(o=h.url+=(_t.test(o)?"&":"?")+h.data,delete h.data),h.cache===!1&&(h.url=yt.test(o)?o.replace(yt,"$1_="+vt++):o+(_t.test(o)?"&":"?")+"_="+vt++)),h.ifModified&&(oe.lastModified[o]&&x.setRequestHeader("If-Modified-Since",oe.lastModified[o]),oe.etag[o]&&x.setRequestHeader("If-None-Match",oe.etag[o])),(h.data&&h.hasContent&&h.contentType!==!1||i.contentType)&&x.setRequestHeader("Content-Type",h.contentType),x.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+jt+"; q=0.01":""):h.accepts["*"]);for(d in h.headers)x.setRequestHeader(d,h.headers[d]);if(h.beforeSend&&(h.beforeSend.call(p,x,h)===!1||2===y))return x.abort();w="abort";for(d in{success:1,error:1,complete:1})x[d](h[d]);if(s=N(Tt,h,i,x)){if(x.readyState=1,c&&f.trigger("ajaxSend",[x,h]),2===y)return x;h.async&&h.timeout>0&&(l=e.setTimeout(function(){x.abort("timeout")},h.timeout));try{y=1,s.send(_,n)}catch(k){if(!(2>y))throw k;n(-1,k)}}else n(-1,"No Transport");return x},getJSON:function(e,t,i){return oe.get(e,t,i,"json")},getScript:function(e,t){return oe.get(e,void 0,t,"script")}}),oe.each(["get","post"],function(e,t){oe[t]=function(e,i,n,s){return oe.isFunction(i)&&(s=s||n,n=i,i=void 0),oe.ajax(oe.extend({url:e,type:t,dataType:s,data:i,success:n},oe.isPlainObject(e)&&e))}}),oe._evalUrl=function(e){return oe.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},oe.fn.extend({wrapAll:function(e){var t;return oe.isFunction(e)?this.each(function(t){oe(this).wrapAll(e.call(this,t))}):(this[0]&&(t=oe(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return oe.isFunction(e)?this.each(function(t){oe(this).wrapInner(e.call(this,t))}):this.each(function(){var t=oe(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=oe.isFunction(e);return this.each(function(i){oe(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){oe.nodeName(this,"body")||oe(this).replaceWith(this.childNodes)}).end()}}),oe.expr.filters.hidden=function(e){return!oe.expr.filters.visible(e)},oe.expr.filters.visible=function(e){return e.offsetWidth>0||e.offsetHeight>0||e.getClientRects().length>0};var qt=/%20/g,At=/\[\]$/,Pt=/\r?\n/g,Ft=/^(?:submit|button|image|reset|file)$/i,Dt=/^(?:input|select|textarea|keygen)/i;oe.param=function(e,t){var i,n=[],s=function(e,t){t=oe.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=oe.ajaxSettings&&oe.ajaxSettings.traditional),oe.isArray(e)||e.jquery&&!oe.isPlainObject(e))oe.each(e,function(){s(this.name,this.value)});else for(i in e)W(i,e[i],t,s);return n.join("&").replace(qt,"+")},oe.fn.extend({serialize:function(){return oe.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=oe.prop(this,"elements");return e?oe.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!oe(this).is(":disabled")&&Dt.test(this.nodeName)&&!Ft.test(e)&&(this.checked||!De.test(e))}).map(function(e,t){var i=oe(this).val();return null==i?null:oe.isArray(i)?oe.map(i,function(e){return{name:t.name,value:e.replace(Pt,"\r\n")}}):{name:t.name,value:i.replace(Pt,"\r\n")}}).get()}}),oe.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(t){}};var Rt={0:200,1223:204},Ot=oe.ajaxSettings.xhr();ne.cors=!!Ot&&"withCredentials"in Ot,ne.ajax=Ot=!!Ot,oe.ajaxTransport(function(t){var i,n;return ne.cors||Ot&&!t.crossDomain?{send:function(s,o){var r,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(r in t.xhrFields)a[r]=t.xhrFields[r];t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||s["X-Requested-With"]||(s["X-Requested-With"]="XMLHttpRequest");for(r in s)a.setRequestHeader(r,s[r]);i=function(e){return function(){i&&(i=n=a.onload=a.onerror=a.onabort=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?o(0,"error"):o(a.status,a.statusText):o(Rt[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=i(),n=a.onerror=i("error"),void 0!==a.onabort?a.onabort=n:a.onreadystatechange=function(){4===a.readyState&&e.setTimeout(function(){i&&n()})},i=i("abort");try{a.send(t.hasContent&&t.data||null)}catch(l){if(i)throw l}},abort:function(){i&&i()}}:void 0}),oe.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return oe.globalEval(e),e}}}),oe.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),oe.ajaxTransport("script",function(e){if(e.crossDomain){var t,i;return{send:function(n,s){t=oe("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&s("error"===e.type?404:200,e.type)}),J.head.appendChild(t[0])},abort:function(){i&&i()}}}});var $t=[],It=/(=)\?(?=&|$)|\?\?/;oe.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=$t.pop()||oe.expando+"_"+vt++;return this[e]=!0,e}}),oe.ajaxPrefilter("json jsonp",function(t,i,n){var s,o,r,a=t.jsonp!==!1&&(It.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&It.test(t.data)&&"data");return a||"jsonp"===t.dataTypes[0]?(s=t.jsonpCallback=oe.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(It,"$1"+s):t.jsonp!==!1&&(t.url+=(_t.test(t.url)?"&":"?")+t.jsonp+"="+s),t.converters["script json"]=function(){return r||oe.error(s+" was not called"),r[0]},t.dataTypes[0]="json",o=e[s],e[s]=function(){r=arguments},n.always(function(){void 0===o?oe(e).removeProp(s):e[s]=o,t[s]&&(t.jsonpCallback=i.jsonpCallback,$t.push(s)),r&&oe.isFunction(o)&&o(r[0]),r=o=void 0}),"script"):void 0}),oe.parseHTML=function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||J;var n=fe.exec(e),s=!i&&[];return n?[t.createElement(n[1])]:(n=h([e],t,s),s&&s.length&&oe(s).remove(),oe.merge([],n.childNodes))};var zt=oe.fn.load;oe.fn.load=function(e,t,i){if("string"!=typeof e&&zt)return zt.apply(this,arguments);var n,s,o,r=this,a=e.indexOf(" ");return a>-1&&(n=oe.trim(e.slice(a)),e=e.slice(0,a)),oe.isFunction(t)?(i=t,t=void 0):t&&"object"==typeof t&&(s="POST"),r.length>0&&oe.ajax({url:e,type:s||"GET",dataType:"html",data:t}).done(function(e){o=arguments,r.html(n?oe("<div>").append(oe.parseHTML(e)).find(n):e)}).always(i&&function(e,t){r.each(function(){i.apply(this,o||[e.responseText,t,e])})}),this},oe.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){oe.fn[t]=function(e){return this.on(t,e)}}),oe.expr.filters.animated=function(e){return oe.grep(oe.timers,function(t){return e===t.elem}).length},oe.offset={setOffset:function(e,t,i){var n,s,o,r,a,l,u,c=oe.css(e,"position"),d=oe(e),h={};"static"===c&&(e.style.position="relative"),a=d.offset(),o=oe.css(e,"top"),l=oe.css(e,"left"),u=("absolute"===c||"fixed"===c)&&(o+l).indexOf("auto")>-1,u?(n=d.position(),r=n.top,s=n.left):(r=parseFloat(o)||0,s=parseFloat(l)||0),oe.isFunction(t)&&(t=t.call(e,i,oe.extend({},a))),null!=t.top&&(h.top=t.top-a.top+r),null!=t.left&&(h.left=t.left-a.left+s),"using"in t?t.using.call(e,h):d.css(h)}},oe.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){oe.offset.setOffset(this,e,t)});var t,i,n=this[0],s={top:0,left:0},o=n&&n.ownerDocument;if(o)return t=o.documentElement,oe.contains(t,n)?(s=n.getBoundingClientRect(),i=G(o),{top:s.top+i.pageYOffset-t.clientTop,left:s.left+i.pageXOffset-t.clientLeft}):s},position:function(){if(this[0]){var e,t,i=this[0],n={top:0,left:0};return"fixed"===oe.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),oe.nodeName(e[0],"html")||(n=e.offset()),n.top+=oe.css(e[0],"borderTopWidth",!0),n.left+=oe.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-oe.css(i,"marginTop",!0),left:t.left-n.left-oe.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===oe.css(e,"position");)e=e.offsetParent;return e||Ke})}}),oe.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var i="pageYOffset"===t;oe.fn[e]=function(n){return ke(this,function(e,n,s){var o=G(e);return void 0===s?o?o[t]:e[n]:void(o?o.scrollTo(i?o.pageXOffset:s,i?s:o.pageYOffset):e[n]=s)},e,n,arguments.length)}}),oe.each(["top","left"],function(e,t){oe.cssHooks[t]=j(ne.pixelPosition,function(e,i){return i?(i=T(e,t),Je.test(i)?oe(e).position()[t]+"px":i):void 0})}),oe.each({Height:"height",Width:"width"},function(e,t){oe.each({padding:"inner"+e,content:t,"":"outer"+e},function(i,n){oe.fn[n]=function(n,s){var o=arguments.length&&(i||"boolean"!=typeof n),r=i||(n===!0||s===!0?"margin":"border");return ke(this,function(t,i,n){var s;return oe.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(s=t.documentElement,Math.max(t.body["scroll"+e],s["scroll"+e],t.body["offset"+e],s["offset"+e],s["client"+e])):void 0===n?oe.css(t,i,r):oe.style(t,i,n,r)},t,o?n:void 0,o,null)}})}),oe.fn.extend({bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)},size:function(){return this.length}}),oe.fn.andSelf=oe.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return oe});var Lt=e.jQuery,Mt=e.$;return oe.noConflict=function(t){return e.$===oe&&(e.$=Mt),t&&e.jQuery===oe&&(e.jQuery=Lt),oe},t||(e.jQuery=e.$=oe),oe}),function(){var e=function(){var e={absolute:!1,rootUrl:"http://tutora.co.uk",routes:[{host:null,methods:["GET","HEAD"],uri:"404",name:"404",action:"Closure"},{host:null,methods:["GET","HEAD"],uri:"test",name:null,action:"AppHttpControllershomeController@test"},{host:null,methods:["GET","HEAD"],uri:"img/profile-pictures/{name}@{width}x{height}.{ext}",name:"profile-picture.show",action:"AppHttpControllersProfilePictureController@show"},{host:null,methods:["GET","HEAD"],uri:"img/identity-document/{uuid}.{ext}",name:"identity-document.show",action:"Closure"},{host:null,methods:["GET","HEAD"],uri:"lost-password",name:"password.index",action:"AppHttpControllersPasswordController@index"},{host:null,methods:["POST"],uri:"lost-password",name:"password.create",action:"AppHttpControllersPasswordController@create"},{host:null,methods:["GET","HEAD"],uri:"reset-password/{token}",name:"password.edit",action:"AppHttpControllersPasswordController@edit"},{host:null,methods:["POST"],uri:"reset-password",name:"password.update",action:"AppHttpControllersPasswordController@update"},{host:null,methods:["GET","HEAD"],uri:"/",name:"home",action:"AppHttpControllersHomeController@index"},{host:null,methods:["GET","HEAD"],uri:"about-us",name:"about.index",action:"AppHttpControllersAboutController@index"},{host:null,methods:["POST"],uri:"about-us",name:"about.contact",action:"AppHttpControllersAboutController@contact"},{host:null,methods:["GET","HEAD"],uri:"faqs",name:"faqs.student",action:"AppHttpControllersFaqsController@student"},{host:null,methods:["GET","HEAD"],uri:"faqs/for-tutors",name:"faqs.tutor",action:"AppHttpControllersFaqsController@tutor"},{host:null,methods:["GET","HEAD"],uri:"terms",name:"terms.index",action:"AppHttpControllersTermsController@index"},{host:null,methods:["GET","HEAD"],uri:"privacy-policy",name:"policy.privacy",action:"AppHttpControllersPolicyController@privacy"},{host:null,methods:["GET","HEAD"],uri:"articles",name:"articles.index",action:"AppHttpControllersResourcesArticleController@index"},{host:null,methods:["GET","HEAD"],uri:"articles/{slug}",name:"articles.show",action:"AppHttpControllersResourcesArticleController@show"},{host:null,methods:["GET","HEAD"],uri:"locations",name:"locations.index",action:"AppHttpControllersLocationsController@index"},{host:null,methods:["GET","HEAD"],uri:"locations/{region}/{city}",name:"locations.show",action:"AppHttpControllersLocationsController@show"},{host:null,methods:["POST"],uri:"search",name:"search.create",action:"AppHttpControllersSearchController@create"},{host:null,methods:["GET","HEAD"],uri:"search/{subject}/tutors-near/{location}",name:null,action:"Closure"},{host:null,methods:["GET","HEAD"],uri:"search/{subject}/tutors-in/{location}",name:"search.index",action:"AppHttpControllersSearchController@index"},{host:null,methods:["GET","HEAD"],uri:"search/{subject}/tutors",name:"search.subject",action:"AppHttpControllersSearchController@index"},{host:null,methods:["GET","HEAD"],uri:"search/tutors-in/{location}",name:"search.location",action:"AppHttpControllersSearchController@location"},{host:null,methods:["GET","HEAD"],uri:"search",name:"search.none",action:"AppHttpControllersSearchController@none"},{host:null,methods:["GET","HEAD"],uri:"tutors/{uuid}/{section?}/{tab?}",name:"tutor.profile.show",action:"Closure"},{host:null,methods:["GET","HEAD"],uri:"message/{uuid}",name:"message.create",action:"AppHttpControllersTutorController@show"},{host:null,methods:["GET","HEAD"],uri:"login",name:"auth.login",action:"AppHttpControllersHomeController@index"},{host:null,methods:["GET","HEAD"],uri:"sign-up",name:"register.student",action:"AppHttpControllersHomeController@index"},{host:null,methods:["GET","HEAD"],uri:"become-a-tutor",name:"tutor.index",action:"AppHttpControllersTutorController@index"},{host:null,methods:["GET","HEAD"],uri:"become-a-tutor/sign-up",name:"register.tutor",action:"AppHttpControllersTutorController@index"},{host:null,methods:["GET","HEAD"],uri:"logout",name:"auth.logout",action:"AppHttpControllersAuthController@logout"},{host:null,methods:["GET","HEAD"],uri:"sign-up/confirm",name:"register.confirm",action:"AppHttpControllersAuthController@confirm"},{host:null,methods:["GET","HEAD"],uri:"message",name:"message.redirect",action:"AppHttpControllersMessageController@redirect"},{host:null,methods:["GET","HEAD"],uri:"unsubscribe",name:"unsubscribe",action:"AppHttpControllersSubscriptionsController@unsubscribeFromUrl"},{host:null,methods:["GET","HEAD"],uri:"tutor/dashboard",name:"tutor.dashboard.index",action:"AppHttpControllersTutorDashboardController@index"},{host:null,methods:["GET","HEAD"],uri:"tutor/messages",name:"tutor.messages.index",action:"AppHttpControllersTutorMessagesController@index"},{host:null,methods:["GET","HEAD"],uri:"tutor/messages/{id}/{dialogue?}",name:"tutor.messages.show",action:"AppHttpControllersTutorMessagesController@show"},{host:null,methods:["POST"],uri:"tutor/messages/{id}",name:"tutor.messages.store",action:"AppHttpControllersTutorMessagesController@store"},{host:null,methods:["GET","HEAD"],uri:"tutor/students",name:"tutor.students.index",action:"AppHttpControllersTutorStudentsController@index"},{host:null,methods:["GET","HEAD"],uri:"tutor/lessons",name:"tutor.lessons.index",action:"AppHttpControllersTutorLessonsController@index"},{host:null,methods:["GET","HEAD"],uri:"tutor/lessons/create",name:"tutor.lessons.create",action:"AppHttpControllersTutorLessonsController@index"},{host:null,methods:["GET","HEAD"],uri:"tutor/lessons/{booking}/edit",name:"tutor.lessons.edit",action:"AppHttpControllersTutorLessonsController@index"},{host:null,methods:["GET","HEAD"],uri:"tutor/lessons/{booking}/cancel",name:"tutor.lessons.cancel",action:"AppHttpControllersTutorLessonsController@index"},{host:null,methods:["GET","HEAD"],uri:"tutor/account",name:"tutor.account.index",action:"Closure"},{host:null,methods:["GET","HEAD"],uri:"tutor/account/personal-details",name:"tutor.account.personal.index",action:"AppHttpControllersTutorAccountController@index"},{host:null,methods:["GET","HEAD"],uri:"tutor/account/payment-details",name:"tutor.account.payment.index",action:"AppHttpControllersTutorAccountController@index"},{host:null,methods:["GET","HEAD"],uri:"tutor/account/identification",name:"tutor.account.identification.index",action:"AppHttpControllersTutorAccountController@index"},{host:null,methods:["GET","HEAD"],uri:"review/{tutor}",name:"review.create",action:"AppHttpControllersStudentTutorsController@index"},{host:null,methods:["GET","HEAD"],uri:"student/dashboard",name:"student.dashboard.index",action:"AppHttpControllersStudentDashboardController@index"},{host:null,methods:["GET","HEAD"],uri:"student/messages",name:"student.messages.index",action:"AppHttpControllersStudentMessagesController@index"},{host:null,methods:["GET","HEAD"],uri:"student/messages/{id}/{dialogue?}",name:"student.messages.show",action:"AppHttpControllersStudentMessagesController@show"},{host:null,methods:["POST"],uri:"student/messages/{id}",name:"student.messages.store",action:"AppHttpControllersStudentMessagesController@store"},{host:null,methods:["GET","HEAD"],uri:"student/tutors",name:"student.tutors.index",action:"AppHttpControllersStudentTutorsController@index"},{host:null,methods:["GET","HEAD"],uri:"student/lessons",name:"student.lessons.index",action:"AppHttpControllersStudentLessonsController@index"},{host:null,methods:["GET","HEAD"],uri:"student/lessons/{lesson}",name:"student.lessons.show",action:"AppHttpControllersStudentLessonsController@show"},{host:null,methods:["GET","HEAD"],uri:"student/lessons/{booking}/confirm",name:"student.lessons.confirm",action:"AppHttpControllersStudentLessonsController@confirm"},{host:null,methods:["GET","HEAD"],uri:"student/lessons/{booking}/confirmed",name:"student.lessons.confirmed",action:"AppHttpControllersStudentLessonsController@confirmed"},{host:null,methods:["GET","HEAD"],uri:"student/lessons/{booking}/pay",name:"student.lessons.pay",action:"AppHttpControllersStudentLessonsController@index"},{host:null,methods:["GET","HEAD"],uri:"student/lessons/{booking}/cancel",name:"student.lessons.cancel",action:"AppHttpControllersStudentLessonsController@index"},{host:null,methods:["GET","HEAD"],uri:"student/account",name:"student.account.index",action:"Closure"},{host:null,methods:["GET","HEAD"],uri:"student/account/personal-details",name:"student.account.personal.index",action:"AppHttpControllersStudentAccountController@index"},{host:null,methods:["GET","HEAD"],uri:"student/account/payment-details",name:"student.account.payment.index",action:"AppHttpControllersStudentAccountController@index"},{host:null,methods:["GET","HEAD"],uri:"admin",name:null,action:"Closure"},{host:null,methods:["GET","HEAD"],uri:"admin/dashboard",name:"admin.dashboard.index",action:"AppHttpControllersAdminDashboardController@index"},{host:null,methods:["GET","HEAD"],uri:"admin/relationships",name:"admin.relationships.index",action:"AppHttpControllersAdminRelationshipsController@index"},{host:null,methods:["GET","HEAD"],uri:"admin/relationships/create",name:"admin.relationships.create",action:"AppHttpControllersAdminRelationshipsController@create"},{host:null,methods:["POST"],uri:"admin/relationships",name:"admin.relationships.store",action:"AppHttpControllersAdminRelationshipsController@store"},{host:null,methods:["GET","HEAD"],uri:"admin/relationships/{id}",name:"admin.relationships.show",action:"AppHttpControllersAdminRelationshipsController@show"},{host:null,methods:["GET","HEAD"],uri:"admin/relationships/{id}/details",name:"admin.relationships.details.show",action:"AppHttpControllersAdminRelationshipsDetailsController@show"},{host:null,methods:["GET","HEAD"],uri:"admin/relationships/{id}/details/edit",name:"admin.relationships.details.edit",action:"AppHttpControllersAdminRelationshipsDetailsController@edit"},{host:null,methods:["POST"],uri:"admin/relationships/{id}/details",name:"admin.relationships.details.update",
action:"AppHttpControllersAdminRelationshipsDetailsController@update"},{host:null,methods:["POST"],uri:"admin/relationships/{id}/tasks",name:"admin.relationships.tasks.store",action:"AppHttpControllersAdminRelationshipsTasksController@store"},{host:null,methods:["POST"],uri:"admin/relationships/{id}/tasks/{task}",name:"admin.relationships.tasks.update",action:"AppHttpControllersAdminRelationshipsTasksController@update"},{host:null,methods:["DELETE"],uri:"admin/relationships/{relationship}/tasks/{task}",name:"admin.relationships.tasks.destroy",action:"AppHttpControllersAdminRelationshipsTasksController@destroy"},{host:null,methods:["PUT"],uri:"admin/relationships/{id}/notes",name:"admin.relationships.notes.update",action:"Closure"},{host:null,methods:["GET","HEAD"],uri:"admin/relationships/{id}/messages",name:"admin.relationships.messages.show",action:"AppHttpControllersAdminRelationshipsMessagesController@show"},{host:null,methods:["POST"],uri:"admin/relationships/{id}/messages",name:"admin.relationships.messages.store",action:"AppHttpControllersAdminRelationshipsMessagesController@store"},{host:null,methods:["GET","HEAD"],uri:"admin/relationships/{id}/lessons",name:"admin.relationships.lessons.index",action:"AppHttpControllersAdminRelationshipsLessonsController@index"},{host:null,methods:["GET","HEAD"],uri:"admin/tutors",name:"admin.tutors.index",action:"AppHttpControllersAdminTutorsController@index"},{host:null,methods:["GET","HEAD"],uri:"admin/tutors/profile-score",name:"admin.tutors.profile-score",action:"AppHttpControllersAdminTutorsController@profileScore"},{host:null,methods:["GET","HEAD"],uri:"admin/tutors/booking-score",name:"admin.tutors.booking-score",action:"AppHttpControllersAdminTutorsController@bookingScore"},{host:null,methods:["GET","HEAD"],uri:"admin/tutors/{uuid}",name:"admin.tutors.show",action:"AppHttpControllersAdminTutorsController@show"},{host:null,methods:["GET","HEAD"],uri:"admin/tutors/{uuid}/delete",name:"admin.tutors.delete",action:"AppHttpControllersAdminTutorsController@delete"},{host:null,methods:["GET","HEAD"],uri:"admin/tutors/{uuid}/personal",name:"admin.tutors.personal.show",action:"AppHttpControllersAdminTutorsPersonalController@show"},{host:null,methods:["GET","HEAD"],uri:"admin/tutors/{uuid}/personal/edit",name:"admin.tutors.personal.edit",action:"AppHttpControllersAdminTutorsPersonalController@edit"},{host:null,methods:["POST"],uri:"admin/tutors/{uuid}/personal",name:"admin.tutors.personal.update",action:"AppHttpControllersAdminTutorsPersonalController@update"},{host:null,methods:["POST"],uri:"admin/tutors/{uuid}/tasks",name:"admin.tutors.tasks.store",action:"Closure"},{host:null,methods:["POST"],uri:"admin/tutors/{uuid}/tasks/{task}",name:"admin.tutors.tasks.update",action:"Closure"},{host:null,methods:["DELETE"],uri:"admin/tutors/{uuid}/tasks/{task}",name:"admin.tutors.tasks.destroy",action:"Closure"},{host:null,methods:["PUT"],uri:"admin/tutors/{uuid}/notes",name:"admin.tutors.notes.update",action:"Closure"},{host:null,methods:["GET","HEAD"],uri:"admin/tutors/{uuid}/relationships",name:"admin.tutors.relationships.index",action:"AppHttpControllersAdminTutorsRelationshipsController@index"},{host:null,methods:["GET","HEAD"],uri:"admin/tutors/{uuid}/billing",name:"admin.tutors.billing.index",action:"AppHttpControllersAdminTutorsBillingController@index"},{host:null,methods:["GET","HEAD"],uri:"admin/tutors/{uuid}/lessons",name:"admin.tutors.lessons.index",action:"AppHttpControllersAdminTutorsLessonsController@index"},{host:null,methods:["GET","HEAD"],uri:"admin/tutors/{uuid}/lessons/create",name:"admin.tutors.lessons.create",action:"AppHttpControllersAdminTutorsLessonsController@index"},{host:null,methods:["GET","HEAD"],uri:"admin/students",name:"admin.students.index",action:"AppHttpControllersAdminStudentsController@index"},{host:null,methods:["GET","HEAD"],uri:"admin/students/{uuid}",name:"admin.students.show",action:"AppHttpControllersAdminStudentsController@show"},{host:null,methods:["POST"],uri:"admin/students/{uuid}/delete",name:"admin.students.delete",action:"AppHttpControllersAdminStudentsController@delete"},{host:null,methods:["GET","HEAD"],uri:"admin/students/{uuid}/personal",name:"admin.students.personal.show",action:"AppHttpControllersAdminStudentsPersonalController@show"},{host:null,methods:["GET","HEAD"],uri:"admin/students/{uuid}/payment",name:"admin.students.payment.index",action:"AppHttpControllersAdminStudentsPaymentsController@index"},{host:null,methods:["GET","HEAD"],uri:"admin/students/{uuid}/personal/edit",name:"admin.students.personal.edit",action:"AppHttpControllersAdminStudentsPersonalController@edit"},{host:null,methods:["POST"],uri:"admin/students/{uuid}/personal",name:"admin.students.personal.update",action:"AppHttpControllersAdminStudentsPersonalController@update"},{host:null,methods:["POST"],uri:"admin/students/{uuid}/tasks",name:"admin.students.tasks.store",action:"Closure"},{host:null,methods:["POST"],uri:"admin/students/{uuid}/tasks/{task}",name:"admin.students.tasks.update",action:"Closure"},{host:null,methods:["DELETE"],uri:"admin/students/{uuid}/tasks/{task}",name:"admin.students.tasks.destroy",action:"Closure"},{host:null,methods:["PUT"],uri:"admin/students/{uuid}/notes",name:"admin.students.notes.update",action:"Closure"},{host:null,methods:["GET","HEAD"],uri:"admin/students/{uuid}/relationships",name:"admin.students.relationships.index",action:"AppHttpControllersAdminStudentsRelationshipsController@index"},{host:null,methods:["GET","HEAD"],uri:"admin/students/{uuid}/lessons",name:"admin.students.lessons.index",action:"AppHttpControllersAdminStudentsLessonsController@index"},{host:null,methods:["GET","HEAD"],uri:"admin/students/{uuid}/lessons/{lessonUuid}/confirm",name:"admin.students.lessons.confirm",action:"AppHttpControllersAdminStudentsLessonsController@confirm"},{host:null,methods:["GET","HEAD"],uri:"admin/students/{uuid}/lessons/{lessonUuid}/retry",name:"admin.students.lessons.retry",action:"AppHttpControllersAdminStudentsLessonsController@retry"},{host:null,methods:["GET","HEAD"],uri:"admin/messages",name:"admin.messages.index",action:"AppHttpControllersAdminMessagesController@index"},{host:null,methods:["GET","HEAD"],uri:"admin/lessons",name:"admin.lessons.index",action:"AppHttpControllersAdminLessonsController@index"},{host:null,methods:["GET","HEAD"],uri:"admin/lessons/{uuid}/refund",name:"admin.lessons.refund",action:"AppHttpControllersAdminLessonsController@index"},{host:null,methods:["GET","HEAD"],uri:"admin/lessons/{uuid}/cancel",name:"admin.lessons.cancel",action:"AppHttpControllersAdminLessonsController@index"},{host:null,methods:["GET","HEAD"],uri:"admin/lessons/{uuid}/edit",name:"admin.lessons.edit",action:"AppHttpControllersAdminLessonsController@index"},{host:null,methods:["GET","HEAD"],uri:"admin/students/{uuid}/settings",name:"admin.students.settings.show",action:"AppHttpControllersAdminStudentsSettingsController@show"},{host:null,methods:["POST"],uri:"admin/students/{uuid}/settings",name:"admin.students.settings.update",action:"AppHttpControllersAdminStudentsSettingsController@update"},{host:null,methods:["GET","HEAD"],uri:"admin/blog",name:"admin.blog.index",action:"AppHttpControllersAdminBlogController@index"},{host:null,methods:["GET","HEAD"],uri:"admin/blog/{id}/article",name:"admin.blog.article.show",action:"AppHttpControllersAdminBlogArticleController@show"},{host:null,methods:["GET","HEAD"],uri:"admin/blog/article/create",name:"admin.blog.article.create",action:"AppHttpControllersAdminBlogArticleController@create"},{host:null,methods:["POST"],uri:"admin/blog/articles",name:"admin.blog.article.store",action:"AppHttpControllersAdminBlogArticleController@store"},{host:null,methods:["GET","HEAD"],uri:"admin/blog/article/{id}/delete",name:"admin.blog.article.delete",action:"AppHttpControllersAdminBlogArticleController@destroy"},{host:null,methods:["POST"],uri:"admin/blog/article/upload",name:"admin.blog.article.upload",action:"AppHttpControllersAdminBlogArticleController@upload"},{host:null,methods:["DELETE"],uri:"admin/blog/article/delete_image",name:"admin.blog.article.delete_image",action:"AppHttpControllersAdminBlogArticleController@delete_image"},{host:null,methods:["GET","HEAD"],uri:"admin/transgressions",name:"admin.transgressions.index",action:"AppHttpControllersAdminTransgressionsController@index"},{host:null,methods:["POST"],uri:"api/cookies",name:null,action:"Closure"},{host:null,methods:["POST"],uri:"api/sessions",name:"api.sessions.create",action:"AppHttpControllersApiSessionsController@create"},{host:null,methods:["POST"],uri:"api/users",name:"api.users.create",action:"AppHttpControllersApiUsersController@create"},{host:null,methods:["PATCH"],uri:"api/users/{uuid}",name:"api.users.edit",action:"AppHttpControllersApiUsersController@edit"},{host:null,methods:["GET","HEAD"],uri:"api/users/{uuid}",name:"api.users.get",action:"AppHttpControllersApiUsersController@get"},{host:null,methods:["DELETE"],uri:"api/users/{uuid}",name:"api.users.destroy",action:"AppHttpControllersApiUsersController@destroy"},{host:null,methods:["POST"],uri:"api/users/{uuid}/profile-picture",name:"api.users.profile-picture.create",action:"AppHttpControllersApiUsersProfilePictureController@create"},{host:null,methods:["POST"],uri:"api/users/{uuid}/identity-document",name:"api.users.identity-document.create",action:"AppHttpControllersApiUsersIdentityDocumentController@create"},{host:null,methods:["POST"],uri:"api/users/{uuid}/qualifications",name:"api.users.qualifications.create",action:"AppHttpControllersApiUsersQualificationsController@create"},{host:null,methods:["PUT"],uri:"api/users/{uuid}/qualifications/qts",name:"api.users.qualifications.qts.create",action:"AppHttpControllersApiUsersQualificationsQTSController@create"},{host:null,methods:["POST"],uri:"api/users/{uuid}/subjects",name:"api.users.subjects.create",action:"AppHttpControllersApiUsersSubjectsController@create"},{host:null,methods:["POST"],uri:"api/users/{uuid}/reviews",name:"api.users.reviews.create",action:"AppHttpControllersApiUsersReviewsController@create"},{host:null,methods:["POST"],uri:"api/users/{uuid}/quiz",name:"api.users.quiz.submit",action:"AppHttpControllersApiUsersQuizController@submit"},{host:null,methods:["POST"],uri:"api/tutors/{uuid}/lessons/book",name:"api.tutors.lessons.book",action:"AppHttpControllersApiTutorsLessonsController@book"},{host:null,methods:["GET","HEAD"],uri:"api/subjects",name:"api.subjects.index",action:"AppHttpControllersApiSubjectsController@index"},{host:null,methods:["GET","HEAD"],uri:"api/quiz",name:"api.quiz.index",action:"AppHttpControllersApiQuizController@index"},{host:null,methods:["GET","HEAD"],uri:"api/quiz_prep",name:"api.quiz_prep.index",action:"AppHttpControllersApiQuizPrepController@index"},{host:null,methods:["GET","HEAD"],uri:"api/dialogue_routes",name:"api.basic_dialogue.routes",action:"AppHttpControllersApiDialogueController@routes"},{host:null,methods:["GET","HEAD"],uri:"api/basic_user_dialogue/{name}",name:"api.basic_dialogue.show",action:"AppHttpControllersApiDialogueController@show"},{host:null,methods:["POST"],uri:"api/user_dialogue_interaction",name:"api.dialogue_interaction.create",action:"AppHttpControllersApiDialogueInteractionController@create"},{host:null,methods:["PATCH"],uri:"api/user_dialogue_interaction/{id}",name:"api.dialogue_interaction.update",action:"AppHttpControllersApiDialogueInteractionController@update"},{host:null,methods:["POST"],uri:"api/messages",name:"api.messages.create",action:"AppHttpControllersApiMessagesController@create"},{host:null,methods:["GET","HEAD"],uri:"api/bookings",name:"api.bookings.store",action:"AppHttpControllersApiBookingsController@store"},{host:null,methods:["POST"],uri:"api/bookings",name:"api.bookings.store",action:"AppHttpControllersApiBookingsController@store"},{host:null,methods:["GET","HEAD"],uri:"api/bookings/{booking}",name:"api.bookings.show",action:"AppHttpControllersApiBookingsController@show"},{host:null,methods:["PUT"],uri:"api/bookings/{booking}",name:"api.bookings.edit",action:"AppHttpControllersApiBookingsController@edit"},{host:null,methods:["PUT"],uri:"api/bookings/{booking}/cancel",name:"api.bookings.cancel",action:"AppHttpControllersApiBookingsController@cancel"},{host:null,methods:["PUT"],uri:"api/bookings/{booking}/refund",name:"api.bookings.refund",action:"AppHttpControllersApiBookingsController@refund"},{host:null,methods:["PUT"],uri:"api/bookings/{booking}/confirm",name:"api.bookings.confirm",action:"AppHttpControllersApiBookingsController@confirm"},{host:null,methods:["GET","HEAD"],uri:"api/autocomplete/tutors",name:"api.autocomplete.tutors",action:"AppHttpControllersApiAutocompleteTutorsController@index"},{host:null,methods:["GET","HEAD"],uri:"api/autocomplete/students",name:"api.autocomplete.students",action:"AppHttpControllersApiAutocompleteStudentsController@index"},{host:null,methods:["GET","HEAD"],uri:"api/autocomplete/search",name:"api.autocomplete.search",action:"AppHttpControllersApiAutocompleteSearchController@index"},{host:null,methods:["GET","HEAD","POST","PUT","PATCH","DELETE"],uri:"api/webhooks/stripe",name:"api.webhooks.stripe",action:"AppHttpControllersApiWebhooksStripeController@handle"},{host:null,methods:["GET","HEAD"],uri:"sitemap.xml",name:"sitemap",action:"AppHttpControllersSitemapController@index"}],prefix:"",route:function(e,t,i){return(i=i||this.getByName(e))?this.toRoute(i,t):void 0},url:function(e,t){t=t||[];var i=e+"/"+t.join("/");return this.getCorrectUrl(i)},toRoute:function(e,t){var i=this.replaceNamedParameters(e.uri,t),n=this.getRouteQueryString(t);return this.getCorrectUrl(i+n)},replaceNamedParameters:function(e,t){return e=e.replace(/\{(.*?)\??\}/g,function(e,i){if(t.hasOwnProperty(i)){var n=t[i];return delete t[i],n}return e}),e=e.replace(/\/\{.*?\?\}/g,"")},getRouteQueryString:function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i+"="+e[i]);return t.length<1?"":"?"+t.join("&")},getByName:function(e){for(var t in this.routes)if(this.routes.hasOwnProperty(t)&&this.routes[t].name===e)return this.routes[t]},getByAction:function(e){for(var t in this.routes)if(this.routes.hasOwnProperty(t)&&this.routes[t].action===e)return this.routes[t]},getCorrectUrl:function(e){var t=this.prefix+"/"+e.replace(/^\/?/,"");return this.absolute?this.rootUrl.replace("//?$/","")+t:t}},t=function(e){if(!e)return"";var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i+'="'+e[i]+'"');return t.join(" ")},i=function(e,i,n){return i=i||e,n=t(n),'<a href="'+e+'" '+n+">"+i+"</a>"};return{action:function(t,i){return i=i||{},e.route(t,i,e.getByAction(t))},route:function(t,i){return i=i||{},e.route(t,i)},url:function(t,i){return i=i||{},e.url(t,i)},link_to:function(e,t,n){return e=this.url(e),i(e,t,n)},link_to_route:function(e,t,n,s){var o=this.route(e,n);return i(o,t,s)},link_to_action:function(e,t,n,s){var o=this.action(e,n);return i(o,t,s)}}}.call(this);"function"==typeof define&&define.amd?define("laroute",[],function(){return e}):"object"==typeof module&&module.exports?module.exports=e:window.laroute=e}.call(this),function(){var e=this,t=e._,i={},n=Array.prototype,s=Object.prototype,o=Function.prototype,r=n.push,a=n.slice,l=n.concat,u=s.toString,c=s.hasOwnProperty,d=n.forEach,h=n.map,p=n.reduce,f=n.reduceRight,m=n.filter,g=n.every,v=n.some,_=n.indexOf,b=n.lastIndexOf,y=Array.isArray,w=Object.keys,x=o.bind,k=function(e){return e instanceof k?e:this instanceof k?void(this._wrapped=e):new k(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=k),exports._=k):e._=k,k.VERSION="1.6.0";var C=k.each=k.forEach=function(e,t,n){if(null==e)return e;if(d&&e.forEach===d)e.forEach(t,n);else if(e.length===+e.length){for(var s=0,o=e.length;o>s;s++)if(t.call(n,e[s],s,e)===i)return}else for(var r=k.keys(e),s=0,o=r.length;o>s;s++)if(t.call(n,e[r[s]],r[s],e)===i)return;return e};k.map=k.collect=function(e,t,i){var n=[];return null==e?n:h&&e.map===h?e.map(t,i):(C(e,function(e,s,o){n.push(t.call(i,e,s,o))}),n)};var S="Reduce of empty array with no initial value";k.reduce=k.foldl=k.inject=function(e,t,i,n){var s=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return n&&(t=k.bind(t,n)),s?e.reduce(t,i):e.reduce(t);if(C(e,function(e,o,r){s?i=t.call(n,i,e,o,r):(i=e,s=!0)}),!s)throw new TypeError(S);return i},k.reduceRight=k.foldr=function(e,t,i,n){var s=arguments.length>2;if(null==e&&(e=[]),f&&e.reduceRight===f)return n&&(t=k.bind(t,n)),s?e.reduceRight(t,i):e.reduceRight(t);var o=e.length;if(o!==+o){var r=k.keys(e);o=r.length}if(C(e,function(a,l,u){l=r?r[--o]:--o,s?i=t.call(n,i,e[l],l,u):(i=e[l],s=!0)}),!s)throw new TypeError(S);return i},k.find=k.detect=function(e,t,i){var n;return T(e,function(e,s,o){return t.call(i,e,s,o)?(n=e,!0):void 0}),n},k.filter=k.select=function(e,t,i){var n=[];return null==e?n:m&&e.filter===m?e.filter(t,i):(C(e,function(e,s,o){t.call(i,e,s,o)&&n.push(e)}),n)},k.reject=function(e,t,i){return k.filter(e,function(e,n,s){return!t.call(i,e,n,s)},i)},k.every=k.all=function(e,t,n){t||(t=k.identity);var s=!0;return null==e?s:g&&e.every===g?e.every(t,n):(C(e,function(e,o,r){return(s=s&&t.call(n,e,o,r))?void 0:i}),!!s)};var T=k.some=k.any=function(e,t,n){t||(t=k.identity);var s=!1;return null==e?s:v&&e.some===v?e.some(t,n):(C(e,function(e,o,r){return s||(s=t.call(n,e,o,r))?i:void 0}),!!s)};k.contains=k.include=function(e,t){return null==e?!1:_&&e.indexOf===_?-1!=e.indexOf(t):T(e,function(e){return e===t})},k.invoke=function(e,t){var i=a.call(arguments,2),n=k.isFunction(t);return k.map(e,function(e){return(n?t:e[t]).apply(e,i)})},k.pluck=function(e,t){return k.map(e,k.property(t))},k.where=function(e,t){return k.filter(e,k.matches(t))},k.findWhere=function(e,t){return k.find(e,k.matches(t))},k.max=function(e,t,i){if(!t&&k.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);var n=-(1/0),s=-(1/0);return C(e,function(e,o,r){var a=t?t.call(i,e,o,r):e;a>s&&(n=e,s=a)}),n},k.min=function(e,t,i){if(!t&&k.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);var n=1/0,s=1/0;return C(e,function(e,o,r){var a=t?t.call(i,e,o,r):e;s>a&&(n=e,s=a)}),n},k.shuffle=function(e){var t,i=0,n=[];return C(e,function(e){t=k.random(i++),n[i-1]=n[t],n[t]=e}),n},k.sample=function(e,t,i){return null==t||i?(e.length!==+e.length&&(e=k.values(e)),e[k.random(e.length-1)]):k.shuffle(e).slice(0,Math.max(0,t))};var j=function(e){return null==e?k.identity:k.isFunction(e)?e:k.property(e)};k.sortBy=function(e,t,i){return t=j(t),k.pluck(k.map(e,function(e,n,s){return{value:e,index:n,criteria:t.call(i,e,n,s)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return e.index-t.index}),"value")};var E=function(e){return function(t,i,n){var s={};return i=j(i),C(t,function(o,r){var a=i.call(n,o,r,t);e(s,a,o)}),s}};k.groupBy=E(function(e,t,i){k.has(e,t)?e[t].push(i):e[t]=[i]}),k.indexBy=E(function(e,t,i){e[t]=i}),k.countBy=E(function(e,t){k.has(e,t)?e[t]++:e[t]=1}),k.sortedIndex=function(e,t,i,n){i=j(i);for(var s=i.call(n,t),o=0,r=e.length;r>o;){var a=o+r>>>1;i.call(n,e[a])<s?o=a+1:r=a}return o},k.toArray=function(e){return e?k.isArray(e)?a.call(e):e.length===+e.length?k.map(e,k.identity):k.values(e):[]},k.size=function(e){return null==e?0:e.length===+e.length?e.length:k.keys(e).length},k.first=k.head=k.take=function(e,t,i){return null!=e?null==t||i?e[0]:0>t?[]:a.call(e,0,t):void 0},k.initial=function(e,t,i){return a.call(e,0,e.length-(null==t||i?1:t))},k.last=function(e,t,i){return null!=e?null==t||i?e[e.length-1]:a.call(e,Math.max(e.length-t,0)):void 0},k.rest=k.tail=k.drop=function(e,t,i){return a.call(e,null==t||i?1:t)},k.compact=function(e){return k.filter(e,k.identity)};var q=function(e,t,i){return t&&k.every(e,k.isArray)?l.apply(i,e):(C(e,function(e){k.isArray(e)||k.isArguments(e)?t?r.apply(i,e):q(e,t,i):i.push(e)}),i)};k.flatten=function(e,t){return q(e,t,[])},k.without=function(e){return k.difference(e,a.call(arguments,1))},k.partition=function(e,t){var i=[],n=[];return C(e,function(e){(t(e)?i:n).push(e)}),[i,n]},k.uniq=k.unique=function(e,t,i,n){k.isFunction(t)&&(n=i,i=t,t=!1);var s=i?k.map(e,i,n):e,o=[],r=[];return C(s,function(i,n){(t?n&&r[r.length-1]===i:k.contains(r,i))||(r.push(i),o.push(e[n]))}),o},k.union=function(){return k.uniq(k.flatten(arguments,!0))},k.intersection=function(e){var t=a.call(arguments,1);return k.filter(k.uniq(e),function(e){return k.every(t,function(t){return k.contains(t,e)})})},k.difference=function(e){var t=l.apply(n,a.call(arguments,1));return k.filter(e,function(e){return!k.contains(t,e)})},k.zip=function(){for(var e=k.max(k.pluck(arguments,"length").concat(0)),t=new Array(e),i=0;e>i;i++)t[i]=k.pluck(arguments,""+i);return t},k.object=function(e,t){if(null==e)return{};for(var i={},n=0,s=e.length;s>n;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i},k.indexOf=function(e,t,i){if(null==e)return-1;var n=0,s=e.length;if(i){if("number"!=typeof i)return n=k.sortedIndex(e,t),e[n]===t?n:-1;n=0>i?Math.max(0,s+i):i}if(_&&e.indexOf===_)return e.indexOf(t,i);for(;s>n;n++)if(e[n]===t)return n;return-1},k.lastIndexOf=function(e,t,i){if(null==e)return-1;var n=null!=i;if(b&&e.lastIndexOf===b)return n?e.lastIndexOf(t,i):e.lastIndexOf(t);for(var s=n?i:e.length;s--;)if(e[s]===t)return s;return-1},k.range=function(e,t,i){arguments.length<=1&&(t=e||0,e=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((t-e)/i),0),s=0,o=new Array(n);n>s;)o[s++]=e,e+=i;return o};var A=function(){};k.bind=function(e,t){var i,n;if(x&&e.bind===x)return x.apply(e,a.call(arguments,1));if(!k.isFunction(e))throw new TypeError;return i=a.call(arguments,2),n=function(){if(!(this instanceof n))return e.apply(t,i.concat(a.call(arguments)));A.prototype=e.prototype;var s=new A;A.prototype=null;var o=e.apply(s,i.concat(a.call(arguments)));return Object(o)===o?o:s}},k.partial=function(e){var t=a.call(arguments,1);return function(){for(var i=0,n=t.slice(),s=0,o=n.length;o>s;s++)n[s]===k&&(n[s]=arguments[i++]);for(;i<arguments.length;)n.push(arguments[i++]);return e.apply(this,n)}},k.bindAll=function(e){var t=a.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return C(t,function(t){e[t]=k.bind(e[t],e)}),e},k.memoize=function(e,t){var i={};return t||(t=k.identity),function(){var n=t.apply(this,arguments);return k.has(i,n)?i[n]:i[n]=e.apply(this,arguments)}},k.delay=function(e,t){var i=a.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},k.defer=function(e){return k.delay.apply(k,[e,1].concat(a.call(arguments,1)))},k.throttle=function(e,t,i){var n,s,o,r=null,a=0;i||(i={});var l=function(){a=i.leading===!1?0:k.now(),r=null,o=e.apply(n,s),n=s=null};return function(){var u=k.now();a||i.leading!==!1||(a=u);var c=t-(u-a);return n=this,s=arguments,0>=c?(clearTimeout(r),r=null,a=u,o=e.apply(n,s),n=s=null):r||i.trailing===!1||(r=setTimeout(l,c)),o}},k.debounce=function(e,t,i){var n,s,o,r,a,l=function(){var u=k.now()-r;t>u?n=setTimeout(l,t-u):(n=null,i||(a=e.apply(o,s),o=s=null))};return function(){o=this,s=arguments,r=k.now();var u=i&&!n;return n||(n=setTimeout(l,t)),u&&(a=e.apply(o,s),o=s=null),a}},k.once=function(e){var t,i=!1;return function(){return i?t:(i=!0,t=e.apply(this,arguments),e=null,t)}},k.wrap=function(e,t){return k.partial(t,e)},k.compose=function(){var e=arguments;return function(){for(var t=arguments,i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},k.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},k.keys=function(e){if(!k.isObject(e))return[];if(w)return w(e);var t=[];for(var i in e)k.has(e,i)&&t.push(i);return t},k.values=function(e){for(var t=k.keys(e),i=t.length,n=new Array(i),s=0;i>s;s++)n[s]=e[t[s]];return n},k.pairs=function(e){for(var t=k.keys(e),i=t.length,n=new Array(i),s=0;i>s;s++)n[s]=[t[s],e[t[s]]];return n},k.invert=function(e){for(var t={},i=k.keys(e),n=0,s=i.length;s>n;n++)t[e[i[n]]]=i[n];return t},k.functions=k.methods=function(e){var t=[];for(var i in e)k.isFunction(e[i])&&t.push(i);return t.sort()},k.extend=function(e){return C(a.call(arguments,1),function(t){if(t)for(var i in t)e[i]=t[i]}),e},k.pick=function(e){var t={},i=l.apply(n,a.call(arguments,1));return C(i,function(i){i in e&&(t[i]=e[i])}),t},k.omit=function(e){var t={},i=l.apply(n,a.call(arguments,1));for(var s in e)k.contains(i,s)||(t[s]=e[s]);return t},k.defaults=function(e){return C(a.call(arguments,1),function(t){if(t)for(var i in t)void 0===e[i]&&(e[i]=t[i])}),e},k.clone=function(e){return k.isObject(e)?k.isArray(e)?e.slice():k.extend({},e):e},k.tap=function(e,t){return t(e),e};var P=function(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof k&&(e=e._wrapped),t instanceof k&&(t=t._wrapped);var s=u.call(e);if(s!=u.call(t))return!1;switch(s){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var o=i.length;o--;)if(i[o]==e)return n[o]==t;var r=e.constructor,a=t.constructor;if(r!==a&&!(k.isFunction(r)&&r instanceof r&&k.isFunction(a)&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1;i.push(e),n.push(t);var l=0,c=!0;if("[object Array]"==s){if(l=e.length,c=l==t.length)for(;l--&&(c=P(e[l],t[l],i,n)););}else{for(var d in e)if(k.has(e,d)&&(l++,!(c=k.has(t,d)&&P(e[d],t[d],i,n))))break;if(c){for(d in t)if(k.has(t,d)&&!l--)break;c=!l}}return i.pop(),n.pop(),c};k.isEqual=function(e,t){return P(e,t,[],[])},k.isEmpty=function(e){if(null==e)return!0;if(k.isArray(e)||k.isString(e))return 0===e.length;for(var t in e)if(k.has(e,t))return!1;return!0},k.isElement=function(e){return!(!e||1!==e.nodeType)},k.isArray=y||function(e){return"[object Array]"==u.call(e)},k.isObject=function(e){return e===Object(e)},C(["Arguments","Function","String","Number","Date","RegExp"],function(e){k["is"+e]=function(t){return u.call(t)=="[object "+e+"]"}}),k.isArguments(arguments)||(k.isArguments=function(e){return!(!e||!k.has(e,"callee"))}),"function"!=typeof/./&&(k.isFunction=function(e){return"function"==typeof e}),k.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},k.isNaN=function(e){return k.isNumber(e)&&e!=+e},k.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==u.call(e)},k.isNull=function(e){return null===e},k.isUndefined=function(e){return void 0===e},k.has=function(e,t){return c.call(e,t)},k.noConflict=function(){return e._=t,this},k.identity=function(e){return e},k.constant=function(e){return function(){return e}},k.property=function(e){return function(t){return t[e]}},k.matches=function(e){return function(t){if(t===e)return!0;for(var i in e)if(e[i]!==t[i])return!1;return!0}},k.times=function(e,t,i){for(var n=Array(Math.max(0,e)),s=0;e>s;s++)n[s]=t.call(i,s);return n},k.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},k.now=Date.now||function(){return(new Date).getTime()};var F={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};F.unescape=k.invert(F.escape);var D={escape:new RegExp("["+k.keys(F.escape).join("")+"]","g"),unescape:new RegExp("("+k.keys(F.unescape).join("|")+")","g")};k.each(["escape","unescape"],function(e){k[e]=function(t){return null==t?"":(""+t).replace(D[e],function(t){return F[e][t]})}}),k.result=function(e,t){if(null!=e){var i=e[t];return k.isFunction(i)?i.call(e):i}},k.mixin=function(e){C(k.functions(e),function(t){var i=k[t]=e[t];k.prototype[t]=function(){var e=[this._wrapped];return r.apply(e,arguments),z.call(this,i.apply(k,e))}})};var R=0;k.uniqueId=function(e){var t=++R+"";return e?e+t:t},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var O=/(.)^/,$={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},I=/\\|'|\r|\n|\t|\u2028|\u2029/g;k.template=function(e,t,i){var n;i=k.defaults({},i,k.templateSettings);var s=new RegExp([(i.escape||O).source,(i.interpolate||O).source,(i.evaluate||O).source].join("|")+"|$","g"),o=0,r="__p+='";e.replace(s,function(t,i,n,s,a){return r+=e.slice(o,a).replace(I,function(e){return"\\"+$[e]}),i&&(r+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(r+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),s&&(r+="';\n"+s+"\n__p+='"),o=a+t.length,t}),r+="';\n",i.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{n=new Function(i.variable||"obj","_",r)}catch(a){throw a.source=r,a}if(t)return n(t,k);var l=function(e){return n.call(this,e,k)};return l.source="function("+(i.variable||"obj")+"){\n"+r+"}",l},k.chain=function(e){return k(e).chain()};var z=function(e){return this._chain?k(e).chain():e};k.mixin(k),C(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];k.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!=e&&"splice"!=e||0!==i.length||delete i[0],z.call(this,i)}}),C(["concat","join","slice"],function(e){var t=n[e];k.prototype[e]=function(){return z.call(this,t.apply(this._wrapped,arguments))}}),k.extend(k.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return k})}.call(this),!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define("underscore.string",e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.s=e()}}(function(){return function e(t,i,n){function s(r,a){if(!i[r]){if(!t[r]){var l="function"==typeof require&&require;if(!a&&l)return l(r,!0);if(o)return o(r,!0);throw new Error("Cannot find module '"+r+"'")}var u=i[r]={exports:{}};t[r][0].call(u.exports,function(e){var i=t[r][1][e];return s(i?i:e)},u,u.exports,e,t,i,n)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)s(n[r]);return s}({1:[function(e,t){var i=e("./trim"),n=e("./decapitalize");t.exports=function(e,t){return e=i(e).replace(/[-_\s]+(.)?/g,function(e,t){return t?t.toUpperCase():""}),t===!0?n(e):e}},{"./decapitalize":9,"./trim":60}],2:[function(e,t){var i=e("./helper/makeString");t.exports=function(e){return e=i(e),e.charAt(0).toUpperCase()+e.slice(1)}},{"./helper/makeString":19}],3:[function(e,t){var i=e("./helper/makeString");t.exports=function(e){return i(e).split("")}},{"./helper/makeString":19}],4:[function(e,t){t.exports=function(e,t){return null==e?[]:(e=String(e),t=~~t,t>0?e.match(new RegExp(".{1,"+t+"}","g")):[e])}},{}],5:[function(e,t){var i=e("./capitalize"),n=e("./camelize"),s=e("./helper/makeString");t.exports=function(e){return e=s(e),i(n(e.replace(/[\W_]/g," ")).replace(/\s/g,""))}},{"./camelize":1,"./capitalize":2,"./helper/makeString":19}],6:[function(e,t){var i=e("./trim");t.exports=function(e){return i(e).replace(/\s+/g," ")}},{"./trim":60}],7:[function(e,t){var i=e("./helper/makeString");t.exports=function(e,t){if(e=i(e),t=i(t),0===e.length||0===t.length)return 0;for(var n=0,s=0,o=t.length;s=e.indexOf(t,s),-1!==s;)n++,s+=o;return n}},{"./helper/makeString":19}],8:[function(e,t){var i=e("./trim");t.exports=function(e){return i(e).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()}},{"./trim":60}],9:[function(e,t){var i=e("./helper/makeString");t.exports=function(e){return e=i(e),e.charAt(0).toLowerCase()+e.slice(1)}},{"./helper/makeString":19}],10:[function(e,t){function i(e){for(var t=e.match(/^[\s\\t]*/gm),i=t[0].length,n=1;n<t.length;n++)i=Math.min(t[n].length,i);return i}var n=e("./helper/makeString");t.exports=function(e,t){e=n(e);var s,o=i(e);return 0===o?e:(s="string"==typeof t?new RegExp("^"+t,"gm"):new RegExp("^[ \\t]{"+o+"}","gm"),e.replace(s,""))}},{"./helper/makeString":19
}],11:[function(e,t){var i=e("./helper/makeString"),n=e("./helper/toPositive");t.exports=function(e,t,s){return e=i(e),t=""+t,s="undefined"==typeof s?e.length-t.length:Math.min(n(s),e.length)-t.length,s>=0&&e.indexOf(t,s)===s}},{"./helper/makeString":19,"./helper/toPositive":21}],12:[function(e,t){var i=e("./helper/makeString"),n=e("./helper/escapeChars"),s={};for(var o in n)s[n[o]]=o;s["'"]="#39",t.exports=function(e){return i(e).replace(/[&<>"']/g,function(e){return"&"+s[e]+";"})}},{"./helper/escapeChars":17,"./helper/makeString":19}],13:[function(e,t){t.exports=function(){var e={};for(var t in this)this.hasOwnProperty(t)&&!t.match(/^(?:include|contains|reverse|join)$/)&&(e[t]=this[t]);return e}},{}],14:[function(e,t){"use strict";function i(e){return this instanceof i?void(this._wrapped=e):new i(e)}function n(e,t){"function"==typeof t&&(i.prototype[e]=function(){var e=[this._wrapped].concat(Array.prototype.slice.call(arguments)),n=t.apply(null,e);return"string"==typeof n?new i(n):n})}function s(e){n(e,function(t){var i=Array.prototype.slice.call(arguments,1);return String.prototype[e].apply(t,i)})}i.VERSION="3.0.3",i.isBlank=e("./isBlank"),i.stripTags=e("./stripTags"),i.capitalize=e("./capitalize"),i.decapitalize=e("./decapitalize"),i.chop=e("./chop"),i.trim=e("./trim"),i.clean=e("./clean"),i.count=e("./count"),i.chars=e("./chars"),i.swapCase=e("./swapCase"),i.escapeHTML=e("./escapeHTML"),i.unescapeHTML=e("./unescapeHTML"),i.splice=e("./splice"),i.insert=e("./insert"),i.replaceAll=e("./replaceAll"),i.include=e("./include"),i.join=e("./join"),i.lines=e("./lines"),i.dedent=e("./dedent"),i.reverse=e("./reverse"),i.startsWith=e("./startsWith"),i.endsWith=e("./endsWith"),i.pred=e("./pred"),i.succ=e("./succ"),i.titleize=e("./titleize"),i.camelize=e("./camelize"),i.underscored=e("./underscored"),i.dasherize=e("./dasherize"),i.classify=e("./classify"),i.humanize=e("./humanize"),i.ltrim=e("./ltrim"),i.rtrim=e("./rtrim"),i.truncate=e("./truncate"),i.prune=e("./prune"),i.words=e("./words"),i.pad=e("./pad"),i.lpad=e("./lpad"),i.rpad=e("./rpad"),i.lrpad=e("./lrpad"),i.sprintf=e("./sprintf"),i.vsprintf=e("./vsprintf"),i.toNumber=e("./toNumber"),i.numberFormat=e("./numberFormat"),i.strRight=e("./strRight"),i.strRightBack=e("./strRightBack"),i.strLeft=e("./strLeft"),i.strLeftBack=e("./strLeftBack"),i.toSentence=e("./toSentence"),i.toSentenceSerial=e("./toSentenceSerial"),i.slugify=e("./slugify"),i.surround=e("./surround"),i.quote=e("./quote"),i.unquote=e("./unquote"),i.repeat=e("./repeat"),i.naturalCmp=e("./naturalCmp"),i.levenshtein=e("./levenshtein"),i.toBoolean=e("./toBoolean"),i.exports=e("./exports"),i.escapeRegExp=e("./helper/escapeRegExp"),i.strip=i.trim,i.lstrip=i.ltrim,i.rstrip=i.rtrim,i.center=i.lrpad,i.rjust=i.lpad,i.ljust=i.rpad,i.contains=i.include,i.q=i.quote,i.toBool=i.toBoolean,i.camelcase=i.camelize,i.prototype={value:function(){return this._wrapped}};for(var o in i)n(o,i[o]);n("tap",function(e,t){return t(e)});var r=["toUpperCase","toLowerCase","split","replace","slice","substring","substr","concat"];for(var o in r)s(r[o]);t.exports=i},{"./camelize":1,"./capitalize":2,"./chars":3,"./chop":4,"./classify":5,"./clean":6,"./count":7,"./dasherize":8,"./decapitalize":9,"./dedent":10,"./endsWith":11,"./escapeHTML":12,"./exports":13,"./helper/escapeRegExp":18,"./humanize":22,"./include":23,"./insert":24,"./isBlank":25,"./join":26,"./levenshtein":27,"./lines":28,"./lpad":29,"./lrpad":30,"./ltrim":31,"./naturalCmp":32,"./numberFormat":33,"./pad":34,"./pred":35,"./prune":36,"./quote":37,"./repeat":38,"./replaceAll":39,"./reverse":40,"./rpad":41,"./rtrim":42,"./slugify":43,"./splice":44,"./sprintf":45,"./startsWith":46,"./strLeft":47,"./strLeftBack":48,"./strRight":49,"./strRightBack":50,"./stripTags":51,"./succ":52,"./surround":53,"./swapCase":54,"./titleize":55,"./toBoolean":56,"./toNumber":57,"./toSentence":58,"./toSentenceSerial":59,"./trim":60,"./truncate":61,"./underscored":62,"./unescapeHTML":63,"./unquote":64,"./vsprintf":65,"./words":66}],15:[function(e,t){var i=e("./makeString");t.exports=function(e,t){return e=i(e),0===e.length?"":e.slice(0,-1)+String.fromCharCode(e.charCodeAt(e.length-1)+t)}},{"./makeString":19}],16:[function(e,t){var i=e("./escapeRegExp");t.exports=function(e){return null==e?"\\s":e.source?e.source:"["+i(e)+"]"}},{"./escapeRegExp":18}],17:[function(e,t){var i={lt:"<",gt:">",quot:'"',amp:"&",apos:"'"};t.exports=i},{}],18:[function(e,t){var i=e("./makeString");t.exports=function(e){return i(e).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}},{"./makeString":19}],19:[function(e,t){t.exports=function(e){return null==e?"":""+e}},{}],20:[function(e,t){t.exports=function(e,t){if(1>t)return"";for(var i="";t>0;)1&t&&(i+=e),t>>=1,e+=e;return i}},{}],21:[function(e,t){t.exports=function(e){return 0>e?0:+e||0}},{}],22:[function(e,t){var i=e("./capitalize"),n=e("./underscored"),s=e("./trim");t.exports=function(e){return i(s(n(e).replace(/_id$/,"").replace(/_/g," ")))}},{"./capitalize":2,"./trim":60,"./underscored":62}],23:[function(e,t){var i=e("./helper/makeString");t.exports=function(e,t){return""===t?!0:-1!==i(e).indexOf(t)}},{"./helper/makeString":19}],24:[function(e,t){var i=e("./splice");t.exports=function(e,t,n){return i(e,t,0,n)}},{"./splice":44}],25:[function(e,t){var i=e("./helper/makeString");t.exports=function(e){return/^\s*$/.test(i(e))}},{"./helper/makeString":19}],26:[function(e,t){var i=e("./helper/makeString"),n=[].slice;t.exports=function(){var e=n.call(arguments),t=e.shift();return e.join(i(t))}},{"./helper/makeString":19}],27:[function(e,t){var i=e("./helper/makeString");t.exports=function(e,t){e=i(e),t=i(t);for(var n,s,o=[],r=0;r<=t.length;r++)for(var a=0;a<=e.length;a++)s=r&&a?e.charAt(a-1)===t.charAt(r-1)?n:Math.min(o[a],o[a-1],n)+1:r+a,n=o[a],o[a]=s;return o.pop()}},{"./helper/makeString":19}],28:[function(e,t){t.exports=function(e){return null==e?[]:String(e).split(/\r?\n/)}},{}],29:[function(e,t){var i=e("./pad");t.exports=function(e,t,n){return i(e,t,n)}},{"./pad":34}],30:[function(e,t){var i=e("./pad");t.exports=function(e,t,n){return i(e,t,n,"both")}},{"./pad":34}],31:[function(e,t){var i=e("./helper/makeString"),n=e("./helper/defaultToWhiteSpace"),s=String.prototype.trimLeft;t.exports=function(e,t){return e=i(e),!t&&s?s.call(e):(t=n(t),e.replace(new RegExp("^"+t+"+"),""))}},{"./helper/defaultToWhiteSpace":16,"./helper/makeString":19}],32:[function(e,t){t.exports=function(e,t){if(e==t)return 0;if(!e)return-1;if(!t)return 1;for(var i=/(\.\d+)|(\d+)|(\D+)/g,n=String(e).match(i),s=String(t).match(i),o=Math.min(n.length,s.length),r=0;o>r;r++){var a=n[r],l=s[r];if(a!==l){var u=+a,c=+l;return u===u&&c===c?u>c?1:-1:l>a?-1:1}}return n.length!=s.length?n.length-s.length:t>e?-1:1}},{}],33:[function(e,t){t.exports=function(e,t,i,n){if(isNaN(e)||null==e)return"";e=e.toFixed(~~t),n="string"==typeof n?n:",";var s=e.split("."),o=s[0],r=s[1]?(i||".")+s[1]:"";return o.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+n)+r}},{}],34:[function(e,t){var i=e("./helper/makeString"),n=e("./helper/strRepeat");t.exports=function(e,t,s,o){e=i(e),t=~~t;var r=0;switch(s?s.length>1&&(s=s.charAt(0)):s=" ",o){case"right":return r=t-e.length,e+n(s,r);case"both":return r=t-e.length,n(s,Math.ceil(r/2))+e+n(s,Math.floor(r/2));default:return r=t-e.length,n(s,r)+e}}},{"./helper/makeString":19,"./helper/strRepeat":20}],35:[function(e,t){var i=e("./helper/adjacent");t.exports=function(e){return i(e,-1)}},{"./helper/adjacent":15}],36:[function(e,t){var i=e("./helper/makeString"),n=e("./rtrim");t.exports=function(e,t,s){if(e=i(e),t=~~t,s=null!=s?String(s):"...",e.length<=t)return e;var o=function(e){return e.toUpperCase()!==e.toLowerCase()?"A":" "},r=e.slice(0,t+1).replace(/.(?=\W*\w*$)/g,o);return r=r.slice(r.length-2).match(/\w\w/)?r.replace(/\s*\S+$/,""):n(r.slice(0,r.length-1)),(r+s).length>e.length?e:e.slice(0,r.length)+s}},{"./helper/makeString":19,"./rtrim":42}],37:[function(e,t){var i=e("./surround");t.exports=function(e,t){return i(e,t||'"')}},{"./surround":53}],38:[function(e,t){var i=e("./helper/makeString"),n=e("./helper/strRepeat");t.exports=function s(e,t,o){if(e=i(e),t=~~t,null==o)return n(e,t);for(var s=[];t>0;s[--t]=e);return s.join(o)}},{"./helper/makeString":19,"./helper/strRepeat":20}],39:[function(e,t){var i=e("./helper/makeString");t.exports=function(e,t,n,s){var o=s===!0?"gi":"g",r=new RegExp(t,o);return i(e).replace(r,n)}},{"./helper/makeString":19}],40:[function(e,t){var i=e("./chars");t.exports=function(e){return i(e).reverse().join("")}},{"./chars":3}],41:[function(e,t){var i=e("./pad");t.exports=function(e,t,n){return i(e,t,n,"right")}},{"./pad":34}],42:[function(e,t){var i=e("./helper/makeString"),n=e("./helper/defaultToWhiteSpace"),s=String.prototype.trimRight;t.exports=function(e,t){return e=i(e),!t&&s?s.call(e):(t=n(t),e.replace(new RegExp(t+"+$"),""))}},{"./helper/defaultToWhiteSpace":16,"./helper/makeString":19}],43:[function(e,t){var i=e("./helper/makeString"),n=e("./helper/defaultToWhiteSpace"),s=e("./trim"),o=e("./dasherize");t.exports=function(e){var t="",r="aaaaaaaaaccceeeeeghiiiijllnnoooooooossssttuuuuuunyyczzz",a=new RegExp(n(t),"g");return e=i(e).toLowerCase().replace(a,function(e){var i=t.indexOf(e);return r.charAt(i)||"-"}),s(o(e.replace(/[^\w\s-]/g,"-")),"-")}},{"./dasherize":8,"./helper/defaultToWhiteSpace":16,"./helper/makeString":19,"./trim":60}],44:[function(e,t){var i=e("./chars");t.exports=function(e,t,n,s){var o=i(e);return o.splice(~~t,~~n,s),o.join("")}},{"./chars":3}],45:[function(e,t){var i=e("./helper/strRepeat"),n=Object.prototype.toString,s=function(){function e(e){return n.call(e).slice(8,-1).toLowerCase()}var t=i,o=function(){return o.cache.hasOwnProperty(arguments[0])||(o.cache[arguments[0]]=o.parse(arguments[0])),o.format.call(null,o.cache[arguments[0]],arguments)};return o.format=function(i,n){var o,r,a,l,u,c,d,h=1,p=i.length,f="",m=[];for(r=0;p>r;r++)if(f=e(i[r]),"string"===f)m.push(i[r]);else if("array"===f){if(l=i[r],l[2])for(o=n[h],a=0;a<l[2].length;a++){if(!o.hasOwnProperty(l[2][a]))throw new Error(s('[_.sprintf] property "%s" does not exist',l[2][a]));o=o[l[2][a]]}else o=l[1]?n[l[1]]:n[h++];if(/[^s]/.test(l[8])&&"number"!=e(o))throw new Error(s("[_.sprintf] expecting number but found %s",e(o)));switch(l[8]){case"b":o=o.toString(2);break;case"c":o=String.fromCharCode(o);break;case"d":o=parseInt(o,10);break;case"e":o=l[7]?o.toExponential(l[7]):o.toExponential();break;case"f":o=l[7]?parseFloat(o).toFixed(l[7]):parseFloat(o);break;case"o":o=o.toString(8);break;case"s":o=(o=String(o))&&l[7]?o.substring(0,l[7]):o;break;case"u":o=Math.abs(o);break;case"x":o=o.toString(16);break;case"X":o=o.toString(16).toUpperCase()}o=/[def]/.test(l[8])&&l[3]&&o>=0?"+"+o:o,c=l[4]?"0"==l[4]?"0":l[4].charAt(1):" ",d=l[6]-String(o).length,u=l[6]?t(c,d):"",m.push(l[5]?o+u:u+o)}return m.join("")},o.cache={},o.parse=function(e){for(var t=e,i=[],n=[],s=0;t;){if(null!==(i=/^[^\x25]+/.exec(t)))n.push(i[0]);else if(null!==(i=/^\x25{2}/.exec(t)))n.push("%");else{if(null===(i=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t)))throw new Error("[_.sprintf] huh?");if(i[2]){s|=1;var o=[],r=i[2],a=[];if(null===(a=/^([a-z_][a-z_\d]*)/i.exec(r)))throw new Error("[_.sprintf] huh?");for(o.push(a[1]);""!==(r=r.substring(a[0].length));)if(null!==(a=/^\.([a-z_][a-z_\d]*)/i.exec(r)))o.push(a[1]);else{if(null===(a=/^\[(\d+)\]/.exec(r)))throw new Error("[_.sprintf] huh?");o.push(a[1])}i[2]=o}else s|=2;if(3===s)throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");n.push(i)}t=t.substring(i[0].length)}return n},o}();t.exports=s},{"./helper/strRepeat":20}],46:[function(e,t){var i=e("./helper/makeString"),n=e("./helper/toPositive");t.exports=function(e,t,s){return e=i(e),t=""+t,s=null==s?0:Math.min(n(s),e.length),e.lastIndexOf(t,s)===s}},{"./helper/makeString":19,"./helper/toPositive":21}],47:[function(e,t){var i=e("./helper/makeString");t.exports=function(e,t){e=i(e),t=i(t);var n=t?e.indexOf(t):-1;return~n?e.slice(0,n):e}},{"./helper/makeString":19}],48:[function(e,t){var i=e("./helper/makeString");t.exports=function(e,t){e=i(e),t=i(t);var n=e.lastIndexOf(t);return~n?e.slice(0,n):e}},{"./helper/makeString":19}],49:[function(e,t){var i=e("./helper/makeString");t.exports=function(e,t){e=i(e),t=i(t);var n=t?e.indexOf(t):-1;return~n?e.slice(n+t.length,e.length):e}},{"./helper/makeString":19}],50:[function(e,t){var i=e("./helper/makeString");t.exports=function(e,t){e=i(e),t=i(t);var n=t?e.lastIndexOf(t):-1;return~n?e.slice(n+t.length,e.length):e}},{"./helper/makeString":19}],51:[function(e,t){var i=e("./helper/makeString");t.exports=function(e){return i(e).replace(/<\/?[^>]+>/g,"")}},{"./helper/makeString":19}],52:[function(e,t){var i=e("./helper/adjacent");t.exports=function(e){return i(e,1)}},{"./helper/adjacent":15}],53:[function(e,t){t.exports=function(e,t){return[t,e,t].join("")}},{}],54:[function(e,t){var i=e("./helper/makeString");t.exports=function(e){return i(e).replace(/\S/g,function(e){return e===e.toUpperCase()?e.toLowerCase():e.toUpperCase()})}},{"./helper/makeString":19}],55:[function(e,t){var i=e("./helper/makeString");t.exports=function(e){return i(e).toLowerCase().replace(/(?:^|\s|-)\S/g,function(e){return e.toUpperCase()})}},{"./helper/makeString":19}],56:[function(e,t){function i(e,t){var i,n,s=e.toLowerCase();for(t=[].concat(t),i=0;i<t.length;i+=1)if(n=t[i]){if(n.test&&n.test(e))return!0;if(n.toLowerCase()===s)return!0}}var n=e("./trim");t.exports=function(e,t,s){return"number"==typeof e&&(e=""+e),"string"!=typeof e?!!e:(e=n(e),i(e,t||["true","1"])?!0:i(e,s||["false","0"])?!1:void 0)}},{"./trim":60}],57:[function(e,t){e("./trim"),t.exports=function(e,t){if(null==e)return 0;var i=Math.pow(10,isFinite(t)?t:0);return Math.round(e*i)/i}},{"./trim":60}],58:[function(e,t){var i=e("./rtrim");t.exports=function(e,t,n,s){t=t||", ",n=n||" and ";var o=e.slice(),r=o.pop();return e.length>2&&s&&(n=i(t)+n),o.length?o.join(t)+n+r:r}},{"./rtrim":42}],59:[function(e,t){var i=e("./toSentence");t.exports=function(e,t,n){return i(e,t,n,!0)}},{"./toSentence":58}],60:[function(e,t){var i=e("./helper/makeString"),n=e("./helper/defaultToWhiteSpace"),s=String.prototype.trim;t.exports=function(e,t){return e=i(e),!t&&s?s.call(e):(t=n(t),e.replace(new RegExp("^"+t+"+|"+t+"+$","g"),""))}},{"./helper/defaultToWhiteSpace":16,"./helper/makeString":19}],61:[function(e,t){var i=e("./helper/makeString");t.exports=function(e,t,n){return e=i(e),n=n||"...",t=~~t,e.length>t?e.slice(0,t)+n:e}},{"./helper/makeString":19}],62:[function(e,t){var i=e("./trim");t.exports=function(e){return i(e).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()}},{"./trim":60}],63:[function(e,t){var i=e("./helper/makeString"),n=e("./helper/escapeChars");t.exports=function(e){return i(e).replace(/\&([^;]+);/g,function(e,t){var i;return t in n?n[t]:(i=t.match(/^#x([\da-fA-F]+)$/))?String.fromCharCode(parseInt(i[1],16)):(i=t.match(/^#(\d+)$/))?String.fromCharCode(~~i[1]):e})}},{"./helper/escapeChars":17,"./helper/makeString":19}],64:[function(e,t){t.exports=function(e,t){return t=t||'"',e[0]===t&&e[e.length-1]===t?e.slice(1,e.length-1):e}},{}],65:[function(e,t){var i=e("./sprintf");t.exports=function(e,t){return t.unshift(e),i.apply(null,t)}},{"./sprintf":45}],66:[function(e,t){var i=e("./isBlank"),n=e("./trim");t.exports=function(e,t){return i(e)?[]:n(e,t).split(t||/\s+/)}},{"./isBlank":25,"./trim":60}]},{},[14])(14)}),function(e){"function"==typeof define&&define.amd?define("picker",["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):this.Picker=e(jQuery)}(function(e){function t(o,r,l,h){function p(){return t._.node("div",t._.node("div",t._.node("div",t._.node("div",j.component.nodes(x.open),C.box),C.wrap),C.frame),C.holder,'tabindex="-1"')}function f(){S.data(r,j).addClass(C.input).val(S.data("value")?j.get("select",k.format):o.value),k.editable||S.on("focus."+x.id+" click."+x.id,function(e){e.preventDefault(),j.open()}).on("keydown."+x.id,y),s(o,{haspopup:!0,expanded:!1,readonly:!1,owns:o.id+"_root"})}function m(){s(j.$root[0],"hidden",!0)}function g(){j.$holder.on({keydown:y,"focus.toOpen":b,blur:function(){S.removeClass(C.target)},focusin:function(e){j.$root.removeClass(C.focused),e.stopPropagation()},"mousedown click":function(t){var i=t.target;i!=j.$holder[0]&&(t.stopPropagation(),"mousedown"!=t.type||e(i).is("input, select, textarea, button, option")||(t.preventDefault(),j.$holder[0].focus()))}}).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var t=e(this),i=t.data(),n=t.hasClass(C.navDisabled)||t.hasClass(C.disabled),s=a();s=s&&(s.type||s.href),(n||s&&!e.contains(j.$root[0],s))&&j.$holder[0].focus(),!n&&i.nav?j.set("highlight",j.component.item.highlight,{nav:i.nav}):!n&&"pick"in i?(j.set("select",i.pick),k.closeOnSelect&&j.close(!0)):i.clear?(j.clear(),k.closeOnClear&&j.close(!0)):i.close&&j.close(!0)})}function v(){var t;k.hiddenName===!0?(t=o.name,o.name=""):(t=["string"==typeof k.hiddenPrefix?k.hiddenPrefix:"","string"==typeof k.hiddenSuffix?k.hiddenSuffix:"_submit"],t=t[0]+o.name+t[1]),j._hidden=e('<input type=hidden name="'+t+'"'+(S.data("value")||o.value?' value="'+j.get("select",k.formatSubmit)+'"':"")+">")[0],S.on("change."+x.id,function(){j._hidden.value=o.value?j.get("select",k.formatSubmit):""})}function _(){w&&d?j.$holder.find("."+C.frame).one("transitionend",function(){j.$holder[0].focus()}):j.$holder[0].focus()}function b(e){e.stopPropagation(),S.addClass(C.target),j.$root.addClass(C.focused),j.open()}function y(e){var t=e.keyCode,i=/^(8|46)$/.test(t);return 27==t?(j.close(!0),!1):void((32==t||i||!x.open&&j.component.key[t])&&(e.preventDefault(),e.stopPropagation(),i?j.clear().close():j.open()))}if(!o)return t;var w=!1,x={id:o.id||"P"+Math.abs(~~(Math.random()*new Date))},k=l?e.extend(!0,{},l.defaults,h):h||{},C=e.extend({},t.klasses(),k.klass),S=e(o),T=function(){return this.start()},j=T.prototype={constructor:T,$node:S,start:function(){return x&&x.start?j:(x.methods={},x.start=!0,x.open=!1,x.type=o.type,o.autofocus=o==a(),o.readOnly=!k.editable,o.id=o.id||x.id,"text"!=o.type&&(o.type="text"),j.component=new l(j,k),j.$root=e('<div class="'+C.picker+'" id="'+o.id+'_root" />'),m(),j.$holder=e(p()).appendTo(j.$root),g(),k.formatSubmit&&v(),f(),k.containerHidden?e(k.containerHidden).append(j._hidden):S.after(j._hidden),k.container?e(k.container).append(j.$root):S.after(j.$root),j.on({start:j.component.onStart,render:j.component.onRender,stop:j.component.onStop,open:j.component.onOpen,close:j.component.onClose,set:j.component.onSet}).on({start:k.onStart,render:k.onRender,stop:k.onStop,open:k.onOpen,close:k.onClose,set:k.onSet}),w=i(j.$holder[0]),o.autofocus&&j.open(),j.trigger("start").trigger("render"))},render:function(t){return t?(j.$holder=e(p()),g(),j.$root.html(j.$holder)):j.$root.find("."+C.box).html(j.component.nodes(x.open)),j.trigger("render")},stop:function(){return x.start?(j.close(),j._hidden&&j._hidden.parentNode.removeChild(j._hidden),j.$root.remove(),S.removeClass(C.input).removeData(r),setTimeout(function(){S.off("."+x.id)},0),o.type=x.type,o.readOnly=!1,j.trigger("stop"),x.methods={},x.start=!1,j):j},open:function(i){return x.open?j:(S.addClass(C.active),s(o,"expanded",!0),setTimeout(function(){j.$root.addClass(C.opened),s(j.$root[0],"hidden",!1)},0),i!==!1&&(x.open=!0,w&&c.css("overflow","hidden").css("padding-right","+="+n()),_(),u.on("click."+x.id+" focusin."+x.id,function(e){var t=e.target;t!=o&&t!=document&&3!=e.which&&j.close(t===j.$holder[0])}).on("keydown."+x.id,function(i){var n=i.keyCode,s=j.component.key[n],o=i.target;27==n?j.close(!0):o!=j.$holder[0]||!s&&13!=n?e.contains(j.$root[0],o)&&13==n&&(i.preventDefault(),o.click()):(i.preventDefault(),s?t._.trigger(j.component.key.go,j,[t._.trigger(s)]):j.$root.find("."+C.highlighted).hasClass(C.disabled)||(j.set("select",j.component.item.highlight),k.closeOnSelect&&j.close(!0)))})),j.trigger("open"))},close:function(e){return e&&(k.editable?o.focus():(j.$holder.off("focus.toOpen").focus(),setTimeout(function(){j.$holder.on("focus.toOpen",b)},0))),S.removeClass(C.active),s(o,"expanded",!1),setTimeout(function(){j.$root.removeClass(C.opened+" "+C.focused),s(j.$root[0],"hidden",!0)},0),x.open?(x.open=!1,w&&c.css("overflow","").css("padding-right","-="+n()),u.off("."+x.id),j.trigger("close")):j},clear:function(e){return j.set("clear",null,e)},set:function(t,i,n){var s,o,r=e.isPlainObject(t),a=r?t:{};if(n=r&&e.isPlainObject(i)?i:n||{},t){r||(a[t]=i);for(s in a)o=a[s],s in j.component.item&&(void 0===o&&(o=null),j.component.set(s,o,n)),("select"==s||"clear"==s)&&S.val("clear"==s?"":j.get(s,k.format)).trigger("change");j.render()}return n.muted?j:j.trigger("set",a)},get:function(e,i){if(e=e||"value",null!=x[e])return x[e];if("valueSubmit"==e){if(j._hidden)return j._hidden.value;e="value"}if("value"==e)return o.value;if(e in j.component.item){if("string"==typeof i){var n=j.component.get(e);return n?t._.trigger(j.component.formats.toString,j.component,[i,n]):""}return j.component.get(e)}},on:function(t,i,n){var s,o,r=e.isPlainObject(t),a=r?t:{};if(t){r||(a[t]=i);for(s in a)o=a[s],n&&(s="_"+s),x.methods[s]=x.methods[s]||[],x.methods[s].push(o)}return j},off:function(){var e,t,i=arguments;for(e=0,namesCount=i.length;e<namesCount;e+=1)t=i[e],t in x.methods&&delete x.methods[t];return j},trigger:function(e,i){var n=function(e){var n=x.methods[e];n&&n.map(function(e){t._.trigger(e,j,[i])})};return n("_"+e),n(e),j}};return new T}function i(e){var t,i="position";return e.currentStyle?t=e.currentStyle[i]:window.getComputedStyle&&(t=getComputedStyle(e)[i]),"fixed"==t}function n(){if(c.height()<=l.height())return 0;var t=e('<div style="visibility:hidden;width:100px" />').appendTo("body"),i=t[0].offsetWidth;t.css("overflow","scroll");var n=e('<div style="width:100%" />').appendTo(t),s=n[0].offsetWidth;return t.remove(),i-s}function s(t,i,n){if(e.isPlainObject(i))for(var s in i)o(t,s,i[s]);else o(t,i,n)}function o(e,t,i){e.setAttribute(("role"==t?"":"aria-")+t,i)}function r(t,i){e.isPlainObject(t)||(t={attribute:i}),i="";for(var n in t){var s=("role"==n?"":"aria-")+n,o=t[n];i+=null==o?"":s+'="'+t[n]+'"'}return i}function a(){try{return document.activeElement}catch(e){}}var l=e(window),u=e(document),c=e(document.documentElement),d=null!=document.documentElement.style.transition;return t.klasses=function(e){return e=e||"picker",{picker:e,opened:e+"--opened",focused:e+"--focused",input:e+"__input",active:e+"__input--active",target:e+"__input--target",holder:e+"__holder",frame:e+"__frame",wrap:e+"__wrap",box:e+"__box"}},t._={group:function(e){for(var i,n="",s=t._.trigger(e.min,e);s<=t._.trigger(e.max,e,[s]);s+=e.i)i=t._.trigger(e.item,e,[s]),n+=t._.node(e.node,i[0],i[1],i[2]);return n},node:function(t,i,n,s){return i?(i=e.isArray(i)?i.join(""):i,n=n?' class="'+n+'"':"",s=s?" "+s:"","<"+t+n+s+">"+i+"</"+t+">"):""},lead:function(e){return(10>e?"0":"")+e},trigger:function(e,t,i){return"function"==typeof e?e.apply(t,i||[]):e},digits:function(e){return/\d/.test(e[1])?2:1},isDate:function(e){return{}.toString.call(e).indexOf("Date")>-1&&this.isInteger(e.getDate())},isInteger:function(e){return{}.toString.call(e).indexOf("Number")>-1&&e%1===0},ariaAttr:r},t.extend=function(i,n){e.fn[i]=function(s,o){var r=this.data(i);return"picker"==s?r:r&&"string"==typeof s?t._.trigger(r[s],r,[o]):this.each(function(){var o=e(this);o.data(i)||new t(this,i,n,s)})},e.fn[i].defaults=n.defaults},t}),function(e){"function"==typeof define&&define.amd?define("picker.date",["picker","jquery"],e):"object"==typeof exports?module.exports=e(require("./picker.js"),require("jquery")):e(Picker,jQuery)}(function(e,t){function i(e,t){var i=this,n=e.$node[0],s=n.value,o=e.$node.data("value"),r=o||s,a=o?t.formatSubmit:t.format,l=function(){return n.currentStyle?"rtl"==n.currentStyle.direction:"rtl"==getComputedStyle(e.$root[0]).direction};i.settings=t,i.$node=e.$node,i.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"},i.item={},i.item.clear=null,i.item.disable=(t.disable||[]).slice(0),i.item.enable=-function(e){return e[0]===!0?e.shift():-1}(i.item.disable),i.set("min",t.min).set("max",t.max).set("now"),r?i.set("select",r,{format:a,defaultValue:!0}):i.set("select",null).set("highlight",i.item.now),i.key={40:7,38:-7,39:function(){return l()?-1:1},37:function(){return l()?1:-1},go:function(e){var t=i.item.highlight,n=new Date(t.year,t.month,t.date+e);i.set("highlight",n,{interval:e}),this.render()}},e.on("render",function(){e.$root.find("."+t.klass.selectMonth).on("change",function(){var i=this.value;i&&(e.set("highlight",[e.get("view").year,i,e.get("highlight").date]),e.$root.find("."+t.klass.selectMonth).trigger("focus"))}),e.$root.find("."+t.klass.selectYear).on("change",function(){var i=this.value;i&&(e.set("highlight",[i,e.get("view").month,e.get("highlight").date]),e.$root.find("."+t.klass.selectYear).trigger("focus"))})},1).on("open",function(){var n="";i.disabled(i.get("now"))&&(n=":not(."+t.klass.buttonToday+")"),e.$root.find("button"+n+", select").attr("disabled",!1)},1).on("close",function(){e.$root.find("button, select").attr("disabled",!0)},1)}var n=7,s=6,o=e._;i.prototype.set=function(e,t,i){var n=this,s=n.item;return null===t?("clear"==e&&(e="select"),s[e]=t,n):(s["enable"==e?"disable":"flip"==e?"enable":e]=n.queue[e].split(" ").map(function(s){return t=n[s](e,t,i)}).pop(),"select"==e?n.set("highlight",s.select,i):"highlight"==e?n.set("view",s.highlight,i):e.match(/^(flip|min|max|disable|enable)$/)&&(s.select&&n.disabled(s.select)&&n.set("select",s.select,i),s.highlight&&n.disabled(s.highlight)&&n.set("highlight",s.highlight,i)),n)},i.prototype.get=function(e){return this.item[e]},i.prototype.create=function(e,i,n){var s,r=this;return i=void 0===i?e:i,i==-(1/0)||i==1/0?s=i:t.isPlainObject(i)&&o.isInteger(i.pick)?i=i.obj:t.isArray(i)?(i=new Date(i[0],i[1],i[2]),i=o.isDate(i)?i:r.create().obj):i=o.isInteger(i)||o.isDate(i)?r.normalize(new Date(i),n):r.now(e,i,n),{year:s||i.getFullYear(),month:s||i.getMonth(),date:s||i.getDate(),day:s||i.getDay(),obj:s||i,pick:s||i.getTime()}},i.prototype.createRange=function(e,i){var n=this,s=function(e){return e===!0||t.isArray(e)||o.isDate(e)?n.create(e):e};return o.isInteger(e)||(e=s(e)),o.isInteger(i)||(i=s(i)),o.isInteger(e)&&t.isPlainObject(i)?e=[i.year,i.month,i.date+e]:o.isInteger(i)&&t.isPlainObject(e)&&(i=[e.year,e.month,e.date+i]),{from:s(e),to:s(i)}},i.prototype.withinRange=function(e,t){return e=this.createRange(e.from,e.to),t.pick>=e.from.pick&&t.pick<=e.to.pick},i.prototype.overlapRanges=function(e,t){var i=this;return e=i.createRange(e.from,e.to),t=i.createRange(t.from,t.to),i.withinRange(e,t.from)||i.withinRange(e,t.to)||i.withinRange(t,e.from)||i.withinRange(t,e.to)},i.prototype.now=function(e,t,i){return t=new Date,i&&i.rel&&t.setDate(t.getDate()+i.rel),this.normalize(t,i)},i.prototype.navigate=function(e,i,n){var s,o,r,a,l=t.isArray(i),u=t.isPlainObject(i),c=this.item.view;if(l||u){for(u?(o=i.year,r=i.month,a=i.date):(o=+i[0],r=+i[1],a=+i[2]),n&&n.nav&&c&&c.month!==r&&(o=c.year,r=c.month),s=new Date(o,r+(n&&n.nav?n.nav:0),1),o=s.getFullYear(),r=s.getMonth();new Date(o,r,a).getMonth()!==r;)a-=1;i=[o,r,a]}return i},i.prototype.normalize=function(e){return e.setHours(0,0,0,0),e},i.prototype.measure=function(e,t){var i=this;return t?"string"==typeof t?t=i.parse(e,t):o.isInteger(t)&&(t=i.now(e,t,{rel:t})):t="min"==e?-(1/0):1/0,t},i.prototype.viewset=function(e,t){return this.create([t.year,t.month,1])},i.prototype.validate=function(e,i,n){var s,r,a,l,u=this,c=i,d=n&&n.interval?n.interval:1,h=-1===u.item.enable,p=u.item.min,f=u.item.max,m=h&&u.item.disable.filter(function(e){if(t.isArray(e)){var n=u.create(e).pick;n<i.pick?s=!0:n>i.pick&&(r=!0)}return o.isInteger(e)}).length;if((!n||!n.nav&&!n.defaultValue)&&(!h&&u.disabled(i)||h&&u.disabled(i)&&(m||s||r)||!h&&(i.pick<=p.pick||i.pick>=f.pick)))for(h&&!m&&(!r&&d>0||!s&&0>d)&&(d*=-1);u.disabled(i)&&(Math.abs(d)>1&&(i.month<c.month||i.month>c.month)&&(i=c,d=d>0?1:-1),i.pick<=p.pick?(a=!0,d=1,i=u.create([p.year,p.month,p.date+(i.pick===p.pick?0:-1)])):i.pick>=f.pick&&(l=!0,d=-1,i=u.create([f.year,f.month,f.date+(i.pick===f.pick?0:1)])),!a||!l);)i=u.create([i.year,i.month,i.date+d]);return i},i.prototype.disabled=function(e){var i=this,n=i.item.disable.filter(function(n){return o.isInteger(n)?e.day===(i.settings.firstDay?n:n-1)%7:t.isArray(n)||o.isDate(n)?e.pick===i.create(n).pick:t.isPlainObject(n)?i.withinRange(n,e):void 0});return n=n.length&&!n.filter(function(e){return t.isArray(e)&&"inverted"==e[3]||t.isPlainObject(e)&&e.inverted}).length,-1===i.item.enable?!n:n||e.pick<i.item.min.pick||e.pick>i.item.max.pick},i.prototype.parse=function(e,t,i){var n=this,s={};return t&&"string"==typeof t?(i&&i.format||(i=i||{},i.format=n.settings.format),n.formats.toArray(i.format).map(function(e){var i=n.formats[e],r=i?o.trigger(i,n,[t,s]):e.replace(/^!/,"").length;i&&(s[e]=t.substr(0,r)),t=t.substr(r)}),[s.yyyy||s.yy,+(s.mm||s.m)-1,s.dd||s.d]):t},i.prototype.formats=function(){function e(e,t,i){var n=e.match(/[^\x00-\x7F]+|\w+/)[0];return i.mm||i.m||(i.m=t.indexOf(n)+1),n.length}function t(e){return e.match(/\w+/)[0].length}return{d:function(e,t){return e?o.digits(e):t.date},dd:function(e,t){return e?2:o.lead(t.date)},ddd:function(e,i){return e?t(e):this.settings.weekdaysShort[i.day]},dddd:function(e,i){return e?t(e):this.settings.weekdaysFull[i.day]},m:function(e,t){return e?o.digits(e):t.month+1},mm:function(e,t){return e?2:o.lead(t.month+1)},mmm:function(t,i){var n=this.settings.monthsShort;return t?e(t,n,i):n[i.month]},mmmm:function(t,i){var n=this.settings.monthsFull;return t?e(t,n,i):n[i.month]},yy:function(e,t){return e?2:(""+t.year).slice(2)},yyyy:function(e,t){return e?4:t.year},toArray:function(e){return e.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(e,t){var i=this;return i.formats.toArray(e).map(function(e){return o.trigger(i.formats[e],i,[0,t])||e.replace(/^!/,"")}).join("")}}}(),i.prototype.isDateExact=function(e,i){var n=this;return o.isInteger(e)&&o.isInteger(i)||"boolean"==typeof e&&"boolean"==typeof i?e===i:(o.isDate(e)||t.isArray(e))&&(o.isDate(i)||t.isArray(i))?n.create(e).pick===n.create(i).pick:t.isPlainObject(e)&&t.isPlainObject(i)?n.isDateExact(e.from,i.from)&&n.isDateExact(e.to,i.to):!1},i.prototype.isDateOverlap=function(e,i){var n=this,s=n.settings.firstDay?1:0;return o.isInteger(e)&&(o.isDate(i)||t.isArray(i))?(e=e%7+s,e===n.create(i).day+1):o.isInteger(i)&&(o.isDate(e)||t.isArray(e))?(i=i%7+s,i===n.create(e).day+1):t.isPlainObject(e)&&t.isPlainObject(i)?n.overlapRanges(e,i):!1},i.prototype.flipEnable=function(e){var t=this.item;t.enable=e||(-1==t.enable?1:-1)},i.prototype.deactivate=function(e,i){var n=this,s=n.item.disable.slice(0);return"flip"==i?n.flipEnable():i===!1?(n.flipEnable(1),s=[]):i===!0?(n.flipEnable(-1),s=[]):i.map(function(e){for(var i,r=0;r<s.length;r+=1)if(n.isDateExact(e,s[r])){i=!0;break}i||(o.isInteger(e)||o.isDate(e)||t.isArray(e)||t.isPlainObject(e)&&e.from&&e.to)&&s.push(e)}),s},i.prototype.activate=function(e,i){var n=this,s=n.item.disable,r=s.length;return"flip"==i?n.flipEnable():i===!0?(n.flipEnable(1),s=[]):i===!1?(n.flipEnable(-1),s=[]):i.map(function(e){var i,a,l,u;for(l=0;r>l;l+=1){if(a=s[l],n.isDateExact(a,e)){i=s[l]=null,u=!0;break}if(n.isDateOverlap(a,e)){t.isPlainObject(e)?(e.inverted=!0,i=e):t.isArray(e)?(i=e,i[3]||i.push("inverted")):o.isDate(e)&&(i=[e.getFullYear(),e.getMonth(),e.getDate(),"inverted"]);break}}if(i)for(l=0;r>l;l+=1)if(n.isDateExact(s[l],e)){s[l]=null;break}if(u)for(l=0;r>l;l+=1)if(n.isDateOverlap(s[l],e)){s[l]=null;break}i&&s.push(i)}),s.filter(function(e){return null!=e})},i.prototype.nodes=function(e){var t=this,i=t.settings,r=t.item,a=r.now,l=r.select,u=r.highlight,c=r.view,d=r.disable,h=r.min,p=r.max,f=function(e,t){
return i.firstDay&&(e.push(e.shift()),t.push(t.shift())),o.node("thead",o.node("tr",o.group({min:0,max:n-1,i:1,node:"th",item:function(n){return[e[n],i.klass.weekdays,'scope=col title="'+t[n]+'"']}})))}((i.showWeekdaysFull?i.weekdaysFull:i.weekdaysShort).slice(0),i.weekdaysFull.slice(0)),m=function(e){return o.node("div"," ",i.klass["nav"+(e?"Next":"Prev")]+(e&&c.year>=p.year&&c.month>=p.month||!e&&c.year<=h.year&&c.month<=h.month?" "+i.klass.navDisabled:""),"data-nav="+(e||-1)+" "+o.ariaAttr({role:"button",controls:t.$node[0].id+"_table"})+' title="'+(e?i.labelMonthNext:i.labelMonthPrev)+'"')},g=function(){var n=i.showMonthsShort?i.monthsShort:i.monthsFull;return i.selectMonths?o.node("select",o.group({min:0,max:11,i:1,node:"option",item:function(e){return[n[e],0,"value="+e+(c.month==e?" selected":"")+(c.year==h.year&&e<h.month||c.year==p.year&&e>p.month?" disabled":"")]}}),i.klass.selectMonth,(e?"":"disabled")+" "+o.ariaAttr({controls:t.$node[0].id+"_table"})+' title="'+i.labelMonthSelect+'"'):o.node("div",n[c.month],i.klass.month)},v=function(){var n=c.year,s=i.selectYears===!0?5:~~(i.selectYears/2);if(s){var r=h.year,a=p.year,l=n-s,u=n+s;if(r>l&&(u+=r-l,l=r),u>a){var d=l-r,f=u-a;l-=d>f?f:d,u=a}return o.node("select",o.group({min:l,max:u,i:1,node:"option",item:function(e){return[e,0,"value="+e+(n==e?" selected":"")]}}),i.klass.selectYear,(e?"":"disabled")+" "+o.ariaAttr({controls:t.$node[0].id+"_table"})+' title="'+i.labelYearSelect+'"')}return o.node("div",n,i.klass.year)};return o.node("div",(i.selectYears?v()+g():g()+v())+m()+m(1),i.klass.header)+o.node("table",f+o.node("tbody",o.group({min:0,max:s-1,i:1,node:"tr",item:function(e){var s=i.firstDay&&0===t.create([c.year,c.month,1]).day?-7:0;return[o.group({min:n*e-c.day+s+1,max:function(){return this.min+n-1},i:1,node:"td",item:function(e){e=t.create([c.year,c.month,e+(i.firstDay?1:0)]);var n=l&&l.pick==e.pick,s=u&&u.pick==e.pick,r=d&&t.disabled(e)||e.pick<h.pick||e.pick>p.pick,f=o.trigger(t.formats.toString,t,[i.format,e]);return[o.node("div",e.date,function(t){return t.push(c.month==e.month?i.klass.infocus:i.klass.outfocus),a.pick==e.pick&&t.push(i.klass.now),n&&t.push(i.klass.selected),s&&t.push(i.klass.highlighted),r&&t.push(i.klass.disabled),t.join(" ")}([i.klass.day]),"data-pick="+e.pick+" "+o.ariaAttr({role:"gridcell",label:f,selected:n&&t.$node.val()===f?!0:null,activedescendant:s?!0:null,disabled:r?!0:null})),"",o.ariaAttr({role:"presentation"})]}})]}})),i.klass.table,'id="'+t.$node[0].id+'_table" '+o.ariaAttr({role:"grid",controls:t.$node[0].id,readonly:!0}))+o.node("div",o.node("button",i.today,i.klass.buttonToday,"type=button data-pick="+a.pick+(e&&!t.disabled(a)?"":" disabled")+" "+o.ariaAttr({controls:t.$node[0].id}))+o.node("button",i.clear,i.klass.buttonClear,"type=button data-clear=1"+(e?"":" disabled")+" "+o.ariaAttr({controls:t.$node[0].id}))+o.node("button",i.close,i.klass.buttonClose,"type=button data-close=true "+(e?"":" disabled")+" "+o.ariaAttr({controls:t.$node[0].id})),i.klass.footer)},i.defaults=function(e){return{labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],today:"Today",clear:"Clear",close:"Close",closeOnSelect:!0,closeOnClear:!0,format:"d mmmm, yyyy",klass:{table:e+"table",header:e+"header",navPrev:e+"nav--prev",navNext:e+"nav--next",navDisabled:e+"nav--disabled",month:e+"month",year:e+"year",selectMonth:e+"select--month",selectYear:e+"select--year",weekdays:e+"weekday",day:e+"day",disabled:e+"day--disabled",selected:e+"day--selected",highlighted:e+"day--highlighted",now:e+"day--today",infocus:e+"day--infocus",outfocus:e+"day--outfocus",footer:e+"footer",buttonClear:e+"button--clear",buttonToday:e+"button--today",buttonClose:e+"button--close"}}}(e.klasses().picker+"__"),e.extend("pickadate",i)}),function(e,t){if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(i,n,s){e.Backbone=t(e,s,i,n)});else if("undefined"!=typeof exports){var i=require("underscore");t(e,exports,i)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,i,n){var s=e.Backbone,o=[],r=(o.push,o.slice);o.splice;t.VERSION="1.1.2",t.$=n,t.noConflict=function(){return e.Backbone=s,this},t.emulateHTTP=!1,t.emulateJSON=!1;var a=t.Events={on:function(e,t,i){if(!u(this,"on",e,[t,i])||!t)return this;this._events||(this._events={});var n=this._events[e]||(this._events[e]=[]);return n.push({callback:t,context:i,ctx:i||this}),this},once:function(e,t,n){if(!u(this,"once",e,[t,n])||!t)return this;var s=this,o=i.once(function(){s.off(e,o),t.apply(this,arguments)});return o._callback=t,this.on(e,o,n)},off:function(e,t,n){var s,o,r,a,l,c,d,h;if(!this._events||!u(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events=void 0,this;for(a=e?[e]:i.keys(this._events),l=0,c=a.length;c>l;l++)if(e=a[l],r=this._events[e]){if(this._events[e]=s=[],t||n)for(d=0,h=r.length;h>d;d++)o=r[d],(t&&t!==o.callback&&t!==o.callback._callback||n&&n!==o.context)&&s.push(o);s.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=r.call(arguments,1);if(!u(this,"trigger",e,t))return this;var i=this._events[e],n=this._events.all;return i&&c(i,t),n&&c(n,arguments),this},stopListening:function(e,t,n){var s=this._listeningTo;if(!s)return this;var o=!t&&!n;n||"object"!=typeof t||(n=this),e&&((s={})[e._listenId]=e);for(var r in s)e=s[r],e.off(t,n,this),(o||i.isEmpty(e._events))&&delete this._listeningTo[r];return this}},l=/\s+/,u=function(e,t,i,n){if(!i)return!0;if("object"==typeof i){for(var s in i)e[t].apply(e,[s,i[s]].concat(n));return!1}if(l.test(i)){for(var o=i.split(l),r=0,a=o.length;a>r;r++)e[t].apply(e,[o[r]].concat(n));return!1}return!0},c=function(e,t){var i,n=-1,s=e.length,o=t[0],r=t[1],a=t[2];switch(t.length){case 0:for(;++n<s;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<s;)(i=e[n]).callback.call(i.ctx,o);return;case 2:for(;++n<s;)(i=e[n]).callback.call(i.ctx,o,r);return;case 3:for(;++n<s;)(i=e[n]).callback.call(i.ctx,o,r,a);return;default:for(;++n<s;)(i=e[n]).callback.apply(i.ctx,t);return}},d={listenTo:"on",listenToOnce:"once"};i.each(d,function(e,t){a[t]=function(t,n,s){var o=this._listeningTo||(this._listeningTo={}),r=t._listenId||(t._listenId=i.uniqueId("l"));return o[r]=t,s||"object"!=typeof n||(s=this),t[e](n,s,this),this}}),a.bind=a.on,a.unbind=a.off,i.extend(t,a);var h=t.Model=function(e,t){var n=e||{};t||(t={}),this.cid=i.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{}),n=i.defaults({},n,i.result(this,"defaults")),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};i.extend(h.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return i.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,n){var s,o,r,a,l,u,c,d;if(null==e)return this;if("object"==typeof e?(o=e,n=t):(o={})[e]=t,n||(n={}),!this._validate(o,n))return!1;r=n.unset,l=n.silent,a=[],u=this._changing,this._changing=!0,u||(this._previousAttributes=i.clone(this.attributes),this.changed={}),d=this.attributes,c=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(s in o)t=o[s],i.isEqual(d[s],t)||a.push(s),i.isEqual(c[s],t)?delete this.changed[s]:this.changed[s]=t,r?delete d[s]:d[s]=t;if(!l){a.length&&(this._pending=n);for(var h=0,p=a.length;p>h;h++)this.trigger("change:"+a[h],this,d[a[h]],n)}if(u)return this;if(!l)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,i.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,i.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!i.isEmpty(this.changed):i.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?i.clone(this.changed):!1;var t,n=!1,s=this._changing?this._previousAttributes:this.attributes;for(var o in e)i.isEqual(s[o],t=e[o])||((n||(n={}))[o]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,n=e.success;return e.success=function(i){return t.set(t.parse(i,e),e)?(n&&n(t,i,e),void t.trigger("sync",t,i,e)):!1},I(this,e),this.sync("read",this,e)},save:function(e,t,n){var s,o,r,a=this.attributes;if(null==e||"object"==typeof e?(s=e,n=t):(s={})[e]=t,n=i.extend({validate:!0},n),s&&!n.wait){if(!this.set(s,n))return!1}else if(!this._validate(s,n))return!1;s&&n.wait&&(this.attributes=i.extend({},a,s)),void 0===n.parse&&(n.parse=!0);var l=this,u=n.success;return n.success=function(e){l.attributes=a;var t=l.parse(e,n);return n.wait&&(t=i.extend(s||{},t)),i.isObject(t)&&!l.set(t,n)?!1:(u&&u(l,e,n),void l.trigger("sync",l,e,n))},I(this,n),o=this.isNew()?"create":n.patch?"patch":"update","patch"===o&&(n.attrs=s),r=this.sync(o,this,n),s&&n.wait&&(this.attributes=a),r},destroy:function(e){e=e?i.clone(e):{};var t=this,n=e.success,s=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(i){(e.wait||t.isNew())&&s(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)},this.isNew())return e.success(),!1;I(this,e);var o=this.sync("delete",this,e);return e.wait||s(),o},url:function(){var e=i.result(this,"urlRoot")||i.result(this.collection,"url")||$();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},i.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=i.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,i.extend(t,{validationError:n})),!1):!0}});var p=["keys","values","pairs","invert","pick","omit"];i.each(p,function(e){h.prototype[e]=function(){var t=r.call(arguments);return t.unshift(this.attributes),i[e].apply(i,t)}});var f=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,i.extend({silent:!0},t))},m={add:!0,remove:!0,merge:!0},g={add:!0,remove:!1};i.extend(f.prototype,a,{model:h,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,i.extend({merge:!1},t,g))},remove:function(e,t){var n=!i.isArray(e);e=n?[e]:i.clone(e),t||(t={});var s,o,r,a;for(s=0,o=e.length;o>s;s++)a=e[s]=this.get(e[s]),a&&(delete this._byId[a.id],delete this._byId[a.cid],r=this.indexOf(a),this.models.splice(r,1),this.length--,t.silent||(t.index=r,a.trigger("remove",a,this,t)),this._removeReference(a,t));return n?e[0]:e},set:function(e,t){t=i.defaults({},t,m),t.parse&&(e=this.parse(e,t));var n=!i.isArray(e);e=n?e?[e]:[]:i.clone(e);var s,o,r,a,l,u,c,d=t.at,p=this.model,f=this.comparator&&null==d&&t.sort!==!1,g=i.isString(this.comparator)?this.comparator:null,v=[],_=[],b={},y=t.add,w=t.merge,x=t.remove,k=!f&&y&&x?[]:!1;for(s=0,o=e.length;o>s;s++){if(l=e[s]||{},r=l instanceof h?a=l:l[p.prototype.idAttribute||"id"],u=this.get(r))x&&(b[u.cid]=!0),w&&(l=l===a?a.attributes:l,t.parse&&(l=u.parse(l,t)),u.set(l,t),f&&!c&&u.hasChanged(g)&&(c=!0)),e[s]=u;else if(y){if(a=e[s]=this._prepareModel(l,t),!a)continue;v.push(a),this._addReference(a,t)}a=u||a,!k||!a.isNew()&&b[a.id]||k.push(a),b[a.id]=!0}if(x){for(s=0,o=this.length;o>s;++s)b[(a=this.models[s]).cid]||_.push(a);_.length&&this.remove(_,t)}if(v.length||k&&k.length)if(f&&(c=!0),this.length+=v.length,null!=d)for(s=0,o=v.length;o>s;s++)this.models.splice(d+s,0,v[s]);else{k&&(this.models.length=0);var C=k||v;for(s=0,o=C.length;o>s;s++)this.models.push(C[s])}if(c&&this.sort({silent:!0}),!t.silent){for(s=0,o=v.length;o>s;s++)(a=v[s]).trigger("add",a,this,t);(c||k&&k.length)&&this.trigger("sort",this,t)}return n?e[0]:e},reset:function(e,t){t||(t={});for(var n=0,s=this.models.length;s>n;n++)this._removeReference(this.models[n],t);return t.previousModels=this.models,this._reset(),e=this.add(e,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,i.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,i.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return r.apply(this.models,arguments)},get:function(e){return null!=e?this._byId[e]||this._byId[e.id]||this._byId[e.cid]:void 0},at:function(e){return this.models[e]},where:function(e,t){return i.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return i.invoke(this.models,"get",e)},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,n=this;return e.success=function(i){var s=e.reset?"reset":"set";n[s](i,e),t&&t(n,i,e),n.trigger("sync",n,i,e)},I(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?i.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,s=t.success;return t.success=function(e,i){t.wait&&n.add(e,t),s&&s(e,i,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof h)return e;t=t?i.clone(t):{},t.collection=this;var n=new this.model(e,t);return n.validationError?(this.trigger("invalid",this,n.validationError,t),!1):n},_addReference:function(e,t){this._byId[e.cid]=e,null!=e.id&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];i.each(v,function(e){f.prototype[e]=function(){var t=r.call(arguments);return t.unshift(this.models),i[e].apply(i,t)}});var _=["groupBy","countBy","sortBy","indexBy"];i.each(_,function(e){f.prototype[e]=function(t,n){var s=i.isFunction(t)?t:function(e){return e.get(t)};return i[e](this.models,s,n)}});var b=t.View=function(e){this.cid=i.uniqueId("view"),e||(e={}),i.extend(this,i.pick(e,w)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},y=/^(\S+)\s*(.*)$/,w=["model","collection","el","id","attributes","className","tagName","events"];i.extend(b.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=i.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];if(i.isFunction(n)||(n=this[e[t]]),n){var s=t.match(y),o=s[1],r=s[2];n=i.bind(n,this),o+=".delegateEvents"+this.cid,""===r?this.$el.on(o,n):this.$el.on(o,r,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var e=i.extend({},i.result(this,"attributes"));this.id&&(e.id=i.result(this,"id")),this.className&&(e["class"]=i.result(this,"className"));var n=t.$("<"+i.result(this,"tagName")+">").attr(e);this.setElement(n,!1)}}}),t.sync=function(e,n,s){var o=k[e];i.defaults(s||(s={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var r={type:o,dataType:"json"};if(s.url||(r.url=i.result(n,"url")||$()),null!=s.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(r.contentType="application/json",r.data=JSON.stringify(s.attrs||n.toJSON(s))),s.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),s.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){r.type="POST",s.emulateJSON&&(r.data._method=o);var a=s.beforeSend;s.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",o),a?a.apply(this,arguments):void 0}}"GET"===r.type||s.emulateJSON||(r.processData=!1),"PATCH"===r.type&&x&&(r.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=s.xhr=t.ajax(i.extend(r,s));return n.trigger("request",n,l,s),l};var x=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),k={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var C=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},S=/\((.*?)\)/g,T=/(\(\?)?:\w+/g,j=/\*\w+/g,E=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(C.prototype,a,{initialize:function(){},route:function(e,n,s){i.isRegExp(e)||(e=this._routeToRegExp(e)),i.isFunction(n)&&(s=n,n=""),s||(s=this[n]);var o=this;return t.history.route(e,function(i){var r=o._extractParameters(e,i);o.execute(s,r),o.trigger.apply(o,["route:"+n].concat(r)),o.trigger("route",n,r),t.history.trigger("route",o,n,r)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var e,t=i.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(E,"\\$&").replace(S,"(?:$1)?").replace(T,function(e,t){return t?e:"([^/?]+)"}).replace(j,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return i.map(n,function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null})}});var q=t.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},A=/^[#\/]|\s+$/g,P=/^\/+|\/+$/g,F=/msie [\w.]+/,D=/\/$/,R=/#.*$/;q.started=!1,i.extend(q.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var i=this.root.replace(D,"");e.indexOf(i)||(e=e.slice(i.length))}else e=this.getHash();return e.replace(A,"")},start:function(e){if(q.started)throw new Error("Backbone.history has already been started");q.started=!0,this.options=i.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),s=document.documentMode,o=F.exec(navigator.userAgent.toLowerCase())&&(!s||7>=s);if(this.root=("/"+this.root+"/").replace(P,"/"),o&&this._wantsHashChange){var r=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=r.hide().appendTo("body")[0].contentWindow,this.navigate(n)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&a.hash&&(this.fragment=this.getHash().replace(A,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),q.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(e){return e=this.fragment=this.getFragment(e),i.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})},navigate:function(e,t){if(!q.started)return!1;t&&t!==!0||(t={trigger:!!t});var i=this.root+(e=this.getFragment(e||""));if(e=e.replace(R,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}}),t.history=new q;var O=function(e,t){var n,s=this;n=e&&i.has(e,"constructor")?e.constructor:function(){return s.apply(this,arguments)},i.extend(n,s,t);var o=function(){this.constructor=n};return o.prototype=s.prototype,n.prototype=new o,e&&i.extend(n.prototype,e),n.__super__=s.prototype,n};h.extend=f.extend=C.extend=b.extend=q.extend=O;var $=function(){throw new Error('A "url" property or function must be specified')},I=function(e,t){var i=t.error;t.error=function(n){i&&i(e,n,t),e.trigger("error",e,n,t)}};return t}),function(e){"object"==typeof exports?module.exports=e(require("backbone"),require("underscore")):"function"==typeof define&&define.amd&&define("backbone.validation",["backbone","underscore"],e)}(function(e,t){return e.Validation=function(e){"use strict";var t={forceUpdate:!1,selector:"name",labelFormatter:"sentenceCase",valid:Function.prototype,invalid:Function.prototype},i={formatLabel:function(e,i){return l[t.labelFormatter](e,i)},format:function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return t.replace(/\{(\d+)\}/g,function(t,i){return"undefined"!=typeof e[i]?e[i]:t})}},n=function(t,i,s){return i=i||{},s=s||"",e.each(t,function(e,o){t.hasOwnProperty(o)&&(e&&"object"==typeof e&&e.constructor===Object&&n(e,i,s+o+"."),i[s+o]=e)}),i},s=function(){var s=function(t,i){return i=i||e.keys(e.result(t,"validation")||{}),e.reduce(i,function(e,t){return e[t]=void 0,e},{})},r=function(t,i){var n=t.attributes;return e.isFunction(n)?n=n(i):e.isString(n)&&e.isFunction(u[n])&&(n=u[n](i)),e.isArray(n)?n:void 0},a=function(t,i){var n=t.validation?e.result(t,"validation")[i]||{}:{};return(e.isFunction(n)||e.isString(n))&&(n={fn:n}),e.isArray(n)||(n=[n]),e.reduce(n,function(t,i){return e.each(e.without(e.keys(i),"msg"),function(e){t.push({fn:c[e],val:i[e],msg:i.msg})}),t},[])},l=function(t,n,s,o){return e.reduce(a(t,n),function(r,a){var l=e.extend({},i,c),u=a.fn.call(l,s,n,a.val,t,o);return u===!1||r===!1?!1:u&&!r?e.result(a,"msg")||u:r},"")},d=function(t,i,n){var s,o={},r=!0,a=e.clone(i);return e.each(n,function(e,i){s=l(t,i,e,a),s&&(o[i]=s,r=!1)}),{invalidAttrs:o,isValid:r}},h=function(t,i){return{preValidate:function(t,i){var n,s=this,o={};return e.isObject(t)?(e.each(t,function(e,t){n=s.preValidate(t,e),n&&(o[t]=n)}),e.isEmpty(o)?void 0:o):l(this,t,i,e.extend({},this.attributes))},isValid:function(s){var o,a,u,c;return s=s||r(i,t),e.isString(s)?a=[s]:e.isArray(s)&&(a=s),a&&(o=n(this.attributes),e.each(this.associatedViews,function(t){e.each(a,function(n){u=l(this,n,o[n],e.extend({},this.attributes)),u?(i.invalid(t,n,u,i.selector),c=c||{},c[n]=u):i.valid(t,n,i.selector)},this)},this)),s===!0&&(c=this.validate()),c&&this.trigger("invalid",this,c,{validationError:c}),a?!c:this.validation?this._isValid:!0},validate:function(o,a){var l=this,u=!o,c=e.extend({},i,a),h=s(l,r(i,t)),p=e.extend({},h,l.attributes,o),f=n(p),m=o?n(o):f,g=d(l,p,e.pick(f,e.keys(h)));return l._isValid=g.isValid,e.each(l.associatedViews,function(t){e.each(h,function(e,i){var n=g.invalidAttrs.hasOwnProperty(i),s=m.hasOwnProperty(i);n||c.valid(t,i,c.selector),n&&(s||u)&&c.invalid(t,i,g.invalidAttrs[i],c.selector)})}),e.defer(function(){l.trigger("validated",l._isValid,l,g.invalidAttrs),l.trigger("validated:"+(l._isValid?"valid":"invalid"),l,g.invalidAttrs)}),!c.forceUpdate&&e.intersection(e.keys(g.invalidAttrs),e.keys(m)).length>0?g.invalidAttrs:void 0}}},p=function(t,i,n){i.associatedViews?i.associatedViews.push(t):i.associatedViews=[t],e.extend(i,h(t,n))},f=function(t,i){i&&t.associatedViews.length>1?t.associatedViews=e.without(t.associatedViews,i):(delete t.validate,delete t.preValidate,delete t.isValid,delete t.associatedViews)},m=function(e){p(this.view,e,this.options)},g=function(e){f(e)};return{version:"0.11.3",configure:function(i){e.extend(t,i)},bind:function(i,n){n=e.extend({},t,o,n);var s=n.model||i.model,r=n.collection||i.collection;if("undefined"==typeof s&&"undefined"==typeof r)throw"Before you execute the binding your view must have a model or a collection.\nSee http://thedersen.com/projects/backbone-validation/#using-form-model-validation for more information.";s?p(i,s,n):r&&(r.each(function(e){p(i,e,n)}),r.bind("add",m,{view:i,options:n}),r.bind("remove",g))},unbind:function(t,i){i=e.extend({},i);var n=i.model||t.model,s=i.collection||t.collection;n?f(n,t):s&&(s.each(function(e){f(e,t)}),s.unbind("add",m),s.unbind("remove",g))},mixin:h(null,t)}}(),o=s.callbacks={valid:function(e,t,i){e.$("["+i+'~="'+t+'"]').removeClass("invalid").removeAttr("data-error")},invalid:function(e,t,i,n){e.$("["+n+'~="'+t+'"]').addClass("invalid").attr("data-error",i)}},r=s.patterns={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},a=s.messages={required:"{0} is required",acceptance:"{0} must be accepted",min:"{0} must be greater than or equal to {1}",max:"{0} must be less than or equal to {1}",range:"{0} must be between {1} and {2}",length:"{0} must be {1} characters",minLength:"{0} must be at least {1} characters",maxLength:"{0} must be at most {1} characters",rangeLength:"{0} must be between {1} and {2} characters",oneOf:"{0} must be one of: {1}",equalTo:"{0} must be the same as {1}",digits:"{0} must only contain digits",number:"{0} must be a number",email:"{0} must be a valid email",url:"{0} must be a valid url",inlinePattern:"{0} is invalid"},l=s.labelFormatters={none:function(e){return e},sentenceCase:function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,t){return 0===t?e.toUpperCase():" "+e.toLowerCase()}).replace(/_/g," ")},label:function(e,t){return t.labels&&t.labels[e]||l.sentenceCase(e,t)}},u=s.attributeLoaders={inputNames:function(e){var t=[];return e&&e.$("form [name]").each(function(){/^(?:input|select|textarea)$/i.test(this.nodeName)&&this.name&&"submit"!==this.type&&-1===t.indexOf(this.name)&&t.push(this.name)}),t}},c=s.validators=function(){var t=String.prototype.trim?function(e){return null===e?"":String.prototype.trim.call(e)}:function(e){var t=/^\s+/,i=/\s+$/;return null===e?"":e.toString().replace(t,"").replace(i,"")},i=function(t){return e.isNumber(t)||e.isString(t)&&t.match(r.number)},n=function(i){return!(e.isNull(i)||e.isUndefined(i)||e.isString(i)&&""===t(i)||e.isArray(i)&&e.isEmpty(i))};return{fn:function(t,i,n,s,o){return e.isString(n)&&(n=s[n]),n.call(s,t,i,o)},required:function(t,i,s,o,r){var l=e.isFunction(s)?s.call(o,t,i,r):s;return l||n(t)?l&&!n(t)?this.format(a.required,this.formatLabel(i,o)):void 0:!1},acceptance:function(t,i,n,s){return"true"===t||e.isBoolean(t)&&t!==!1?void 0:this.format(a.acceptance,this.formatLabel(i,s))},min:function(e,t,n,s){return!i(e)||n>e?this.format(a.min,this.formatLabel(t,s),n):void 0},max:function(e,t,n,s){return!i(e)||e>n?this.format(a.max,this.formatLabel(t,s),n):void 0},range:function(e,t,n,s){return!i(e)||e<n[0]||e>n[1]?this.format(a.range,this.formatLabel(t,s),n[0],n[1]):void 0},length:function(t,i,n,s){return e.isString(t)&&t.length===n?void 0:this.format(a.length,this.formatLabel(i,s),n);
},minLength:function(t,i,n,s){return!e.isString(t)||t.length<n?this.format(a.minLength,this.formatLabel(i,s),n):void 0},maxLength:function(t,i,n,s){return!e.isString(t)||t.length>n?this.format(a.maxLength,this.formatLabel(i,s),n):void 0},rangeLength:function(t,i,n,s){return!e.isString(t)||t.length<n[0]||t.length>n[1]?this.format(a.rangeLength,this.formatLabel(i,s),n[0],n[1]):void 0},oneOf:function(t,i,n,s){return e.include(n,t)?void 0:this.format(a.oneOf,this.formatLabel(i,s),n.join(", "))},equalTo:function(e,t,i,n,s){return e!==s[i]?this.format(a.equalTo,this.formatLabel(t,n),this.formatLabel(i,n)):void 0},pattern:function(e,t,i,s){return n(e)&&e.toString().match(r[i]||i)?void 0:this.format(a[i]||a.inlinePattern,this.formatLabel(t,s),i)}}}();return e.each(c,function(t,n){c[n]=e.bind(c[n],e.extend({},i,c))}),s}(t),e.Validation}),function(e,t){if("function"==typeof define&&define.amd)define("backbone.wreqr",["backbone","underscore"],function(e,i){return t(e,i)});else if("undefined"!=typeof exports){var i=require("backbone"),n=require("underscore");module.exports=t(i,n)}else t(e.Backbone,e._)}(this,function(e,t){"use strict";var i=e.Wreqr,n=e.Wreqr={};return e.Wreqr.VERSION="1.3.2",e.Wreqr.noConflict=function(){return e.Wreqr=i,this},n.Handlers=function(e,t){var i=function(e){this.options=e,this._wreqrHandlers={},t.isFunction(this.initialize)&&this.initialize(e)};return i.extend=e.Model.extend,t.extend(i.prototype,e.Events,{setHandlers:function(e){t.each(e,function(e,i){var n=null;t.isObject(e)&&!t.isFunction(e)&&(n=e.context,e=e.callback),this.setHandler(i,e,n)},this)},setHandler:function(e,t,i){var n={callback:t,context:i};this._wreqrHandlers[e]=n,this.trigger("handler:add",e,t,i)},hasHandler:function(e){return!!this._wreqrHandlers[e]},getHandler:function(e){var t=this._wreqrHandlers[e];if(t)return function(){return t.callback.apply(t.context,arguments)}},removeHandler:function(e){delete this._wreqrHandlers[e]},removeAllHandlers:function(){this._wreqrHandlers={}}}),i}(e,t),n.CommandStorage=function(){var i=function(e){this.options=e,this._commands={},t.isFunction(this.initialize)&&this.initialize(e)};return t.extend(i.prototype,e.Events,{getCommands:function(e){var t=this._commands[e];return t||(t={command:e,instances:[]},this._commands[e]=t),t},addCommand:function(e,t){var i=this.getCommands(e);i.instances.push(t)},clearCommands:function(e){var t=this.getCommands(e);t.instances=[]}}),i}(),n.Commands=function(e,t){return e.Handlers.extend({storageType:e.CommandStorage,constructor:function(t){this.options=t||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this),e.Handlers.prototype.constructor.apply(this,arguments)},execute:function(e){e=arguments[0];var i=t.rest(arguments);this.hasHandler(e)?this.getHandler(e).apply(this,i):this.storage.addCommand(e,i)},_executeCommands:function(e,i,n){var s=this.storage.getCommands(e);t.each(s.instances,function(e){i.apply(n,e)}),this.storage.clearCommands(e)},_initializeStorage:function(e){var i,n=e.storageType||this.storageType;i=t.isFunction(n)?new n:n,this.storage=i}})}(n,t),n.RequestResponse=function(e,t){return e.Handlers.extend({request:function(e){return this.hasHandler(e)?this.getHandler(e).apply(this,t.rest(arguments)):void 0}})}(n,t),n.EventAggregator=function(e,t){var i=function(){};return i.extend=e.Model.extend,t.extend(i.prototype,e.Events),i}(e,t),n.Channel=function(i){var n=function(t){this.vent=new e.Wreqr.EventAggregator,this.reqres=new e.Wreqr.RequestResponse,this.commands=new e.Wreqr.Commands,this.channelName=t};return t.extend(n.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this},connectEvents:function(e,t){return this._connect("vent",e,t),this},connectCommands:function(e,t){return this._connect("commands",e,t),this},connectRequests:function(e,t){return this._connect("reqres",e,t),this},_connect:function(e,i,n){if(i){n=n||this;var s="vent"===e?"on":"setHandler";t.each(i,function(i,o){this[e][s](o,t.bind(i,n))},this)}}}),n}(n),n.radio=function(e,t){var i=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};t.extend(i.prototype,{channel:function(e){if(!e)throw new Error("Channel must receive a name");return this._getChannel(e)},_getChannel:function(t){var i=this._channels[t];return i||(i=new e.Channel(t),this._channels[t]=i),i},_proxyMethods:function(){t.each(["vent","commands","reqres"],function(e){t.each(n[e],function(t){this[e][t]=s(this,e,t)},this)},this)}});var n={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},s=function(e,i,n){return function(s){var o=e._getChannel(s)[i];return o[n].apply(o,t.rest(arguments))}};return new i}(n,t),e.Wreqr}),function(e,t){if("function"==typeof define&&define.amd)define("backbone.babysitter",["backbone","underscore"],function(e,i){return t(e,i)});else if("undefined"!=typeof exports){var i=require("backbone"),n=require("underscore");module.exports=t(i,n)}else t(e.Backbone,e._)}(this,function(e,t){"use strict";var i=e.ChildViewContainer;return e.ChildViewContainer=function(e,t){var i=function(e){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),t.each(e,this.add,this)};t.extend(i.prototype,{add:function(e,t){var i=e.cid;return this._views[i]=e,e.model&&(this._indexByModel[e.model.cid]=i),t&&(this._indexByCustom[t]=i),this._updateLength(),this},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var t=this._indexByModel[e];return this.findByCid(t)},findByCustom:function(e){var t=this._indexByCustom[e];return this.findByCid(t)},findByIndex:function(e){return t.values(this._views)[e]},findByCid:function(e){return this._views[e]},remove:function(e){var i=e.cid;return e.model&&delete this._indexByModel[e.model.cid],t.any(this._indexByCustom,function(e,t){return e===i?(delete this._indexByCustom[t],!0):void 0},this),delete this._views[i],this._updateLength(),this},call:function(e){this.apply(e,t.tail(arguments))},apply:function(e,i){t.each(this._views,function(n){t.isFunction(n[e])&&n[e].apply(n,i||[])})},_updateLength:function(){this.length=t.size(this._views)}});var n=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck","reduce"];return t.each(n,function(e){i.prototype[e]=function(){var i=t.values(this._views),n=[i].concat(t.toArray(arguments));return t[e].apply(t,n)}}),i}(e,t),e.ChildViewContainer.VERSION="0.1.6",e.ChildViewContainer.noConflict=function(){return e.ChildViewContainer=i,this},e.ChildViewContainer}),function(e,t){if("function"==typeof define&&define.amd)define("backbone.marionette",["backbone","underscore","backbone.wreqr","backbone.babysitter"],function(i,n){return e.Marionette=e.Mn=t(e,i,n)});else if("undefined"!=typeof exports){var i=require("backbone"),n=require("underscore");require("backbone.wreqr"),require("backbone.babysitter");module.exports=t(e,i,n)}else e.Marionette=e.Mn=t(e,e.Backbone,e._)}(this,function(e,t,i){"use strict";var n=e.Marionette,s=e.Mn,o=t.Marionette={};o.VERSION="2.4.2",o.noConflict=function(){return e.Marionette=n,e.Mn=s,this},o.Deferred=t.$.Deferred,o.FEATURES={},o.isEnabled=function(e){return!!o.FEATURES[e]},o.extend=t.Model.extend,o.isNodeAttached=function(e){return t.$.contains(document.documentElement,e)},o.mergeOptions=function(e,t){e&&i.extend(this,i.pick(e,t))},o.getOption=function(e,t){return e&&t?e.options&&void 0!==e.options[t]?e.options[t]:e[t]:void 0},o.proxyGetOption=function(e){return o.getOption(this,e)},o._getValue=function(e,t,n){return i.isFunction(e)&&(e=n?e.apply(t,n):e.call(t)),e},o.normalizeMethods=function(e){return i.reduce(e,function(e,t,n){return i.isFunction(t)||(t=this[t]),t&&(e[n]=t),e},{},this)},o.normalizeUIString=function(e,t){return e.replace(/@ui\.[a-zA-Z_$0-9]*/g,function(e){return t[e.slice(4)]})},o.normalizeUIKeys=function(e,t){return i.reduce(e,function(e,i,n){var s=o.normalizeUIString(n,t);return e[s]=i,e},{})},o.normalizeUIValues=function(e,t,n){return i.each(e,function(s,r){i.isString(s)?e[r]=o.normalizeUIString(s,t):i.isObject(s)&&i.isArray(n)&&(i.extend(s,o.normalizeUIValues(i.pick(s,n),t)),i.each(n,function(e){var n=s[e];i.isString(n)&&(s[e]=o.normalizeUIString(n,t))}))}),e},o.actAsCollection=function(e,t){var n=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];i.each(n,function(n){e[n]=function(){var e=i.values(i.result(this,t)),s=[e].concat(i.toArray(arguments));return i[n].apply(i,s)}})};var r=o.deprecate=function(e,t){i.isObject(e)&&(e=e.prev+" is going to be removed in the future. Please use "+e.next+" instead."+(e.url?" See: "+e.url:"")),void 0!==t&&t||r._cache[e]||(r._warn("Deprecation warning: "+e),r._cache[e]=!0)};r._warn="undefined"!=typeof console&&(console.warn||console.log)||function(){},r._cache={},o._triggerMethod=function(){function e(e,t,i){return i.toUpperCase()}var t=/(^|:)(\w)/gi;return function(n,s,o){var r=arguments.length<3;r&&(o=s,s=o[0]);var a,l="on"+s.replace(t,e),u=n[l];return i.isFunction(u)&&(a=u.apply(n,r?i.rest(o):o)),i.isFunction(n.trigger)&&(r+o.length>1?n.trigger.apply(n,r?o:[s].concat(i.drop(o,0))):n.trigger(s)),a}}(),o.triggerMethod=function(e){return o._triggerMethod(this,arguments)},o.triggerMethodOn=function(e){var t=i.isFunction(e.triggerMethod)?e.triggerMethod:o.triggerMethod;return t.apply(e,i.rest(arguments))},o.MonitorDOMRefresh=function(e){function t(){e._isShown=!0,s()}function n(){e._isRendered=!0,s()}function s(){e._isShown&&e._isRendered&&o.isNodeAttached(e.el)&&i.isFunction(e.triggerMethod)&&e.triggerMethod("dom:refresh")}e.on({show:t,render:n})},function(e){function t(t,n,s,o){var r=o.split(/\s+/);i.each(r,function(i){var o=t[i];if(!o)throw new e.Error('Method "'+i+'" was configured as an event handler, but does not exist.');t.listenTo(n,s,o)})}function n(e,t,i,n){e.listenTo(t,i,n)}function s(e,t,n,s){var o=s.split(/\s+/);i.each(o,function(i){var s=e[i];e.stopListening(t,n,s)})}function o(e,t,i,n){e.stopListening(t,i,n)}function r(t,n,s,o,r){if(n&&s){if(!i.isObject(s))throw new e.Error({message:"Bindings must be an object or function.",url:"marionette.functions.html#marionettebindentityevents"});s=e._getValue(s,t),i.each(s,function(e,s){i.isFunction(e)?o(t,n,s,e):r(t,n,s,e)})}}e.bindEntityEvents=function(e,i,s){r(e,i,s,n,t)},e.unbindEntityEvents=function(e,t,i){r(e,t,i,o,s)},e.proxyBindEntityEvents=function(t,i){return e.bindEntityEvents(this,t,i)},e.proxyUnbindEntityEvents=function(t,i){return e.unbindEntityEvents(this,t,i)}}(o);var a=["description","fileName","lineNumber","name","message","number"];return o.Error=o.extend.call(Error,{urlRoot:"http://marionettejs.com/docs/v"+o.VERSION+"/",constructor:function(e,t){i.isObject(e)?(t=e,e=t.message):t||(t={});var n=Error.call(this,e);i.extend(this,i.pick(n,a),i.pick(t,a)),this.captureStackTrace(),t.url&&(this.url=this.urlRoot+t.url)},captureStackTrace:function(){Error.captureStackTrace&&Error.captureStackTrace(this,o.Error)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}}),o.Error.extend=o.extend,o.Callbacks=function(){this._deferred=o.Deferred(),this._callbacks=[]},i.extend(o.Callbacks.prototype,{add:function(e,t){var n=i.result(this._deferred,"promise");this._callbacks.push({cb:e,ctx:t}),n.then(function(i){t&&(i.context=t),e.call(i.context,i.options)})},run:function(e,t){this._deferred.resolve({options:e,context:t})},reset:function(){var e=this._callbacks;this._deferred=o.Deferred(),this._callbacks=[],i.each(e,function(e){this.add(e.cb,e.ctx)},this)}}),o.Controller=function(e){this.options=e||{},i.isFunction(this.initialize)&&this.initialize(this.options)},o.Controller.extend=o.extend,i.extend(o.Controller.prototype,t.Events,{destroy:function(){return o._triggerMethod(this,"before:destroy",arguments),o._triggerMethod(this,"destroy",arguments),this.stopListening(),this.off(),this},triggerMethod:o.triggerMethod,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption}),o.Object=function(e){this.options=i.extend({},i.result(this,"options"),e),this.initialize.apply(this,arguments)},o.Object.extend=o.extend,i.extend(o.Object.prototype,t.Events,{initialize:function(){},destroy:function(){return this.triggerMethod("before:destroy"),this.triggerMethod("destroy"),this.stopListening(),this},triggerMethod:o.triggerMethod,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.Region=o.Object.extend({constructor:function(e){if(this.options=e||{},this.el=this.getOption("el"),this.el=this.el instanceof t.$?this.el[0]:this.el,!this.el)throw new o.Error({name:"NoElError",message:'An "el" must be specified for a region.'});this.$el=this.getEl(this.el),o.Object.call(this,e)},show:function(e,t){if(this._ensureElement()){this._ensureViewIsIntact(e);var n=t||{},s=e!==this.currentView,r=!!n.preventDestroy,a=!!n.forceShow,l=!!this.currentView,u=s&&!r,c=s||a;if(l&&this.triggerMethod("before:swapOut",this.currentView,this,t),this.currentView&&delete this.currentView._parent,u?this.empty():l&&c&&this.currentView.off("destroy",this.empty,this),c){e.once("destroy",this.empty,this),e.render(),e._parent=this,l&&this.triggerMethod("before:swap",e,this,t),this.triggerMethod("before:show",e,this,t),o.triggerMethodOn(e,"before:show",e,this,t),l&&this.triggerMethod("swapOut",this.currentView,this,t);var d=o.isNodeAttached(this.el),h=[],p=i.extend({triggerBeforeAttach:this.triggerBeforeAttach,triggerAttach:this.triggerAttach},n);return d&&p.triggerBeforeAttach&&(h=this._displayedViews(e),this._triggerAttach(h,"before:")),this.attachHtml(e),this.currentView=e,d&&p.triggerAttach&&(h=this._displayedViews(e),this._triggerAttach(h)),l&&this.triggerMethod("swap",e,this,t),this.triggerMethod("show",e,this,t),o.triggerMethodOn(e,"show",e,this,t),this}return this}},triggerBeforeAttach:!0,triggerAttach:!0,_triggerAttach:function(e,t){var n=(t||"")+"attach";i.each(e,function(e){o.triggerMethodOn(e,n,e,this)},this)},_displayedViews:function(e){return i.union([e],i.result(e,"_getNestedViews")||[])},_ensureElement:function(){if(i.isObject(this.el)||(this.$el=this.getEl(this.el),this.el=this.$el[0]),!this.$el||0===this.$el.length){if(this.getOption("allowMissingEl"))return!1;throw new o.Error('An "el" '+this.$el.selector+" must exist in DOM")}return!0},_ensureViewIsIntact:function(e){if(!e)throw new o.Error({name:"ViewNotValid",message:"The view passed is undefined and therefore invalid. You must pass a view instance to show."});if(e.isDestroyed)throw new o.Error({name:"ViewDestroyedError",message:'View (cid: "'+e.cid+'") has already been destroyed and cannot be used.'})},getEl:function(e){return t.$(e,o._getValue(this.options.parentEl,this))},attachHtml:function(e){this.$el.contents().detach(),this.el.appendChild(e.el)},empty:function(e){var t=this.currentView,i=o._getValue(e,"preventDestroy",this);return t?(t.off("destroy",this.empty,this),this.triggerMethod("before:empty",t),i||this._destroyView(),this.triggerMethod("empty",t),delete this.currentView,i&&this.$el.contents().detach(),this):void 0},_destroyView:function(){var e=this.currentView;e.destroy&&!e.isDestroyed?e.destroy():e.remove&&(e.remove(),e.isDestroyed=!0)},attachView:function(e){return this.currentView=e,this},hasView:function(){return!!this.currentView},reset:function(){return this.empty(),this.$el&&(this.el=this.$el.selector),delete this.$el,this}},{buildRegion:function(e,t){if(i.isString(e))return this._buildRegionFromSelector(e,t);if(e.selector||e.el||e.regionClass)return this._buildRegionFromObject(e,t);if(i.isFunction(e))return this._buildRegionFromRegionClass(e);throw new o.Error({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})},_buildRegionFromSelector:function(e,t){return new t({el:e})},_buildRegionFromObject:function(e,t){var n=e.regionClass||t,s=i.omit(e,"selector","regionClass");return e.selector&&!s.el&&(s.el=e.selector),new n(s)},_buildRegionFromRegionClass:function(e){return new e}}),o.RegionManager=o.Controller.extend({constructor:function(e){this._regions={},this.length=0,o.Controller.call(this,e),this.addRegions(this.getOption("regions"))},addRegions:function(e,t){return e=o._getValue(e,this,arguments),i.reduce(e,function(e,n,s){return i.isString(n)&&(n={selector:n}),n.selector&&(n=i.defaults({},n,t)),e[s]=this.addRegion(s,n),e},{},this)},addRegion:function(e,t){var i;return i=t instanceof o.Region?t:o.Region.buildRegion(t,o.Region),this.triggerMethod("before:add:region",e,i),i._parent=this,this._store(e,i),this.triggerMethod("add:region",e,i),i},get:function(e){return this._regions[e]},getRegions:function(){return i.clone(this._regions)},removeRegion:function(e){var t=this._regions[e];return this._remove(e,t),t},removeRegions:function(){var e=this.getRegions();return i.each(this._regions,function(e,t){this._remove(t,e)},this),e},emptyRegions:function(){var e=this.getRegions();return i.invoke(e,"empty"),e},destroy:function(){return this.removeRegions(),o.Controller.prototype.destroy.apply(this,arguments)},_store:function(e,t){this._regions[e]||this.length++,this._regions[e]=t},_remove:function(e,t){this.triggerMethod("before:remove:region",e,t),t.empty(),t.stopListening(),delete t._parent,delete this._regions[e],this.length--,this.triggerMethod("remove:region",e,t)}}),o.actAsCollection(o.RegionManager.prototype,"_regions"),o.TemplateCache=function(e){this.templateId=e},i.extend(o.TemplateCache,{templateCaches:{},get:function(e,t){var i=this.templateCaches[e];return i||(i=new o.TemplateCache(e),this.templateCaches[e]=i),i.load(t)},clear:function(){var e,t=i.toArray(arguments),n=t.length;if(n>0)for(e=0;n>e;e++)delete this.templateCaches[t[e]];else this.templateCaches={}}}),i.extend(o.TemplateCache.prototype,{load:function(e){if(this.compiledTemplate)return this.compiledTemplate;var t=this.loadTemplate(this.templateId,e);return this.compiledTemplate=this.compileTemplate(t,e),this.compiledTemplate},loadTemplate:function(e,i){var n=t.$(e).html();if(!n||0===n.length)throw new o.Error({name:"NoTemplateError",message:'Could not find template: "'+e+'"'});return n},compileTemplate:function(e,t){return i.template(e,t)}}),o.Renderer={render:function(e,t){if(!e)throw new o.Error({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});var n=i.isFunction(e)?e:o.TemplateCache.get(e);return n(t)}},o.View=t.View.extend({isDestroyed:!1,constructor:function(e){i.bindAll(this,"render"),e=o._getValue(e,this),this.options=i.extend({},i.result(this,"options"),e),this._behaviors=o.Behaviors(this),t.View.call(this,this.options),o.MonitorDOMRefresh(this)},getTemplate:function(){return this.getOption("template")},serializeModel:function(e){return e.toJSON.apply(e,i.rest(arguments))},mixinTemplateHelpers:function(e){e=e||{};var t=this.getOption("templateHelpers");return t=o._getValue(t,this),i.extend(e,t)},normalizeUIKeys:function(e){var t=i.result(this,"_uiBindings");return o.normalizeUIKeys(e,t||i.result(this,"ui"))},normalizeUIValues:function(e,t){var n=i.result(this,"ui"),s=i.result(this,"_uiBindings");return o.normalizeUIValues(e,s||n,t)},configureTriggers:function(){if(this.triggers){var e=this.normalizeUIKeys(i.result(this,"triggers"));return i.reduce(e,function(e,t,i){return e[i]=this._buildViewTrigger(t),e},{},this)}},delegateEvents:function(e){return this._delegateDOMEvents(e),this.bindEntityEvents(this.model,this.getOption("modelEvents")),this.bindEntityEvents(this.collection,this.getOption("collectionEvents")),i.each(this._behaviors,function(e){e.bindEntityEvents(this.model,e.getOption("modelEvents")),e.bindEntityEvents(this.collection,e.getOption("collectionEvents"))},this),this},_delegateDOMEvents:function(e){var n=o._getValue(e||this.events,this);n=this.normalizeUIKeys(n),i.isUndefined(e)&&(this.events=n);var s={},r=i.result(this,"behaviorEvents")||{},a=this.configureTriggers(),l=i.result(this,"behaviorTriggers")||{};i.extend(s,r,n,a,l),t.View.prototype.delegateEvents.call(this,s)},undelegateEvents:function(){return t.View.prototype.undelegateEvents.apply(this,arguments),this.unbindEntityEvents(this.model,this.getOption("modelEvents")),this.unbindEntityEvents(this.collection,this.getOption("collectionEvents")),i.each(this._behaviors,function(e){e.unbindEntityEvents(this.model,e.getOption("modelEvents")),e.unbindEntityEvents(this.collection,e.getOption("collectionEvents"))},this),this},_ensureViewIsIntact:function(){if(this.isDestroyed)throw new o.Error({name:"ViewDestroyedError",message:'View (cid: "'+this.cid+'") has already been destroyed and cannot be used.'})},destroy:function(){if(this.isDestroyed)return this;var e=i.toArray(arguments);return this.triggerMethod.apply(this,["before:destroy"].concat(e)),this.isDestroyed=!0,this.triggerMethod.apply(this,["destroy"].concat(e)),this.unbindUIElements(),this.isRendered=!1,this.remove(),i.invoke(this._behaviors,"destroy",e),this},bindUIElements:function(){this._bindUIElements(),i.invoke(this._behaviors,this._bindUIElements)},_bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var e=i.result(this,"_uiBindings");this.ui={},i.each(e,function(e,t){this.ui[t]=this.$(e)},this)}},unbindUIElements:function(){this._unbindUIElements(),i.invoke(this._behaviors,this._unbindUIElements)},_unbindUIElements:function(){this.ui&&this._uiBindings&&(i.each(this.ui,function(e,t){delete this.ui[t]},this),this.ui=this._uiBindings,delete this._uiBindings)},_buildViewTrigger:function(e){var t=i.isObject(e),n=i.defaults({},t?e:{},{preventDefault:!0,stopPropagation:!0}),s=t?n.event:e;return function(e){e&&(e.preventDefault&&n.preventDefault&&e.preventDefault(),e.stopPropagation&&n.stopPropagation&&e.stopPropagation());var t={view:this,model:this.model,collection:this.collection};this.triggerMethod(s,t)}},setElement:function(){var e=t.View.prototype.setElement.apply(this,arguments);return i.invoke(this._behaviors,"proxyViewProperties",this),e},triggerMethod:function(){var e=o._triggerMethod(this,arguments);return this._triggerEventOnBehaviors(arguments),this._triggerEventOnParentLayout(arguments[0],i.rest(arguments)),e},_triggerEventOnBehaviors:function(e){for(var t=o._triggerMethod,i=this._behaviors,n=0,s=i&&i.length;s>n;n++)t(i[n],e)},_triggerEventOnParentLayout:function(e,t){var n=this._parentLayoutView();if(n){var s=o.getOption(n,"childViewEventPrefix"),r=s+":"+e;o._triggerMethod(n,[r,this].concat(t));var a=o.getOption(n,"childEvents"),l=n.normalizeMethods(a);l&&i.isFunction(l[e])&&l[e].apply(n,[this].concat(t))}},_getImmediateChildren:function(){return[]},_getNestedViews:function(){var e=this._getImmediateChildren();return e.length?i.reduce(e,function(e,t){return t._getNestedViews?e.concat(t._getNestedViews()):e},e):e},_getAncestors:function(){for(var e=[],t=this._parent;t;)e.push(t),t=t._parent;return e},_parentLayoutView:function(){var e=this._getAncestors();return i.find(e,function(e){return e instanceof o.LayoutView})},normalizeMethods:o.normalizeMethods,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.ItemView=o.View.extend({constructor:function(){o.View.apply(this,arguments)},serializeData:function(){if(!this.model&&!this.collection)return{};var e=[this.model||this.collection];return arguments.length&&e.push.apply(e,arguments),this.model?this.serializeModel.apply(this,e):{items:this.serializeCollection.apply(this,e)}},serializeCollection:function(e){return e.toJSON.apply(e,i.rest(arguments))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderTemplate(),this.isRendered=!0,this.bindUIElements(),this.triggerMethod("render",this),this},_renderTemplate:function(){var e=this.getTemplate();if(e!==!1){if(!e)throw new o.Error({name:"UndefinedTemplateError",message:"Cannot render the template since it is null or undefined."});var t=this.mixinTemplateHelpers(this.serializeData()),i=o.Renderer.render(e,t,this);return this.attachElContent(i),this}},attachElContent:function(e){return this.$el.html(e),this}}),o.CollectionView=o.View.extend({childViewEventPrefix:"childview",sort:!0,constructor:function(e){this.once("render",this._initialEvents),this._initChildViewStorage(),o.View.apply(this,arguments),this.on({"before:show":this._onBeforeShowCalled,show:this._onShowCalled,"before:attach":this._onBeforeAttachCalled,attach:this._onAttachCalled}),this.initRenderBuffer()},initRenderBuffer:function(){this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){var e,t=this._isShown&&o.isNodeAttached(this.el);this.isBuffering=!1,this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"before:show"),t&&this._triggerBeforeAttach&&(e=this._getNestedViews(),this._triggerMethodMany(e,this,"before:attach")),this.attachBuffer(this,this._createBuffer()),t&&this._triggerAttach&&(e=this._getNestedViews(),this._triggerMethodMany(e,this,"attach")),this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"show"),this.initRenderBuffer()},_triggerMethodMany:function(e,t,n){var s=i.drop(arguments,3);i.each(e,function(e){o.triggerMethodOn.apply(e,[e,n,e,t].concat(s))})},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.render),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(e,t,n){var s;if(s=void 0!==n.at?n.at:i.indexOf(this._filteredSortedModels(),e),this._shouldAddChild(e,s)){this.destroyEmptyView();var o=this.getChildView(e);this.addChild(e,o,s)}},_onCollectionRemove:function(e){var t=this.children.findByModel(e);this.removeChildView(t),this.checkEmpty()},_onBeforeShowCalled:function(){this._triggerBeforeAttach=this._triggerAttach=!1,this.children.each(function(e){o.triggerMethodOn(e,"before:show",e)})},_onShowCalled:function(){this.children.each(function(e){o.triggerMethodOn(e,"show",e)})},_onBeforeAttachCalled:function(){this._triggerBeforeAttach=!0},_onAttachCalled:function(){this._triggerAttach=!0},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderChildren(),this.isRendered=!0,this.triggerMethod("render",this),this},reorder:function(){var e=this.children,t=this._filteredSortedModels(),n=i.find(t,function(t){return!e.findByModel(t)});if(n)this.render();else{var s=i.map(t,function(t,i){var n=e.findByModel(t);return n._index=i,n.el});this.triggerMethod("before:reorder"),this._appendReorderedChildren(s),this.triggerMethod("reorder")}},resortView:function(){o.getOption(this,"reorderOnSort")?this.reorder():this.render()},_sortViews:function(){var e=this._filteredSortedModels(),t=i.find(e,function(e,t){var i=this.children.findByModel(e);return!i||i._index!==t},this);t&&this.resortView()},_emptyViewIndex:-1,_appendReorderedChildren:function(e){this.$el.append(e)},_renderChildren:function(){this.destroyEmptyView(),this.destroyChildren({checkEmpty:!1}),this.isEmpty(this.collection)?this.showEmptyView():(this.triggerMethod("before:render:collection",this),this.startBuffering(),this.showCollection(),this.endBuffering(),this.triggerMethod("render:collection",this),this.children.isEmpty()&&this.showEmptyView())},showCollection:function(){var e,t=this._filteredSortedModels();i.each(t,function(t,i){e=this.getChildView(t),this.addChild(t,e,i)},this)},_filteredSortedModels:function(){var e,t=this.getViewComparator();return e=t?i.isString(t)||1===t.length?this.collection.sortBy(t,this):i.clone(this.collection.models).sort(i.bind(t,this)):this.collection.models,this.getOption("filter")&&(e=i.filter(e,function(e,t){return this._shouldAddChild(e,t)},this)),e},showEmptyView:function(){var e=this.getEmptyView();if(e&&!this._showingEmptyView){this.triggerMethod("before:render:empty"),this._showingEmptyView=!0;var i=new t.Model;this.addEmptyView(i,e),this.triggerMethod("render:empty")}},destroyEmptyView:function(){this._showingEmptyView&&(this.triggerMethod("before:remove:empty"),this.destroyChildren(),delete this._showingEmptyView,this.triggerMethod("remove:empty"))},getEmptyView:function(){return this.getOption("emptyView")},addEmptyView:function(e,t){var n,s=this._isShown&&!this.isBuffering&&o.isNodeAttached(this.el),r=this.getOption("emptyViewOptions")||this.getOption("childViewOptions");i.isFunction(r)&&(r=r.call(this,e,this._emptyViewIndex));var a=this.buildChildView(e,t,r);a._parent=this,this.proxyChildEvents(a),this._isShown&&o.triggerMethodOn(a,"before:show",a),this.children.add(a),s&&this._triggerBeforeAttach&&(n=[a].concat(a._getNestedViews()),a.once("render",function(){this._triggerMethodMany(n,this,"before:attach")},this)),this.renderChildView(a,this._emptyViewIndex),s&&this._triggerAttach&&(n=[a].concat(a._getNestedViews()),this._triggerMethodMany(n,this,"attach")),this._isShown&&o.triggerMethodOn(a,"show",a)},getChildView:function(e){var t=this.getOption("childView");if(!t)throw new o.Error({name:"NoChildViewError",message:'A "childView" must be specified'});return t},addChild:function(e,t,i){var n=this.getOption("childViewOptions");n=o._getValue(n,this,[e,i]);var s=this.buildChildView(e,t,n);return this._updateIndices(s,!0,i),this.triggerMethod("before:add:child",s),this._addChildView(s,i),this.triggerMethod("add:child",s),s._parent=this,s},_updateIndices:function(e,t,i){this.getOption("sort")&&(t&&(e._index=i),this.children.each(function(i){i._index>=e._index&&(i._index+=t?1:-1)}))},_addChildView:function(e,t){var i,n=this._isShown&&!this.isBuffering&&o.isNodeAttached(this.el);this.proxyChildEvents(e),this._isShown&&!this.isBuffering&&o.triggerMethodOn(e,"before:show",e),this.children.add(e),n&&this._triggerBeforeAttach&&(i=[e].concat(e._getNestedViews()),e.once("render",function(){this._triggerMethodMany(i,this,"before:attach")},this)),this.renderChildView(e,t),n&&this._triggerAttach&&(i=[e].concat(e._getNestedViews()),this._triggerMethodMany(i,this,"attach")),this._isShown&&!this.isBuffering&&o.triggerMethodOn(e,"show",e)},renderChildView:function(e,t){return e.render(),this.attachHtml(this,e,t),e},buildChildView:function(e,t,n){var s=i.extend({model:e},n);return new t(s)},removeChildView:function(e){return e&&(this.triggerMethod("before:remove:child",e),e.destroy?e.destroy():e.remove&&e.remove(),delete e._parent,this.stopListening(e),this.children.remove(e),this.triggerMethod("remove:child",e),this._updateIndices(e,!1)),e},isEmpty:function(){return!this.collection||0===this.collection.length},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},attachBuffer:function(e,t){e.$el.append(t)},_createBuffer:function(){var e=document.createDocumentFragment();return i.each(this._bufferedChildren,function(t){e.appendChild(t.el)}),e},attachHtml:function(e,t,i){e.isBuffering?e._bufferedChildren.splice(i,0,t):e._insertBefore(t,i)||e._insertAfter(t)},_insertBefore:function(e,t){var i,n=this.getOption("sort")&&t<this.children.length-1;return n&&(i=this.children.find(function(e){return e._index===t+1})),i?(i.$el.before(e.el),!0):!1},_insertAfter:function(e){this.$el.append(e.el)},_initChildViewStorage:function(){this.children=new t.ChildViewContainer},destroy:function(){return this.isDestroyed?this:(this.triggerMethod("before:destroy:collection"),this.destroyChildren({checkEmpty:!1}),this.triggerMethod("destroy:collection"),
o.View.prototype.destroy.apply(this,arguments))},destroyChildren:function(e){var t=e||{},n=!0,s=this.children.map(i.identity);return i.isUndefined(t.checkEmpty)||(n=t.checkEmpty),this.children.each(this.removeChildView,this),n&&this.checkEmpty(),s},_shouldAddChild:function(e,t){var n=this.getOption("filter");return!i.isFunction(n)||n.call(this,e,t,this.collection)},proxyChildEvents:function(e){var t=this.getOption("childViewEventPrefix");this.listenTo(e,"all",function(){var n=i.toArray(arguments),s=n[0],o=this.normalizeMethods(i.result(this,"childEvents"));n[0]=t+":"+s,n.splice(1,0,e),"undefined"!=typeof o&&i.isFunction(o[s])&&o[s].apply(this,n.slice(1)),this.triggerMethod.apply(this,n)})},_getImmediateChildren:function(){return i.values(this.children._views)},getViewComparator:function(){return this.getOption("viewComparator")}}),o.CompositeView=o.CollectionView.extend({constructor:function(){o.CollectionView.apply(this,arguments)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this._renderChildren),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},getChildView:function(e){var t=this.getOption("childView")||this.constructor;return t},serializeData:function(){var e={};return this.model&&(e=i.partial(this.serializeModel,this.model).apply(this,arguments)),e},render:function(){return this._ensureViewIsIntact(),this._isRendering=!0,this.resetChildViewContainer(),this.triggerMethod("before:render",this),this._renderTemplate(),this._renderChildren(),this._isRendering=!1,this.isRendered=!0,this.triggerMethod("render",this),this},_renderChildren:function(){(this.isRendered||this._isRendering)&&o.CollectionView.prototype._renderChildren.call(this)},_renderTemplate:function(){var e={};e=this.serializeData(),e=this.mixinTemplateHelpers(e),this.triggerMethod("before:render:template");var t=this.getTemplate(),i=o.Renderer.render(t,e,this);this.attachElContent(i),this.bindUIElements(),this.triggerMethod("render:template")},attachElContent:function(e){return this.$el.html(e),this},attachBuffer:function(e,t){var i=this.getChildViewContainer(e);i.append(t)},_insertAfter:function(e){var t=this.getChildViewContainer(this,e);t.append(e.el)},_appendReorderedChildren:function(e){var t=this.getChildViewContainer(this);t.append(e)},getChildViewContainer:function(e,t){if(e.$childViewContainer)return e.$childViewContainer;var i,n=o.getOption(e,"childViewContainer");if(n){var s=o._getValue(n,e);if(i="@"===s.charAt(0)&&e.ui?e.ui[s.substr(4)]:e.$(s),i.length<=0)throw new o.Error({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+e.childViewContainer})}else i=e.$el;return e.$childViewContainer=i,i},resetChildViewContainer:function(){this.$childViewContainer&&(this.$childViewContainer=void 0)}}),o.LayoutView=o.ItemView.extend({regionClass:o.Region,options:{destroyImmediate:!1},childViewEventPrefix:"childview",constructor:function(e){e=e||{},this._firstRender=!0,this._initializeRegions(e),o.ItemView.call(this,e)},render:function(){return this._ensureViewIsIntact(),this._firstRender?this._firstRender=!1:this._reInitializeRegions(),o.ItemView.prototype.render.apply(this,arguments)},destroy:function(){return this.isDestroyed?this:(this.getOption("destroyImmediate")===!0&&this.$el.remove(),this.regionManager.destroy(),o.ItemView.prototype.destroy.apply(this,arguments))},showChildView:function(e,t){return this.getRegion(e).show(t)},getChildView:function(e){return this.getRegion(e).currentView},addRegion:function(e,t){var i={};return i[e]=t,this._buildRegions(i)[e]},addRegions:function(e){return this.regions=i.extend({},this.regions,e),this._buildRegions(e)},removeRegion:function(e){return delete this.regions[e],this.regionManager.removeRegion(e)},getRegion:function(e){return this.regionManager.get(e)},getRegions:function(){return this.regionManager.getRegions()},_buildRegions:function(e){var t={regionClass:this.getOption("regionClass"),parentEl:i.partial(i.result,this,"el")};return this.regionManager.addRegions(e,t)},_initializeRegions:function(e){var t;this._initRegionManager(),t=o._getValue(this.regions,this,[e])||{};var n=this.getOption.call(e,"regions");n=o._getValue(n,this,[e]),i.extend(t,n),t=this.normalizeUIValues(t,["selector","el"]),this.addRegions(t)},_reInitializeRegions:function(){this.regionManager.invoke("reset")},getRegionManager:function(){return new o.RegionManager},_initRegionManager:function(){this.regionManager=this.getRegionManager(),this.regionManager._parent=this,this.listenTo(this.regionManager,"before:add:region",function(e){this.triggerMethod("before:add:region",e)}),this.listenTo(this.regionManager,"add:region",function(e,t){this[e]=t,this.triggerMethod("add:region",e,t)}),this.listenTo(this.regionManager,"before:remove:region",function(e){this.triggerMethod("before:remove:region",e)}),this.listenTo(this.regionManager,"remove:region",function(e,t){delete this[e],this.triggerMethod("remove:region",e,t)})},_getImmediateChildren:function(){return i.chain(this.regionManager.getRegions()).pluck("currentView").compact().value()}}),o.Behavior=o.Object.extend({constructor:function(e,t){this.view=t,this.defaults=i.result(this,"defaults")||{},this.options=i.extend({},this.defaults,e),this.ui=i.extend({},i.result(t,"ui"),i.result(this,"ui")),o.Object.apply(this,arguments)},$:function(){return this.view.$.apply(this.view,arguments)},destroy:function(){return this.stopListening(),this},proxyViewProperties:function(e){this.$el=e.$el,this.el=e.el}}),o.Behaviors=function(e,t){function i(e,n){return t.isObject(e.behaviors)?(n=i.parseBehaviors(e,n||t.result(e,"behaviors")),i.wrap(e,n,t.keys(r)),n):{}}function n(e,t){this._view=e,this._behaviors=t,this._triggers={}}function s(e){return e._uiBindings||e.ui}var o=/^(\S+)\s*(.*)$/,r={behaviorTriggers:function(e,t){var i=new n(this,t);return i.buildBehaviorTriggers()},behaviorEvents:function(i,n){var r={};return t.each(n,function(i,n){var a={},l=t.clone(t.result(i,"events"))||{};l=e.normalizeUIKeys(l,s(i));var u=0;t.each(l,function(e,s){var r=s.match(o),l=r[1]+"."+[this.cid,n,u++," "].join(""),c=r[2],d=l+c,h=t.isFunction(e)?e:i[e];a[d]=t.bind(h,i)},this),r=t.extend(r,a)},this),r}};return t.extend(i,{behaviorsLookup:function(){throw new e.Error({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.html#behaviorslookup"})},getBehaviorClass:function(t,n){return t.behaviorClass?t.behaviorClass:e._getValue(i.behaviorsLookup,this,[t,n])[n]},parseBehaviors:function(e,n){return t.chain(n).map(function(n,s){var o=i.getBehaviorClass(n,s),r=new o(n,e),a=i.parseBehaviors(e,t.result(r,"behaviors"));return[r].concat(a)}).flatten().value()},wrap:function(e,i,n){t.each(n,function(n){e[n]=t.partial(r[n],e[n],i)})}}),t.extend(n.prototype,{buildBehaviorTriggers:function(){return t.each(this._behaviors,this._buildTriggerHandlersForBehavior,this),this._triggers},_buildTriggerHandlersForBehavior:function(i,n){var o=t.clone(t.result(i,"triggers"))||{};o=e.normalizeUIKeys(o,s(i)),t.each(o,t.bind(this._setHandlerForBehavior,this,i,n))},_setHandlerForBehavior:function(e,t,i,n){var s=n.replace(/^\S+/,function(e){return e+".behaviortriggers"+t});this._triggers[s]=this._view._buildViewTrigger(i)}}),i}(o,i),o.AppRouter=t.Router.extend({constructor:function(e){this.options=e||{},t.Router.apply(this,arguments);var i=this.getOption("appRoutes"),n=this._getController();this.processAppRoutes(n,i),this.on("route",this._processOnRoute,this)},appRoute:function(e,t){var i=this._getController();this._addAppRoute(i,e,t)},_processOnRoute:function(e,t){if(i.isFunction(this.onRoute)){var n=i.invert(this.getOption("appRoutes"))[e];this.onRoute(e,n,t)}},processAppRoutes:function(e,t){if(t){var n=i.keys(t).reverse();i.each(n,function(i){this._addAppRoute(e,i,t[i])},this)}},_getController:function(){return this.getOption("controller")},_addAppRoute:function(e,t,n){var s=e[n];if(!s)throw new o.Error('Method "'+n+'" was not found on the controller');this.route(t,n,i.bind(s,e))},mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,triggerMethod:o.triggerMethod,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.Application=o.Object.extend({constructor:function(e){this._initializeRegions(e),this._initCallbacks=new o.Callbacks,this.submodules={},i.extend(this,e),this._initChannel(),o.Object.call(this,e)},execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(e){this._initCallbacks.add(e)},start:function(e){this.triggerMethod("before:start",e),this._initCallbacks.run(e,this),this.triggerMethod("start",e)},addRegions:function(e){return this._regionManager.addRegions(e)},emptyRegions:function(){return this._regionManager.emptyRegions()},removeRegion:function(e){return this._regionManager.removeRegion(e)},getRegion:function(e){return this._regionManager.get(e)},getRegions:function(){return this._regionManager.getRegions()},module:function(e,t){var n=o.Module.getClass(t),s=i.toArray(arguments);return s.unshift(this),n.create.apply(n,s)},getRegionManager:function(){return new o.RegionManager},_initializeRegions:function(e){var t=i.isFunction(this.regions)?this.regions(e):this.regions||{};this._initRegionManager();var n=o.getOption(e,"regions");return i.isFunction(n)&&(n=n.call(this,e)),i.extend(t,n),this.addRegions(t),this},_initRegionManager:function(){this._regionManager=this.getRegionManager(),this._regionManager._parent=this,this.listenTo(this._regionManager,"before:add:region",function(){o._triggerMethod(this,"before:add:region",arguments)}),this.listenTo(this._regionManager,"add:region",function(e,t){this[e]=t,o._triggerMethod(this,"add:region",arguments)}),this.listenTo(this._regionManager,"before:remove:region",function(){o._triggerMethod(this,"before:remove:region",arguments)}),this.listenTo(this._regionManager,"remove:region",function(e){delete this[e],o._triggerMethod(this,"remove:region",arguments)})},_initChannel:function(){this.channelName=i.result(this,"channelName")||"global",this.channel=i.result(this,"channel")||t.Wreqr.radio.channel(this.channelName),this.vent=i.result(this,"vent")||this.channel.vent,this.commands=i.result(this,"commands")||this.channel.commands,this.reqres=i.result(this,"reqres")||this.channel.reqres}}),o.Module=function(e,t,n){this.moduleName=e,this.options=i.extend({},this.options,n),this.initialize=n.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=t,i.isFunction(this.initialize)&&this.initialize(e,t,this.options)},o.Module.extend=o.extend,i.extend(o.Module.prototype,t.Events,{startWithParent:!0,initialize:function(){},addInitializer:function(e){this._initializerCallbacks.add(e)},addFinalizer:function(e){this._finalizerCallbacks.add(e)},start:function(e){this._isInitialized||(i.each(this.submodules,function(t){t.startWithParent&&t.start(e)}),this.triggerMethod("before:start",e),this._initializerCallbacks.run(e,this),this._isInitialized=!0,this.triggerMethod("start",e))},stop:function(){this._isInitialized&&(this._isInitialized=!1,this.triggerMethod("before:stop"),i.invoke(this.submodules,"stop"),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),this.triggerMethod("stop"))},addDefinition:function(e,t){this._runModuleDefinition(e,t)},_runModuleDefinition:function(e,n){if(e){var s=i.flatten([this,this.app,t,o,t.$,i,n]);e.apply(this,s)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new o.Callbacks,this._finalizerCallbacks=new o.Callbacks},triggerMethod:o.triggerMethod}),i.extend(o.Module,{create:function(e,t,n){var s=e,o=i.drop(arguments,3);t=t.split(".");var r=t.length,a=[];return a[r-1]=n,i.each(t,function(t,i){var r=s;s=this._getModule(r,t,e,n),this._addModuleDefinition(r,s,a[i],o)},this),s},_getModule:function(e,t,n,s,o){var r=i.extend({},s),a=this.getClass(s),l=e[t];return l||(l=new a(t,n,r),e[t]=l,e.submodules[t]=l),l},getClass:function(e){var t=o.Module;return e?e.prototype instanceof t?e:e.moduleClass||t:t},_addModuleDefinition:function(e,t,i,n){var s=this._getDefine(i),o=this._getStartWithParent(i,t);s&&t.addDefinition(s,n),this._addStartWithParent(e,t,o)},_getStartWithParent:function(e,t){var n;return i.isFunction(e)&&e.prototype instanceof o.Module?(n=t.constructor.prototype.startWithParent,i.isUndefined(n)?!0:n):i.isObject(e)?(n=e.startWithParent,i.isUndefined(n)?!0:n):!0},_getDefine:function(e){return!i.isFunction(e)||e.prototype instanceof o.Module?i.isObject(e)?e.define:null:e},_addStartWithParent:function(e,t,i){t.startWithParent=t.startWithParent&&i,t.startWithParent&&!t.startWithParentIsConfigured&&(t.startWithParentIsConfigured=!0,e.addInitializer(function(e){t.startWithParent&&t.start(e)}))}}),o}),define("functions",[],function(){window.object_dot=function(e,t){t=t||"";var i={};return _.each(e,function(e,n){_.isObject(e)&&!_.isRegExp(e)?i=_.extend(i,object_dot(e,t+n+".")):i[t+n]=e}),i},window.object_undot=function(e){var t={};return _.each(e,function(e,i){object_set(t,i,e)}),t},window.object_get=function(e,t,i){if(i=i||null,!t)return e;if(_.has(e,t))return e[t];for(var n=t.split("."),s=0,o=n.length;o>s;s++){var r=n[s];if(!_.isObject(e)||!_.has(e,r))return i;e=e[r]}return e},window.object_set=function(e,t,i){if(!_.isArray(t))var t=t.split(".");for(var n=0;n<t.length-1;n++)e=e[t[n]]=e[t[n]]||{};return e=e[t[n]]=i}}),define("config",["functions"],function(){var e=function(){var e=document.getElementById("preload");if(!e)return{};var t=e.innerHTML;return t?JSON.parse(t):{}}.call(this),t=e;return{get:function(e){return object_get(t,e)},set:function(e,i){return object_set(t,e,i)}}}),function(e,t){"function"==typeof define&&define.amd?define("pusher",[],function(){return e.Pusher=t()}):"object"==typeof exports?module.exports=t():e.Pusher=t()}(this,function(){return function(){function e(t,i){(null===t||void 0===t)&&e.warn("Warning","You must pass your app key when you instantiate Pusher."),i=i||{};var n=this;this.key=t,this.config=e.Util.extend(e.getGlobalConfig(),i.cluster?e.getClusterConfig(i.cluster):{},i),this.channels=new e.Channels,this.global_emitter=new e.EventsDispatcher,this.sessionID=Math.floor(1e9*Math.random()),this.timeline=new e.Timeline(this.key,this.sessionID,{cluster:this.config.cluster,features:e.Util.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:e.Timeline.INFO,version:e.VERSION}),this.config.disableStats||(this.timelineSender=new e.TimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline/v2/jsonp"})),this.connection=new e.ConnectionManager(this.key,e.Util.extend({getStrategy:function(t){return t=e.Util.extend({},n.config,t),e.StrategyBuilder.build(e.getDefaultStrategy(t),t)},timeline:this.timeline,activityTimeout:this.config.activity_timeout,pongTimeout:this.config.pong_timeout,unavailableTimeout:this.config.unavailable_timeout},this.config,{encrypted:this.isEncrypted()})),this.connection.bind("connected",function(){n.subscribeAll(),n.timelineSender&&n.timelineSender.send(n.connection.isEncrypted())}),this.connection.bind("message",function(e){var t=0===e.event.indexOf("pusher_internal:");if(e.channel){var i=n.channel(e.channel);i&&i.handleEvent(e.event,e.data)}t||n.global_emitter.emit(e.event,e.data)}),this.connection.bind("disconnected",function(){n.channels.disconnect()}),this.connection.bind("error",function(t){e.warn("Error",t)}),e.instances.push(this),this.timeline.info({instances:e.instances.length}),e.isReady&&n.connect()}var t=e.prototype;e.instances=[],e.isReady=!1,e.debug=function(){e.log&&e.log(e.Util.stringify.apply(this,arguments))},e.warn=function(){var t=e.Util.stringify.apply(this,arguments);window.console&&(window.console.warn?window.console.warn(t):window.console.log&&window.console.log(t)),e.log&&e.log(t)},e.ready=function(){e.isReady=!0;for(var t=0,i=e.instances.length;i>t;t++)e.instances[t].connect()},t.channel=function(e){return this.channels.find(e)},t.allChannels=function(){return this.channels.all()},t.connect=function(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var t=this.connection.isEncrypted(),i=this.timelineSender;this.timelineSenderTimer=new e.PeriodicTimer(6e4,function(){i.send(t)})}},t.disconnect=function(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)},t.bind=function(e,t){return this.global_emitter.bind(e,t),this},t.bind_all=function(e){return this.global_emitter.bind_all(e),this},t.subscribeAll=function(){for(var e in this.channels.channels)this.channels.channels.hasOwnProperty(e)&&this.subscribe(e)},t.subscribe=function(e){return e=this.channels.add(e,this),"connected"===this.connection.state&&e.subscribe(),e},t.unsubscribe=function(e){(e=this.channels.remove(e))&&"connected"===this.connection.state&&e.unsubscribe()},t.send_event=function(e,t,i){return this.connection.send_event(e,t,i)},t.isEncrypted=function(){return"https:"===e.Util.getDocument().location.protocol?!0:Boolean(this.config.encrypted)},e.HTTP={},this.Pusher=e}.call(this),function(){function e(e){window.clearTimeout(e)}function t(e){window.clearInterval(e)}function i(e,t,i,n){var s=this;this.clear=t,this.timer=e(function(){null!==s.timer&&(s.timer=n(s.timer))},i)}var n=i.prototype;n.isRunning=function(){return null!==this.timer},n.ensureAborted=function(){this.timer&&(this.clear(this.timer),this.timer=null)},Pusher.Timer=function(t,n){return new i(setTimeout,e,t,function(e){return n(),null})},Pusher.PeriodicTimer=function(e,n){return new i(setInterval,t,e,function(e){return n(),e})}}.call(this),function(){Pusher.Util={now:function(){return Date.now?Date.now():(new Date).valueOf()},defer:function(e){return new Pusher.Timer(0,e)},extend:function(e){for(var t=1;t<arguments.length;t++){var i,n=arguments[t];for(i in n)e[i]=n[i]&&n[i].constructor&&n[i].constructor===Object?Pusher.Util.extend(e[i]||{},n[i]):n[i]}return e},stringify:function(){for(var e=["Pusher"],t=0;t<arguments.length;t++)"string"==typeof arguments[t]?e.push(arguments[t]):void 0===window.JSON?e.push(arguments[t].toString()):e.push(JSON.stringify(arguments[t]));return e.join(" : ")},arrayIndexOf:function(e,t){var i=Array.prototype.indexOf;if(null===e)return-1;if(i&&e.indexOf===i)return e.indexOf(t);for(var i=0,n=e.length;n>i;i++)if(e[i]===t)return i;return-1},objectApply:function(e,t){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t(e[i],i,e)},keys:function(e){var t=[];return Pusher.Util.objectApply(e,function(e,i){t.push(i)}),t},values:function(e){var t=[];return Pusher.Util.objectApply(e,function(e){t.push(e)}),t},apply:function(e,t,i){for(var n=0;n<e.length;n++)t.call(i||window,e[n],n,e)},map:function(e,t){for(var i=[],n=0;n<e.length;n++)i.push(t(e[n],n,e,i));return i},mapObject:function(e,t){var i={};return Pusher.Util.objectApply(e,function(e,n){i[n]=t(e)}),i},filter:function(e,t){t=t||function(e){return!!e};for(var i=[],n=0;n<e.length;n++)t(e[n],n,e,i)&&i.push(e[n]);return i},filterObject:function(e,t){var i={};return Pusher.Util.objectApply(e,function(n,s){(t&&t(n,s,e,i)||Boolean(n))&&(i[s]=n)}),i},flatten:function(e){var t=[];return Pusher.Util.objectApply(e,function(e,i){t.push([i,e])}),t},any:function(e,t){for(var i=0;i<e.length;i++)if(t(e[i],i,e))return!0;return!1},all:function(e,t){for(var i=0;i<e.length;i++)if(!t(e[i],i,e))return!1;return!0},method:function(e){var t=Array.prototype.slice.call(arguments,1);return function(i){return i[e].apply(i,t.concat(arguments))}},getWindow:function(){return window},getDocument:function(){return document},getLocalStorage:function(){try{return window.localStorage}catch(e){}},getClientFeatures:function(){return Pusher.Util.keys(Pusher.Util.filterObject({ws:Pusher.WSTransport},function(e){return e.isSupported({})}))},addWindowListener:function(e,t){var i=Pusher.Util.getWindow();void 0!==i.addEventListener?i.addEventListener(e,t,!1):i.attachEvent("on"+e,t)},removeWindowListener:function(e,t){var i=Pusher.Util.getWindow();void 0!==i.addEventListener?i.removeEventListener(e,t,!1):i.detachEvent("on"+e,t)},isXHRSupported:function(){var e=window.XMLHttpRequest;return Boolean(e)&&void 0!==(new e).withCredentials},isXDRSupported:function(e){e=e?"https:":"http:";var t=Pusher.Util.getDocument().location.protocol;return Boolean(window.XDomainRequest)&&t===e}}}.call(this),function(){Pusher.VERSION="3.0.0",Pusher.PROTOCOL=7,Pusher.host="ws.pusherapp.com",Pusher.ws_port=80,Pusher.wss_port=443,Pusher.sockjs_host="sockjs.pusher.com",Pusher.sockjs_http_port=80,Pusher.sockjs_https_port=443,Pusher.sockjs_path="/pusher",Pusher.stats_host="stats.pusher.com",Pusher.channel_auth_endpoint="/pusher/auth",Pusher.channel_auth_transport="ajax",Pusher.activity_timeout=12e4,Pusher.pong_timeout=3e4,Pusher.unavailable_timeout=1e4,Pusher.cdn_http="http://js.pusher.com/",Pusher.cdn_https="https://js.pusher.com/",Pusher.dependency_suffix=".min",Pusher.getDefaultStrategy=function(e){return[[":def","ws_options",{hostUnencrypted:e.wsHost+":"+e.wsPort,hostEncrypted:e.wsHost+":"+e.wssPort}],[":def","wss_options",[":extend",":ws_options",{encrypted:!0}]],[":def","sockjs_options",{hostUnencrypted:e.httpHost+":"+e.httpPort,hostEncrypted:e.httpHost+":"+e.httpsPort,httpPath:e.httpPath}],[":def","timeouts",{loop:!0,timeout:15e3,timeoutLimit:6e4}],[":def","ws_manager",[":transport_manager",{lives:2,minPingDelay:1e4,maxPingDelay:e.activity_timeout}]],[":def","streaming_manager",[":transport_manager",{lives:2,minPingDelay:1e4,maxPingDelay:e.activity_timeout}]],[":def_transport","ws","ws",3,":ws_options",":ws_manager"],[":def_transport","wss","ws",3,":wss_options",":ws_manager"],[":def_transport","sockjs","sockjs",1,":sockjs_options"],[":def_transport","xhr_streaming","xhr_streaming",1,":sockjs_options",":streaming_manager"],[":def_transport","xdr_streaming","xdr_streaming",1,":sockjs_options",":streaming_manager"],[":def_transport","xhr_polling","xhr_polling",1,":sockjs_options"],[":def_transport","xdr_polling","xdr_polling",1,":sockjs_options"],[":def","ws_loop",[":sequential",":timeouts",":ws"]],[":def","wss_loop",[":sequential",":timeouts",":wss"]],[":def","sockjs_loop",[":sequential",":timeouts",":sockjs"]],[":def","streaming_loop",[":sequential",":timeouts",[":if",[":is_supported",":xhr_streaming"],":xhr_streaming",":xdr_streaming"]]],[":def","polling_loop",[":sequential",":timeouts",[":if",[":is_supported",":xhr_polling"],":xhr_polling",":xdr_polling"]]],[":def","http_loop",[":if",[":is_supported",":streaming_loop"],[":best_connected_ever",":streaming_loop",[":delayed",4e3,[":polling_loop"]]],[":polling_loop"]]],[":def","http_fallback_loop",[":if",[":is_supported",":http_loop"],[":http_loop"],[":sockjs_loop"]]],[":def","strategy",[":cached",18e5,[":first_connected",[":if",[":is_supported",":ws"],e.encrypted?[":best_connected_ever",":ws_loop",[":delayed",2e3,[":http_fallback_loop"]]]:[":best_connected_ever",":ws_loop",[":delayed",2e3,[":wss_loop"]],[":delayed",5e3,[":http_fallback_loop"]]],":http_fallback_loop"]]]]]}}.call(this),function(){Pusher.getGlobalConfig=function(){return{wsHost:Pusher.host,wsPort:Pusher.ws_port,wssPort:Pusher.wss_port,httpHost:Pusher.sockjs_host,httpPort:Pusher.sockjs_http_port,httpsPort:Pusher.sockjs_https_port,httpPath:Pusher.sockjs_path,statsHost:Pusher.stats_host,authEndpoint:Pusher.channel_auth_endpoint,authTransport:Pusher.channel_auth_transport,activity_timeout:Pusher.activity_timeout,pong_timeout:Pusher.pong_timeout,unavailable_timeout:Pusher.unavailable_timeout}},Pusher.getClusterConfig=function(e){return{wsHost:"ws-"+e+".pusher.com",httpHost:"sockjs-"+e+".pusher.com"}}}.call(this),function(){function e(e){var t=function(t){Error.call(this,t),this.name=e};return Pusher.Util.extend(t.prototype,Error.prototype),t}Pusher.Errors={BadEventName:e("BadEventName"),RequestTimedOut:e("RequestTimedOut"),TransportPriorityTooLow:e("TransportPriorityTooLow"),TransportClosed:e("TransportClosed"),UnsupportedTransport:e("UnsupportedTransport"),UnsupportedStrategy:e("UnsupportedStrategy")}}.call(this),function(){function e(e){this.callbacks=new t,this.global_callbacks=[],this.failThrough=e}function t(){this._callbacks={}}var i=e.prototype;i.bind=function(e,t,i){return this.callbacks.add(e,t,i),this},i.bind_all=function(e){return this.global_callbacks.push(e),this},i.unbind=function(e,t,i){return this.callbacks.remove(e,t,i),this},i.unbind_all=function(e,t){return this.callbacks.remove(e,t),this},i.emit=function(e,t){var i;for(i=0;i<this.global_callbacks.length;i++)this.global_callbacks[i](e,t);var n=this.callbacks.get(e);if(n&&0<n.length)for(i=0;i<n.length;i++)n[i].fn.call(n[i].context||window,t);else this.failThrough&&this.failThrough(e,t);return this},t.prototype.get=function(e){return this._callbacks["_"+e]},t.prototype.add=function(e,t,i){e="_"+e,this._callbacks[e]=this._callbacks[e]||[],this._callbacks[e].push({fn:t,context:i})},t.prototype.remove=function(e,t,i){e||t||i?(e=e?["_"+e]:Pusher.Util.keys(this._callbacks),t||i?Pusher.Util.apply(e,function(e){this._callbacks[e]=Pusher.Util.filter(this._callbacks[e]||[],function(e){return t&&t!==e.fn||i&&i!==e.context}),0===this._callbacks[e].length&&delete this._callbacks[e]},this):Pusher.Util.apply(e,function(e){delete this._callbacks[e]},this)):this._callbacks={}},Pusher.EventsDispatcher=e}.call(this),function(){function e(e,t){this.lastId=0,this.prefix=e,this.name=t}var t=e.prototype;t.create=function(e){this.lastId++;var t=this.lastId,i=this.prefix+t,n=this.name+"["+t+"]",s=!1,o=function(){s||(e.apply(null,arguments),s=!0)};return this[t]=o,{number:t,id:i,name:n,callback:o}},t.remove=function(e){delete this[e.number]},Pusher.ScriptReceiverFactory=e,Pusher.ScriptReceivers=new e("_pusher_script_","Pusher.ScriptReceivers")}.call(this),function(){function e(e){this.src=e}var t=e.prototype;t.send=function(e){var t=this,i="Error loading "+t.src;t.script=document.createElement("script"),t.script.id=e.id,t.script.src=t.src,t.script.type="text/javascript",t.script.charset="UTF-8",t.script.addEventListener?(t.script.onerror=function(){e.callback(i)},t.script.onload=function(){e.callback(null)}):t.script.onreadystatechange=function(){("loaded"===t.script.readyState||"complete"===t.script.readyState)&&e.callback(null)},void 0===t.script.async&&document.attachEvent&&/opera/i.test(navigator.userAgent)?(t.errorScript=document.createElement("script"),t.errorScript.id=e.id+"_error",t.errorScript.text=e.name+"('"+i+"');",t.script.async=t.errorScript.async=!1):t.script.async=!0;var n=document.getElementsByTagName("head")[0];n.insertBefore(t.script,n.firstChild),t.errorScript&&n.insertBefore(t.errorScript,t.script.nextSibling)},t.cleanup=function(){this.script&&(this.script.onload=this.script.onerror=null,this.script.onreadystatechange=null),this.script&&this.script.parentNode&&this.script.parentNode.removeChild(this.script),this.errorScript&&this.errorScript.parentNode&&this.errorScript.parentNode.removeChild(this.errorScript),this.errorScript=this.script=null},Pusher.ScriptRequest=e}.call(this),function(){function e(e){this.options=e,this.receivers=e.receivers||Pusher.ScriptReceivers,this.loading={}}var t=e.prototype;t.load=function(e,t,i){var n=this;if(n.loading[e]&&0<n.loading[e].length)n.loading[e].push(i);else{n.loading[e]=[i];var s=new Pusher.ScriptRequest(n.getPath(e,t)),o=n.receivers.create(function(t){if(n.receivers.remove(o),n.loading[e]){var i=n.loading[e];delete n.loading[e];for(var r=function(e){e||s.cleanup()},a=0;a<i.length;a++)i[a](t,r)}});s.send(o)}},t.getRoot=function(e){var t=Pusher.Util.getDocument().location.protocol;return(e&&e.encrypted||"https:"===t?this.options.cdn_https:this.options.cdn_http).replace(/\/*$/,"")+"/"+this.options.version},t.getPath=function(e,t){return this.getRoot(t)+"/"+e+this.options.suffix+".js"},Pusher.DependencyLoader=e}.call(this),function(){function e(){Pusher.ready()}function t(e){document.body?e():setTimeout(function(){t(e)},0)}function i(){t(e)}Pusher.DependenciesReceivers=new Pusher.ScriptReceiverFactory("_pusher_dependencies","Pusher.DependenciesReceivers"),Pusher.Dependencies=new Pusher.DependencyLoader({cdn_http:Pusher.cdn_http,cdn_https:Pusher.cdn_https,version:Pusher.VERSION,suffix:Pusher.dependency_suffix,receivers:Pusher.DependenciesReceivers}),window.JSON?i():Pusher.Dependencies.load("json2",{},i)}(),function(){for(var e=String.fromCharCode,t=0;64>t;t++)"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t);var i=function(t){var i=t.charCodeAt(0);return 128>i?t:2048>i?e(192|i>>>6)+e(128|63&i):e(224|i>>>12&15)+e(128|i>>>6&63)+e(128|63&i)},n=function(e){var t=[0,2,1][e.length%3];return e=e.charCodeAt(0)<<16|(1<e.length?e.charCodeAt(1):0)<<8|(2<e.length?e.charCodeAt(2):0),["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>>18),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>>12&63),t>=2?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>>6&63),t>=1?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&e)].join("")},s=window.btoa||function(e){return e.replace(/[\s\S]{1,3}/g,n)};Pusher.Base64={encode:function(e){return s(e.replace(/[^\x00-\x7F]/g,i))}}}.call(this),function(){function e(e,t){this.url=e,this.data=t}function t(e){return Pusher.Util.mapObject(e,function(e){return"object"==typeof e&&(e=JSON.stringify(e)),encodeURIComponent(Pusher.Base64.encode(e.toString()))})}var i=e.prototype;i.send=function(e){if(!this.request){var i=Pusher.Util.filterObject(this.data,function(e){return void 0!==e}),i=Pusher.Util.map(Pusher.Util.flatten(t(i)),Pusher.Util.method("join","=")).join("&");this.request=new Pusher.ScriptRequest(this.url+"/"+e.number+"?"+i),this.request.send(e)}},i.cleanup=function(){this.request&&this.request.cleanup()},Pusher.JSONPRequest=e}.call(this),function(){function e(e,t,i){this.key=e,this.session=t,this.events=[],this.options=i||{},this.uniqueID=this.sent=0}var t=e.prototype;e.ERROR=3,e.INFO=6,e.DEBUG=7,t.log=function(e,t){e<=this.options.level&&(this.events.push(Pusher.Util.extend({},t,{timestamp:Pusher.Util.now()})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())},t.error=function(t){this.log(e.ERROR,t)},t.info=function(t){this.log(e.INFO,t)},t.debug=function(t){this.log(e.DEBUG,t)},t.isEmpty=function(){return 0===this.events.length},t.send=function(e,t){var i=this,n=Pusher.Util.extend({session:i.session,bundle:i.sent+1,key:i.key,lib:"js",version:i.options.version,cluster:i.options.cluster,features:i.options.features,timeline:i.events},i.options.params);return i.events=[],e(n,function(e,n){e||i.sent++,t&&t(e,n)}),!0},t.generateUniqueID=function(){return this.uniqueID++,this.uniqueID},Pusher.Timeline=e}.call(this),function(){function e(e,t){this.timeline=e,this.options=t||{}}e.prototype.send=function(e,t){var i=this;i.timeline.isEmpty()||i.timeline.send(function(t,n){var s=new Pusher.JSONPRequest("http"+(e?"s":"")+"://"+(i.host||i.options.host)+i.options.path,t),o=Pusher.ScriptReceivers.create(function(e,t){Pusher.ScriptReceivers.remove(o),s.cleanup(),t&&t.host&&(i.host=t.host),n&&n(e,t)});s.send(o)},t)},Pusher.TimelineSender=e}.call(this),function(){function e(e){this.strategies=e}function t(e,t,i){var s=Pusher.Util.map(e,function(e,n,s,o){return e.connect(t,i(n,o))});return{abort:function(){Pusher.Util.apply(s,n)},forceMinPriority:function(e){Pusher.Util.apply(s,function(t){t.forceMinPriority(e)})}}}function i(e){return Pusher.Util.all(e,function(e){return Boolean(e.error)})}function n(e){!e.error&&!e.aborted&&(e.abort(),e.aborted=!0)}var s=e.prototype;s.isSupported=function(){return Pusher.Util.any(this.strategies,Pusher.Util.method("isSupported"))},s.connect=function(e,n){return t(this.strategies,e,function(e,t){
return function(s,o){(t[e].error=s)?i(t)&&n(!0):(Pusher.Util.apply(t,function(e){e.forceMinPriority(o.transport.priority)}),n(null,o))}})},Pusher.BestConnectedEverStrategy=e}.call(this),function(){function e(e,t,i){this.strategy=e,this.transports=t,this.ttl=i.ttl||18e5,this.encrypted=i.encrypted,this.timeline=i.timeline}function t(e){return"pusherTransport"+(e?"Encrypted":"Unencrypted")}function i(e){var i=Pusher.Util.getLocalStorage();if(i)try{var s=i[t(e)];if(s)return JSON.parse(s)}catch(o){n(e)}return null}function n(e){var i=Pusher.Util.getLocalStorage();if(i)try{delete i[t(e)]}catch(n){}}var s=e.prototype;s.isSupported=function(){return this.strategy.isSupported()},s.connect=function(e,s){var o=this.encrypted,r=i(o),a=[this.strategy];if(r&&r.timestamp+this.ttl>=Pusher.Util.now()){var l=this.transports[r.transport];l&&(this.timeline.info({cached:!0,transport:r.transport,latency:r.latency}),a.push(new Pusher.SequentialStrategy([l],{timeout:2*r.latency+1e3,failFast:!0})))}var u=Pusher.Util.now(),c=a.pop().connect(e,function d(i,r){if(i)n(o),0<a.length?(u=Pusher.Util.now(),c=a.pop().connect(e,d)):s(i);else{var l=r.transport.name,h=Pusher.Util.now()-u,p=Pusher.Util.getLocalStorage();if(p)try{p[t(o)]=JSON.stringify({timestamp:Pusher.Util.now(),transport:l,latency:h})}catch(f){}s(null,r)}});return{abort:function(){c.abort()},forceMinPriority:function(t){e=t,c&&c.forceMinPriority(t)}}},Pusher.CachedStrategy=e}.call(this),function(){function e(e,t){this.strategy=e,this.options={delay:t.delay}}var t=e.prototype;t.isSupported=function(){return this.strategy.isSupported()},t.connect=function(e,t){var i,n=this.strategy,s=new Pusher.Timer(this.options.delay,function(){i=n.connect(e,t)});return{abort:function(){s.ensureAborted(),i&&i.abort()},forceMinPriority:function(t){e=t,i&&i.forceMinPriority(t)}}},Pusher.DelayedStrategy=e}.call(this),function(){function e(e){this.strategy=e}var t=e.prototype;t.isSupported=function(){return this.strategy.isSupported()},t.connect=function(e,t){var i=this.strategy.connect(e,function(e,n){n&&i.abort(),t(e,n)});return i},Pusher.FirstConnectedStrategy=e}.call(this),function(){function e(e,t,i){this.test=e,this.trueBranch=t,this.falseBranch=i}var t=e.prototype;t.isSupported=function(){return(this.test()?this.trueBranch:this.falseBranch).isSupported()},t.connect=function(e,t){return(this.test()?this.trueBranch:this.falseBranch).connect(e,t)},Pusher.IfStrategy=e}.call(this),function(){function e(e,t){this.strategies=e,this.loop=Boolean(t.loop),this.failFast=Boolean(t.failFast),this.timeout=t.timeout,this.timeoutLimit=t.timeoutLimit}var t=e.prototype;t.isSupported=function(){return Pusher.Util.any(this.strategies,Pusher.Util.method("isSupported"))},t.connect=function(e,t){var i=this,n=this.strategies,s=0,o=this.timeout,r=null,a=function(l,u){u?t(null,u):(s+=1,i.loop&&(s%=n.length),s<n.length?(o&&(o*=2,i.timeoutLimit&&(o=Math.min(o,i.timeoutLimit))),r=i.tryStrategy(n[s],e,{timeout:o,failFast:i.failFast},a)):t(!0))},r=this.tryStrategy(n[s],e,{timeout:o,failFast:this.failFast},a);return{abort:function(){r.abort()},forceMinPriority:function(t){e=t,r&&r.forceMinPriority(t)}}},t.tryStrategy=function(e,t,i,n){var s=null,o=null;return 0<i.timeout&&(s=new Pusher.Timer(i.timeout,function(){o.abort(),n(!0)})),o=e.connect(t,function(e,t){e&&s&&s.isRunning()&&!i.failFast||(s&&s.ensureAborted(),n(e,t))}),{abort:function(){s&&s.ensureAborted(),o.abort()},forceMinPriority:function(e){o.forceMinPriority(e)}}},Pusher.SequentialStrategy=e}.call(this),function(){function e(e,t,i,n){this.name=e,this.priority=t,this.transport=i,this.options=n||{}}function t(e,t){return Pusher.Util.defer(function(){t(e)}),{abort:function(){},forceMinPriority:function(){}}}var i=e.prototype;i.isSupported=function(){return this.transport.isSupported({encrypted:this.options.encrypted})},i.connect=function(e,i){if(!this.isSupported())return t(new Pusher.Errors.UnsupportedStrategy,i);if(this.priority<e)return t(new Pusher.Errors.TransportPriorityTooLow,i);var n=this,s=!1,o=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),r=null,a=function(){o.unbind("initialized",a),o.connect()},l=function(){r=new Pusher.Handshake(o,function(e){s=!0,d(),i(null,e)})},u=function(e){d(),i(e)},c=function(){d(),i(new Pusher.Errors.TransportClosed(o))},d=function(){o.unbind("initialized",a),o.unbind("open",l),o.unbind("error",u),o.unbind("closed",c)};return o.bind("initialized",a),o.bind("open",l),o.bind("error",u),o.bind("closed",c),o.initialize(),{abort:function(){s||(d(),r?r.close():o.close())},forceMinPriority:function(e){s||n.priority<e&&(r?r.close():o.close())}}},Pusher.TransportStrategy=e}.call(this),function(){function e(e,t,i){return e+(t.encrypted?"s":"")+"://"+(t.encrypted?t.hostEncrypted:t.hostUnencrypted)+i}function t(e,t){return"/app/"+e+("?protocol="+Pusher.PROTOCOL+"&client=js&version="+Pusher.VERSION+(t?"&"+t:""))}Pusher.URLSchemes={ws:{getInitial:function(i,n){return e("ws",n,t(i,"flash=false"))}},sockjs:{getInitial:function(t,i){return e("http",i,i.httpPath||"/pusher","")},getPath:function(e,i){return t(e)}},http:{getInitial:function(i,n){var s=(n.httpPath||"/pusher")+t(i);return e("http",n,s)}}}}.call(this),function(){function e(e,t,i,n,s){Pusher.EventsDispatcher.call(this),this.hooks=e,this.name=t,this.priority=i,this.key=n,this.options=s,this.state="new",this.timeline=s.timeline,this.activityTimeout=s.activityTimeout,this.id=this.timeline.generateUniqueID()}var t=e.prototype;Pusher.Util.extend(t,Pusher.EventsDispatcher.prototype),t.handlesActivityChecks=function(){return Boolean(this.hooks.handlesActivityChecks)},t.supportsPing=function(){return Boolean(this.hooks.supportsPing)},t.initialize=function(){var e=this;e.timeline.info(e.buildTimelineMessage({transport:e.name+(e.options.encrypted?"s":"")})),e.hooks.isInitialized()?e.changeState("initialized"):e.hooks.file?(e.changeState("initializing"),Pusher.Dependencies.load(e.hooks.file,{encrypted:e.options.encrypted},function(t,i){e.hooks.isInitialized()?(e.changeState("initialized"),i(!0)):(t&&e.onError(t),e.onClose(),i(!1))})):e.onClose()},t.connect=function(){var e=this;if(e.socket||"initialized"!==e.state)return!1;var t=e.hooks.urls.getInitial(e.key,e.options);try{e.socket=e.hooks.getSocket(t,e.options)}catch(i){return Pusher.Util.defer(function(){e.onError(i),e.changeState("closed")}),!1}return e.bindListeners(),Pusher.debug("Connecting",{transport:e.name,url:t}),e.changeState("connecting"),!0},t.close=function(){return this.socket?(this.socket.close(),!0):!1},t.send=function(e){var t=this;return"open"===t.state?(Pusher.Util.defer(function(){t.socket&&t.socket.send(e)}),!0):!1},t.ping=function(){"open"===this.state&&this.supportsPing()&&this.socket.ping()},t.onOpen=function(){this.hooks.beforeOpen&&this.hooks.beforeOpen(this.socket,this.hooks.urls.getPath(this.key,this.options)),this.changeState("open"),this.socket.onopen=void 0},t.onError=function(e){this.emit("error",{type:"WebSocketError",error:e}),this.timeline.error(this.buildTimelineMessage({error:e.toString()}))},t.onClose=function(e){e?this.changeState("closed",{code:e.code,reason:e.reason,wasClean:e.wasClean}):this.changeState("closed"),this.unbindListeners(),this.socket=void 0},t.onMessage=function(e){this.emit("message",e)},t.onActivity=function(){this.emit("activity")},t.bindListeners=function(){var e=this;e.socket.onopen=function(){e.onOpen()},e.socket.onerror=function(t){e.onError(t)},e.socket.onclose=function(t){e.onClose(t)},e.socket.onmessage=function(t){e.onMessage(t)},e.supportsPing()&&(e.socket.onactivity=function(){e.onActivity()})},t.unbindListeners=function(){this.socket&&(this.socket.onopen=void 0,this.socket.onerror=void 0,this.socket.onclose=void 0,this.socket.onmessage=void 0,this.supportsPing()&&(this.socket.onactivity=void 0))},t.changeState=function(e,t){this.state=e,this.timeline.info(this.buildTimelineMessage({state:e,params:t})),this.emit(e,t)},t.buildTimelineMessage=function(e){return Pusher.Util.extend({cid:this.id},e)},Pusher.TransportConnection=e}.call(this),function(){function e(e){this.hooks=e}var t=e.prototype;t.isSupported=function(e){return this.hooks.isSupported(e)},t.createConnection=function(e,t,i,n){return new Pusher.TransportConnection(this.hooks,e,t,i,n)},Pusher.Transport=e}.call(this),function(){Pusher.WSTransport=new Pusher.Transport({urls:Pusher.URLSchemes.ws,handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return Boolean(window.WebSocket||window.MozWebSocket)},isSupported:function(){return Boolean(window.WebSocket||window.MozWebSocket)},getSocket:function(e){return new(window.WebSocket||window.MozWebSocket)(e)}}),Pusher.SockJSTransport=new Pusher.Transport({file:"sockjs",urls:Pusher.URLSchemes.sockjs,handlesActivityChecks:!0,supportsPing:!1,isSupported:function(){return!0},isInitialized:function(){return void 0!==window.SockJS},getSocket:function(e,t){return new SockJS(e,null,{js_path:Pusher.Dependencies.getPath("sockjs",{encrypted:t.encrypted}),ignore_null_origin:t.ignoreNullOrigin})},beforeOpen:function(e,t){e.send(JSON.stringify({path:t}))}});var e={urls:Pusher.URLSchemes.http,handlesActivityChecks:!1,supportsPing:!0,isInitialized:function(){return Boolean(Pusher.HTTP.Socket)}},t=Pusher.Util.extend({getSocket:function(e){return Pusher.HTTP.getStreamingSocket(e)}},e),e=Pusher.Util.extend({getSocket:function(e){return Pusher.HTTP.getPollingSocket(e)}},e),i={file:"xhr",isSupported:Pusher.Util.isXHRSupported},n={file:"xdr",isSupported:function(e){return Pusher.Util.isXDRSupported(e.encrypted)}};Pusher.XHRStreamingTransport=new Pusher.Transport(Pusher.Util.extend({},t,i)),Pusher.XDRStreamingTransport=new Pusher.Transport(Pusher.Util.extend({},t,n)),Pusher.XHRPollingTransport=new Pusher.Transport(Pusher.Util.extend({},e,i)),Pusher.XDRPollingTransport=new Pusher.Transport(Pusher.Util.extend({},e,n))}.call(this),function(){function e(e,t,i){this.manager=e,this.transport=t,this.minPingDelay=i.minPingDelay,this.maxPingDelay=i.maxPingDelay,this.pingDelay=void 0}var t=e.prototype;t.createConnection=function(e,t,i,n){var s=this;n=Pusher.Util.extend({},n,{activityTimeout:s.pingDelay});var o=s.transport.createConnection(e,t,i,n),r=null,a=function(){o.unbind("open",a),o.bind("closed",l),r=Pusher.Util.now()},l=function(e){o.unbind("closed",l),1002===e.code||1003===e.code?s.manager.reportDeath():!e.wasClean&&r&&(e=Pusher.Util.now()-r,e<2*s.maxPingDelay&&(s.manager.reportDeath(),s.pingDelay=Math.max(e/2,s.minPingDelay)))};return o.bind("open",a),o},t.isSupported=function(e){return this.manager.isAlive()&&this.transport.isSupported(e)},Pusher.AssistantToTheTransportManager=e}.call(this),function(){function e(e){this.options=e||{},this.livesLeft=this.options.lives||1/0}var t=e.prototype;t.getAssistant=function(e){return new Pusher.AssistantToTheTransportManager(this,e,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})},t.isAlive=function(){return 0<this.livesLeft},t.reportDeath=function(){this.livesLeft-=1},Pusher.TransportManager=e}.call(this),function(){function e(e){return function(t){return[e.apply(this,arguments),t]}}function t(e,i){if(0===e.length)return[[],i];var s=n(e[0],i),o=t(e.slice(1),s[1]);return[[s[0]].concat(o[0]),o[1]]}function i(e,i){if("string"==typeof e[0]&&":"===e[0].charAt(0)){var s=i[e[0].slice(1)];if(1<e.length){if("function"!=typeof s)throw"Calling non-function "+e[0];var o=[Pusher.Util.extend({},i)].concat(Pusher.Util.map(e.slice(1),function(e){return n(e,Pusher.Util.extend({},i))[0]}));return s.apply(this,o)}return[s,i]}return t(e,i)}function n(e,t){if("string"==typeof e){var n;if("string"==typeof e&&":"===e.charAt(0)){if(n=t[e.slice(1)],void 0===n)throw"Undefined symbol "+e;n=[n,t]}else n=[e,t];return n}return"object"==typeof e&&e instanceof Array&&0<e.length?i(e,t):[e,t]}var s={ws:Pusher.WSTransport,sockjs:Pusher.SockJSTransport,xhr_streaming:Pusher.XHRStreamingTransport,xdr_streaming:Pusher.XDRStreamingTransport,xhr_polling:Pusher.XHRPollingTransport,xdr_polling:Pusher.XDRPollingTransport},o={isSupported:function(){return!1},connect:function(e,t){var i=Pusher.Util.defer(function(){t(new Pusher.Errors.UnsupportedStrategy)});return{abort:function(){i.ensureAborted()},forceMinPriority:function(){}}}},r={extend:function(e,t,i){return[Pusher.Util.extend({},t,i),e]},def:function(e,t,i){if(void 0!==e[t])throw"Redefining symbol "+t;return e[t]=i,[void 0,e]},def_transport:function(e,t,i,n,r,a){var l=s[i];if(!l)throw new Pusher.Errors.UnsupportedTransport(i);return i=e.enabledTransports&&-1===Pusher.Util.arrayIndexOf(e.enabledTransports,t)||e.disabledTransports&&-1!==Pusher.Util.arrayIndexOf(e.disabledTransports,t)?o:new Pusher.TransportStrategy(t,n,a?a.getAssistant(l):l,Pusher.Util.extend({key:e.key,encrypted:e.encrypted,timeline:e.timeline,ignoreNullOrigin:e.ignoreNullOrigin},r)),n=e.def(e,t,i)[1],n.transports=e.transports||{},n.transports[t]=i,[void 0,n]},transport_manager:e(function(e,t){return new Pusher.TransportManager(t)}),sequential:e(function(e,t){var i=Array.prototype.slice.call(arguments,2);return new Pusher.SequentialStrategy(i,t)}),cached:e(function(e,t,i){return new Pusher.CachedStrategy(i,e.transports,{ttl:t,timeline:e.timeline,encrypted:e.encrypted})}),first_connected:e(function(e,t){return new Pusher.FirstConnectedStrategy(t)}),best_connected_ever:e(function(){var e=Array.prototype.slice.call(arguments,1);return new Pusher.BestConnectedEverStrategy(e)}),delayed:e(function(e,t,i){return new Pusher.DelayedStrategy(i,{delay:t})}),"if":e(function(e,t,i,n){return new Pusher.IfStrategy(t,i,n)}),is_supported:e(function(e,t){return function(){return t.isSupported()}})};Pusher.StrategyBuilder={build:function(e,t){var i=Pusher.Util.extend({},r,t);return n(e,i)[1].strategy}}}.call(this),function(){Pusher.Protocol={decodeMessage:function(e){try{var t=JSON.parse(e.data);if("string"==typeof t.data)try{t.data=JSON.parse(t.data)}catch(i){if(!(i instanceof SyntaxError))throw i}return t}catch(n){throw{type:"MessageParseError",error:n,data:e.data}}},encodeMessage:function(e){return JSON.stringify(e)},processHandshake:function(e){if(e=this.decodeMessage(e),"pusher:connection_established"===e.event){if(!e.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",id:e.data.socket_id,activityTimeout:1e3*e.data.activity_timeout}}if("pusher:error"===e.event)return{action:this.getCloseAction(e.data),error:this.getCloseError(e.data)};throw"Invalid handshake"},getCloseAction:function(e){return 4e3>e.code?1002<=e.code&&1004>=e.code?"backoff":null:4e3===e.code?"ssl_only":4100>e.code?"refused":4200>e.code?"backoff":4300>e.code?"retry":"refused"},getCloseError:function(e){return 1e3!==e.code&&1001!==e.code?{type:"PusherError",data:{code:e.code,message:e.reason||e.message}}:null}}}.call(this),function(){function e(e,t){Pusher.EventsDispatcher.call(this),this.id=e,this.transport=t,this.activityTimeout=t.activityTimeout,this.bindListeners()}var t=e.prototype;Pusher.Util.extend(t,Pusher.EventsDispatcher.prototype),t.handlesActivityChecks=function(){return this.transport.handlesActivityChecks()},t.send=function(e){return this.transport.send(e)},t.send_event=function(e,t,i){return e={event:e,data:t},i&&(e.channel=i),Pusher.debug("Event sent",e),this.send(Pusher.Protocol.encodeMessage(e))},t.ping=function(){this.transport.supportsPing()?this.transport.ping():this.send_event("pusher:ping",{})},t.close=function(){this.transport.close()},t.bindListeners=function(){var e=this,t={message:function(t){var i;try{i=Pusher.Protocol.decodeMessage(t)}catch(n){e.emit("error",{type:"MessageParseError",error:n,data:t.data})}if(void 0!==i){switch(Pusher.debug("Event recd",i),i.event){case"pusher:error":e.emit("error",{type:"PusherError",data:i.data});break;case"pusher:ping":e.emit("ping");break;case"pusher:pong":e.emit("pong")}e.emit("message",i)}},activity:function(){e.emit("activity")},error:function(t){e.emit("error",{type:"WebSocketError",error:t})},closed:function(t){i(),t&&t.code&&e.handleCloseEvent(t),e.transport=null,e.emit("closed")}},i=function(){Pusher.Util.objectApply(t,function(t,i){e.transport.unbind(i,t)})};Pusher.Util.objectApply(t,function(t,i){e.transport.bind(i,t)})},t.handleCloseEvent=function(e){var t=Pusher.Protocol.getCloseAction(e);(e=Pusher.Protocol.getCloseError(e))&&this.emit("error",e),t&&this.emit(t)},Pusher.Connection=e}.call(this),function(){function e(e,t){this.transport=e,this.callback=t,this.bindListeners()}var t=e.prototype;t.close=function(){this.unbindListeners(),this.transport.close()},t.bindListeners=function(){var e=this;e.onMessage=function(t){e.unbindListeners();try{var i=Pusher.Protocol.processHandshake(t);"connected"===i.action?e.finish("connected",{connection:new Pusher.Connection(i.id,e.transport),activityTimeout:i.activityTimeout}):(e.finish(i.action,{error:i.error}),e.transport.close())}catch(n){e.finish("error",{error:n}),e.transport.close()}},e.onClosed=function(t){e.unbindListeners();var i=Pusher.Protocol.getCloseAction(t)||"backoff";t=Pusher.Protocol.getCloseError(t),e.finish(i,{error:t})},e.transport.bind("message",e.onMessage),e.transport.bind("closed",e.onClosed)},t.unbindListeners=function(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)},t.finish=function(e,t){this.callback(Pusher.Util.extend({transport:this.transport,action:e},t))},Pusher.Handshake=e}.call(this),function(){function e(e,t){Pusher.EventsDispatcher.call(this),this.key=e,this.options=t||{},this.state="initialized",this.connection=null,this.encrypted=!!t.encrypted,this.timeline=this.options.timeline,this.connectionCallbacks=this.buildConnectionCallbacks(),this.errorCallbacks=this.buildErrorCallbacks(),this.handshakeCallbacks=this.buildHandshakeCallbacks(this.errorCallbacks);var i=this;Pusher.Network.bind("online",function(){i.timeline.info({netinfo:"online"}),("connecting"===i.state||"unavailable"===i.state)&&i.retryIn(0)}),Pusher.Network.bind("offline",function(){i.timeline.info({netinfo:"offline"}),i.connection&&i.sendActivityCheck()}),this.updateStrategy()}var t=e.prototype;Pusher.Util.extend(t,Pusher.EventsDispatcher.prototype),t.connect=function(){!this.connection&&!this.runner&&(this.strategy.isSupported()?(this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()):this.updateState("failed"))},t.send=function(e){return this.connection?this.connection.send(e):!1},t.send_event=function(e,t,i){return this.connection?this.connection.send_event(e,t,i):!1},t.disconnect=function(){this.disconnectInternally(),this.updateState("disconnected")},t.isEncrypted=function(){return this.encrypted},t.startConnecting=function(){var e=this,t=function(i,n){i?e.runner=e.strategy.connect(0,t):"error"===n.action?(e.emit("error",{type:"HandshakeError",error:n.error}),e.timeline.error({handshakeError:n.error})):(e.abortConnecting(),e.handshakeCallbacks[n.action](n))};e.runner=e.strategy.connect(0,t)},t.abortConnecting=function(){this.runner&&(this.runner.abort(),this.runner=null)},t.disconnectInternally=function(){this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.connection&&this.abandonConnection().close()},t.updateStrategy=function(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,encrypted:this.encrypted})},t.retryIn=function(e){var t=this;t.timeline.info({action:"retry",delay:e}),e>0&&t.emit("connecting_in",Math.round(e/1e3)),t.retryTimer=new Pusher.Timer(e||0,function(){t.disconnectInternally(),t.connect()})},t.clearRetryTimer=function(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)},t.setUnavailableTimer=function(){var e=this;e.unavailableTimer=new Pusher.Timer(e.options.unavailableTimeout,function(){e.updateState("unavailable")})},t.clearUnavailableTimer=function(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()},t.sendActivityCheck=function(){var e=this;e.stopActivityCheck(),e.connection.ping(),e.activityTimer=new Pusher.Timer(e.options.pongTimeout,function(){e.timeline.error({pong_timed_out:e.options.pongTimeout}),e.retryIn(0)})},t.resetActivityCheck=function(){var e=this;e.stopActivityCheck(),e.connection.handlesActivityChecks()||(e.activityTimer=new Pusher.Timer(e.activityTimeout,function(){e.sendActivityCheck()}))},t.stopActivityCheck=function(){this.activityTimer&&this.activityTimer.ensureAborted()},t.buildConnectionCallbacks=function(){var e=this;return{message:function(t){e.resetActivityCheck(),e.emit("message",t)},ping:function(){e.send_event("pusher:pong",{})},activity:function(){e.resetActivityCheck()},error:function(t){e.emit("error",{type:"WebSocketError",error:t})},closed:function(){e.abandonConnection(),e.shouldRetry()&&e.retryIn(1e3)}}},t.buildHandshakeCallbacks=function(e){var t=this;return Pusher.Util.extend({},e,{connected:function(e){t.activityTimeout=Math.min(t.options.activityTimeout,e.activityTimeout,e.connection.activityTimeout||1/0),t.clearUnavailableTimer(),t.setConnection(e.connection),t.socket_id=t.connection.id,t.updateState("connected",{socket_id:t.socket_id})}})},t.buildErrorCallbacks=function(){function e(e){return function(i){i.error&&t.emit("error",{type:"WebSocketError",error:i.error}),e(i)}}var t=this;return{ssl_only:e(function(){t.encrypted=!0,t.updateStrategy(),t.retryIn(0)}),refused:e(function(){t.disconnect()}),backoff:e(function(){t.retryIn(1e3)}),retry:e(function(){t.retryIn(0)})}},t.setConnection=function(e){this.connection=e;for(var t in this.connectionCallbacks)this.connection.bind(t,this.connectionCallbacks[t]);this.resetActivityCheck()},t.abandonConnection=function(){if(this.connection){this.stopActivityCheck();for(var e in this.connectionCallbacks)this.connection.unbind(e,this.connectionCallbacks[e]);return e=this.connection,this.connection=null,e}},t.updateState=function(e,t){var i=this.state;this.state=e,i!==e&&(Pusher.debug("State changed",i+" -> "+e),this.timeline.info({state:e,params:t}),this.emit("state_change",{previous:i,current:e}),this.emit(e,t))},t.shouldRetry=function(){return"connecting"===this.state||"connected"===this.state},Pusher.ConnectionManager=e}.call(this),function(){function e(){Pusher.EventsDispatcher.call(this);var e=this;void 0!==window.addEventListener&&(window.addEventListener("online",function(){e.emit("online")},!1),window.addEventListener("offline",function(){e.emit("offline")},!1))}Pusher.Util.extend(e.prototype,Pusher.EventsDispatcher.prototype),e.prototype.isOnline=function(){return void 0===window.navigator.onLine?!0:window.navigator.onLine},Pusher.NetInfo=e,Pusher.Network=new e}.call(this),function(){function e(){this.reset()}var t=e.prototype;t.get=function(e){return Object.prototype.hasOwnProperty.call(this.members,e)?{id:e,info:this.members[e]}:null},t.each=function(e){var t=this;Pusher.Util.objectApply(t.members,function(i,n){e(t.get(n))})},t.setMyID=function(e){this.myID=e},t.onSubscription=function(e){this.members=e.presence.hash,this.count=e.presence.count,this.me=this.get(this.myID)},t.addMember=function(e){return null===this.get(e.user_id)&&this.count++,this.members[e.user_id]=e.user_info,this.get(e.user_id)},t.removeMember=function(e){var t=this.get(e.user_id);return t&&(delete this.members[e.user_id],this.count--),t},t.reset=function(){this.members={},this.count=0,this.me=this.myID=null},Pusher.Members=e}.call(this),function(){function e(e,t){Pusher.EventsDispatcher.call(this,function(t,i){Pusher.debug("No callbacks on "+e+" for "+t)}),this.name=e,this.pusher=t,this.subscribed=!1}var t=e.prototype;Pusher.Util.extend(t,Pusher.EventsDispatcher.prototype),t.authorize=function(e,t){return t(!1,{})},t.trigger=function(e,t){if(0!==e.indexOf("client-"))throw new Pusher.Errors.BadEventName("Event '"+e+"' does not start with 'client-'");return this.pusher.send_event(e,t,this.name)},t.disconnect=function(){this.subscribed=!1},t.handleEvent=function(e,t){0===e.indexOf("pusher_internal:")?"pusher_internal:subscription_succeeded"===e&&(this.subscribed=!0,this.emit("pusher:subscription_succeeded",t)):this.emit(e,t)},t.subscribe=function(){var e=this;e.authorize(e.pusher.connection.socket_id,function(t,i){t?e.handleEvent("pusher:subscription_error",i):e.pusher.send_event("pusher:subscribe",{auth:i.auth,channel_data:i.channel_data,channel:e.name})})},t.unsubscribe=function(){this.pusher.send_event("pusher:unsubscribe",{channel:this.name})},Pusher.Channel=e}.call(this),function(){function e(e,t){Pusher.Channel.call(this,e,t)}var t=e.prototype;Pusher.Util.extend(t,Pusher.Channel.prototype),t.authorize=function(e,t){return new Pusher.Channel.Authorizer(this,this.pusher.config).authorize(e,t)},Pusher.PrivateChannel=e}.call(this),function(){function e(e,t){Pusher.PrivateChannel.call(this,e,t),this.members=new Pusher.Members}var t=e.prototype;Pusher.Util.extend(t,Pusher.PrivateChannel.prototype),t.authorize=function(e,t){var i=this;Pusher.PrivateChannel.prototype.authorize.call(i,e,function(e,n){if(!e){if(void 0===n.channel_data)return Pusher.warn("Invalid auth response for channel '"+i.name+"', expected 'channel_data' field"),void t("Invalid auth response");var s=JSON.parse(n.channel_data);i.members.setMyID(s.user_id)}t(e,n)})},t.handleEvent=function(e,t){switch(e){case"pusher_internal:subscription_succeeded":this.members.onSubscription(t),this.subscribed=!0,this.emit("pusher:subscription_succeeded",this.members);break;case"pusher_internal:member_added":var i=this.members.addMember(t);this.emit("pusher:member_added",i);break;case"pusher_internal:member_removed":(i=this.members.removeMember(t))&&this.emit("pusher:member_removed",i);break;default:Pusher.PrivateChannel.prototype.handleEvent.call(this,e,t)}},t.disconnect=function(){this.members.reset(),Pusher.PrivateChannel.prototype.disconnect.call(this)},Pusher.PresenceChannel=e}.call(this),function(){function e(){this.channels={}}var t=e.prototype;t.add=function(e,t){if(!this.channels[e]){var i,n=this.channels;i=0===e.indexOf("private-")?new Pusher.PrivateChannel(e,t):0===e.indexOf("presence-")?new Pusher.PresenceChannel(e,t):new Pusher.Channel(e,t),n[e]=i}return this.channels[e]},t.all=function(e){return Pusher.Util.values(this.channels)},t.find=function(e){return this.channels[e]},t.remove=function(e){var t=this.channels[e];return delete this.channels[e],t},t.disconnect=function(){Pusher.Util.objectApply(this.channels,function(e){e.disconnect()})},Pusher.Channels=e}.call(this),function(){Pusher.Channel.Authorizer=function(e,t){this.channel=e,this.type=t.authTransport,this.options=t,this.authOptions=(t||{}).auth||{}},Pusher.Channel.Authorizer.prototype={composeQuery:function(e){e="socket_id="+encodeURIComponent(e)+"&channel_name="+encodeURIComponent(this.channel.name);for(var t in this.authOptions.params)e+="&"+encodeURIComponent(t)+"="+encodeURIComponent(this.authOptions.params[t]);return e},authorize:function(e,t){return Pusher.authorizers[this.type].call(this,e,t)}};var e=1;Pusher.auth_callbacks={},Pusher.authorizers={ajax:function(e,t){var i;i=Pusher.XHR?new Pusher.XHR:window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),i.open("POST",this.options.authEndpoint,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(var n in this.authOptions.headers)i.setRequestHeader(n,this.authOptions.headers[n]);return i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status){var e,n=!1;try{e=JSON.parse(i.responseText),n=!0}catch(s){t(!0,"JSON returned from webapp was invalid, yet status code was 200. Data was: "+i.responseText)}n&&t(!1,e)}else Pusher.warn("Couldn't get auth info from your webapp",i.status),t(!0,i.status)},i.send(this.composeQuery(e)),i},jsonp:function(t,i){void 0!==this.authOptions.headers&&Pusher.warn("Warn","To send headers with the auth request, you must use AJAX, rather than JSONP.");var n=e.toString();e++;var s=Pusher.Util.getDocument(),o=s.createElement("script");Pusher.auth_callbacks[n]=function(e){i(!1,e)},o.src=this.options.authEndpoint+"?callback="+encodeURIComponent("Pusher.auth_callbacks['"+n+"']")+"&"+this.composeQuery(t),n=s.getElementsByTagName("head")[0]||s.documentElement,n.insertBefore(o,n.firstChild)}}}.call(this),Pusher}),define("events",["backbone","pusher","config"],function(e,t,i){var n=_.extend({},e.Events),s=i.get("user.data.uuid");if(s){var o=new t(i.get("services.pusher.key")),r=o.subscribe("user."+s);r.bind("user_requirement_is_pending",function(e){n.trigger("requirement:pending",e.requirement,e)}),r.bind("user_requirement_was_completed",function(e){n.trigger("requirement:completed",e.requirement,e)}),r.bind("user_requirement_is_incomplete",function(e){"identification"==e.requirement.name&&_.toast('Identification check failed. <a href="'+laroute.route("tutor.account.identification.index")+'">Try again?</a>',"error",2e4),n.trigger("requirement:incompleted",e.requirement,e)}),r.bind("user_requirements",function(e){n.trigger("requirements:reset",e.requirements,e)})}return n}),function(e){"function"==typeof require&&"undefined"!=typeof module&&module.exports?module.exports=e(require("underscore")):"function"==typeof define?define("cocktail",["underscore"],e):this.Cocktail=e(_)}(function(e){var t={};t.mixins={},t.mixin=function(i){var n=e.chain(arguments).toArray().rest().flatten().value(),s=i.prototype||i,o={};return e.each(n,function(i){e.isString(i)&&(i=t.mixins[i]),e.each(i,function(t,i){if(e.isFunction(t)){if(s[i]===t)return;s[i]&&(o[i]=o.hasOwnProperty(i)?o[i]:[s[i]],o[i].push(t)),s[i]=t}else e.isArray(t)?s[i]=e.union(t,s[i]||[]):e.isObject(t)?s[i]=e.extend({},t,s[i]||{}):i in s||(s[i]=t)})}),e.each(o,function(t,i){s[i]=function(){var i,n=this,s=arguments;return e.each(t,function(t){var o=e.isFunction(t)?t.apply(n,s):t;i="undefined"==typeof o?i:o}),i}}),i};var i;return t.patch=function(n){i=n.Model.extend;var s=function(e,n){var s=i.call(this,e,n),o=s.prototype.mixins;return o&&s.prototype.hasOwnProperty("mixins")&&t.mixin(s,o),s};e.each([n.Model,n.Collection,n.Router,n.View],function(i){i.mixin=function(){t.mixin(this,e.toArray(arguments))},i.extend=s})},t.unpatch=function(t){e.each([t.Model,t.Collection,t.Router,t.View],function(e){e.mixin=void 0,e.extend=i})},t}),define("base/collection",["backbone.marionette"],function(e){return Backbone.Collection.extend({parse:function(e){_.has(e,"meta")&&(this.meta=e.meta);var t=_.has(e,"data")?e.data:e;return this.model?_.map(t,function(e){return this.model.prototype.parse(e)},this):t},toJSON:function(){var e=Backbone.Collection.prototype.toJSON.apply(this,arguments);return _.isFunction(this.toJson)?this.toJson(e):e}})}),define("base/collection_view",["backbone.marionette"],function(e){return e.CollectionView.extend({})}),define("base/composite_view",["backbone.marionette"],function(e){return e.CompositeView.extend({})}),define("base/controller",["backbone.marionette"],function(e){return e.Controller.extend({constructor:function(t){t.app&&(this.app=t.app),t.region?this.region=t.region:this.app&&(this.region=this.app.applicationRegion),e.Controller.prototype.constructor.call(this,t)},getResponseJson:function(e){return _.has(e,"responseJSON")?e.responseJSON:JSON.parse(e.responseText)}})}),define("base/item_view",["backbone.marionette"],function(e){return _.extend(Backbone.Marionette.ItemView.prototype,{destroy:function(e){var t=Backbone.Marionette.View.prototype.destroy;if(this.beforeDestroy){var i=$.Deferred(),n=i.resolve;if(this.beforeDestroy(n)===!1)return i.done(_.bind(function(){t.call(this)},this)),!0}t.call(this)}}),e.ItemView.extend({})}),define("base/layout_view",["backbone.marionette"],function(e){return e.LayoutView.extend({})}),define("base/history",["backbone.marionette"],function(e){var t=Backbone.Model.extend({defaults:{fragment:""}}),i=Backbone.Collection.extend({model:t});return e.Controller.extend({initialize:function(e){this.app=e.app,this.history=new i},start:function(e){Backbone.history.start(e),this.updateHistory()},navigate:function(e,t){Backbone.history.navigate(e,t),this.updateHistory()},back:function(e){
var t=this.history.at(1);this.navigate(t?t.get("fragment"):e)},navigateToRoute:function(e,t,i){var n=laroute.route(e,t);this.navigate(n,i)},updateHistory:function(){this.history.unshift(this.getFragment())},getFragment:function(){var e;return e=Backbone.history.fragment?Backbone.history.getFragment():Backbone.history.getHash(),new t({fragment:e})}})}),define("base/model",["backbone.marionette"],function(e){return Backbone.Model.extend({nested:{models:[],collections:[]},sync:function(e,t,i){if(i.beforeSend=function(e){e.setRequestHeader("X-XSRF-TOKEN",_.cookie("XSRF-TOKEN"))},"testing"===_.config("environment")){var n=!1;switch(e.toLowerCase()){case"patch":e="create",n="patch"}n&&(i.attrs._method=n)}return Backbone.Model.prototype.sync.call(this,e,t,i)},parse:function(e){_.has(e,"meta")&&(this.meta=e.meta);var t=_.has(e,"data")?e.data:e;if(_.has(t,"private")){var i=_.has(t["private"],"data")?t["private"].data:t["private"];t=_.extend(t,i),delete t["private"]}return _.has(this.nested,"models")&&_.each(this.nested.models,function(e){t=this.parseModel(t,e)},this),_.has(this.nested,"collections")&&_.each(this.nested.collections,function(e){t=this.parseCollection(t,e)},this),t},parseModel:function(e,t){return _.has(e,t)&&(this[t].clear({silent:!0}).set(this[t].parse(e[t])),this[t].trigger("parsed"),delete e[t]),e},parseCollection:function(e,t){return _.has(e,t)&&(this[t].reset(this[t].parse(e[t])),this[t].trigger("parsed"),delete e[t]),e},toJSON:function(){var e=Backbone.Model.prototype.toJSON.apply(this,arguments);return _.isFunction(this.toJson)?this.toJson(e):e},toJson:function(e){return _.has(this.nested,"models")&&_.each(this.nested.models,function(t){e[t]=this[t].toJSON()},this),_.has(this.nested,"collections")&&_.each(this.nested.collections,function(t){e[t]=this[t].toJSON()},this),e}})}),define("base/region",["backbone.marionette"],function(e){return e.Region.extend({})}),define("base/router",["backbone.marionette"],function(e){return e.AppRouter.extend({constructor:function(t){t&&t.controller&&(this.controller=t.controller,this.controller.app&&(this.app=this.controller.app,this.app.router=this)),_.each(this.routes,function(e,t,i){e=_.trim(e,"/"),e=e.replace(/\{([^\}]+)\}/g,":$1"),i[t]=e}),this.routes=_.invert(this.routes),this.appRoutes=_.invert(this.appRoutes),e.AppRouter.prototype.constructor.call(this,t)}})}),define("base/router_manager",["backbone.marionette"],function(e){return e.Controller.extend({routers:[],addRouters:function(e){_.each(e,function(e,t){this.addRouter(e)},this)},addRouter:function(e){this.routers.push(e)}})}),define("base/view",["backbone.marionette"],function(e){return _.extend(e.View.prototype,{input:function(){var e={};return e=_.extend(e,this.inputFromUi()),e=_.extend(e,this.inputFromChildren()),e=_.extend(e,this.inputFromRegions())},inputFromUi:function(){var e={};return this.ui&&_.each(this.ui,function(t,i){switch(!0){case t.is(":radio"):case t.is(":checkbox"):e[i]=t.filter(":checked").val();break;case t.is("input"):case t.is("textarea"):case t.is("select"):e[i]=t.val()}}),e},inputFromChildren:function(){var e={};return this.children&&this.children.each(function(t){_.extend(e,t.input())},this),e},inputFromRegions:function(){var e={};if(this.regions){var t;_.each(this.regions,function(i,n){t=this[n],t.currentView&&_.extend(e,t.currentView.input())},this)}return e}}),e.View.extend({})}),define("base",["laroute","base/collection","base/collection_view","base/composite_view","base/controller","base/item_view","base/layout_view","base/history","base/model","base/region","base/router","base/router_manager","base/view"],function(e,t,i,n,s,o,r,a,l,u,c,d,h){return window.laroute=e,{Collection:t,CollectionView:i,CompositeView:n,Controller:s,ItemView:o,LayoutView:r,History:a,Model:l,Region:u,Router:c,RouterManager:d,View:h}}),define("mixins/fields/views/layout",["base"],function(e){return{fields:[],fieldParentSelector:".field",fieldParentHasErrorClassName:"field--has-error",fieldErrorSelector:".field__error",getFieldsData:function(){var e={};return _.each(this.fields,function(t){_.isArray(t)?e[t[0]]=_.bind(t[1],this)():e[t]=_.val(this.ui[t])},this),e},hideErrors:function(){_.each(this.fields,function(e){var t=_.isArray(e)?e[0]:e,i=this.ui[t];if(i){var n=i.parents(this.fieldParentSelector),s=n.find(this.fieldErrorSelector);n.removeClass(this.fieldParentHasErrorClassName),s.text("")}},this)},showErrors:function(e){_.each(e,function(e,t){var i=_.isArray(t)?t[0]:t,n=this.ui[i];if(n){var s=n.closest(this.fieldParentSelector),o=s.find(this.fieldErrorSelector);o.text(e),s.addClass(this.fieldParentHasErrorClassName)}},this)}}}),define("mixins/form/controller",["base"],function(e){return{errorCodes:{ERR_UNEXPECTED:"An unexpected error has occured. Please try again later.",ERR_UNAUTHORIZED:"You're not authorized to do that.",ERR_INVALID:"Something doesn't look right.",ERR_INVALID_QUIZ_ANSWER:"Not quite try again!",ERR_INCORRECT_PASSWORD:"That password doesn't look right.",ERR_INCORRECT_CREDENTIALS:"We couldn't find an account for that email. <a href='"+laroute.route("register.student")+"'>Create one now?</a>",ERR_GEOCODE_NO_RESULT:"That address doesn't look right. Please ensure it's correct and try again.",ERR_TOKEN_MISMATCH:"Your session has timed out. Please refresh the page and try again.",ERR_IMAGE_UNREADABLE:"We couldn't open the image you've just uploaded. Please try again ensuring the image you're uploading is either a jpg or a png.",ERR_IMAGE_WRONGFORMAT:"The image you've just attempted to upload is not the correct format, please try again.",ERR_IMAGE_NOPDF:"Sorry, we cannot accept Identity Documents in PDF format, please upload a photographic image (JPEG, JPG or PNG)"},onFormSubmit:function(e){this.view.hideErrors(),this.view.disableSubmit(),_.progress().start(),this.save(e)},onSyncErrorOrInvalid:function(){_.progress().done()},onSyncError:function(e,t){this.view&&this.view.enableSubmit();var i=t.responseJSON;this.parseErrorJson(i,t.status)},parseErrorJson:function(e,t){if(e&&t>=300){var i={};_.each(e.errors,function(e){i[e.field]=e.detail}),this.showErrors(e.message,i)}else this.showErrors("ERR_UNEXPECTED")},onInvalid:function(e,t){this.view.enableSubmit(),this.showErrors("ERR_INVALID",t)},showErrors:function(e,t){_.has(this.errorCodes,e)&&(e=this.errorCodes[e]),_.toast(e,"error"),this.view&&t&&this.view.showErrors(t)}}}),define("mixins/form/views/layout",["base"],function(e){return{submitDisabledClassName:"btn--disabled",ui:{form:".js-form",submit:".js-submit"},events:{"submit @ui.form":"onFormSubmit"},onFormSubmit:function(e){e.preventDefault&&e.preventDefault();var t=this.getData()||{};return _.isFunction(this.getFieldsData)&&(t=_.extend(this.getFieldsData(),t)),this.trigger("form:submit",t),!1},getData:function(){},disableSubmit:function(){this.ui.submit.prop("disabled",!0).addClass(this.submitDisabledClassName)},enableSubmit:function(){this.ui.submit.prop("disabled",!1).removeClass(this.submitDisabledClassName)},showErrors:function(e){},hideErrors:function(){}}}),define("mixins/dialogue/controller",["base"],function(e){return{onClose:function(){this.destroy()},onDestroy:function(){this.region.empty()}}}),define("mixins/dialogue/views/layout",["base"],function(e){return{className:"dialogue",openClassName:"dialogue--open",ui:{close:".js-close"},events:{"click @ui.close":"onClickClose"},onShow:function(){this.$el.addClass(this.openClassName)},onClickClose:function(e){return e.preventDefault&&e.preventDefault(),this.destroy(),!1},onDestroy:function(){this.$el.removeClass(this.openClassName)}}}),function(e,t){"function"==typeof define&&define.amd?define("nprogress",t):"object"==typeof exports?module.exports=t():e.NProgress=t()}(this,function(){function e(e,t,i){return t>e?t:e>i?i:e}function t(e){return 100*(-1+e)}function i(e,i,n){var s;return s="translate3d"===u.positionUsing?{transform:"translate3d("+t(e)+"%,0,0)"}:"translate"===u.positionUsing?{transform:"translate("+t(e)+"%,0)"}:{"margin-left":t(e)+"%"},s.transition="all "+i+"ms "+n,s}function n(e,t){var i="string"==typeof e?e:r(e);return i.indexOf(" "+t+" ")>=0}function s(e,t){var i=r(e),s=i+t;n(i,t)||(e.className=s.substring(1))}function o(e,t){var i,s=r(e);n(e,t)&&(i=s.replace(" "+t+" "," "),e.className=i.substring(1,i.length-1))}function r(e){return(" "+(e.className||"")+" ").replace(/\s+/gi," ")}function a(e){e&&e.parentNode&&e.parentNode.removeChild(e)}var l={};l.version="0.1.6";var u=l.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};l.configure=function(e){var t,i;for(t in e)i=e[t],void 0!==i&&e.hasOwnProperty(t)&&(u[t]=i);return this},l.status=null,l.set=function(t){var n=l.isStarted();t=e(t,u.minimum,1),l.status=1===t?null:t;var s=l.render(!n),o=s.querySelector(u.barSelector),r=u.speed,a=u.easing;return s.offsetWidth,c(function(e){""===u.positionUsing&&(u.positionUsing=l.getPositioningCSS()),d(o,i(t,r,a)),1===t?(d(s,{transition:"none",opacity:1}),s.offsetWidth,setTimeout(function(){d(s,{transition:"all "+r+"ms linear",opacity:0}),setTimeout(function(){l.remove(),e()},r)},r)):setTimeout(e,r)}),this},l.isStarted=function(){return"number"==typeof l.status},l.start=function(){l.status||l.set(0);var e=function(){setTimeout(function(){l.status&&(l.trickle(),e())},u.trickleSpeed)};return u.trickle&&e(),this},l.done=function(e){return e||l.status?l.inc(.3+.5*Math.random()).set(1):this},l.inc=function(t){var i=l.status;return i?("number"!=typeof t&&(t=(1-i)*e(Math.random()*i,.1,.95)),i=e(i+t,0,.994),l.set(i)):l.start()},l.trickle=function(){return l.inc(Math.random()*u.trickleRate)},function(){var e=0,t=0;l.promise=function(i){return i&&"resolved"!=i.state()?(0==t&&l.start(),e++,t++,i.always(function(){t--,0==t?(e=0,l.done()):l.set((e-t)/e)}),this):this}}(),l.render=function(e){if(l.isRendered())return document.getElementById("nprogress");s(document.documentElement,"nprogress-busy");var i=document.createElement("div");i.id="nprogress",i.innerHTML=u.template;var n,o=i.querySelector(u.barSelector),r=e?"-100":t(l.status||0),c=document.querySelector(u.parent);return d(o,{transition:"all 0 linear",transform:"translate3d("+r+"%,0,0)"}),u.showSpinner||(n=i.querySelector(u.spinnerSelector),n&&a(n)),c!=document.body&&s(c,"nprogress-custom-parent"),c.appendChild(i),i},l.remove=function(){o(document.documentElement,"nprogress-busy"),o(document.querySelector(u.parent),"nprogress-custom-parent");var e=document.getElementById("nprogress");e&&a(e)},l.isRendered=function(){return!!document.getElementById("nprogress")},l.getPositioningCSS=function(){var e=document.body.style,t="WebkitTransform"in e?"Webkit":"MozTransform"in e?"Moz":"msTransform"in e?"ms":"OTransform"in e?"O":"";return t+"Perspective"in e?"translate3d":t+"Transform"in e?"translate":"margin"};var c=function(){function e(){var i=t.shift();i&&i(e)}var t=[];return function(i){t.push(i),1==t.length&&e()}}(),d=function(){function e(e){return e.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(e,t){return t.toUpperCase()})}function t(e){var t=document.body.style;if(e in t)return e;for(var i,n=s.length,o=e.charAt(0).toUpperCase()+e.slice(1);n--;)if(i=s[n]+o,i in t)return i;return e}function i(i){return i=e(i),o[i]||(o[i]=t(i))}function n(e,t,n){t=i(t),e.style[t]=n}var s=["Webkit","O","Moz","ms"],o={};return function(e,t){var i,s,o=arguments;if(2==o.length)for(i in t)s=t[i],void 0!==s&&t.hasOwnProperty(i)&&n(e,i,s);else n(e,o[1],o[2])}}();return l}),!function(e,t){"function"==typeof define&&define.amd?define("tipped",["jquery"],t):"object"==typeof module&&module.exports?module.exports=t(require("jquery")):e.Tipped=t(jQuery)}(this,function($){function degrees(e){return 180*e/Math.PI}function radian(e){return e*Math.PI/180}function sec(e){return 1/Math.cos(e)}function sfcc(e){return String.fromCharCode.apply(String,e.replace(" ","").split(","))}function deepExtend(e,t){for(var i in t)t[i]&&t[i].constructor&&t[i].constructor===Object?(e[i]=$.extend({},e[i])||{},deepExtend(e[i],t[i])):e[i]=t[i];return e}function Spin(){return this.initialize.apply(this,_slice.call(arguments))}function Visible(){return this.initialize.apply(this,_slice.call(arguments))}function Skin(){this.initialize.apply(this,_slice.call(arguments))}function Stem(){this.initialize.apply(this,_slice.call(arguments))}function Tooltip(){this.initialize.apply(this,_slice.call(arguments))}function Collection(){this.initialize.apply(this,_slice.call(arguments))}var Tipped={};$.extend(Tipped,{version:"4.5.7"}),Tipped.Skins={base:{afterUpdate:!1,ajax:{},cache:!0,container:!1,containment:{selector:"viewport",padding:5},close:!1,detach:!0,fadeIn:200,fadeOut:200,showDelay:75,hideDelay:25,hideAfter:!1,hideOn:{element:"mouseleave"},hideOthers:!1,position:"top",inline:!1,offset:{x:0,y:0},onHide:!1,onShow:!1,padding:!0,radius:!0,shadow:!0,showOn:{element:"mousemove"},size:"medium",spinner:!0,stem:!0,target:"element",voila:!0},reset:{ajax:!1,hideOn:{element:"mouseleave",tooltip:"mouseleave"},showOn:{element:"mouseenter",tooltip:"mouseenter"}}},$.each("dark light gray red green blue lightyellow lightblue lightpink".split(" "),function(e,t){Tipped.Skins[t]={}});var Browser=function(e){function t(t){var i=new RegExp(t+"([\\d.]+)").exec(e);return i?parseFloat(i[1]):!0}return{IE:!(!window.attachEvent||-1!==e.indexOf("Opera"))&&t("MSIE "),Opera:e.indexOf("Opera")>-1&&(!!window.opera&&opera.version&&parseFloat(opera.version())||7.55),WebKit:e.indexOf("AppleWebKit/")>-1&&t("AppleWebKit/"),Gecko:e.indexOf("Gecko")>-1&&-1===e.indexOf("KHTML")&&t("rv:"),MobileSafari:!!e.match(/Apple.*Mobile.*Safari/),Chrome:e.indexOf("Chrome")>-1&&t("Chrome/"),ChromeMobile:e.indexOf("CrMo")>-1&&t("CrMo/"),Android:e.indexOf("Android")>-1&&t("Android "),IEMobile:e.indexOf("IEMobile")>-1&&t("IEMobile/")}}(navigator.userAgent),Support=function(){function e(e){return i(e,"prefix")}function t(e,t){for(var i in e)if(void 0!==n.style[e[i]])return"prefix"==t?e[i]:!0;return!1}function i(e,i){var n=e.charAt(0).toUpperCase()+e.substr(1),o=(e+" "+s.join(n+" ")+n).split(" ");return t(o,i)}var n=document.createElement("div"),s="Webkit Moz O ms Khtml".split(" ");return{css:{animation:i("animation"),transform:i("transform"),prefixed:e},shadow:i("boxShadow")&&i("pointerEvents"),touch:function(){try{return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}catch(e){return!1}}()}}(),_slice=Array.prototype.slice,_={wrap:function(e,t){var i=e;return function(){var e=[$.proxy(i,this)].concat(_slice.call(arguments));return t.apply(this,e)}},isElement:function(e){return e&&1==e.nodeType},isText:function(e){return e&&3==e.nodeType},isDocumentFragment:function(e){return e&&11==e.nodeType},delay:function(e,t){var i=_slice.call(arguments,2);return setTimeout(function(){return e.apply(e,i)},t)},defer:function(e){return _.delay.apply(this,[e,1].concat(_slice.call(arguments,1)))},pointer:function(e){return{x:e.pageX,y:e.pageY}},element:{isAttached:function(){function e(e){for(var t=e;t&&t.parentNode;)t=t.parentNode;return t}return function(t){var i=e(t);return!(!i||!i.body)}}()}},getUID=function(){var e=0,t="_tipped-uid-";return function(i){for(i=i||t,e++;document.getElementById(i+e);)e++;return i+e}}(),Position={positions:["topleft","topmiddle","topright","righttop","rightmiddle","rightbottom","bottomright","bottommiddle","bottomleft","leftbottom","leftmiddle","lefttop"],regex:{toOrientation:/^(top|left|bottom|right)(top|left|bottom|right|middle|center)$/,horizontal:/^(top|bottom)/,isCenter:/(middle|center)/,side:/^(top|bottom|left|right)/},toDimension:function(){var e={top:"height",left:"width",bottom:"height",right:"width"};return function(t){return e[t]}}(),isCenter:function(e){return!!e.toLowerCase().match(this.regex.isCenter)},isCorner:function(e){return!this.isCenter(e)},getOrientation:function(e){return e.toLowerCase().match(this.regex.horizontal)?"horizontal":"vertical"},getSide:function(e){var t=null,i=e.toLowerCase().match(this.regex.side);return i&&i[1]&&(t=i[1]),t},split:function(e){return e.toLowerCase().match(this.regex.toOrientation)},_flip:{top:"bottom",bottom:"top",left:"right",right:"left"},flip:function(e,t){var i=this.split(e);return t?this.inverseCornerPlane(this.flip(this.inverseCornerPlane(e))):this._flip[i[1]]+i[2]},inverseCornerPlane:function(e){if(Position.isCorner(e)){var t=this.split(e);return t[2]+t[1]}return e},adjustOffsetBasedOnPosition:function(e,t,i){var n=$.extend({},e),s={horizontal:"x",vertical:"y"},o={x:"y",y:"x"},r={top:{right:"x"},bottom:{left:"x"},left:{bottom:"y"},right:{top:"y"}},a=Position.getOrientation(t);if(a==Position.getOrientation(i)){if(Position.getSide(t)!=Position.getSide(i)){var l=o[s[a]];n[l]*=-1}}else{var u=n.x;n.x=n.y,n.y=u;var c=r[Position.getSide(t)][Position.getSide(i)];c&&(n[c]*=-1),n[s[Position.getOrientation(i)]]=0}return n},getBoxFromPoints:function(e,t,i,n){var s=Math.min(e,i),o=Math.max(e,i),r=Math.min(t,n),a=Math.max(t,n);return{left:s,top:r,width:Math.max(o-s,0),height:Math.max(a-r,0)}},isPointWithinBox:function(e,t,i,n,s,o){var r=this.getBoxFromPoints(i,n,s,o);return e>=r.left&&e<=r.left+r.width&&t>=r.top&&t<=r.top+r.height},isPointWithinBoxLayout:function(e,t,i){return this.isPointWithinBox(e,t,i.position.left,i.position.top,i.position.left+i.dimensions.width,i.position.top+i.dimensions.height)},getDistance:function(e,t,i,n){return Math.sqrt(Math.pow(Math.abs(i-e),2)+Math.pow(Math.abs(n-t),2))},intersectsLine:function(){var e=function(e,t,i,n,s,o){var r=(o-t)*(i-e)-(n-t)*(s-e);return r>0?!0:0>r?!1:!0};return function(t,i,n,s,o,r,a,l,u){if(!u)return e(t,i,o,r,a,l)!=e(n,s,o,r,a,l)&&e(t,i,n,s,o,r)!=e(t,i,n,s,a,l);var c,d,h,p;c=n-t,d=s-i,h=a-o,p=l-r;var f,m;if(f=(-d*(t-o)+c*(i-r))/(-h*d+c*p),m=(h*(i-r)-p*(t-o))/(-h*d+c*p),f>=0&&1>=f&&m>=0&&1>=m){var g=t+m*c,v=i+m*d;return{x:g,y:v}}return!1}}()},Bounds={viewport:function(){var e;return e=Browser.MobileSafari||Browser.Android&&Browser.Gecko?{width:window.innerWidth,height:window.innerHeight}:{height:$(window).height(),width:$(window).width()}}},Mouse={_buffer:{pageX:0,pageY:0},_dimensions:{width:30,height:30},_shift:{x:2,y:10},getPosition:function(e){var t=this.getActualPosition(e);return{left:t.left-Math.round(.5*this._dimensions.width)+this._shift.x,top:t.top-Math.round(.5*this._dimensions.height)+this._shift.y}},getActualPosition:function(e){var t=e&&"number"==$.type(e.pageX)?e:this._buffer;return{left:t.pageX,top:t.pageY}},getDimensions:function(){return this._dimensions}},Color=function(){function e(e){return("0"+parseInt(e).toString(16)).slice(-2)}function t(t){return t=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+))?\)$/),"#"+e(t[1])+e(t[2])+e(t[3])}var i={_default:"#000000",aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"};return{toRGB:function(e){if(/^rgba?\(/.test(e))return t(e);i[e]&&(e=i[e]);var n=e.replace("#","");return/^(?:[0-9a-fA-F]{3}){1,2}$/.test(n)||i._default,3==n.length&&(n=n.charAt(0)+n.charAt(0)+n.charAt(1)+n.charAt(1)+n.charAt(2)+n.charAt(2)),"#"+n}}}();Spin.supported=Support.css.transform&&Support.css.animation,$.extend(Spin.prototype,{initialize:function(){this.options=$.extend({},arguments[0]||{}),this.build(),this.start()},build:function(){var e=2*(this.options.length+this.options.radius),t={height:e,width:e};this.element=$("<div>").addClass("tpd-spin").css(t),this.element.append(this._rotate=$("<div>").addClass("tpd-spin-rotate")),this.element.css({"margin-left":-.5*t.width,"margin-top":-.5*t.height});for(var i=this.options.lines,n=0;i>n;n++){var s,o;this._rotate.append(s=$("<div>").addClass("tpd-spin-frame").append(o=$("<div>").addClass("tpd-spin-line"))),o.css({"background-color":this.options.color,width:this.options.width,height:this.options.length,"margin-left":-.5*this.options.width,"border-radius":Math.round(.5*this.options.width)}),s.css({opacity:(1/i*(n+1)).toFixed(2)});var r={};r[Support.css.prefixed("transform")]="rotate("+360/i*(n+1)+"deg)",s.css(r)}},start:function(){var e={};e[Support.css.prefixed("animation")]="tpd-spin 1s infinite steps("+this.options.lines+")",this._rotate.css(e)},stop:function(){var e={};e[Support.css.prefixed("animation")]="none",this._rotate.css(e),this.element.detach()}}),$.extend(Visible.prototype,{initialize:function(e){return e="array"==$.type(e)?e:[e],this.elements=e,this._restore=[],$.each(e,$.proxy(function(e,t){var i=$(t).is(":visible");i||$(t).show(),this._restore.push({element:t,visible:i})},this)),this},restore:function(){$.each(this._restore,function(e,t){t.visible||$(t.element).show()}),this._restore=null}});var AjaxCache=function(){var e=[];return{get:function(t){for(var i=null,n=0;n<e.length;n++)e[n]&&e[n].url==t.url&&(e[n].type||"GET").toUpperCase()==(t.type||"GET").toUpperCase()&&$.param(e[n].data||{})==$.param(t.data||{})&&(i=e[n]);return i},set:function(t,i,n){var s=this.get(t);s||(s=$.extend({callbacks:{}},t),e.push(s)),s.callbacks[i]=n},remove:function(t){for(var i=0;i<e.length;i++)e[i]&&e[i].url==t&&delete e[i]},clear:function(){e=[]}}}(),Voila=function(e){function t(i,n,s){if(!(this instanceof t))return new t(i,n,s);var o=e.type(arguments[1]),r="object"===o?arguments[1]:{},a="function"===o?arguments[1]:"function"===e.type(arguments[2])?arguments[2]:!1;return this.options=e.extend({method:"onload"},r),this.deferred=new jQuery.Deferred,a&&this.always(a),this._processed=0,this.images=[],this._add(i),this}e.extend(t.prototype,{_add:function(t){var n="string"==e.type(t)?e(t):t instanceof jQuery||t.length>0?t:[t];e.each(n,e.proxy(function(t,n){var s=e(),o=e(n);s=o.is("img")?s.add(o):s.add(o.find("img")),s.each(e.proxy(function(t,n){this.images.push(new i(n,e.proxy(function(e){this._progress(e)},this),e.proxy(function(e){this._progress(e)},this),this.options))},this))},this)),this.images.length<1&&setTimeout(e.proxy(function(){this._resolve()},this))},abort:function(){this._progress=this._notify=this._reject=this._resolve=function(){},e.each(this.images,function(e,t){t.abort()}),this.images=[]},_progress:function(e){this._processed++,e.isLoaded||(this._broken=!0),this._notify(e),this._processed==this.images.length&&this[this._broken?"_reject":"_resolve"]()},_notify:function(e){this.deferred.notify(this,e)},_reject:function(){this.deferred.reject(this)},_resolve:function(){this.deferred.resolve(this)},always:function(e){return this.deferred.always(e),this},done:function(e){return this.deferred.done(e),this},fail:function(e){return this.deferred.fail(e),this},progress:function(e){return this.deferred.progress(e),this}});var i=function(e){var t=function(){return this.initialize.apply(this,Array.prototype.slice.call(arguments))};e.extend(t.prototype,{initialize:function(){this.options=e.extend({test:function(){},success:function(){},timeout:function(){},callAt:!1,intervals:[[0,0],[1e3,10],[2e3,50],[4e3,100],[2e4,500]]},arguments[0]||{}),this._test=this.options.test,this._success=this.options.success,this._timeout=this.options.timeout,this._ipos=0,this._time=0,this._delay=this.options.intervals[this._ipos][1],this._callTimeouts=[],this.poll(),this._createCallsAt()},poll:function(){this._polling=setTimeout(e.proxy(function(){if(this._test())return void this.success();if(this._time+=this._delay,this._time>=this.options.intervals[this._ipos][0]){if(!this.options.intervals[this._ipos+1])return void("function"==e.type(this._timeout)&&this._timeout());this._ipos++,this._delay=this.options.intervals[this._ipos][1]}this.poll()},this),this._delay)},success:function(){this.abort(),this._success()},_createCallsAt:function(){this.options.callAt&&e.each(this.options.callAt,e.proxy(function(t,i){var n=i[0],s=i[1],o=setTimeout(e.proxy(function(){s()},this),n);this._callTimeouts.push(o)},this))},_stopCallTimeouts:function(){e.each(this._callTimeouts,function(e,t){clearTimeout(t)}),this._callTimeouts=[]},abort:function(){this._stopCallTimeouts(),this._polling&&(clearTimeout(this._polling),this._polling=null)}});var i=function(){return this.initialize.apply(this,Array.prototype.slice.call(arguments))};return e.extend(i.prototype,{supports:{naturalWidth:function(){return"naturalWidth"in new Image}()},initialize:function(t,i,n){return this.img=e(t)[0],this.successCallback=i,this.errorCallback=n,this.isLoaded=!1,this.options=e.extend({method:"onload",pollFallbackAfter:1e3},arguments[3]||{}),"onload"!=this.options.method&&this.supports.naturalWidth?void this.poll():void this.load()},poll:function(){this._poll=new t({test:e.proxy(function(){return this.img.naturalWidth>0},this),success:e.proxy(function(){this.success()},this),timeout:e.proxy(function(){this.error()},this),callAt:[[this.options.pollFallbackAfter,e.proxy(function(){this.load()},this)]]})},load:function(){this._loading=setTimeout(e.proxy(function(){var t=new Image;this._onloadImage=t,t.onload=e.proxy(function(){t.onload=function(){},this.supports.naturalWidth||(this.img.naturalWidth=t.width,this.img.naturalHeight=t.height,t.naturalWidth=t.width,t.naturalHeight=t.height),this.success()},this),t.onerror=e.proxy(this.error,this),t.src=this.img.src},this))},success:function(){this._calledSuccess||(this._calledSuccess=!0,this.abort(),this.waitForRender(e.proxy(function(){this.isLoaded=!0,this.successCallback(this)},this)))},error:function(){this._calledError||(this._calledError=!0,this.abort(),this._errorRenderTimeout=setTimeout(e.proxy(function(){this.errorCallback&&this.errorCallback(this)},this)))},abort:function(){this.stopLoading(),this.stopPolling(),this.stopWaitingForRender()},stopPolling:function(){this._poll&&(this._poll.abort(),this._poll=null)},stopLoading:function(){this._loading&&(clearTimeout(this._loading),this._loading=null),this._onloadImage&&(this._onloadImage.onload=function(){},this._onloadImage.onerror=function(){})},waitForRender:function(e){this._renderTimeout=setTimeout(e)},stopWaitingForRender:function(){this._renderTimeout&&(clearTimeout(this._renderTimeout),this._renderTimeout=null),this._errorRenderTimeout&&(clearTimeout(this._errorRenderTimeout),this._errorRenderTimeout=null)}}),i}(jQuery);return t}(jQuery);Tipped.Behaviors={hide:{showOn:{element:"mouseenter",tooltip:!1},hideOn:{element:"mouseleave",tooltip:"mouseenter"}},mouse:{showOn:{element:"mouseenter",tooltip:!1},hideOn:{element:"mouseleave",tooltip:"mouseenter"},target:"mouse",showDelay:100,fadeIn:0,hideDelay:0,fadeOut:0},sticky:{showOn:{element:"mouseenter",tooltip:"mouseenter"},hideOn:{element:"mouseleave",tooltip:"mouseleave"},showDelay:150,target:"mouse",fixed:!0}};var Options={create:function(){function e(t){return s=Tipped.Skins.base,o=deepExtend($.extend({},s),Tipped.Skins.reset),e=n,n(t)}function t(e){return e.match(/^(top|left|bottom|right)$/)&&(e+="middle"),e.replace("center","middle").replace(" ",""),e}function i(e){var t,i;return t=e.behavior&&(i=Tipped.Behaviors[e.behavior])?deepExtend($.extend({},i),e):e}function n(e){var n=e.skin?e.skin:Tooltips.options.defaultSkin,r=$.extend({},Tipped.Skins[n]||{});r.skin||(r.skin=Tooltips.options.defaultSkin||"dark");var a=deepExtend($.extend({},o),i(r)),l=deepExtend($.extend({},a),i(e));if(l.ajax){var u=(o.ajax||{},s.ajax);"boolean"==$.type(l.ajax)&&(l.ajax={}),l.ajax=deepExtend($.extend({},u),l.ajax)}var c,d=d=l.position&&l.position.target||"string"==$.type(l.position)&&l.position||o.position&&o.position.target||"string"==$.type(o.position)&&o.position||s.position&&s.position.target||s.position;d=t(d);var h=l.position&&l.position.tooltip||o.position&&o.position.tooltip||s.position&&s.position.tooltip||Tooltips.Position.getInversedPosition(d);if(h=t(h),l.position?"string"==$.type(l.position)?(l.position=t(l.position),c={target:l.position,tooltip:Tooltips.Position.getTooltipPositionFromTarget(l.position)}):(c={tooltip:h,target:d},l.position.tooltip&&(c.tooltip=t(l.position.tooltip)),l.position.target&&(c.target=t(l.position.target))):c={tooltip:h,target:d},Position.isCorner(c.target)&&Position.getOrientation(c.target)!=Position.getOrientation(c.tooltip)&&(c.target=Position.inverseCornerPlane(c.target)),"mouse"==l.target){var p=Position.getOrientation(c.target);c.target="horizontal"==p?c.target.replace(/(left|right)/,"middle"):c.target.replace(/(top|bottom)/,"middle")}l.position=c;var f;if("mouse"==l.target?(f=$.extend({},s.offset),$.extend(f,Tipped.Skins.reset.offset||{}),e.skin&&$.extend(f,(Tipped.Skins[e.skin]||Tipped.Skins[Tooltips.options.defaultSkin]||{}).offset||{}),f=Position.adjustOffsetBasedOnPosition(s.offset,s.position,c.target,!0),e.offset&&(f=$.extend(f,e.offset||{}))):f={x:l.offset.x,y:l.offset.y},l.offset=f,l.hideOn&&"click-outside"==l.hideOn&&(l.hideOnClickOutside=!0,l.hideOn=!1,l.fadeOut=0),l.showOn){var m=l.showOn;"string"==$.type(m)&&(m={element:m}),l.showOn=m}if(l.hideOn){var g=l.hideOn;"string"==$.type(g)&&(g={element:g}),l.hideOn=g}return l.inline&&"string"!=$.type(l.inline)&&(l.inline=!1),Browser.IE&&Browser.IE<9&&$.extend(l,{fadeIn:0,fadeOut:0,hideDelay:0}),l.spinner&&(Spin.supported?"boolean"==$.type(l.spinner)&&(l.spinner=o.spinner||s.spinner||{}):l.spinner=!1),l.container||(l.container=document.body),l.containment&&"string"==$.type(l.containment)&&(l.containment={selector:l.containment,padding:o.containment&&o.containment.padding||s.padding&&s.containment.padding}),l.shadow&&(l.shadow=Support.shadow),l}var s,o;return e}()};$.extend(Skin.prototype,{initialize:function(e){this.tooltip=e,this.element=e._skin;var t=this.tooltip.options;this.tooltip._tooltip[(t.shadow?"remove":"add")+"Class"]("tpd-no-shadow")[(t.radius?"remove":"add")+"Class"]("tpd-no-radius")[(t.stem?"remove":"add")+"Class"]("tpd-no-stem");var i,n,s,o,r=Support.css.prefixed("borderTopLeftRadius");this.element.append(i=$("<div>").addClass("tpd-frames").append($("<div>").addClass("tpd-frame").append($("<div>").addClass("tpd-backgrounds").append(n=$("<div>").addClass("tpd-background").append(s=$("<div>").addClass("tpd-background-content")))))).append(o=$("<div>").addClass("tpd-spinner")),n.css({width:999,height:999,zoom:1}),this._css={border:parseFloat(n.css("border-top-width")),radius:parseFloat(r?n.css(r):0),padding:parseFloat(e._content.css("padding-top")),borderColor:n.css("border-top-color"),backgroundColor:s.css("background-color"),backgroundOpacity:s.css("opacity"),spinner:{dimensions:{width:o.innerWidth(),height:o.innerHeight()}}},o.remove(),i.remove(),this._side=Position.getSide(e.options.position.tooltip)||"top",this._vars={}},destroy:function(){this.frames&&($.each("top right bottom left".split(" "),$.proxy(function(e,t){this["stem_"+t]&&this["stem_"+t].destroy()},this)),this.frames.remove(),this.frames=null)},build:function(){this.frames||(this.element.append(this.frames=$("<div>").addClass("tpd-frames")),$.each("top right bottom left".split(" "),$.proxy(function(e,t){this.insertFrame(t)},this)),this._spinner||this.tooltip._tooltip.append(this._spinner=$("<div>").addClass("tpd-spinner").hide().append($("<div>").addClass("tpd-spinner-spin"))))},_frame:function(){var e,t=$("<div>").addClass("tpd-frame").append(e=$("<div>").addClass("tpd-backgrounds").append($("<div>").addClass("tpd-background-shadow"))).append($("<div>").addClass("tpd-shift-stem").append($("<div>").addClass("tpd-shift-stem-side tpd-shift-stem-side-before")).append($("<div>").addClass("tpd-stem")).append($("<div>").addClass("tpd-shift-stem-side tpd-shift-stem-side-after")));return $.each("top right bottom left".split(" "),$.proxy(function(t,i){e.append($("<div>").addClass("tpd-background-box tpd-background-box-"+i).append($("<div>").addClass("tpd-background-box-shift").append($("<div>").addClass("tpd-background-box-shift-further").append($("<div>").addClass("tpd-background").append($("<div>").addClass("tpd-background-title")).append($("<div>").addClass("tpd-background-content"))).append($("<div>").addClass("tpd-background tpd-background-loading")).append($("<div>").addClass("tpd-background-border-hack").hide()))));
},this)),t}(),_getFrame:function(e){var t=this._frame.clone();t.addClass("tpd-frame-"+e),t.find(".tpd-background-shadow").css({"border-radius":this._css.radius}),this.tooltip.options.stem&&t.find(".tpd-stem").attr("data-stem-position",e);var i=Math.max(this._css.radius-this._css.border,0);t.find(".tpd-background-title").css({"border-top-left-radius":i,"border-top-right-radius":i}),t.find(".tpd-background-content").css({"border-bottom-left-radius":i,"border-bottom-right-radius":i}),t.find(".tpd-background-loading").css({"border-radius":i});var n={backgroundColor:this._css.borderColor},s=Position.getOrientation(e),o="horizontal"==s;n[o?"height":"width"]=this._css.border+"px";var r={top:"bottom",bottom:"top",left:"right",right:"left"};return n[r[e]]=0,t.find(".tpd-shift-stem-side").css(n),t},insertFrame:function(e){var t=this["frame_"+e]=this._getFrame(e);if(this.frames.append(t),this.tooltip.options.stem){var i=t.find(".tpd-stem");this["stem_"+e]=new Stem(i,this,{})}},startLoading:function(){this.tooltip.supportsLoading&&(this.build(),this._spinner||this.tooltip.is("resize-to-content")||this.setDimensions(this._css.spinner.dimensions),this._spinner&&this._spinner.show())},stopLoading:function(){this.tooltip.supportsLoading&&this._spinner&&(this.build(),this._spinner.hide())},updateBackground:function(){var e=this._vars.frames[this._side],t=$.extend({},e.background.dimensions);if(this.tooltip.title&&!this.tooltip.is("loading")){this.element.find(".tpd-background-title, .tpd-background-content").show(),this.element.find(".tpd-background").css({"background-color":"transparent"});var i=$.extend({},t),n=Math.max(this._css.radius-this._css.border,0),s={"border-top-left-radius":n,"border-top-right-radius":n,"border-bottom-left-radius":n,"border-bottom-right-radius":n},o=new Visible(this.tooltip._tooltip),r=this.tooltip._titleWrapper.innerHeight();i.height-=r,this.element.find(".tpd-background-title").css({height:r,width:t.width}),s["border-top-left-radius"]=0,s["border-top-right-radius"]=0,o.restore(),this.element.find(".tpd-background-content").css(i).css(s),this.element.find(".tpd-background-loading").css({"background-color":this._css.backgroundColor})}else this.element.find(".tpd-background-title, .tpd-background-content").hide(),this.element.find(".tpd-background").css({"background-color":this._css.backgroundColor});this._css.border&&(this.element.find(".tpd-background").css({"border-color":"transparent"}),this.element.find(".tpd-background-border-hack").css({width:t.width,height:t.height,"border-radius":this._css.radius,"border-width":this._css.border,"border-color":this._css.borderColor}).show())},paint:function(){if(!this._paintedDimensions||this._paintedDimensions.width!=this._dimensions.width||this._paintedDimensions.height!=this._dimensions.height||this._paintedStemPosition!=this._stemPosition){this._paintedDimensions=this._dimensions,this._paintedStemPosition=this._stemPosition,this.element.removeClass("tpd-visible-frame-top tpd-visible-frame-bottom tpd-visible-frame-left tpd-visible-frame-right").addClass("tpd-visible-frame-"+this._side);var e=this._vars.frames[this._side],t=$.extend({},e.background.dimensions);this.element.find(".tpd-background").css(t),this.element.find(".tpd-background-shadow").css({width:t.width+2*this._css.border,height:t.height+2*this._css.border}),this.updateBackground(),this.element.find(".tpd-background-box-shift, .tpd-background-box-shift-further").removeAttr("style"),this.element.add(this.frames).add(this.tooltip._tooltip).css(e.dimensions);var i=this._side,n=this._vars.frames[i],s=this.element.find(".tpd-frame-"+this._side),o=this._vars.frames[i].dimensions;s.css(o),s.find(".tpd-backgrounds").css($.extend({},n.background.position,{width:o.width-n.background.position.left,height:o.height-n.background.position.top}));var r=Position.getOrientation(i);if(this.tooltip.options.stem)if(s.find(".tpd-shift-stem").css($.extend({},n.shift.dimensions,n.shift.position)),"vertical"==r){var a=s.find(".tpd-background-box-top, .tpd-background-box-bottom");a.css({height:this._vars.cut,width:this._css.border}),s.find(".tpd-background-box-bottom").css({top:n.dimensions.height-this._vars.cut}).find(".tpd-background-box-shift").css({"margin-top":-1*n.dimensions.height+this._vars.cut});var l="right"==i?n.dimensions.width-n.stemPx-this._css.border:0;a.css({left:l}).find(".tpd-background-box-shift").css({"margin-left":-1*l}),s.find(".tpd-background-box-"+("left"==i?"left":"right")).hide(),"right"==i?s.find(".tpd-background-box-left").css({width:n.dimensions.width-n.stemPx-this._css.border}):s.find(".tpd-background-box-right").css({"margin-left":this._css.border}).find(".tpd-background-box-shift").css({"margin-left":-1*this._css.border});var u=s.find(".tpd-background-box-"+this._side);u.css({height:n.dimensions.height-2*this._vars.cut,"margin-top":this._vars.cut}),u.find(".tpd-background-box-shift").css({"margin-top":-1*this._vars.cut})}else{var a=s.find(".tpd-background-box-left, .tpd-background-box-right");a.css({width:this._vars.cut,height:this._css.border}),s.find(".tpd-background-box-right").css({left:n.dimensions.width-this._vars.cut}).find(".tpd-background-box-shift").css({"margin-left":-1*n.dimensions.width+this._vars.cut});var l="bottom"==i?n.dimensions.height-n.stemPx-this._css.border:0;a.css({top:l}).find(".tpd-background-box-shift").css({"margin-top":-1*l}),s.find(".tpd-background-box-"+("top"==i?"top":"bottom")).hide(),"bottom"==i?s.find(".tpd-background-box-top").css({height:n.dimensions.height-n.stemPx-this._css.border}):s.find(".tpd-background-box-bottom").css({"margin-top":this._css.border}).find(".tpd-background-box-shift").css({"margin-top":-1*this._css.border});var u=s.find(".tpd-background-box-"+this._side);u.css({width:n.dimensions.width-2*this._vars.cut,"margin-left":this._vars.cut}),u.find(".tpd-background-box-shift").css({"margin-left":-1*this._vars.cut})}var c=e.background,d=c.position,h=c.dimensions;this._spinner.css({top:d.top+this._css.border+(.5*h.height-.5*this._css.spinner.dimensions.height),left:d.left+this._css.border+(.5*h.width-.5*this._css.spinner.dimensions.width)})}},getVars:function(){var e=(this._css.padding,this._css.radius,this._css.border),t=this._vars.maxStemHeight||0,i=$.extend({},this._dimensions||{}),n={frames:{},dimensions:i,maxStemHeight:t};n.cut=Math.max(this._css.border,this._css.radius)||0;var s={width:0,height:0},o=0,r=0;return this.tooltip.options.stem&&(s=this.stem_top.getMath().dimensions.outside,o=this.stem_top._css.offset,r=Math.max(s.height-this._css.border,0)),n.stemDimensions=s,n.stemOffset=o,Position.getOrientation(this._side),$.each("top right bottom left".split(" "),$.proxy(function(t,o){var a=Position.getOrientation(o),l="vertical"==a,u={width:i.width+2*e,height:i.height+2*e},c=u[l?"height":"width"]-2*n.cut,d={dimensions:u,stemPx:r,position:{top:0,left:0},background:{dimensions:$.extend({},i),position:{top:0,left:0}}};if(n.frames[o]=d,d.dimensions[l?"width":"height"]+=r,("top"==o||"left"==o)&&(d.background.position[o]+=r),$.extend(d,{shift:{position:{top:0,left:0},dimensions:{width:l?s.height:c,height:l?c:s.height}}}),Browser.IE&&Browser.IE<9){var h=d.shift.dimensions;h.width=Math.round(h.width),h.height=Math.round(h.height)}switch(o){case"top":case"bottom":d.shift.position.left+=n.cut,"bottom"==o&&(d.shift.position.top+=u.height-e-r);break;case"left":case"right":d.shift.position.top+=n.cut,"right"==o&&(d.shift.position.left+=u.width-e-r)}},this)),n.connections={},$.each(Position.positions,$.proxy(function(e,t){n.connections[t]=this.getConnectionLayout(t,n)},this)),n},setDimensions:function(e){this.build();var t=this._dimensions;t&&t.width==e.width&&t.height==e.height||(this._dimensions=e,this._vars=this.getVars())},setSide:function(e){this._side=e,this._vars=this.getVars()},getConnectionLayout:function(e,t){var i=Position.getSide(e),n=Position.getOrientation(e),s=(t.dimensions,t.cut),o=this["stem_"+i],r=t.stemOffset,a=this.tooltip.options.stem?o.getMath().dimensions.outside.width:0,l=s+r+.5*a,u={stem:{}},c={left:0,right:0,up:0,down:0},d={top:0,left:0},h={top:0,left:0},p=t.frames[i],l=0;if("horizontal"==n){var f=p.dimensions.width;this.tooltip.options.stem&&(f=p.shift.dimensions.width,2*r>f-a&&(r=Math.floor(.5*(f-a))||0),l=s+r+.5*a);var m=f-2*r,g=Position.split(e),v=r;switch(g[2]){case"left":c.right=m-a,d.left=l;break;case"middle":v+=Math.round(.5*m-.5*a),c.left=v-r,c.right=v-r,d.left=h.left=Math.round(.5*p.dimensions.width);break;case"right":v+=m-a,c.left=m-a,d.left=p.dimensions.width-l,h.left=p.dimensions.width}"bottom"==g[1]&&(d.top+=p.dimensions.height,h.top+=p.dimensions.height),$.extend(u.stem,{position:{left:v},before:{width:v},after:{left:v+a,width:f-v-a+1}})}else{var _=p.dimensions.height;this.tooltip.options.stem&&(_=p.shift.dimensions.height,2*r>_-a&&(r=Math.floor(.5*(_-a))||0),l=s+r+.5*a);var b=_-2*r,g=Position.split(e),y=r;switch(g[2]){case"top":c.down=b-a,d.top=l;break;case"middle":y+=Math.round(.5*b-.5*a),c.up=y-r,c.down=y-r,d.top=h.top=Math.round(.5*p.dimensions.height);break;case"bottom":y+=b-a,c.up=b-a,d.top=p.dimensions.height-l,h.top=p.dimensions.height}"right"==g[1]&&(d.left+=p.dimensions.width,h.left+=p.dimensions.width),$.extend(u.stem,{position:{top:y},before:{height:y},after:{top:y+a,height:_-y-a+1}})}return u.move=c,u.stem.connection=d,u.connection=h,u},setStemPosition:function(e,t){if(this._stemPosition!=e){this._stemPosition=e;var i=Position.getSide(e);this.setSide(i)}this.tooltip.options.stem&&this.setStemShift(e,t)},setStemShift:function(e,t){var i=this._shift,n=this._dimensions;if(!i||i.stemPosition!=e||i.shift.x!=t.x||i.shift.y!=t.y||!n||i.dimensions.width!=n.width||i.dimensions.height!=n.height){this._shift={stemPosition:e,shift:t,dimensions:n};var s=Position.getSide(e),o={horizontal:"x",vertical:"y"}[Position.getOrientation(e)],r={x:{left:"left",width:"width"},y:{left:"top",width:"height"}}[o],a=this["stem_"+s],l=deepExtend({},this._vars.connections[e].stem);t&&0!==t[o]&&(l.before[r.width]+=t[o],l.position[r.left]+=t[o],l.after[r.left]+=t[o],l.after[r.width]-=t[o]),a.element.css(l.position),a.element.siblings(".tpd-shift-stem-side-before").css(l.before),a.element.siblings(".tpd-shift-stem-side-after").css(l.after)}}}),$.extend(Stem.prototype,{initialize:function(e,t){this.element=$(e),this.element[0]&&(this.skin=t,this.element.removeClass("tpd-stem-reset"),this._css=$.extend({},t._css,{width:this.element.innerWidth(),height:this.element.innerHeight(),offset:parseFloat(this.element.css("margin-left")),spacing:parseFloat(this.element.css("margin-top"))}),this.element.addClass("tpd-stem-reset"),this.options=$.extend({},arguments[2]||{}),this._position=this.element.attr("data-stem-position")||"top",this._m=100,this.build())},destroy:function(){this.element.html("")},build:function(){this.destroy();var e=this._css.backgroundColor,t=e.indexOf("rgba")>-1&&parseFloat(e.replace(/^.*,(.+)\)/,"$1")),i=t&&1>t;this._useTransform=i&&Support.css.transform,this._css.border||(this._useTransform=!1),this[(this._useTransform?"build":"buildNo")+"Transform"]()},buildTransform:function(){this.element.append(this.spacer=$("<div>").addClass("tpd-stem-spacer").append(this.downscale=$("<div>").addClass("tpd-stem-downscale").append(this.transform=$("<div>").addClass("tpd-stem-transform").append(this.first=$("<div>").addClass("tpd-stem-side").append(this.border=$("<div>").addClass("tpd-stem-border")).append($("<div>").addClass("tpd-stem-border-corner")).append($("<div>").addClass("tpd-stem-triangle")))))),this.transform.append(this.last=this.first.clone().addClass("tpd-stem-side-inversed")),this.sides=this.first.add(this.last);var e=this.getMath(),t=e.dimensions,i=this._m,n=Position.getSide(this._position);if(this.element.find(".tpd-stem-spacer").css({width:d?t.inside.height:t.inside.width,height:d?t.inside.width:t.inside.height}),"top"==n||"left"==n){var s={};"top"==n?(s.bottom=0,s.top="auto"):"left"==n&&(s.right=0,s.left="auto"),this.element.find(".tpd-stem-spacer").css(s)}this.transform.css({width:t.inside.width*i,height:t.inside.height*i});var o=Support.css.prefixed("transform"),r={"background-color":"transparent","border-bottom-color":this._css.backgroundColor,"border-left-width":.5*t.inside.width*i,"border-bottom-width":t.inside.height*i};r[o]="translate("+e.border*i+"px, 0)",this.element.find(".tpd-stem-triangle").css(r);var a=this._css.borderColor;alpha=a.indexOf("rgba")>-1&&parseFloat(a.replace(/^.*,(.+)\)/,"$1")),alpha&&1>alpha?a=(a.substring(0,a.lastIndexOf(","))+")").replace("rgba","rgb"):alpha=1;var l={"background-color":"transparent","border-right-width":e.border*i,width:e.border*i,"margin-left":-2*e.border*i,"border-color":a,opacity:alpha};l[o]="skew("+e.skew+"deg) translate("+e.border*i+"px, "+-1*this._css.border*i+"px)",this.element.find(".tpd-stem-border").css(l);var a=this._css.borderColor;alpha=a.indexOf("rgba")>-1&&parseFloat(a.replace(/^.*,(.+)\)/,"$1")),alpha&&1>alpha?a=(a.substring(0,a.lastIndexOf(","))+")").replace("rgba","rgb"):alpha=1;var u={width:e.border*i,"border-right-width":e.border*i,"border-right-color":a,background:a,opacity:alpha,"margin-left":-2*e.border*i};if(u[o]="skew("+e.skew+"deg) translate("+e.border*i+"px, "+(t.inside.height-this._css.border)*i+"px)",this.element.find(".tpd-stem-border-corner").css(u),this.setPosition(this._position),i>1){var c={};c[o]="scale("+1/i+","+1/i+")",this.downscale.css(c)}var d=/^(left|right)$/.test(this._position);this._css.border||this.element.find(".tpd-stem-border, .tpd-stem-border-corner").hide(),this.element.css({width:d?t.outside.height:t.outside.width,height:d?t.outside.width:t.outside.height})},buildNoTransform:function(){this.element.append(this.spacer=$("<div>").addClass("tpd-stem-spacer").append($("<div>").addClass("tpd-stem-notransform").append($("<div>").addClass("tpd-stem-border").append($("<div>").addClass("tpd-stem-border-corner")).append($("<div>").addClass("tpd-stem-border-center-offset").append($("<div>").addClass("tpd-stem-border-center-offset-inverse").append($("<div>").addClass("tpd-stem-border-center"))))).append($("<div>").addClass("tpd-stem-triangle"))));var e=this.getMath(),t=e.dimensions,i=/^(left|right)$/.test(this._position),n=/^(bottom)$/.test(this._position),s=/^(right)$/.test(this._position),o=Position.getSide(this._position);if(this.element.css({width:i?t.outside.height:t.outside.width,height:i?t.outside.width:t.outside.height}),this.element.find(".tpd-stem-notransform").add(this.element.find(".tpd-stem-spacer")).css({width:i?t.inside.height:t.inside.width,height:i?t.inside.width:t.inside.height}),"top"==o||"left"==o){var r={};"top"==o?(r.bottom=0,r.top="auto"):"left"==o&&(r.right=0,r.left="auto"),this.element.find(".tpd-stem-spacer").css(r)}this.element.find(".tpd-stem-border").css({width:"100%",background:"transparent"});var a={opacity:Browser.IE&&Browser.IE<9?this._css.borderOpacity:1};a[i?"height":"width"]="100%",a[i?"width":"height"]=this._css.border,a[n?"top":"bottom"]=0,$.extend(a,s?{left:0}:{right:0}),this.element.find(".tpd-stem-border-corner").css(a);var l={width:0,"background-color":"transparent",opacity:Browser.IE&&Browser.IE<9?this._css.borderOpacity:1},u=.5*t.inside.width+"px solid transparent",c={"background-color":"transparent"};if(.5*t.inside.width-e.border+"px solid transparent",i){var d={left:"auto",top:"50%","margin-top":-.5*t.inside.width,"border-top":u,"border-bottom":u};if($.extend(l,d),l[s?"right":"left"]=0,l[s?"border-left":"border-right"]=t.inside.height+"px solid "+this._css.borderColor,$.extend(c,d),c[s?"border-left":"border-right"]=t.inside.height+"px solid "+this._css.backgroundColor,c[s?"right":"left"]=e.top,c[s?"left":"right"]="auto",Browser.IE&&Browser.IE<8){var h=.5*this._css.width+"px solid transparent";$.extend(c,{"margin-top":-.5*this._css.width,"border-top":h,"border-bottom":h}),c[s?"border-left":"border-right"]=this._css.height+"px solid "+this._css.backgroundColor}this.element.find(".tpd-stem-border-center-offset").css({"margin-left":-1*this._css.border*(s?-1:1)}).find(".tpd-stem-border-center-offset-inverse").css({"margin-left":this._css.border*(s?-1:1)})}else{var d={"margin-left":-.5*t.inside.width,"border-left":u,"border-right":u};if($.extend(l,d),l[n?"border-top":"border-bottom"]=t.inside.height+"px solid "+this._css.borderColor,$.extend(c,d),c[n?"border-top":"border-bottom"]=t.inside.height+"px solid "+this._css.backgroundColor,c[n?"bottom":"top"]=e.top,c[n?"top":"bottom"]="auto",Browser.IE&&Browser.IE<8){var h=.5*this._css.width+"px solid transparent";$.extend(c,{"margin-left":-.5*this._css.width,"border-left":h,"border-right":h}),c[n?"border-top":"border-bottom"]=this._css.height+"px solid "+this._css.backgroundColor}this.element.find(".tpd-stem-border-center-offset").css({"margin-top":-1*this._css.border*(n?-1:1)}).find(".tpd-stem-border-center-offset-inverse").css({"margin-top":this._css.border*(n?-1:1)})}this.element.find(".tpd-stem-border-center").css(l),this.element.find(".tpd-stem-border-corner").css({"background-color":this._css.borderColor}),this.element.find(".tpd-stem-triangle").css(c),this._css.border||this.element.find(".tpd-stem-border").hide()},setPosition:function(e){this._position=e,this.transform.attr("class","tpd-stem-transform tpd-stem-transform-"+e)},getMath:function(){var e=this._css.height,t=this._css.width,i=this._css.border;this._useTransform&&Math.floor(t)%2&&(t=Math.max(Math.floor(t)-1,0));var n=degrees(Math.atan(.5*t/e)),s=90-n,o=i/Math.cos((90-s)*Math.PI/180),r=i/Math.cos((90-n)*Math.PI/180),a={width:t+2*o,height:e+r};Math.max(i,this._css.radius),e=a.height,t=.5*a.width;var l=degrees(Math.atan(e/t)),u=90-l,c=i/Math.cos(u*Math.PI/180),d=180*Math.atan(e/t)/Math.PI,h=-1*(90-d),p=90-d,f=i*Math.tan(p*Math.PI/180),r=i/Math.cos((90-p)*Math.PI/180),m=$.extend({},a),g=$.extend({},a);g.height+=this._css.spacing,g.height=Math.ceil(g.height);var v=!0;return 2*i>=a.width&&(v=!1),{enabled:v,outside:g,dimensions:{inside:m,outside:g},top:r,border:c,skew:h,corner:f}}});var Tooltips={tooltips:{},options:{defaultSkin:"dark",startingZIndex:999999},_emptyClickHandler:function(){},init:function(){this.reset(),this._resizeHandler=$.proxy(this.onWindowResize,this),$(window).bind("resize orientationchange",this._resizeHandler),Browser.MobileSafari&&$("body").bind("click",this._emptyClickHandler)},reset:function(){Tooltips.removeAll(),Delegations.removeAll(),this._resizeHandler&&$(window).unbind("resize orientationchange",this._resizeHandler),Browser.MobileSafari&&$("body").unbind("click",this._emptyClickHandler)},onWindowResize:function(){this._resizeTimer&&(window.clearTimeout(this._resizeTimer),this._resizeTimer=null),this._resizeTimer=_.delay($.proxy(function(){var e=this.getVisible();$.each(e,function(e,t){t.clearUpdatedTo(),t.position()})},this),15)},_getTooltips:function(e,t){var i,n=[],s=[];if(_.isElement(e)?(i=$(e).data("tipped-uids"))&&(n=n.concat(i)):$(e).each(function(e,t){(i=$(t).data("tipped-uids"))&&(n=n.concat(i))}),!n[0]&&!t){var o=this.getTooltipByTooltipElement($(e).closest(".tpd-tooltip")[0]);o&&o.element&&(i=$(o.element).data("tipped-uids")||[],i&&(n=n.concat(i)))}return n.length>0&&$.each(n,$.proxy(function(e,t){var i;(i=this.tooltips[t])&&s.push(i)},this)),s},findElement:function(e){var t=[];return _.isElement(e)&&(t=this._getTooltips(e)),t[0]&&t[0].element},get:function(e){var t=$.extend({api:!1},arguments[1]||{}),i=[];return _.isElement(e)?i=this._getTooltips(e):e instanceof $?e.each($.proxy(function(e,t){var n=this._getTooltips(t,!0);n.length>0&&(i=i.concat(n))},this)):"string"==$.type(e)&&$.each(this.tooltips,function(t,n){n.element&&$(n.element).is(e)&&i.push(n)}),t.api&&$.each(i,function(e,t){t.is("api",!0)}),i},getTooltipByTooltipElement:function(e){if(!e)return null;var t=null;return $.each(this.tooltips,function(i,n){n.is("build")&&n._tooltip[0]===e&&(t=n)}),t},getBySelector:function(e){var t=[];return $.each(this.tooltips,function(i,n){n.element&&$(n.element).is(e)&&t.push(n)}),t},getNests:function(){var e=[];return $.each(this.tooltips,function(t,i){i.is("nest")&&e.push(i)}),e},show:function(e){$(this.get(e)).each(function(e,t){t.show(!1,!0)})},hide:function(e){$(this.get(e)).each(function(e,t){t.hide()})},toggle:function(e){$(this.get(e)).each(function(e,t){t.toggle()})},hideAll:function(e){$.each(this.getVisible(),function(t,i){e&&e==i||i.hide()})},refresh:function(e){var t;t=e?$.grep(this.get(e),function(e){return e.is("visible")}):this.getVisible(),$.each(t,function(e,t){t.refresh()})},getVisible:function(){var e=[];return $.each(this.tooltips,function(t,i){i.visible()&&e.push(i)}),e},isVisibleByElement:function(e){var t=!1;return _.isElement(e)&&$.each(this.getVisible()||[],function(i,n){return n.element==e?(t=!0,!1):void 0}),t},getHighestTooltip:function(){var e,t=0;return $.each(this.tooltips,function(i,n){n.zIndex>t&&(t=n.zIndex,e=n)}),e},resetZ:function(){this.getVisible().length<=1&&$.each(this.tooltips,function(e,t){t.is("build")&&!t.options.zIndex&&t._tooltip.css({zIndex:t.zIndex=+Tooltips.options.startingZIndex})})},clearAjaxCache:function(){$.each(this.tooltips,$.proxy(function(e,t){t.options.ajax&&(t._cache&&t._cache.xhr&&(t._cache.xhr.abort(),t._cache.xhr=null),t.is("updated",!1),t.is("updating",!1),t.is("sanitized",!1))},this)),AjaxCache.clear()},add:function(e){this.tooltips[e.uid]=e},remove:function(e){var t=this._getTooltips(e);this.removeTooltips(t)},removeTooltips:function(e){e&&$.each(e,$.proxy(function(e,t){var i=t.uid;delete this.tooltips[i],Browser.IE&&Browser.IE<9?_.defer(function(){t.remove()}):t.remove()},this))},removeDetached:function(){var e=this.getNests(),t=[];e.length>0&&$.each(e,function(e,i){i.is("detached")&&(t.push(i),i.attach())}),$.each(this.tooltips,$.proxy(function(e,t){t.element&&!_.element.isAttached(t.element)&&this.remove(t.element)},this)),$.each(t,function(e,t){t.detach()})},removeAll:function(){$.each(this.tooltips,$.proxy(function(e,t){t.element&&this.remove(t.element)},this)),this.tooltips={}},setDefaultSkin:function(e){this.options.defaultSkin=e||"dark"},setStartingZIndex:function(e){this.options.startingZIndex=e||0}};Tooltips.Position={inversedPosition:{left:"right",right:"left",top:"bottom",bottom:"top",middle:"middle",center:"center"},getInversedPosition:function(e){var t=Position.split(e),i=t[1],n=t[2],s=Position.getOrientation(e),o=$.extend({horizontal:!0,vertical:!0},arguments[1]||{});return"horizontal"==s?(o.vertical&&(i=this.inversedPosition[i]),o.horizontal&&(n=this.inversedPosition[n])):(o.vertical&&(n=this.inversedPosition[n]),o.horizontal&&(i=this.inversedPosition[i])),i+n},getTooltipPositionFromTarget:function(e){var t=Position.split(e);return this.getInversedPosition(t[1]+this.inversedPosition[t[2]])}},$.extend(Tooltip.prototype,{supportsLoading:Support.css.transform&&Support.css.animation,initialize:function(element,content){if(this.element=element,this.element){var options;"object"!=$.type(content)||_.isElement(content)||_.isText(content)||_.isDocumentFragment(content)||content instanceof $?options=arguments[2]||{}:(options=content,content=null);var dataOptions=$(element).data("tipped-options");dataOptions&&(options=deepExtend($.extend({},options),eval("({"+dataOptions+"})"))),this.options=Options.create(options),this._cache={dimensions:{width:0,height:0},events:[],timers:{},layouts:{},is:{},fnCallFn:"",updatedTo:{}},this.queues={showhide:$({})};var title=$(element).attr("title")||$(element).data("tipped-restore-title");if(!content){var dt=$(element).attr("data-tipped");if(dt?content=dt:title&&(content=title),content){var SCRIPT_REGEX=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;content=content.replace(SCRIPT_REGEX,"")}}if((!content||content instanceof $&&!content[0])&&!(this.options.ajax&&this.options.ajax.url||this.options.inline))return void(this._aborted=!0);title&&($(element).data("tipped-restore-title",title),$(element)[0].setAttribute("title","")),this.content=content,this.title=$(this.element).data("tipped-title"),"undefined"!=$.type(this.options.title)&&(this.title=this.options.title),this.zIndex=this.options.zIndex||+Tooltips.options.startingZIndex;var uids=$(element).data("tipped-uids");uids||(uids=[]);var uid=getUID();this.uid=uid,uids.push(uid),$(element).data("tipped-uids",uids);var parentTooltipElement=$(this.element).closest(".tpd-tooltip")[0],parentTooltip;parentTooltipElement&&(parentTooltip=Tooltips.getTooltipByTooltipElement(parentTooltipElement))&&parentTooltip.is("nest",!0);var target=this.options.target;this.target="mouse"==target?this.element:"element"!=target&&target?_.isElement(target)?target:target instanceof $&&target[0]?target[0]:this.element:this.element,this.options.inline&&(this.content=$("#"+this.options.inline)[0]),this.options.ajax&&(this.__content=this.content),"function"==$.type(this.content)&&(this._fn=this.content),this.preBuild(),Tooltips.add(this)}},remove:function(){this.unbind(),this.clearTimers(),this.restoreElementToMarker(),this.stopLoading(),this.abort(),this.is("build")&&this._tooltip&&(this._tooltip.remove(),this._tooltip=null);var e=$(this.element).data("tipped-uids")||[],t=$.inArray(this.uid,e);if(t>-1&&(e.splice(t,1),$(this.element).data("tipped-uids",e)),e.length<1){var i,n="tipped-restore-title";(i=$(this.element).data(n))&&(""!=!$(this.element)[0].getAttribute("title")&&$(this.element).attr("title",i),$(this.element).removeData(n)),$(this.element).removeData("tipped-uids")}var s=$(this.element).attr("class")||"",o=s.replace(/(tpd-delegation-uid-)\d+/g,"").replace(/^\s\s*/,"").replace(/\s\s*$/,"");$(this.element).attr("class",o)},detach:function(){this.options.detach&&!this.is("detached")&&(this._tooltip&&this._tooltip.detach(),this.is("detached",!0))},attach:function(){if(this.is("detached")){var e;if("string"==$.type(this.options.container)){var t=this.target;"mouse"==t&&(t=this.element),e=$($(t).closest(this.options.container).first())}else e=$(this.options.container);e[0]||(e=$(document.body)),e.append(this._tooltip),this.is("detached",!1)}},preBuild:function(){this.is("detached",!0);var e={left:"-10000px",top:"-10000px",opacity:0,zIndex:this.zIndex};this._tooltip=$("<div>").addClass("tpd-tooltip").addClass("tpd-skin-"+this.options.skin).addClass("tpd-size-"+this.options.size).css(e).hide(),this.createPreBuildObservers()},build:function(){this.is("build")||(this.attach(),Browser.IE&&Browser.IE<7&&this._tooltip.append(this.iframeShim=$("<iframe>").addClass("tpd-iframeshim").attr({frameBorder:0,src:"javascript:'';"})),this._tooltip.append(this._skin=$("<div>").addClass("tpd-skin")).append(this._contentWrapper=$("<div>").addClass("tpd-content-wrapper").append(this._contentSpacer=$("<div>").addClass("tpd-content-spacer").append(this._titleWrapper=$("<div>").addClass("tpd-title-wrapper").append(this._titleSpacer=$("<div>").addClass("tpd-title-spacer").append(this._titleRelative=$("<div>").addClass("tpd-title-relative").append(this._titleRelativePadder=$("<div>").addClass("tpd-title-relative-padder").append(this._title=$("<div>").addClass("tpd-title"))))).append(this._close=$("<div>").addClass("tpd-close").append($("<div>").addClass("tpd-close-icon").html("&times;")))).append(this._contentRelative=$("<div>").addClass("tpd-content-relative").append(this._contentRelativePadder=$("<div>").addClass("tpd-content-relative-padder").append(this._content=$("<div>").addClass("tpd-content"))).append(this._inner_close=$("<div>").addClass("tpd-close").append($("<div>").addClass("tpd-close-icon").html("&times;")))))),this.skin=new Skin(this),this._contentSpacer.css({"border-radius":Math.max(this.skin._css.radius-this.skin._css.border,0)}),this.createPostBuildObservers(),this.is("build",!0))},createPostBuildObservers:function(){this._tooltip.delegate(".tpd-close, .close-tooltip","click",$.proxy(function(e){e.stopPropagation(),e.preventDefault(),this.is("api",!1),this.hide(!0)},this))},createPreBuildObservers:function(){this.bind(this.element,"mouseenter",this.setActive),this.bind(this._tooltip,Support.touch&&Browser.MobileSafari?"touchstart":"mouseenter",this.setActive),this.bind(this.element,"mouseleave",function(e){this.setIdle(e)}),this.bind(this._tooltip,"mouseleave",function(e){this.setIdle(e)}),this.options.showOn&&($.each(this.options.showOn,$.proxy(function(e,t){var i,n=!1;switch(e){case"element":i=this.element,this.options.hideOn&&this.options.showOn&&"click"==this.options.hideOn.element&&"click"==this.options.showOn.element&&(n=!0,this.is("toggleable",n));break;case"tooltip":i=this._tooltip;break;case"target":i=this.target}if(i&&t){var s=t;this.bind(i,s,"click"==t&&n?function(){this.is("api",!1),this.toggle()}:function(){this.is("api",!1),this.showDelayed()})}},this)),Support.touch&&Browser.MobileSafari&&this.bind(this._tooltip,"touchend",function(){this._tooltipTouchEndTime=(new Date).getTime()})),this.options.hideOn&&$.each(this.options.hideOn,$.proxy(function(e,t){var i;switch(e){case"element":if(this.is("toggleable")&&"click"==t)return;i=this.element;break;case"tooltip":i=this._tooltip;break;case"target":i=this.target}if(i&&t){var n=t;Support.touch&&Browser.MobileSafari&&/^(target|element)/.test(e)&&/mouse(leave|out)/.test(n)?this.bind(i,n,function(e){if(this._tooltipTouchEndTime&&/^mouse(leave|out)$/.test(e.type)){var t=(new Date).getTime();if(t-this._tooltipTouchEndTime<450)return}this.is("api",!1),this.hideDelayed()}):this.bind(i,n,function(){this.is("api",!1),this.hideDelayed()})}},this)),this.options.hideOnClickOutside&&($(this.element).addClass("tpd-hideOnClickOutside"),this.bind(document.documentElement,"click touchend",$.proxy(function(e){if(this.visible()){var t=$(e.target).closest(".tpd-tooltip, .tpd-hideOnClickOutside")[0];(!t||t&&t!=this._tooltip[0]&&t!=this.element)&&this.hide()}},this))),"mouse"==this.options.target&&this.bind(this.element,"mouseenter mousemove",$.proxy(function(e){this._cache.event=e},this));var e=!1;this.options.showOn&&"mouse"==this.options.target&&!this.options.fixed&&(e=!0),e&&this.bind(this.element,"mousemove",function(){this.is("build")&&(this.is("api",!1),this.position())})}}),$.extend(Tooltip.prototype,{stop:function(){if(this._tooltip){var e=this.queues.showhide;e.queue([]),this._tooltip.stop(1,0)}},showDelayed:function(){this.is("disabled")||(this.clearTimer("hide"),this.is("visible")||this.getTimer("show")||this.setTimer("show",$.proxy(function(){this.clearTimer("show"),this.show()},this),this.options.showDelay||1))},show:function(){if(this.clearTimer("hide"),!this.visible()&&!this.is("disabled")&&$(this.target).is(":visible")){this.is("visible",!0),this.attach(),this.stop();var e=this.queues.showhide;this.is("updated")||this.is("updating")||e.queue($.proxy(function(e){this._onResizeDimensions={width:0,height:0},this.update($.proxy(function(t){return t?(this.is("visible",!1),void this.detach()):void e()},this))},this)),e.queue($.proxy(function(e){this.is("sanitized")?(this.stopLoading(),this._contentWrapper.css({visibility:"visible"}),this.is("resize-to-content",!0),e()):(this._contentWrapper.css({visibility:"hidden"}),this.startLoading(),this.sanitize($.proxy(function(){this.stopLoading(),this._contentWrapper.css({visibility:"visible"}),this.is("resize-to-content",!0),e()},this)))},this)),e.queue($.proxy(function(e){this.position(),this.raise(),e()},this)),e.queue($.proxy(function(e){if(this.is("updated")&&"function"==$.type(this.options.onShow)){var t=new Visible(this._tooltip);this.options.onShow(this._content[0],this.element),t.restore(),e()}else e()},this)),e.queue($.proxy(function(e){this._show(this.options.fadeIn,function(){e()})},this))}},_show:function(e,t){e=("number"==$.type(e)?e:this.options.fadeIn)||0,t=t||("function"==$.type(arguments[0])?arguments[0]:!1),this.options.hideOthers&&Tooltips.hideAll(this),this._tooltip.fadeTo(e,1,$.proxy(function(){t&&t()},this))},hideDelayed:function(){this.clearTimer("show"),this.getTimer("hide")||!this.visible()||this.is("disabled")||this.setTimer("hide",$.proxy(function(){this.clearTimer("hide"),this.hide()},this),this.options.hideDelay||1)},hide:function(e,t){if(this.clearTimer("show"),this.visible()&&!this.is("disabled")){
this.is("visible",!1),this.stop();var i=this.queues.showhide;i.queue($.proxy(function(e){this.abort(),e()},this)),i.queue($.proxy(function(t){this._hide(e,t)},this)),i.queue(function(e){Tooltips.resetZ(),e()}),i.queue($.proxy(function(e){this.clearUpdatedTo(),e()},this)),"function"==$.type(this.options.afterHide)&&this.is("updated")&&i.queue($.proxy(function(e){this.options.afterHide(this._content[0],this.element),e()},this)),this.options.cache||!this.options.ajax&&!this._fn||i.queue($.proxy(function(e){this.is("updated",!1),this.is("updating",!1),this.is("sanitized",!1),e()},this)),"function"==$.type(t)&&i.queue(function(e){t(),e()}),i.queue($.proxy(function(e){this.detach(),e()},this))}},_hide:function(e,t){t=t||("function"==$.type(arguments[0])?arguments[0]:!1),this.attach(),this._tooltip.fadeTo(e?0:this.options.fadeOut,0,$.proxy(function(){this.stopLoading(),this.is("resize-to-content",!1),this._tooltip.hide(),t&&t()},this))},toggle:function(){this.is("disabled")||this[this.visible()?"hide":"show"]()},raise:function(){if(this.is("build")&&!this.options.zIndex){var e=Tooltips.getHighestTooltip();e&&e!=this&&this.zIndex<=e.zIndex&&(this.zIndex=e.zIndex+1,this._tooltip.css({"z-index":this.zIndex}),this._tooltipShadow&&(this._tooltipShadow.css({"z-index":this.zIndex}),this.zIndex=e.zIndex+2,this._tooltip.css({"z-index":this.zIndex})))}}}),$.extend(Tooltip.prototype,{createElementMarker:function(){!this.elementMarker&&this.content&&_.element.isAttached(this.content)&&($(this.content).data("tpd-restore-inline-display",$(this.content).css("display")),this.elementMarker=$("<div>").hide(),$(this.content).before($(this.elementMarker).hide()))},restoreElementToMarker:function(){var e;this.content,this.elementMarker&&this.content&&((e=$(this.content).data("tpd-restore-inline-display"))&&$(this.content).css({display:e}),$(this.elementMarker).before(this.content).remove())},startLoading:function(){this.is("loading")||(this.build(),this.is("loading",!0),this.options.spinner&&(this._tooltip.addClass("tpd-is-loading"),this.skin.startLoading(),this.is("resize-to-content")||(this.position(),this.raise(),this._show())))},stopLoading:function(){this.build(),this.is("loading",!1),this.options.spinner&&(this._tooltip.removeClass("tpd-is-loading"),this.skin.stopLoading())},abort:function(){this.abortAjax(),this.abortSanitize(),this.is("refreshed-before-sanitized",!1)},abortSanitize:function(){this._cache.voila&&(this._cache.voila.abort(),this._cache.voila=null)},abortAjax:function(){this._cache.xhr&&(this._cache.xhr.abort(),this._cache.xhr=null,this.is("updated",!1),this.is("updating",!1))},update:function(e){if(!this.is("updating")){this.is("updating",!0),this.build();var t=this.options.inline?"inline":this.options.ajax?"ajax":_.isElement(this.content)||_.isText(this.content)||_.isDocumentFragment(this.content)?"element":this._fn?"function":"html";switch(this._contentWrapper.css({visibility:"hidden"}),t){case"html":case"element":case"inline":if(this.is("updated"))return void(e&&e());this._update(this.content,e);break;case"function":if(this.is("updated"))return void(e&&e());var i=this._fn(this.element);if(!i)return this.is("updating",!1),void(e&&e(!0));this._update(i,e);break;case"ajax":var n=this.options.ajax||{},s=n.url||this.__content,o=n.data||{},t=n.type||"GET",r=n.dataType,a={url:s,data:o};t&&$.extend(a,{type:t}),r&&$.extend(a,{dataType:r});var l=$.extend({},a,n);l.method&&(l=$.extend({},l),delete l.method),$.each("complete error success".split(" "),$.proxy(function(t,i){l[i]||(l[i]="success"==i?function(e,t,i){return i.responseText}:function(){}),l[i]=_.wrap(l[i],$.proxy(function(t){var n=_slice.call(arguments,1),s=$.type("object"==n[0])?n[0]:n[2];if(!s.statusText||"abort"!=s.statusText){this.options.cache&&AjaxCache.set({url:l.url,type:l.type,data:l.data},i,n),this._cache.xhr=null;var o=t.apply(this,n);o&&this._update(o,e)}},this))},this));var u;if(this.options.cache&&(u=AjaxCache.get(l))&&u.callbacks.success)return void $.each(u.callbacks,$.proxy(function(e,t){"function"==$.type(l[e])&&l[e].apply(this,t)},this));this.startLoading(),this._cache.xhr=$.ajax(l)}}},_update:function(e,t){var i={title:this.options.title,close:this.options.close};"string"==$.type(e)||_.isElement(e)||_.isText(e)||_.isDocumentFragment(e)||e instanceof $?i.content=e:$.extend(i,e);var e=i.content,n=i.title,s=i.close;this.content=e,this.title=n,this.close=s,this.createElementMarker(),(_.isElement(e)||e instanceof $)&&$(e).show(),this._content.html(this.content),this._title.html(n&&"string"==$.type(n)?n:""),this._titleWrapper[n?"show":"hide"](),this._close[(this.title||this.options.title)&&s?"show":"hide"]();var o=s&&!(this.options.title||this.title),r=s&&!(this.options.title||this.title)&&"overlap"!=s,a=s&&(this.options.title||this.title)&&"overlap"!=s;this._inner_close[o?"show":"hide"](),this._tooltip[(r?"add":"remove")+"Class"]("tpd-has-inner-close"),this._tooltip[(a?"add":"remove")+"Class"]("tpd-has-title-close"),this._content[(this.options.padding?"remove":"add")+"Class"]("tpd-content-no-padding"),this.finishUpdate(t)},sanitize:function(e){return!this.options.voila||this._content.find("img").length<1?(this.is("sanitized",!0),void(e&&e())):void(this._cache.voila=Voila(this._content,{method:"onload"},$.proxy(function(t){this._markImagesAsSanitized(t.images),this.is("refreshed-before-sanitized")?(this.is("refreshed-before-sanitized",!1),this.sanitize(e)):(this.is("sanitized",!0),e&&e())},this)))},_markImagesAsSanitized:function(e){$.each(e,function(e,t){var i=t.img;$(i).data("completed-src",t.img.src)})},_hasAllImagesSanitized:function(){var e=!0;return this._content.find("img").each(function(t,i){var n=$(i).data("completed-src");return n&&i.src==n?void 0:(e=!1,!1)}),e},refresh:function(){if(this.visible()){if(!this.is("sanitized"))return void this.is("refreshed-before-sanitized",!0);this.is("refreshing",!0),this.clearTimer("refresh-spinner"),!this.options.voila||this._content.find("img").length<1||this._hasAllImagesSanitized()?(this.is("should-update-dimensions",!0),this.position(),this.is("refreshing",!1)):(this.is("sanitized",!1),this._contentWrapper.css({visibility:"hidden"}),this.startLoading(),this.sanitize($.proxy(function(){this._contentWrapper.css({visibility:"visible"}),this.stopLoading(),this.is("should-update-dimensions",!0),this.position(),this.is("refreshing",!1)},this)))}},finishUpdate:function(e){if(this.is("updated",!0),this.is("updating",!1),"function"==$.type(this.options.afterUpdate)){var t=this._contentWrapper.css("visibility");t&&this._contentWrapper.css({visibility:"visible"}),this.options.afterUpdate(this._content[0],this.element),t&&this._contentWrapper.css({visibility:"hidden"})}e&&e()}}),$.extend(Tooltip.prototype,{clearUpdatedTo:function(){this._cache.updatedTo={}},updateDimensionsToContent:function(e,t){this.skin.build();var i=this.is("loading"),n=this._cache.updatedTo;if((this._maxWidthPass||this.is("api")||this.is("should-update-dimensions")||n.stemPosition!=t||n.loading!=i)&&(!i||!this.is("resize-to-content"))){this._cache.updatedTo={type:this.is("resize-to-content")?"content":"spinner",loading:this.is("loading"),stemPosition:t},this.is("should-update-dimensions")&&this.is("should-update-dimensions",!1);var e=e||this.options.position.target,t=t||this.options.position.tooltip,s=Position.getSide(t),o=Position.getOrientation(t),r=this.skin._css.border;this._tooltip.addClass("tpd-tooltip-measuring");var a=this._tooltip.attr("style");this._tooltip.removeAttr("style");var l={top:r,right:r,bottom:r,left:r},u=0;if("vertical"==Position.getOrientation(t)){this.options.stem&&(l[s]=this.skin["stem_"+s].getMath().dimensions.outside.height);var c=this.getMouseRoom();c[Position._flip[s]]&&(l[s]+=c[Position._flip[s]]);var d=this.getContainmentLayout(t),h=this.getPaddingLine(e),p=!1;Position.isPointWithinBoxLayout(h.x1,h.y1,d)||Position.isPointWithinBoxLayout(h.x2,h.y2,d)?p=!0:$.each("top right bottom left".split(" "),$.proxy(function(e,t){var i=this.getSideLine(d,t);return Position.intersectsLine(h.x1,h.y1,h.x2,h.y2,i.x1,i.y1,i.x2,i.y2)?(p=!0,!1):void 0},this)),p&&(u="left"==s?h.x1-d.position.left:d.position.left+d.dimensions.width-h.x1,l[s]+=u)}if(this.options.offset&&"vertical"==o){var f=Position.adjustOffsetBasedOnPosition(this.options.offset,this.options.position.target,e);0!==f.x&&(l.right+=Math.abs(f.x))}var u;this.options.containment&&(u=this.options.containment.padding)&&($.each(l,function(e){l[e]+=u}),"vertical"==o?l["left"==s?"left":"right"]-=u:l["top"==s?"top":"bottom"]-=u);var m=Bounds.viewport(),g=this.close&&"overlap"!=this.close&&!this.title,v={width:0,height:0};g&&(v=this._innerCloseDimensions||{width:this._inner_close.outerWidth(!0),height:this._inner_close.outerHeight(!0)},this._innerCloseDimensions=v),this._contentRelativePadder.css({"padding-right":v.width}),this._contentSpacer.css({width:m.width-l.left-l.right});var _={width:this._content.innerWidth()+v.width,height:Math.max(this._content.innerHeight(),v.height||0)},b={width:0,height:0};if(this.title){var y={width:0,height:0};this._titleWrapper.add(this._titleSpacer).css({width:"auto",height:"auto"}),this.close&&"overlap"!=this.close&&(y={width:this._close.outerWidth(!0),height:this._close.outerHeight(!0)},this._close.hide()),this._maxWidthPass&&_.width>this.options.maxWidth&&this._titleRelative.css({width:_.width}),this._titleRelativePadder.css({"padding-right":y.width});var w=parseFloat(this._titleWrapper.css("border-bottom-width"));b={width:this.title?this._titleWrapper.innerWidth():0,height:Math.max(this.title?this._titleWrapper.innerHeight()+w:0,y.height+w)},b.width>m.width-l.left-l.right&&(b.width=m.width-l.left-l.right,this._titleSpacer.css({width:b.width}),b.height=Math.max(this.title?this._titleWrapper.innerHeight()+w:0,y.height+w)),_.width=Math.max(b.width,_.width),_.height+=b.height,this._titleWrapper.css({height:Math.max(this.title?this._titleWrapper.innerHeight():0,y.height)}),this.close&&this._close.show()}if(this.options.stem){var x="vertical"==o?"height":"width",k=this.skin["stem_"+s].getMath(),C=k.outside.width+2*this.skin._css.radius;_[x]<C&&(_[x]=C)}if(this._contentSpacer.css({width:_.width}),_.height!=Math.max(this._content.innerHeight(),v.height)+(this.title?this._titleRelative.outerHeight():0)&&_.width++,this.is("resize-to-content")||(_=this.skin._css.spinner.dimensions),this.setDimensions(_),l={top:r,right:r,bottom:r,left:r},this.options.stem){var S=Position.getSide(t);l[S]=this.skin.stem_top.getMath().dimensions.outside.height}this._contentSpacer.css({"margin-top":l.top,"margin-left":+l.left,width:_.width}),(this.title||this.close)&&this._titleWrapper.css({height:this._titleWrapper.innerHeight(),width:_.width}),this._tooltip.removeClass("tpd-tooltip-measuring"),this._tooltip.attr("style",a);var T=this._contentRelative.add(this._titleRelative);this.options.maxWidth&&_.width>this.options.maxWidth&&!this._maxWidthPass&&this.is("resize-to-content")&&(T.css({width:this.options.maxWidth}),this._maxWidthPass=!0,this.updateDimensionsToContent(e,t),this._maxWidthPass=!1,T.css({width:"auto"}))}},setDimensions:function(e){this.skin.setDimensions(e)},getContainmentSpace:function(e,t){var i=this.getContainmentLayout(e,t),n=this.getTargetLayout(),s=n.position,o=n.dimensions,r=i.position,a=i.dimensions,l={top:Math.max(s.top-r.top,0),bottom:Math.max(r.top+a.height-(s.top+o.height),0),left:Math.max(s.left-r.left,0),right:Math.max(r.left+a.width-(s.left+o.width),0)};return s.top>r.top+a.height&&(l.top-=s.top-(r.top+a.height)),s.top+o.height<r.top&&(l.bottom-=r.top-(s.top+o.height)),s.left>r.left+a.width&&r.left+a.width>=s.left&&(l.left-=s.left-(r.left+a.width)),s.left+o.width<r.left&&(l.right-=r.left-(s.left+o.width)),this._cache.layouts.containmentSpace=l,l},position:function(){if(this.visible()){this.is("positioning",!0),this._cache.layouts={},this._cache.dimensions;var e=this.options.position.target,t=this.options.position.tooltip,i=t,n=e;this.updateDimensionsToContent(n,i);var s=this.getPositionBasedOnTarget(n,i),o=deepExtend(s),r=[];if(this.options.containment){var a=!1,l={};if($.each("top right bottom left".split(" "),$.proxy(function(e,t){(l[t]=this.isSideWithinContainment(t,i,!0))&&(a=!0)},this)),a||(o.contained=!0),o.contained)this.setPosition(o);else{r.unshift({position:o,targetPosition:n,stemPosition:i});var u=Position.flip(e);if(n=u,i=Position.flip(t),l[Position.getSide(n)]?(this.updateDimensionsToContent(n,i),o=this.getPositionBasedOnTarget(n,i)):o.contained=!1,o.contained)this.setPosition(o,i);else{r.unshift({position:o,targetPosition:n,stemPosition:i});var c,d=e,h=this.getContainmentSpace(i,!0),p="horizontal"==Position.getOrientation(d)?["left","right"]:["top","bottom"];c=h[p[0]]===h[p[1]]?"horizontal"==Position.getOrientation(d)?"left":"top":p[h[p[0]]>h[p[1]]?0:1];var f=Position.split(d)[1],m=c+f,g=Position.flip(m);if(n=m,i=g,l[Position.getSide(n)]?(this.updateDimensionsToContent(n,i),o=this.getPositionBasedOnTarget(n,i)):o.contained=!1,o.contained)this.setPosition(o,i);else{r.unshift({position:o,targetPosition:n,stemPosition:i});var v,_=[];if($.each(r,function(e,t){if(t.position.top>=0&&t.position.left>=0)v=t;else{var i=t.position.top>=0?1:Math.abs(t.position.top),n=t.position.left>=0?1:Math.abs(t.position.left);_.push({result:t,negativity:i*n})}}),!v){var b=_[_.length-1];$.each(_,function(e,t){t.negativity<b.negativity&&(b=t)}),v=b.result}this.updateDimensionsToContent(v.targetPosition,v.stemPosition,!0),this.setPosition(v.position,v.stemPosition)}}}}else this.setPosition(o);this._cache.dimensions=this.skin._vars.dimensions,this.skin.paint(),this.is("positioning",!1)}},getPositionBasedOnTarget:function(e,t){var t=t||this.options.position.tooltip,i=this.getTargetDimensions(),n={left:0,top:0},s={left:0,top:0};Position.getSide(e);var o=this.skin._vars,r=o.frames[Position.getSide(t)],a=Position.getOrientation(e),l=Position.split(e);if("horizontal"==a){var u=Math.floor(.5*i.width);switch(l[2]){case"left":s.left=u;break;case"middle":n.left=i.width-u,s.left=n.left;break;case"right":n.left=i.width,s.left=i.width-u}"bottom"==l[1]&&(n.top=i.height,s.top=i.height)}else{var u=Math.floor(.5*i.height);switch(l[2]){case"top":s.top=u;break;case"middle":n.top=i.height-u,s.top=n.top;break;case"bottom":s.top=i.height-u,n.top=i.height}"right"==l[1]&&(n.left=i.width,s.left=i.width)}var c=this.getTargetPosition(),d=$.extend({},i,{top:c.top,left:c.left,connection:n,max:s}),h={width:r.dimensions.width,height:r.dimensions.height,top:0,left:0,connection:o.connections[t].connection,stem:o.connections[t].stem};if(h.top=d.top+d.connection.top,h.left=d.left+d.connection.left,h.top-=h.connection.top,h.left-=h.connection.left,this.options.stem){var p=o.stemDimensions.width,f={stem:{top:h.top+h.stem.connection.top,left:h.left+h.stem.connection.left},connection:{top:d.top+d.connection.top,left:d.left+d.connection.left},max:{top:d.top+d.max.top,left:d.left+d.max.left}};if(!Position.isPointWithinBox(f.stem.left,f.stem.top,f.connection.left,f.connection.top,f.max.left,f.max.top)){var f={stem:{top:h.top+h.stem.connection.top,left:h.left+h.stem.connection.left},connection:{top:d.top+d.connection.top,left:d.left+d.connection.left},max:{top:d.top+d.max.top,left:d.left+d.max.left}},m={connection:Position.getDistance(f.stem.left,f.stem.top,f.connection.left,f.connection.top),max:Position.getDistance(f.stem.left,f.stem.top,f.max.left,f.max.top)},g=Math.min(m.connection,m.max),v=f[m.connection<=m.max?"connection":"max"],_="horizontal"==Position.getOrientation(t)?"left":"top",b=Position.getDistance(f.connection.left,f.connection.top,f.max.left,f.max.top);if(b>=p){var y={top:0,left:0},w=v[_]<f.stem[_]?-1:1;y[_]=g*w,y[_]+=Math.floor(.5*p)*w,h.left+=y.left,h.top+=y.top}else{$.extend(f,{center:{top:Math.round(d.top+.5*i.height),left:Math.round(d.left+.5*i.left)}});var x={connection:Position.getDistance(f.center.left,f.center.top,f.connection.left,f.connection.top),max:Position.getDistance(f.center.left,f.center.top,f.max.left,f.max.top)},g=m[x.connection<=x.max?"connection":"max"],k={top:0,left:0},w=v[_]<f.stem[_]?-1:1;k[_]=g*w,h.left+=k.left,h.top+=k.top}}}if(this.options.offset){var C=$.extend({},this.options.offset);C=Position.adjustOffsetBasedOnPosition(C,this.options.position.target,e),h.top+=C.y,h.left+=C.x}var S=this.getContainment({top:h.top,left:h.left},t),T=S.horizontal&&S.vertical,j={x:0,y:0},E=Position.getOrientation(t);if(!S[E]){var q="horizontal"==E,A=q?["left","right"]:["up","down"],P=q?"x":"y",F=q?"left":"top",D=S.correction[P],R=this.getContainmentLayout(t),O=R.position[q?"left":"top"];if(0!==D){var I=o.connections[t].move,z=I[A[0>-1*D?0:1]],L=0>D?-1:1;if(z>=D*L&&h[F]+D>=O)h[F]+=D,j[P]=-1*D,T=!0;else if(Position.getOrientation(e)==Position.getOrientation(t)){if(h[F]+=z*L,j[P]=-1*z*L,h[F]<O){var M=O-h[F],H=I[A[0]]+I[A[1]],M=Math.min(M,H);h[F]+=M;var N=j[P]-M;N>=o.connections[t].move[A[0]]&&N<=o.connections[t].move[A[1]]&&(j[P]-=M)}S=this.getContainment({top:h.top,left:h.left},t);var B=S.correction[P],V=deepExtend({},h);this.options.offset&&(V.left-=this.options.offset.x,V.top-=this.options.offset.y);var f={stem:{top:V.top+h.stem.connection.top,left:V.left+h.stem.connection.left}};f.stem[F]+=j[P];var U=this.getTargetLayout(),p=o.stemDimensions.width,W=Math.floor(.5*p),G=O+R.dimensions[q?"width":"height"];if("x"==P){var X=U.position.left+W;B>0&&(X+=U.dimensions.width-2*W),(0>B&&f.stem.left+B>=X&&V.left+B>=O||B>0&&f.stem.left+B<=X&&V.left+B<=G)&&(V.left+=B)}else{var J=U.position.top+W;B>0&&(J+=U.dimensions.height-2*W),(0>B&&f.stem.top+B>=J&&V.top+B>=O||B>0&&f.stem.top+B<=J&&V.top+B<=G)&&(V.top+=B)}h=V,this.options.offset&&(h.left+=this.options.offset.x,h.top+=this.options.offset.y)}}S=this.getContainment({top:h.top,left:h.left},t),T=S.horizontal&&S.vertical}return{top:h.top,left:h.left,contained:T,shift:j}},setPosition:function(e,t){var i=this._position;if(!i||i.top!=e.top||i.left!=e.left){var n;if(this.options.container!=document.body){if("string"==$.type(this.options.container)){var s=this.target;"mouse"==s&&(s=this.element),n=$($(s).closest(this.options.container).first())}else n=$(n);if(n[0]){var o=$(n).offset(),r={top:Math.round(o.top),left:Math.round(o.left)},a={top:Math.round($(n).scrollTop()),left:Math.round($(n).scrollLeft())};e.top-=r.top,e.top+=a.top,e.left-=r.left,e.left+=a.left}}this._position=e,this._tooltip.css({top:e.top,left:e.left})}this.skin.setStemPosition(t||this.options.position.tooltip,e.shift||{x:0,y:0})},getSideLine:function(e,t){var i=e.position.left,n=e.position.top,s=e.position.left,o=e.position.top;switch(t){case"top":s+=e.dimensions.width;break;case"bottom":n+=e.dimensions.height,s+=e.dimensions.width,o+=e.dimensions.height;break;case"left":o+=e.dimensions.height;break;case"right":i+=e.dimensions.width,s+=e.dimensions.width,o+=e.dimensions.height}return{x1:i,y1:n,x2:s,y2:o}},isSideWithinContainment:function(e,t,i){var n=this.getContainmentLayout(t,i),s=this.getTargetLayout(),o=this.getSideLine(s,e);if(Position.isPointWithinBoxLayout(o.x1,o.y1,n)||Position.isPointWithinBoxLayout(o.x2,o.y2,n))return!0;var r=!1;return $.each("top right bottom left".split(" "),$.proxy(function(e,t){var i=this.getSideLine(n,t);return Position.intersectsLine(o.x1,o.y1,o.x2,o.y2,i.x1,i.y1,i.x2,i.y2)?(r=!0,!1):void 0},this)),r},getContainment:function(e,t){var i={horizontal:!0,vertical:!0,correction:{y:0,x:0}};if(this.options.containment){var n=this.getContainmentLayout(t),s=this.skin._vars.frames[Position.getSide(t)].dimensions;this.options.containment&&((e.left<n.position.left||e.left+s.width>n.position.left+n.dimensions.width)&&(i.horizontal=!1,i.correction.x=e.left<n.position.left?n.position.left-e.left:n.position.left+n.dimensions.width-(e.left+s.width)),(e.top<n.position.top||e.top+s.height>n.position.top+n.dimensions.height)&&(i.vertical=!1,i.correction.y=e.top<n.position.top?n.position.top-e.top:n.position.top+n.dimensions.height-(e.top+s.height)))}return i},getContainmentLayout:function(e,t){var i={top:$(window).scrollTop(),left:$(window).scrollLeft()},n=this.target;"mouse"==n&&(n=this.element);var s,o=$(n).closest(this.options.containment.selector).first()[0];s=o&&"viewport"!=this.options.containment.selector?{dimensions:{width:$(o).innerWidth(),height:$(o).innerHeight()},position:$(o).offset()}:{dimensions:Bounds.viewport(),position:i};var r=this.options.containment.padding;if(r&&!t){var a=Math.max(s.dimensions.height,s.dimensions.width);if(2*r>a&&(r=Math.max(Math.floor(.5*a),0)),r){s.dimensions.width-=2*r,s.dimensions.height-=2*r,s.position.top+=r,s.position.left+=r;var l=Position.getOrientation(e);"vertical"==l?(s.dimensions.width+=r,"left"==Position.getSide(e)&&(s.position.left-=r)):(s.dimensions.height+=r,"top"==Position.getSide(e)&&(s.position.top-=r))}}return this._cache.layouts.containmentLayout=s,s},getMouseRoom:function(){var e={top:0,left:0,right:0,bottom:0};if("mouse"==this.options.target&&!this.is("api")){var t=Mouse.getActualPosition(this._cache.event),i=$(this.element).offset(),n={width:$(this.element).innerWidth(),height:$(this.element).innerHeight()};e={top:Math.max(0,t.top-i.top),bottom:Math.max(0,i.top+n.height-t.top),left:Math.max(0,t.left-i.left),right:Math.max(0,i.left+n.width-t.left)}}return e},getTargetPosition:function(){var e;if("mouse"==this.options.target)if(this.is("api")){var t=$(this.element).offset();e={top:Math.round(t.top),left:Math.round(t.left)}}else e=Mouse.getPosition(this._cache.event);else{var t=$(this.target).offset();e={top:Math.round(t.top),left:Math.round(t.left)}}return this._cache.layouts.targetPosition=e,e},getTargetDimensions:function(){if(this._cache.layouts.targetDimensions)return this._cache.layouts.targetDimensions;var e;return e="mouse"==this.options.target?Mouse.getDimensions():{width:$(this.target).innerWidth(),height:$(this.target).innerHeight()},this._cache.layouts.targetDimensions=e,e},getTargetLayout:function(){if(this._cache.layouts.targetLayout)return this._cache.layouts.targetLayout;var e={position:this.getTargetPosition(),dimensions:this.getTargetDimensions()};return this._cache.layouts.targetLayout=e,e},getPaddingLine:function(e){var t=this.getTargetLayout(),i="left";if("vertical"==Position.getOrientation(e))return this.getSideLine(t,Position.getSide(e));if(Position.isCorner(e)){var n=Position.inverseCornerPlane(e);return i=Position.getSide(n),this.getSideLine(t,i)}var s=this.getSideLine(t,i),o=Math.round(.5*t.dimensions.width);return s.x1+=o,s.x2+=o,s}}),$.extend(Tooltip.prototype,{setActive:function(){this.is("active",!0),this.visible()&&this.raise(),this.options.hideAfter&&this.clearTimer("idle")},setIdle:function(){this.is("active",!1),this.options.hideAfter&&this.setTimer("idle",$.proxy(function(){this.clearTimer("idle"),this.is("active")||this.hide()},this),this.options.hideAfter)}}),$.extend(Tooltip.prototype,{bind:function(e,t,i,n){t=t;var s=$.proxy(i,n||this);this._cache.events.push({element:e,eventName:t,handler:s}),$(e).bind(t,s)},unbind:function(){$.each(this._cache.events,function(e,t){$(t.element).unbind(t.eventName,t.handler)}),this._cache.events=[]}}),$.extend(Tooltip.prototype,{disable:function(){this.is("disabled")||this.is("disabled",!0)},enable:function(){this.is("disabled")&&this.is("disabled",!1)}}),$.extend(Tooltip.prototype,{is:function(e,t){return"boolean"==$.type(t)&&(this._cache.is[e]=t),this._cache.is[e]},visible:function(){return this.is("visible")}}),$.extend(Tooltip.prototype,{setTimer:function(e,t,i){this._cache.timers[e]=_.delay(t,i)},getTimer:function(e){return this._cache.timers[e]},clearTimer:function(e){this._cache.timers[e]&&(clearTimeout(this._cache.timers[e]),delete this._cache.timers[e])},clearTimers:function(){$.each(this._cache.timers,function(e,t){clearTimeout(t)}),this._cache.timers={}}}),$.extend(Tipped,{init:function(){Tooltips.init()},create:function(e,t){var i=$.extend({},arguments[2]||{}),n=[];return _.isElement(e)?n.push(new Tooltip(e,t,i)):$(e).each(function(e,s){n.push(new Tooltip(s,t,i))}),new Collection(n)},get:function(e){var t=Tooltips.get(e);return new Collection(t)},findElement:function(e){return Tooltips.findElement(e)},hideAll:function(){return Tooltips.hideAll(),this},setDefaultSkin:function(e){return Tooltips.setDefaultSkin(e),this},visible:function(e){if(_.isElement(e))return Tooltips.isVisibleByElement(e);if("undefined"!=$.type(e)){var t=$(e),i=0;return $.each(t,function(e,t){Tooltips.isVisibleByElement(t)&&i++}),i}return Tooltips.getVisible().length},clearAjaxCache:function(){return Tooltips.clearAjaxCache(),this},refresh:function(e,t,i){return Tooltips.refresh(e,t,i),this},setStartingZIndex:function(e){return Tooltips.setStartingZIndex(e),this},remove:function(e){return Tooltips.remove(e),this}}),$.each("show hide toggle disable enable".split(" "),function(e,t){Tipped[t]=function(e){return this.get(e)[t](),this}}),$.extend(Tipped,{delegate:function(){Delegations.add.apply(Delegations,_slice.call(arguments))},undelegate:function(){Delegations.remove.apply(Delegations,_slice.call(arguments))}});var Delegations={_uid:0,_delegations:{},add:function(e,t,i){var i;"object"!=$.type(t)||_.isElement(t)?i=arguments[2]||{}:(i=t,t=null);var n=++this._uid,s=Options.create($.extend({},i));this._delegations[n]={uid:n,selector:e,content:t,options:s};var o=function(e){$(this).addClass("tpd-delegation-uid-"+n);var s=new Tooltip(this,t,i);s._cache.event=e,s.setActive(),s.showDelayed()};this._delegations[n].removeTitleHandler=$.proxy(this.removeTitle,this),$(document).delegate(e+":not(.tpd-delegation-uid-"+n+")","mouseenter",this._delegations[n].removeTitleHandler),this._delegations[n].handler=o,$(document).delegate(e+":not(.tpd-delegation-uid-"+n+")",s.showOn.element,o)},removeTitle:function(e){var t=e.currentTarget,i=$(t).attr("title");i&&($(t).data("tipped-restore-title",i),$(t)[0].setAttribute("title",""))},remove:function(e){$.each(this._delegations,$.proxy(function(t,i){i.selector==e&&($(document).undelegate(e+":not(.tpd-delegation-uid-"+t+")","mouseenter",i.removeTitleHandler).undelegate(e+":not(.tpd-delegation-uid-"+t+")",i.options.showOn.element,i.handler),delete this._delegations[t])},this))},removeAll:function(){$.each(this._delegations,$.proxy(function(e,t){$(document).undelegate(selector+":not(.tpd-delegation-uid-"+e+")","mouseenter",t.removeTitleHandler).undelegate(t.selector+":not(.tpd-delegation-uid-"+e+")",t.options.showOn.element,t.handler),delete this._delegations[e]},this))}};return $.extend(Collection.prototype,{initialize:function(e){return this.tooltips=e,this},items:function(){return $.each(this.tooltips,function(e,t){t.is("api",!0)}),this.tooltips},refresh:function(){return $.each(this._tooltips,function(e,t){t.is("visible")&&t.refresh()}),this},remove:function(){return Tooltips.removeTooltips(this.tooltips),this.tooltips=[],this}}),$.each("show hide toggle disable enable".split(" "),function(e,t){Collection.prototype[t]=function(){return $.each(this.tooltips,function(e,i){i.is("api",!0),i[t]()}),this}}),Tipped.init(),Tipped}),define("mixins",["backbone","backbone.validation","underscore","underscore.string","events","cocktail","mixins/fields/views/layout","mixins/form/controller","mixins/form/views/layout","mixins/dialogue/controller","mixins/dialogue/views/layout","nprogress","tipped","laroute","config","functions","picker","picker.date"],function(e,t,i,n,s,o,r,a,l,u,c,d,h,p,f){window.laroute=p,i.mixin(n.exports()),i.mixin({config:function(e){return f.get(e)},lang:function(e,t,n){t=i.isObject(t)?t:{},n=i.isUndefined(n)?e:n;var s=f.get("lang."+e);return i.isString(s)?i.templ(s,t):i.isNull(s)?n:s},templ:function(e,t){return i.template(e.replace(/:([^\s]+)/g,"<%= $1 %>"),t)},pe:function(e){return e="<p>"+e+"</p>",e=i.replaceAll(e,"\n\n","</p><p>"),e=i.replaceAll(e,"\n","<br>")},cookie:function(e){var t="; "+document.cookie,i=t.split("; "+e+"=");return 2==i.length?t=i.pop().split(";").shift():void 0},queryString:function(e){for(var t=location.search.substr(1).split("&"),i=0,n=t.length;n>i;i++){var s=t[i].split("=");if(s[0]===e)return decodeURIComponent(s[1])}},progress:function(){return d},tipped:function(){return h},toast:function(e,t,i){s.trigger("toast",e,t,i)},val:function(e){var t,n=$(e);if(n.length>1){t={};var s=/\[(.*?)\]/g;i.each(n,function(e){for(var n,o=[];n=s.exec(e.name);)o.push(n[1]);object_set(t,o.join("."),i.val(e))})}else switch(!0){case n.is('[type="checkbox"]'):t=n.is(":checked");break;case n.is('[type="radio"]'):t=n.filter(":checked").val();break;default:t=n.val()}return t},patch:function(e){return i.isObject(e&&e.prototype&&e.prototype.mixins)?i.each(e.prototype.mixins,function(t){o.mixin(e,t)}):i.each(e,i.patch),e},callback:function(e){var t=e[0],i=e[1],n=e[2]||[];t.apply(i,n)},datepicker:function(e){e.pickadate({format:"dd/mm/yyyy"})}}),i.extend(e.Validation.validators,{"boolean":function(e,t,n,s){return i.isBoolean(e)?void 0:"The "+t+" field must be true or false."},numeric:function(e,t,n,s){return NaN===e||!i.isNumber(e)&&isNaN(e)?"The "+t+" field must be a number.":void 0}}),i.extend(e.Model.prototype,t.mixin),o.mixins={FieldsLayout:r,FormController:a,FormLayout:l,DialogueController:u,DialogueLayout:c}}),define("entities/address",["base"],function(e){var t=e.Model.extend({defaults:{line_1:null,line_2:null,line_3:null,postcode:null,latitude:null,longitude:null}}),i=e.Model.extend({nested:{models:["default","billing"]},constructor:function(i,n){n=n||{},_.each(this.nested.models,function(e){this[e]=new t,this[e].url=this.url+"/"+e},this),e.Model.apply(this,arguments)},clear:function(e){return _.each(this.nested.models,function(t){this[t].clear(e).set(_.clone(this[t].defaults),{silent:!0})},this),this},set:function(e,t){return _.each(this.nested.models,function(i){this[i].set(e[i],t)},this),this}});return{model:function(e,i){return new t(e,i)},models:function(e,t){return new i(e,t)}}}),define("entities/user_profile",["base"],function(e,t){var i=e.Model.extend({defaults:{tagline:null,rate:null},isNew:function(){return!1}});return{model:function(e,t){return new i(e,t)}}}),define("entities/user_qualification_university",["base"],function(e){var t=e.Model.extend({defaults:{subject:"",university:"",level:"",still_studying:!1},validation:function(){return{university:[{required:!0,msg:"The university field is required."},{maxLength:255,msg:"The university field must not be greater than 255 characters."}],level:[{required:!0,msg:"The level field is required."},{oneOf:["degree","masters","phd"],msg:"The selected level is invalid."}],subject:[{required:!0,msg:"The subject field is required."},{maxLength:255,msg:"The subject field must not be greater than 255 characters."}],still_studying:[{"boolean":!0,msg:"The still studying field must be true or false."}]}}}),i=e.Collection.extend({model:t,save:function(e){Backbone.sync("create",this,e)}});return{model:function(e,i){return new t(e,i)},collection:function(e,t){return new i(e,t)}}}),define("entities/user_qualification_alevel",["base"],function(e){var t=e.Model.extend({defaults:{subject:"",college:"",grade:"",still_studying:!1},validation:{college:[{required:!0,msg:"The college field is required."},{maxLength:255,msg:"The college field must not be greater than 255 characters."}],grade:[{required:!0,msg:"The grade field is required."},{oneOf:["A*","A","B","C","D","E"],msg:"The selected grade is invalid."}],subject:[{required:!0,msg:"The subject field is required."},{maxLength:255,msg:"The subject field must not be greater than 255 characters."}],still_studying:[{"boolean":!0,msg:"The still studying field must be true or false."}]}}),i=e.Collection.extend({url:function(){return"/api/users/"+this.user_id+"/qualification_alevels"},model:t,constructor:function(e,t){t=t||{},this.user_id=t.user_id,Backbone.Collection.apply(this,arguments)},save:function(e){Backbone.sync("create",this,e)}});return{model:function(e,i){return new t(e,i)},collection:function(e,t){return new i(e,t)}}}),define("entities/user_qualification_other",["base"],function(e){var t=e.Model.extend({defaults:{subject:"",location:"",grade:"",still_studying:!1},validation:{location:[{
required:!0,msg:"The location field is required."},{maxLength:255,msg:"The location field must not be greater than 255 characters."}],grade:[{required:!0,msg:"The grade field is required."},{maxLength:255,msg:"The grade field must not be greater than 255 characters."}],subject:[{required:!0,msg:"The subject field is required."},{maxLength:255,msg:"The subject field must not be greater than 255 characters."}],still_studying:[{"boolean":!0,msg:"The still studying field must be true or false."}]}}),i=e.Collection.extend({url:function(){return"/api/users/"+this.user_id+"/qualification_others"},model:t,constructor:function(e,t){t=t||{},this.user_id=t.user_id,Backbone.Collection.apply(this,arguments)},save:function(e){Backbone.sync("create",this,e)}});return{model:function(e,i){return new t(e,i)},collection:function(e,t){return new i(e,t)}}}),define("entities/user_qualification",["base","entities/user_qualification_university","entities/user_qualification_alevel","entities/user_qualification_other"],function(e,t,i,n){var s=e.Model.extend({nested:{collections:["universities","alevels","others"]},constructor:function(e,s){this.universities=t.collection(),this.alevels=i.collection(),this.others=n.collection(),Backbone.Model.apply(this,arguments)}});return{model:function(e,t){return new s(e,t)}}}),define("entities/user_qualification_teacher_status",["base"],function(e){var t=e.Model.extend({defaults:{level:null},isNew:function(){return!1}});return{model:function(e,i){return new t(e,i)}}}),define("entities/user_background_check",["base"],function(e){var t=e.Model.extend({defaults:{dbs:null,enhanced_dbs:null}});return{model:function(e,i){return new t(e,i)}}}),define("entities/subject",["base"],function(e){var t=e.Model.extend({urlRoot:"/api/subjects",defaults:{name:null,path:null,depth:null,children:null},toJson:function(e){return _.has(e,"children")&&_.isArray(e.children)&&(e.children=_.map(e.children,function(e){return e.toJSON()})),e}}),i=e.Collection.extend({model:t,url:"/api/subjects",parse:function(e){return _.has(e,"data")?data=e.data:data=e,_.isArray(data)?_.map(data,function(e){return _.has(e,"children")&&_.isArray(e.children)&&(e.children=this.parse(e.children)),new t(e)},this):data},save:function(e){e=_.extend(e||{},{attrs:{subjects:this.toJSON()}}),Backbone.sync("create",this,_.extend({success:_.bind(function(t){t=this.parse(t),this.reset(t,{silent:!0}),this.trigger("sync",this,t,e)},this),error:_.bind(function(t){this.trigger("error",this,t,e)},this)},e))}});return{model:function(e,i){return new t(e,i)},collection:function(e,t){return new i(e,t)}}}),define("entities/quiz",["base"],function(e){var t=e.Model.extend({urlRoot:"/api/quiz"}),i=e.Model.extend({idAttribute:"key",defaults:{question:"",key:"",answers:[]}}),n=e.Collection.extend({model:i,url:"/api/quiz",parse:function(e){if(_.has(e,"data")?data=e.data:data=e,!_.isArray(data))return data;var t=_.map(data,function(e){return _.has(e,"answers")&&_.isArray(e.answers)&&(e.answers=new Backbone.Collection(e.answers)),new i(e)},this);return t}});return{model:function(e,i){return new t(e,i)},collection:function(e,t){return new n(e,t)}}}),define("entities/user",["base","events","entities/address","entities/user_profile","entities/user_qualification","entities/user_qualification_teacher_status","entities/user_background_check","entities/subject","entities/quiz"],function(e,t,i,n,s,o,r,a,l){var u,c=e.Model.extend({defaults:{title:"",is_pending:!1,is_completed:!1,is_optional:!1,is_js:!1}}),d=e.Collection.extend({model:c,comparator:"sort",initialize:function(){this.listenTo(t,"requirements:reset",function(e){this.reset(e.data)})}}),h=e.Model.extend({urlRoot:laroute.route("api.users.create"),idAttribute:"uuid",nested:{models:["addresses","profile","qualifications","qts","background_check","identity_document"],collections:["subjects","students","requirements"]},defaults:{first_name:null,last_name:null,dob:null,email:null,telephone:null,password:null},constructor:function(t,u){t=t||{},_.has(t,"data")&&(t=t.data);var c=t[this.idAttribute];return this.addresses=i.models(),this.addresses.url=laroute.route("api.users.addresses.create",{uuid:c}),this.profile=n.model(),this.profile.url=laroute.route("api.users.profile.edit",{uuid:c}),this.requirements=new d,this.students=new p,this.students.url=laroute.route("api.users.students.create",{uuid:c}),this.subjects=a.collection(),this.subjects.url=laroute.route("api.users.subjects.create",{uuid:c}),this.quiz=l.model(),this.quiz.url=laroute.route("api.users.quiz.submit",{uuid:c}),this.qualifications=s.model(),this.qualifications.url=laroute.route("api.users.qualifications.create",{uuid:c}),this.qts=o.model(),this.qts.url=laroute.route("api.users.qualifications.qts.create",{uuid:c}),this.identity_document=new e.Model,this.background_check=r.model(),Backbone.Model.apply(this,arguments)},allowedRateRange:function(){var e=this.get("rate");return{min:parseInt(.5*e),max:parseInt(2*e)}}}),p=e.Collection.extend({model:h,url:laroute.route("api.users.create")});return{current:function(){if(!u){var e=_.clone(_.config("user"));u=new h(e,{parse:!0})}return u},set:function(e){return u=new h(e,{parse:!0})},model:function(e,t){return t=_.extend({parse:!0},t),new h(e,t)}}}),define("requirejs-text",["module"],function(e){"use strict";var t,i,n,s,o,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],a=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,u="undefined"!=typeof location&&location.href,c=u&&location.protocol&&location.protocol.replace(/\:/,""),d=u&&location.hostname,h=u&&(location.port||void 0),p={},f=e.config&&e.config()||{};return t={version:"2.0.14",strip:function(e){if(e){e=e.replace(a,"");var t=e.match(l);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){i=r[t];try{e=new ActiveXObject(i)}catch(n){}if(e){r=[i];break}}return e},parseName:function(e){var t,i,n,s=!1,o=e.lastIndexOf("."),r=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!r||o>1)?(t=e.substring(0,o),i=e.substring(o+1)):t=e,n=i||t,o=n.indexOf("!"),-1!==o&&(s="strip"===n.substring(o+1),n=n.substring(0,o),i?i=n:t=n),{moduleName:t,ext:i,strip:s}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,i,n,s){var o,r,a,l=t.xdRegExp.exec(e);return l?(o=l[2],r=l[3],r=r.split(":"),a=r[1],r=r[0],!(o&&o!==i||r&&r.toLowerCase()!==n.toLowerCase()||(a||r)&&a!==s)):!0},finishLoad:function(e,i,n,s){n=i?t.strip(n):n,f.isBuild&&(p[e]=n),s(n)},load:function(e,i,n,s){if(s&&s.isBuild&&!s.inlineText)return void n();f.isBuild=s&&s.isBuild;var o=t.parseName(e),r=o.moduleName+(o.ext?"."+o.ext:""),a=i.toUrl(r),l=f.useXhr||t.useXhr;return 0===a.indexOf("empty:")?void n():void(!u||l(a,c,d,h)?t.get(a,function(i){t.finishLoad(e,o.strip,i,n)},function(e){n.error&&n.error(e)}):i([r],function(e){t.finishLoad(o.moduleName+"."+o.ext,o.strip,e,n)}))},write:function(e,i,n,s){if(p.hasOwnProperty(i)){var o=t.jsEscape(p[i]);n.asModule(e+"!"+i,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,i,n,s,o){var r=t.parseName(i),a=r.ext?"."+r.ext:"",l=r.moduleName+a,u=n.toUrl(r.moduleName+a)+".js";t.load(l,n,function(i){var n=function(e){return s(u,e)};n.asModule=function(e,t){return s.asModule(e,u,t)},t.write(e,l,n,o)},o)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(i=require.nodeRequire("fs"),t.get=function(e,t,n){try{var s=i.readFileSync(e,"utf8");"\ufeff"===s[0]&&(s=s.substring(1)),t(s)}catch(o){n&&n(o)}}):"xhr"===f.env||!f.env&&t.createXhr()?t.get=function(e,i,n,s){var o,r=t.createXhr();if(r.open("GET",e,!0),s)for(o in s)s.hasOwnProperty(o)&&r.setRequestHeader(o.toLowerCase(),s[o]);f.onXhr&&f.onXhr(r,e),r.onreadystatechange=function(t){var s,o;4===r.readyState&&(s=r.status||0,s>399&&600>s?(o=new Error(e+" HTTP status: "+s),o.xhr=r,n&&n(o)):i(r.responseText),f.onXhrComplete&&f.onXhrComplete(r,e))},r.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var i,n,s="utf-8",o=new java.io.File(e),r=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),s)),l="";try{for(i=new java.lang.StringBuffer,n=a.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=a.readLine());)i.append(r),i.append(n);l=String(i.toString())}finally{a.close()}t(l)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,s=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),o="@mozilla.org/windows-registry-key;1"in n,t.get=function(e,t){var i,r,a,l={};o&&(e=e.replace(/\//g,"\\")),a=new FileUtils.File(e);try{i=n["@mozilla.org/network/file-input-stream;1"].createInstance(s.nsIFileInputStream),i.init(a,1,0,!1),r=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(s.nsIConverterInputStream),r.init(i,"utf-8",i.available(),s.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),r.readString(i.available(),l),r.close(),i.close(),t(l.value)}catch(u){throw new Error((a&&a.path||"")+": "+u)}}),t}),define("requirejs-text!components/requirements/templates/layout.html",[],function(){return'<header class="u-mt progress-bar-section-margin-bottom">\n    <h3 class="heading">Progress</h3>\n\n    <div class="progress-bar progress-bar--<%= percent_completed %> u-mt- u-mb-">\n        <div class="progress-bar__bar"></div>\n    </div>\n</header>\n\n<div class="[ js-requirements-profile-region ]"></div>\n<div class="[ js-requirements-account-region ]"></div>\n<div class="[ js-requirements-other-region ]"></div>'}),define("components/requirements/views/layout",["base","requirejs-text!components/requirements/templates/layout.html"],function(e,t){return e.LayoutView.extend({template:_.template(t),regions:{profileRequirementsRegion:".js-requirements-profile-region",accountRequirementsRegion:".js-requirements-account-region",otherRequirementsRegion:".js-requirements-other-region"},templateHelpers:function(){return{percent_completed:this.percentCompleted()}},collectionEvents:{change:"progress",reset:"progress"},ui:{progress_bar:".progress-bar__bar"},progress:function(){this.ui.progress_bar.css({width:this.percentCompleted()+"%"})},percentCompleted:function(){var e=this.collection.where({is_optional:!1}).length,t=this.collection.where({is_completed:!0,is_optional:!1}).length;return Math.round(t/e*100)}})}),define("requirejs-text!components/requirements/templates/requirement.html",[],function(){return"<<%= url ? 'a href=\"' + url + '\"' : 'span' %>\n  <%= is_js ? 'data-js' : '' %>\n  class=\"\n    requirements__title\n    <%= is_completed ? 'requirements__title--completed' : '' %>\n    <%= is_pending   ? 'requirements__title'   : '' %>\n  \"\n>\n    <%= title %>\n<!--<%= is_optional ? '*' : '' %>-->\n\n</<%= url ? 'a' : 'span'%>>"}),define("components/requirements/views/requirement",["base","requirejs-text!components/requirements/templates/requirement.html"],function(e,t){return e.ItemView.extend({tagName:"li",className:"requirements__item",template:_.template(t),modelEvents:{change:"render"}})}),define("requirejs-text!components/requirements/templates/list.html",[],function(){return'<% if (show) { %>\n    <% if (show_heading) { %>\n        <header class="u-mt">\n            <h5 class="heading"><%= heading %></h5>\n        </header>\n    <% } %>\n\n    <ul class="list-bare [ js-list-region ]"></ul>\n<% } %>'}),define("components/requirements/views/list",["base","components/requirements/views/requirement","requirejs-text!components/requirements/templates/list.html"],function(e,t,i){return e.CompositeView.extend({template:_.template(i),templateHelpers:function(){return"Other"==this.options.heading&&(this.options.heading="Optional"),{heading:this.options.heading,show:this.collection.length>0,show_heading:"Optional"==this.options.heading}},childViewContainer:".js-list-region",childView:t})}),define("components/requirements/controller",["base","events","entities/user","components/requirements/views/layout","components/requirements/views/list"],function(e,t,i,n,s){return e.Controller.extend({initialize:function(e){this.region=e.region,this.user=i.current(),this.quiz_auto_loaded=!1,this.view=new n({collection:this.user.requirements}),this.listenTo(this.user.requirements,"reset",this.showLists),this.listenTo(t,"requirement:completed",this.onRequirementCompleted),this.listenTo(t,"requirement:pending",this.onRequirementPending),this.listenTo(t,"requirement:incompleted",this.onRequirementIncompleted),this.listenTo(this.view,"show",this.onShow),this.region.show(this.view)},onShow:function(){this.showLists()},showLists:function(){this.user.requirements.each(this.isRequirementJs,this),this.showList("profile",this.view.profileRequirementsRegion),this.showList("account",this.view.accountRequirementsRegion),this.showList("other",this.view.otherRequirementsRegion)},showList:function(e,t){var i=this.user.requirements.where({section:e}),n=new s({collection:new Backbone.Collection(i),heading:_.humanize(e)});t.show(n)},onRequirementCompleted:function(e){this.updateRequirement(_.extend({is_pending:!1,is_completed:!0},e)),this.isQuizOnlyLeft()&&this.redirectToTheQuiz()},isQuizOnlyLeft:function(){var e=this.user.requirements;return this.isProfileCompleted(e)&&this.isAccountCompleted(e)?this.isQuizCompleted(e)?!1:!0:!1},isProfileCompleted:function(e){return this.isSectionCompleted("profile",e)},isAccountCompleted:function(e){return this.isSectionCompleted("account",e)},isQuizCompleted:function(e){return this.isSectionCompleted("quiz",e)},isSectionCompleted:function(e,t){var i=!0;return _.each(t.models,function(t){var n=t.get("section"),s=t.get("is_completed");n!==e||s||(i=!1)},this),i},redirectToTheQuiz:function(){if(!this.quiz_auto_loaded){this.quiz_auto_loaded=!0,_.progress().done();var e=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid")})+"/quiz_intro";this.app.history.navigate(e,{trigger:!0})}},onRequirementPending:function(e){this.updateRequirement(_.extend({is_pending:!0,is_completed:!1},e))},onRequirementIncompleted:function(e){this.updateRequirement(_.extend({is_pending:!1,is_completed:!1},e))},updateRequirement:function(e){var t=this.user.requirements.findWhere(_.pick(e,"name","section"));t&&!t.get("is_completed")&&t.set(_.pick(e,"is_pending","is_completed"))},isRequirementJs:function(e){var t=_.camelize("is_"+e.get("name")+"_requirement_js");_.isFunction(this[t])&&e.set("is_js",this[t](_.config("route")))},isTaglineRequirementJs:function(e){return this.isProfileRequirementJs(e)},isRateRequirementJs:function(e){return this.isProfileRequirementJs(e)},isTravelPolicyRequirementJs:function(e){return this.isProfileRequirementJs(e)},isBioRequirementJs:function(e){return this.isProfileRequirementJs(e)},isProfilePictureRequirementJs:function(e){return this.isProfileRequirementJs(e)},isSubjectsRequirementJs:function(e){return this.isProfileRequirementJs(e)},isQualificationsRequirementJs:function(e){return this.isProfileRequirementJs(e)},isQualifiedTeacherStatusRequirementJs:function(e){return this.isProfileRequirementJs(e)},isQuizQuestionsRequirementJs:function(e){return this.isProfileRequirementJs(e)},isIdentificationRequirementJs:function(e){return this.isAccountRequirementJs(e)},isPaymentDetailsRequirementJs:function(e){return this.isAccountRequirementJs(e)},isDbsCheckRequirementJs:function(e){return!1},isProfileRequirementJs:function(e){return"tutor.profile.show"===e},isAccountRequirementJs:function(e){return _.startsWith(e,"tutor.account")}})}),define("components/requirements/component",["components/requirements/controller"],function(e){return function(){var t=$(".js-requirements");return t.length>0?(this.addRegions({requirementsRegion:t}),new e({app:this,region:this.requirementsRegion})):void 0}}),function(e){"use strict";"function"==typeof define&&define.amd?define("autocomplete",["jquery"],e):e("object"==typeof exports&&"function"==typeof require?require("jquery"):jQuery)}(function(e){"use strict";function t(i,n){var s=function(){},o=this,r={ajaxSettings:{},autoSelectFirst:!1,appendTo:document.body,serviceUrl:null,lookup:null,onSelect:null,width:"auto",minChars:1,maxHeight:300,deferRequestBy:0,params:{},formatResult:t.formatResult,delimiter:null,zIndex:9999,type:"GET",noCache:!1,onSearchStart:s,onSearchComplete:s,onSearchError:s,preserveInput:!1,containerClass:"autocomplete-suggestions",tabDisabled:!1,dataType:"text",currentRequest:null,triggerSelectOnValidInput:!0,preventBadQueries:!0,lookupFilter:function(e,t,i){return-1!==e.value.toLowerCase().indexOf(i)},paramName:"query",transformResult:function(t){return"string"==typeof t?e.parseJSON(t):t},showNoSuggestionNotice:!1,noSuggestionNotice:"No results",orientation:"bottom",forceFixPosition:!1};o.element=i,o.el=e(i),o.suggestions=[],o.badQueries=[],o.selectedIndex=-1,o.currentValue=o.element.value,o.intervalId=0,o.cachedResponse={},o.onChangeInterval=null,o.onChange=null,o.isLocal=!1,o.suggestionsContainer=null,o.noSuggestionsContainer=null,o.options=e.extend({},r,n),o.classes={selected:"autocomplete-selected",suggestion:"autocomplete-suggestion"},o.hint=null,o.hintValue="",o.selection=null,o.initialize(),o.setOptions(n)}var i=function(){return{escapeRegExChars:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},createNode:function(e){var t=document.createElement("div");return t.className=e,t.style.position="absolute",t.style.display="none",t}}}(),n={ESC:27,TAB:9,RETURN:13,LEFT:37,UP:38,RIGHT:39,DOWN:40};t.utils=i,e.Autocomplete=t,t.formatResult=function(e,t){var n="("+i.escapeRegExChars(t)+")";return e.value.replace(new RegExp(n,"gi"),"<strong>$1</strong>").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/&lt;(\/?strong)&gt;/g,"<$1>")},t.prototype={killerFn:null,initialize:function(){var i,n=this,s="."+n.classes.suggestion,o=n.classes.selected,r=n.options;n.element.setAttribute("autocomplete","off"),n.killerFn=function(t){0===e(t.target).closest("."+n.options.containerClass).length&&(n.killSuggestions(),n.disableKillerFn())},n.noSuggestionsContainer=e('<div class="autocomplete-no-suggestion"></div>').html(this.options.noSuggestionNotice).get(0),n.suggestionsContainer=t.utils.createNode(r.containerClass),i=e(n.suggestionsContainer),i.appendTo(r.appendTo),"auto"!==r.width&&i.width(r.width),i.on("mouseover.autocomplete",s,function(){n.activate(e(this).data("index"))}),i.on("mouseout.autocomplete",function(){n.selectedIndex=-1,i.children("."+o).removeClass(o)}),i.on("click.autocomplete",s,function(){n.select(e(this).data("index"))}),n.fixPositionCapture=function(){n.visible&&n.fixPosition()},e(window).on("resize.autocomplete",n.fixPositionCapture),n.el.on("keydown.autocomplete",function(e){n.onKeyPress(e)}),n.el.on("keyup.autocomplete",function(e){n.onKeyUp(e)}),n.el.on("blur.autocomplete",function(){n.onBlur()}),n.el.on("focus.autocomplete",function(){n.onFocus()}),n.el.on("change.autocomplete",function(e){n.onKeyUp(e)}),n.el.on("input.autocomplete",function(e){n.onKeyUp(e)})},onFocus:function(){var e=this;e.fixPosition(),0===e.options.minChars&&0===e.el.val().length&&e.onValueChange()},onBlur:function(){this.enableKillerFn()},abortAjax:function(){var e=this;e.currentRequest&&(e.currentRequest.abort(),e.currentRequest=null)},setOptions:function(t){var i=this,n=i.options;e.extend(n,t),i.isLocal=e.isArray(n.lookup),i.isLocal&&(n.lookup=i.verifySuggestionsFormat(n.lookup)),n.orientation=i.validateOrientation(n.orientation,"bottom"),e(i.suggestionsContainer).css({"max-height":n.maxHeight+"px",width:n.width+"px","z-index":n.zIndex})},clearCache:function(){this.cachedResponse={},this.badQueries=[]},clear:function(){this.clearCache(),this.currentValue="",this.suggestions=[]},disable:function(){var e=this;e.disabled=!0,clearInterval(e.onChangeInterval),e.abortAjax()},enable:function(){this.disabled=!1},fixPosition:function(){var t=this,i=e(t.suggestionsContainer),n=i.parent().get(0);if(n===document.body||t.options.forceFixPosition){var s=t.options.orientation,o=i.outerHeight(),r=t.el.outerHeight(),a=t.el.offset(),l={top:a.top,left:a.left};if("auto"===s){var u=e(window).height(),c=e(window).scrollTop(),d=-c+a.top-o,h=c+u-(a.top+r+o);s=Math.max(d,h)===d?"top":"bottom"}if("top"===s?l.top+=-o:l.top+=r,n!==document.body){var p,f=i.css("opacity");t.visible||i.css("opacity",0).show(),p=i.offsetParent().offset(),l.top-=p.top,l.left-=p.left,t.visible||i.css("opacity",f).hide()}"auto"===t.options.width&&(l.width=t.el.outerWidth()-2+"px"),i.css(l)}},enableKillerFn:function(){var t=this;e(document).on("click.autocomplete",t.killerFn)},disableKillerFn:function(){var t=this;e(document).off("click.autocomplete",t.killerFn)},killSuggestions:function(){var e=this;e.stopKillSuggestions(),e.intervalId=window.setInterval(function(){e.visible&&(e.el.val(e.currentValue),e.hide()),e.stopKillSuggestions()},50)},stopKillSuggestions:function(){window.clearInterval(this.intervalId)},isCursorAtEnd:function(){var e,t=this,i=t.el.val().length,n=t.element.selectionStart;return"number"==typeof n?n===i:document.selection?(e=document.selection.createRange(),e.moveStart("character",-i),i===e.text.length):!0},onKeyPress:function(e){var t=this;if(!t.disabled&&!t.visible&&e.which===n.DOWN&&t.currentValue)return void t.suggest();if(!t.disabled&&t.visible){switch(e.which){case n.ESC:t.el.val(t.currentValue),t.hide();break;case n.RIGHT:if(t.hint&&t.options.onHint&&t.isCursorAtEnd()){t.selectHint();break}return;case n.TAB:if(t.hint&&t.options.onHint)return void t.selectHint();if(-1===t.selectedIndex)return void t.hide();if(t.select(t.selectedIndex),t.options.tabDisabled===!1)return;break;case n.RETURN:if(-1===t.selectedIndex)return void t.hide();t.select(t.selectedIndex);break;case n.UP:t.moveUp();break;case n.DOWN:t.moveDown();break;default:return}e.stopImmediatePropagation(),e.preventDefault()}},onKeyUp:function(e){var t=this;if(!t.disabled){switch(e.which){case n.UP:case n.DOWN:return}clearInterval(t.onChangeInterval),t.currentValue!==t.el.val()&&(t.findBestHint(),t.options.deferRequestBy>0?t.onChangeInterval=setInterval(function(){t.onValueChange()},t.options.deferRequestBy):t.onValueChange())}},onValueChange:function(){var t=this,i=t.options,n=t.el.val(),s=t.getQuery(n);return t.selection&&t.currentValue!==s&&(t.selection=null,(i.onInvalidateSelection||e.noop).call(t.element)),clearInterval(t.onChangeInterval),t.currentValue=n,t.selectedIndex=-1,i.triggerSelectOnValidInput&&t.isExactMatch(s)?void t.select(0):void(s.length<i.minChars?t.hide():t.getSuggestions(s))},isExactMatch:function(e){var t=this.suggestions;return 1===t.length&&t[0].value.toLowerCase()===e.toLowerCase()},getQuery:function(t){var i,n=this.options.delimiter;return n?(i=t.split(n),e.trim(i[i.length-1])):t},getSuggestionsLocal:function(t){var i,n=this,s=n.options,o=t.toLowerCase(),r=s.lookupFilter,a=parseInt(s.lookupLimit,10);return i={suggestions:e.grep(s.lookup,function(e){return r(e,t,o)})},a&&i.suggestions.length>a&&(i.suggestions=i.suggestions.slice(0,a)),i},getSuggestions:function(t){var i,n,s,o,r=this,a=r.options,l=a.serviceUrl;if(a.params[a.paramName]=t,n=a.ignoreParams?null:a.params,a.onSearchStart.call(r.element,a.params)!==!1){if(e.isFunction(a.lookup))return void a.lookup(t,function(e){r.suggestions=e.suggestions,r.suggest(),a.onSearchComplete.call(r.element,t,e.suggestions)});r.isLocal?i=r.getSuggestionsLocal(t):(e.isFunction(l)&&(l=l.call(r.element,t)),s=l+"?"+e.param(n||{}),i=r.cachedResponse[s]),i&&e.isArray(i.suggestions)?(r.suggestions=i.suggestions,r.suggest(),a.onSearchComplete.call(r.element,t,i.suggestions)):r.isBadQuery(t)?a.onSearchComplete.call(r.element,t,[]):(r.abortAjax(),o={url:l,data:n,type:a.type,dataType:a.dataType},e.extend(o,a.ajaxSettings),r.currentRequest=e.ajax(o).done(function(e){var i;r.currentRequest=null,i=a.transformResult(e,t),r.processResponse(i,t,s),a.onSearchComplete.call(r.element,t,i.suggestions)}).fail(function(e,i,n){a.onSearchError.call(r.element,t,e,i,n)}))}},isBadQuery:function(e){if(!this.options.preventBadQueries)return!1;for(var t=this.badQueries,i=t.length;i--;)if(0===e.indexOf(t[i]))return!0;return!1},hide:function(){var t=this,i=e(t.suggestionsContainer);e.isFunction(t.options.onHide)&&t.visible&&t.options.onHide.call(t.element,i),t.visible=!1,t.selectedIndex=-1,clearInterval(t.onChangeInterval),e(t.suggestionsContainer).hide(),t.signalHint(null)},suggest:function(){if(0===this.suggestions.length)return void(this.options.showNoSuggestionNotice?this.noSuggestions():this.hide());var t,i=this,n=i.options,s=n.groupBy,o=n.formatResult,r=i.getQuery(i.currentValue),a=i.classes.suggestion,l=i.classes.selected,u=e(i.suggestionsContainer),c=e(i.noSuggestionsContainer),d=n.beforeRender,h="",p=function(e,i){var n=e.data[s];return t===n?"":(t=n,'<div class="autocomplete-group"><strong>'+t+"</strong></div>")};return n.triggerSelectOnValidInput&&i.isExactMatch(r)?void i.select(0):(e.each(i.suggestions,function(e,t){s&&(h+=p(t,r,e)),h+='<div class="'+a+'" data-index="'+e+'">'+o(t,r)+"</div>"}),this.adjustContainerWidth(),c.detach(),u.html(h),e.isFunction(d)&&d.call(i.element,u),i.fixPosition(),u.show(),n.autoSelectFirst&&(i.selectedIndex=0,u.scrollTop(0),u.children("."+a).first().addClass(l)),i.visible=!0,void i.findBestHint())},noSuggestions:function(){var t=this,i=e(t.suggestionsContainer),n=e(t.noSuggestionsContainer);this.adjustContainerWidth(),n.detach(),i.empty(),i.append(n),t.fixPosition(),i.show(),t.visible=!0},adjustContainerWidth:function(){var t,i=this,n=i.options,s=e(i.suggestionsContainer);"auto"===n.width&&(t=i.el.outerWidth()-2,s.width(t>0?t:300))},findBestHint:function(){var t=this,i=t.el.val().toLowerCase(),n=null;i&&(e.each(t.suggestions,function(e,t){var s=0===t.value.toLowerCase().indexOf(i);return s&&(n=t),!s}),t.signalHint(n))},signalHint:function(t){var i="",n=this;t&&(i=n.currentValue+t.value.substr(n.currentValue.length)),n.hintValue!==i&&(n.hintValue=i,n.hint=t,(this.options.onHint||e.noop)(i))},verifySuggestionsFormat:function(t){return t.length&&"string"==typeof t[0]?e.map(t,function(e){return{value:e,data:null}}):t},validateOrientation:function(t,i){return t=e.trim(t||"").toLowerCase(),-1===e.inArray(t,["auto","bottom","top"])&&(t=i),t},processResponse:function(e,t,i){var n=this,s=n.options;e.suggestions=n.verifySuggestionsFormat(e.suggestions),s.noCache||(n.cachedResponse[i]=e,s.preventBadQueries&&0===e.suggestions.length&&n.badQueries.push(t)),t===n.getQuery(n.currentValue)&&(n.suggestions=e.suggestions,n.suggest())},activate:function(t){var i,n=this,s=n.classes.selected,o=e(n.suggestionsContainer),r=o.find("."+n.classes.suggestion);return o.find("."+s).removeClass(s),n.selectedIndex=t,-1!==n.selectedIndex&&r.length>n.selectedIndex?(i=r.get(n.selectedIndex),e(i).addClass(s),i):null},selectHint:function(){var t=this,i=e.inArray(t.hint,t.suggestions);t.select(i)},select:function(e){var t=this;t.hide(),t.onSelect(e)},moveUp:function(){var t=this;if(-1!==t.selectedIndex)return 0===t.selectedIndex?(e(t.suggestionsContainer).children().first().removeClass(t.classes.selected),t.selectedIndex=-1,t.el.val(t.currentValue),void t.findBestHint()):void t.adjustScroll(t.selectedIndex-1)},moveDown:function(){var e=this;e.selectedIndex!==e.suggestions.length-1&&e.adjustScroll(e.selectedIndex+1)},adjustScroll:function(t){var i=this,n=i.activate(t);if(n){var s,o,r,a=e(n).outerHeight();s=n.offsetTop,o=e(i.suggestionsContainer).scrollTop(),r=o+i.options.maxHeight-a,o>s?e(i.suggestionsContainer).scrollTop(s):s>r&&e(i.suggestionsContainer).scrollTop(s-i.options.maxHeight+a),i.options.preserveInput||i.el.val(i.getValue(i.suggestions[t].value)),i.signalHint(null)}},onSelect:function(t){var i=this,n=i.options.onSelect,s=i.suggestions[t];i.currentValue=i.getValue(s.value),i.currentValue===i.el.val()||i.options.preserveInput||i.el.val(i.currentValue),i.signalHint(null),i.suggestions=[],i.selection=s,e.isFunction(n)&&n.call(i.element,s)},getValue:function(e){var t,i,n=this,s=n.options.delimiter;return s?(t=n.currentValue,i=t.split(s),1===i.length?e:t.substr(0,t.length-i[i.length-1].length)+e):e},dispose:function(){var t=this;t.el.off(".autocomplete").removeData("autocomplete"),t.disableKillerFn(),e(window).off("resize.autocomplete",t.fixPositionCapture),e(t.suggestionsContainer).remove()}},e.fn.autocomplete=e.fn.devbridgeAutocomplete=function(i,n){var s="autocomplete";return 0===arguments.length?this.first().data(s):this.each(function(){var o=e(this),r=o.data(s);"string"==typeof i?r&&"function"==typeof r[i]&&r[i](n):(r&&r.dispose&&r.dispose(),r=new t(this,i),o.data(s,r))})}}),define("components/autocomplete/controller",["base","autocomplete"],function(e,t){return e.Controller.extend({initialize:function(e){var t=$(e.el),i=_.camelize("autocomplete_"+t.data("autocomplete"));_.isFunction(this[i])&&this[i](t)},autocompleteTutors:function(e){var t=$("<input>",{type:"hidden",name:e.attr("name")});e.after(t),e.autocomplete({serviceUrl:"/api/autocomplete/tutors",onSelect:function(e){t.attr("value",e.data)},transformResult:function(e){return e=JSON.parse(e),{suggestions:$.map(e.data,function(e){return{value:e.value,data:e.data}})}}})},autocompleteStudents:function(e){var t=$("<input>",{type:"hidden",name:e.attr("name")});e.after(t),e.autocomplete({serviceUrl:"/api/autocomplete/students",onSelect:function(e){t.attr("value",e.data)},transformResult:function(e){return e=JSON.parse(e),{suggestions:$.map(e.data,function(e){return{value:e.value,data:e.data}})}}})},autocompleteSearch:function(e){e.autocomplete({serviceUrl:"/api/autocomplete/search",onSelect:function(e){window.location=e.data},transformResult:function(e){return e=JSON.parse(e),{suggestions:$.map(e.data,function(e){return{value:e.value,data:e.data}})}}})}})}),define("components/autocomplete/component",["components/autocomplete/controller"],function(e){return function(){var t=$(".js-autocomplete");t.each(function(t,i){new e({app:this,el:i})})}}),define("components/scrolltabs/controller",["base","underscore"],function(e,t){return e.Controller.extend({initialize:function(e){var i=".scrollable--arrows--wrapper .arrow",n=$("body");n.on("mousedown",i,t.bind(this.startScrolling,this)),n.on("mouseup",i,t.bind(this.stopScrolling,this))},startScrolling:function(e){var i=$(e.target),n=i.parent(".scrollable--arrows--wrapper");this.scrollable=n.find(".tabs--scrollable"),this.tabList=n.find(".tabs__list"),this.leftArrow=n.find(".arrow--left"),this.rightArrow=n.find(".arrow--right");var s=i.hasClass("arrow--left");s?this.timer=setInterval(t.bind(this.shiftTabToRight,this),50):this.timer=setInterval(t.bind(this.shiftTabToLeft,this),50)},stopScrolling:function(){clearInterval(this.timer)},shiftTabToLeft:function(){this.shiftTab("left")},shiftTabToRight:function(){this.shiftTab("right")},shiftTab:function(e){var t=this.scrollable.scrollLeft(),i=this.tabList.offset().left,n=i+this.tabList.outerWidth(),s=this.rightArrow.offset().left,o=15,r="left"===e,a="right"===e;return 0>=t&&a||s>=n&&r?void this.stopScrolling():(r?t+=o:t-=o,void this.scrollable.scrollLeft(t))}})}),define("components/scrolltabs/component",["components/scrolltabs/controller"],function(e){return function(){new e({app:this})}}),define("apps/autocomplete/subjects/views/layout",["base"],function(e){return e.LayoutView.extend({regions:{listRegion:".js-region-list"},ui:{input:".js-autocomplete-input"},events:{"keyup @ui.input":"onInputKeyup","blur @ui.input":"onInputBlur"},initialize:function(){this.bindUIElements(),
this.ui.input.attr("autocomplete","off")},onInputKeyup:function(e){this.trigger("search",this.ui.input.val())},onInputBlur:function(e){setTimeout(_.bind(function(){this.trigger("close")},this),100)}})}),define("apps/autocomplete/subjects/views/item",["base"],function(e){return e.ItemView.extend({template:_.template("<%= title %>"),tagName:"li",className:"autocomplete__item",events:{click:"onClick"},onClick:function(){this.trigger("fill",this.model.get("title"))}})}),define("apps/autocomplete/subjects/views/collection",["base","apps/autocomplete/subjects/views/item"],function(e,t){return e.CollectionView.extend({childView:t,tagName:"ul",className:"autocomplete__list",childEvents:{fill:function(e,t){this.trigger("fill",t)}}})}),define("apps/autocomplete/subjects/controller",["base","underscore.string","entities/subject","apps/autocomplete/subjects/views/layout","apps/autocomplete/subjects/views/collection"],function(e,t,i,n,s){return _.patch(e.Controller.extend({initialize:function(t){this.$el=t.$el,this._subjects=i.collection(),this.subjects=new e.Collection,this.$el.append('<div class="js-region-list" />'),this.view=new n({el:this.$el,collection:this.subjects}),this.listenToOnce(this._subjects,"sync",this.onSync),this.listenTo(this.view,"search",this.search),this.listenTo(this.view,"close",this.closeAutocomplete),this.$el.one("click keydown",_.bind(function(){this._subjects.fetch()},this))},onSync:function(){var e=_.bind(function(t){var i=t.get("children");i.length>0&&_.each(i,e),this.subjects.push(t)},this);this._subjects.each(e)},normalizeQuery:function(e){return e?e.toLowerCase().replace(/[^a-z0-9]+/g,""):""},extractTerms:function(e){return e=e.replace("-",""),e=e.split(" "),_.map(e,this.normalizeQuery)},search:function(t){if(this.closeAutocomplete(),!(t.length<3)){t=this.extractTerms(t);var i=new e.Collection(this.subjects.filter(function(e){if(0===e.get("depth"))return!1;var i=this.normalizeQuery(e.get("title")),n=_.reduce(t,function(e,t){return e+(i.indexOf(t)>-1?1:0)},0);return n<t.length?!1:(e.set("score",e.get("depth")),e)},this)),n=new e.Collection(i.sortBy("score").slice(0,10)),o=new s({collection:n});this.listenTo(o,"fill",this.fill),this.view.listRegion.show(o)}},fill:function(e){this.closeAutocomplete(),this.view.ui.input.val(e)},closeAutocomplete:function(){var e=_.tipped();e.hide(".tipped"),this.view.listRegion&&this.view.listRegion.currentView&&(this.stopListening(this.view.listRegion.currentView),this.view.listRegion.currentView.destroy())}}))}),define("apps/autocomplete/controller",["base","apps/autocomplete/subjects/controller"],function(e,t){return e.Controller.extend({initialize:function(e){e=_.isObject(e)?e:{};var t=$(".js-autocomplete");t.each(_.bind(function(t,i){var n=$(i),s=n.data("autocomplete");if(s){var o=_.camelize(s);this[o]&&this[o](n,e)}},this))},subjects:function(e,i){return new t(_.extend({$el:e},i))}})}),define("apps/autocomplete/app",["apps/autocomplete/controller"],function(e){return function(){return new e({app:this})}}),define("requirejs-text!apps/toasts/toast/templates/item.html",[],function(){return'<div class="toasts__content toasts__content--<%= severity%>">\n    <div class="toasts__body">\n        <%= message %>\n    </div>\n</div>'}),define("apps/toasts/toast/views/item",["base","requirejs-text!apps/toasts/toast/templates/item.html"],function(e,t){return e.ItemView.extend({tagName:"li",className:"toasts__item",template:_.template(t)})}),define("apps/toasts/toast/views/collection",["base","apps/toasts/toast/views/item"],function(e,t){return e.CollectionView.extend({tagName:"ul",className:"toasts",childView:t,initialize:function(){this.listenTo(this.collection,"add",function(e){this.collection.length>5&&this.collection.first().destroy(),setTimeout(function(){e.destroy()},e.get("duration"))})}})}),define("apps/toasts/toast/controller",["base","events","apps/toasts/toast/views/collection","apps/toasts/toast/views/item"],function(e,t,i){return e.Controller.extend({initialize:function(t){this.region=t.region,this.collection=new e.Collection,this.view=new i({collection:this.collection}),this.listenTo(this.view,"show",this.onShow),this.region.show(this.view)},onShow:function(){this.listenTo(t,"toast",this.toast);var e=_.config("toasts");e&&!_.isEmpty(e)&&_.each(e,function(e){this.toast(e.message,e.severity,e.duration)},this)},toast:function(t,i,n){i=i||"info",n=n||5e3,this.collection.add(new e.Model({message:t,severity:i,duration:n}))}})}),define("apps/toasts/controller",["base","apps/toasts/toast/controller"],function(e,t){return e.Controller.extend({initialize:function(e){return e=_.isObject(e)?e:{},new t(_.extend({app:this.app,region:this.app.toastRegion},e))}})}),define("apps/toasts/app",["apps/toasts/controller"],function(e,t){return function(){new e({app:this})}}),define("entities/session",["base"],function(e){var t=e.Model.extend({urlRoot:"/api/sessions",defaults:{email:null,password:null,remember_me:null},validation:{email:[{required:!0,msg:"The email field is required."},{maxLength:255,msg:"The email field must not be greater than 255 characters."},{pattern:"email",msg:"The email must be a valid email address."}],password:[{required:!0,msg:"The password field is required."},{minLength:6,msg:"The password field must be greater than 6 characters."}],remember_me:[{"boolean":!0,msg:"The remember me field must be true or false."}]}});return{model:function(e,i){return new t(e,i)}}}),define("requirejs-text!apps/auth/login/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container dialogue__container--tiny">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.auth.login.heading\') %></h4>\n                    <a href="#" class="close icon icon--cross [ js-close ]"></a>\n                </header>\n\n                <form class="layout js-form" novalidate><!--\n                    --><div class="layout__item field">\n                        <input type="email" class="field__input input input--full input--squared input--bordered js-email" name="email" placeholder="Email">\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item field">\n                        <input type="password" class="field__input input input--full input--squared input--bordered js-password" name="password" placeholder="Password">\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item field">\n                        <div class="field__checkbox checkbox checkbox--checked">\n                            <div class="checkbox__box">\n                                <div class="checkbox__tick"></div>\n                                <input type="checkbox" name="remember_me" id="remember_me" value="1" class="checkbox__input js-remember-me" checked="checked">\n                            </div>\n                            <label class="checkbox__label">Remember me</label>\n                        </div>\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item u-mt-">\n                        <button class="btn btn--full [ js-submit ]">Log In</button>\n                    </div><!--\n\n                    --><div class="layout__item u-mt tac">\n                        <a href="<%= laroute.route(\'password.index\') %>" class="tiny">Lost Password?</a>\n                    </div><!--\n                --></form>\n\n                <nav class="dialogue__nav">\n                    <a href="<%= laroute.route(\'register.student\') %>" data-js class="epsilon">\n                        <%= _.lang(\'dialogue.register.student.heading.default\') %><span class="icon icon--nav-right--dark"></span>\n                    </a>\n\n                    <a href="<%= laroute.route(\'register.tutor\') %>" data-js class="epsilon">\n                        <%= _.lang(\'dialogue.register.tutor.heading\') %><span class="icon icon--nav-right--dark"></span>\n                    </a>\n                </nav>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay [ js-close ]"></div>'}),define("apps/auth/login/views/layout",["base","requirejs-text!apps/auth/login/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(t),ui:{email:".js-email",password:".js-password",remember_me:".js-remember-me"},fields:["email","password","remember_me"]}))}),define("apps/auth/login/controller",["base","entities/session","entities/user","apps/auth/login/views/layout"],function(e,t,i,n){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.region=e.region,this.session=new t.model,this.view=new n({model:this.session}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.session,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.session,"sync",this.onSyncSuccess),this.listenTo(this.session,"error",this.onSyncError),this.listenTo(this.session,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){this.session.save(e)},onSyncSuccess:function(e,t){return i.set(t.data),this.app.callbacks.authenticate?_.callback(this.app.callbacks.authenticate):window.location=t.meta.redirect},onDestroy:function(){var e=laroute.route("home");this.app.history.back(e)}}))}),define("apps/auth/controller",["base","apps/auth/login/controller"],function(e,t){return e.Controller.extend({login:function(e){return e=_.isObject(e)?e:{},new t(_.extend({app:this.app,region:this.app.dialogueRegion},e))}})}),define("apps/auth/router",["base"],function(e){return e.Router.extend({routes:{login:laroute.route("auth.login")},login:function(){this.controller.login()}})}),define("apps/auth/app",["apps/auth/controller","apps/auth/router"],function(e,t){return function(){var i=new e({app:this});return new t({controller:i})}}),define("requirejs-text!apps/register/student/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading">\n                        <%= _.lang(\'dialogue.register.student.heading.\' + attempted_action) %>\n                    </h4>\n                    <a href="#" class="close icon icon--cross js-close"></a>\n                </header>\n\n                <form class="layout js-form"><!--\n                    --><div class="layout__item  u-1/2-tablet-and-up field">\n                        <input type="text" name="first_name" placeholder="First Name"\n                          class="field__input input input--full input--squared input--bordered js-first-name">\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item  u-1/2-tablet-and-up field">\n                        <input type="text" name="last_name" placeholder="Last Name"\n                          class="field__input input input--full input--squared input--bordered js-last-name">\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item  u-1/2-tablet-and-up field">\n                        <input type="email" name="email" placeholder="Email"\n                          class="field__input input input--full input--squared input--bordered js-email">\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item  u-1/2-tablet-and-up field">\n                        <input type="tel" name="telephone" placeholder="Telephone" class="field__input input input--full input--squared input--bordered js-telephone">\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item  u-1/2-tablet-and-up field">\n                        <input type="text" name="subject" placeholder="Subject" class="field__input input input--full input--squared input--bordered js-subject">\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item  u-1/2-tablet-and-up field">\n                        <input type="text" name="postcode" placeholder="Postcode" class="field__input input input--full input--squared input--bordered js-postcode">\n                        <div class="field__error"></div>\n                    </div>\n                    <div class="layout__item field">\n                        <textarea name="body" placeholder="Tell us more about what you are looking for" class="[ input input--full input--squared input--bordered ] field__textarea [ js-body ]" ></textarea>\n                    </div>\n                    <div class="layout__item  u-1/2-tablet-and-up field">\n                        <input type="password" name="password"\n                          placeholder="<%= _.lang(\'dialogue.register.student.placeholder.password.\' + attempted_action) %>"\n                          class="field__input input input--full input--squared input--bordered js-password">\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item  u-1/2-tablet-and-up">\n                        <button class="btn btn--full js-submit"><%= _.lang(\'dialogue.register.student.submit.\' + attempted_action) %></button>\n                    </div><!--\n\n                    --><div class="layout__item u-mt tac">\n                        <p class="tiny">By clicking this button you&#39;re agreeing to our <a href="<%= laroute.route(\'terms.student\') %>">Terms &amp; Conditions</a></>\n                    </div><!--\n                --></form>\n\n                <nav class="dialogue__nav">\n                    <a href="<%= laroute.route(\'auth.login\') %>" data-js class="epsilon">\n                        <%= _.lang(\'dialogue.auth.login.heading\') %><span class="icon icon--nav-right--dark"></span>\n                    </a>\n\n                    <a href="<%= laroute.route(\'register.tutor\') %>" data-js class="epsilon">\n                        <%= _.lang(\'dialogue.register.tutor.heading\') %><span class="icon icon--nav-right--dark"></span>\n                    </a>\n                </nav>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay"></div>\n'}),define("apps/register/student/views/layout",["base","requirejs-text!apps/register/student/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(t),templateHelpers:function(){return{attempted_action:this.options.attempted_action}},ui:{a:"a[data-js]",first_name:".js-first-name",last_name:".js-last-name",email:".js-email",telephone:".js-telephone",subject:".js-subject",postcode:".js-postcode",body:".js-body",password:".js-password"},fields:["first_name","last_name","email","telephone","subject","postcode","body","password"],events:{"click @ui.a":"onClickA"},onClickA:function(e){this.destroy()}}))}),define("apps/register/student/controller",["base","entities/user","apps/register/student/views/layout"],function(e,t,i){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.region=e.region,this.user=new t.model,this.view=new i({model:this.user,attempted_action:e.attempted_action||"default"}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){e.account="student",this.user.save(e)},onSyncSuccess:function(e,i){return t.set(i.data),this.app.callbacks.authenticate?_.callback(this.app.callbacks.authenticate):window.location=i.meta.redirect},onDestroy:function(){var e=laroute.route("home");this.app.history.back(e)}}))}),define("requirejs-text!apps/register/tutor/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container dialogue__container--tiny">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.register.tutor.heading\') %></h4>\n                    <a href="#" class="close icon icon--cross js-close"></a>\n                </header>\n\n                <form class="layout js-form" autocomplete="off"><!--\n                    --><div class="layout__item field">\n                        <input type="text" name="first_name" placeholder="First Name" class="field__input input input--full input--squared input--bordered js-first-name">\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item field">\n                        <input type="text" name="last_name" placeholder="Last Name" class="field__input input input--full input--squared input--bordered js-last-name">\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item field">\n                        <input type="email" name="email" placeholder="Email" class="field__input input input--full input--squared input--bordered js-email">\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item field">\n                        <input type="tel" name="telephone" placeholder="Telephone" class="field__input input input--full input--squared input--bordered js-telephone">\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item field">\n                        <input type="password" name="password" placeholder="Password" class="field__input input input--full input--squared input--bordered js-password">\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item u-mt-">\n                        <button class="btn btn--full js-submit">Create Account</button>\n                    </div><!--\n\n                    --><div class="layout__item u-mt tac">\n                        <p class="tiny">By creating your account, you&#39;re agreeing to our <a href="<%= laroute.route(\'terms.student\') %>">Terms &amp; Conditions</a> and the\n                          <a href="https://stripe.com/connect/account-terms" target="_blank">Stripe Connected Account Agreement</a>.</p>\n                    </div><!--\n                --></form>\n\n                <nav class="dialogue__nav">\n                    <a href="<%= laroute.route(\'auth.login\') %>" data-js class="epsilon">\n                        <%= _.lang(\'dialogue.auth.login.heading\') %><span class="icon icon--nav-right--dark"></span>\n                    </a>\n\n                    <a href="<%= laroute.route(\'register.student\') %>" data-js class="epsilon">\n                        <%= _.lang(\'dialogue.register.student.heading.default\') %><span class="icon icon--nav-right--dark"></span>\n                    </a>\n                </nav>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay [ js-close ]"></div>\n'}),define("apps/register/tutor/views/layout",["base","requirejs-text!apps/register/tutor/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(t),ui:{a:"a[data-js]",first_name:".js-first-name",last_name:".js-last-name",email:".js-email",telephone:".js-telephone",password:".js-password"},fields:["first_name","last_name","email","telephone","password"],events:{"click @ui.a":"onClickA"},onClickA:function(e){this.destroy()}}))}),define("apps/register/tutor/controller",["base","entities/user","apps/register/tutor/views/layout"],function(e,t,i){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.region=e.region,this.user=new t.model,this.view=new i({model:this.user}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){e.account="tutor",this.user.save(e)},onSyncSuccess:function(e,i){return t.set(i.data),this.app.callbacks.authenticate?_.callback(this.app.callbacks.authenticate):window.location=i.meta.redirect},onDestroy:function(){var e=laroute.route("tutor.index");this.app.history.back(e)}}))}),define("apps/register/controller",["base","events","apps/register/student/controller","apps/register/tutor/controller"],function(e,t,i,n,s){return e.Controller.extend({initialize:function(){this.listenTo(t,"register.student",this.student)},student:function(e){return e=_.isObject(e)?e:{},new i(_.extend({app:this.app,region:this.app.dialogueRegion},e))},tutor:function(e){return e=_.isObject(e)?e:{},new n(_.extend({app:this.app,region:this.app.dialogueRegion},e))}})}),define("apps/register/router",["base"],function(e){return e.Router.extend({routes:{student:laroute.route("register.student"),tutor:laroute.route("register.tutor")},student:function(){this.controller.student()},tutor:function(){this.controller.tutor()}})}),define("apps/register/app",["apps/register/controller","apps/register/router"],function(e,t){return function(){var i=new e({app:this});return new t({controller:i})}}),define("apps/search/controller",["base"],function(e){return e.Controller.extend({index:function(e){e=_.isObject(e)?e:{};var t=_.tipped();t.create(".tipped",{skin:"lightyellow",close:!0,hideOn:!1,showOn:!1,position:"left",size:"large",onShow:function(e,t){$(t).addClass("highlight"),setTimeout(function(){$(t).removeClass("highlight")},300)}}).show(),$('input[name="location"]').on("focus",function(e){t.hide(".tipped")}),$(".results__item").on("click",function(e){$this=$(this);var t=$this.data("href");t&&(window.location=t)})}})}),define("apps/search/router",["base"],function(e){return e.Router.extend({routes:{index:"/search/*anything"},index:function(){this.controller.index()}})}),define("apps/search/app",["apps/search/controller","apps/search/router"],function(e,t){return function(){var i=new e({app:this});return new t({controller:i})}}),define("apps/tutors/edit/views/tagline",["base"],function(e){return e.ItemView.extend({template:!1,initialize:function(){this.listenTo(this.model,"sync",this.taglineChanged)},taglineChanged:function(){var e=this.model.profile.get("tagline");e&&this.$el.html(e)}})}),function(e){"function"==typeof define&&define.amd?define("dropzone",["jquery"],e):e(jQuery)}(function(e){var t={exports:{}};return function(){var i,n,s,o,r,a,l,u,c=[].slice,d={}.hasOwnProperty,h=function(e,t){function i(){this.constructor=e}for(var n in t)d.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};l=function(){},n=function(){function e(){}return e.prototype.addEventListener=e.prototype.on,e.prototype.on=function(e,t){return this._callbacks=this._callbacks||{},this._callbacks[e]||(this._callbacks[e]=[]),this._callbacks[e].push(t),this},e.prototype.emit=function(){var e,t,i,n,s,o;if(n=arguments[0],e=2<=arguments.length?c.call(arguments,1):[],this._callbacks=this._callbacks||{},i=this._callbacks[n])for(s=0,o=i.length;o>s;s++)t=i[s],t.apply(this,e);return this},e.prototype.removeListener=e.prototype.off,e.prototype.removeAllListeners=e.prototype.off,e.prototype.removeEventListener=e.prototype.off,e.prototype.off=function(e,t){var i,n,s,o,r;if(!this._callbacks||0===arguments.length)return this._callbacks={},this;if(n=this._callbacks[e],!n)return this;if(1===arguments.length)return delete this._callbacks[e],this;for(s=o=0,r=n.length;r>o;s=++o)if(i=n[s],i===t){n.splice(s,1);break}return this},e}(),i=function(e){function t(e,n){var s,o,r;if(this.element=e,this.version=t.version,this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,""),this.clickableElements=[],this.listeners=[],this.files=[],"string"==typeof this.element&&(this.element=document.querySelector(this.element)),!this.element||null==this.element.nodeType)throw new Error("Invalid dropzone element.");if(this.element.dropzone)throw new Error("Dropzone already attached.");if(t.instances.push(this),this.element.dropzone=this,s=null!=(r=t.optionsForElement(this.element))?r:{},this.options=i({},this.defaultOptions,s,null!=n?n:{}),this.options.forceFallback||!t.isBrowserSupported())return this.options.fallback.call(this);if(null==this.options.url&&(this.options.url=this.element.getAttribute("action")),!this.options.url)throw new Error("No URL provided.");if(this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");this.options.acceptedMimeTypes&&(this.options.acceptedFiles=this.options.acceptedMimeTypes,delete this.options.acceptedMimeTypes),this.options.method=this.options.method.toUpperCase(),(o=this.getExistingFallback())&&o.parentNode&&o.parentNode.removeChild(o),this.options.previewsContainer!==!1&&(this.options.previewsContainer?this.previewsContainer=t.getElement(this.options.previewsContainer,"previewsContainer"):this.previewsContainer=this.element),this.options.clickable&&(this.options.clickable===!0?this.clickableElements=[this.element]:this.clickableElements=t.getElements(this.options.clickable,"clickable")),this.init()}var i,s;return h(t,e),t.prototype.Emitter=n,t.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"],t.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,parallelUploads:2,uploadMultiple:!1,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,filesizeBase:1e3,maxFiles:null,filesizeBase:1e3,params:{},clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,capture:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",accept:function(e,t){return t()},init:function(){return l},forceFallback:!1,fallback:function(){var e,i,n,s,o,r;for(this.element.className=""+this.element.className+" dz-browser-not-supported",r=this.element.getElementsByTagName("div"),s=0,o=r.length;o>s;s++)e=r[s],/(^| )dz-message($| )/.test(e.className)&&(i=e,e.className="dz-message");return i||(i=t.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(i)),n=i.getElementsByTagName("span")[0],n&&(n.textContent=this.options.dictFallbackMessage),this.element.appendChild(this.getFallbackForm())},resize:function(e){var t,i,n;return t={srcX:0,srcY:0,srcWidth:e.width,srcHeight:e.height},i=e.width/e.height,t.optWidth=this.options.thumbnailWidth,t.optHeight=this.options.thumbnailHeight,null==t.optWidth&&null==t.optHeight?(t.optWidth=t.srcWidth,t.optHeight=t.srcHeight):null==t.optWidth?t.optWidth=i*t.optHeight:null==t.optHeight&&(t.optHeight=1/i*t.optWidth),n=t.optWidth/t.optHeight,e.height<t.optHeight||e.width<t.optWidth?(t.trgHeight=t.srcHeight,t.trgWidth=t.srcWidth):i>n?(t.srcHeight=e.height,t.srcWidth=t.srcHeight*n):(t.srcWidth=e.width,t.srcHeight=t.srcWidth/n),t.srcX=(e.width-t.srcWidth)/2,t.srcY=(e.height-t.srcHeight)/2,t},drop:function(e){return this.element.classList.remove("dz-drag-hover")},dragstart:l,dragend:function(e){return this.element.classList.remove("dz-drag-hover")},dragenter:function(e){return this.element.classList.add("dz-drag-hover")},dragover:function(e){return this.element.classList.add("dz-drag-hover")},dragleave:function(e){return this.element.classList.remove("dz-drag-hover")},paste:l,reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(e){var i,n,s,o,r,a,l,u,c,d,h,p,f;if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer){for(e.previewElement=t.createElement(this.options.previewTemplate.trim()),e.previewTemplate=e.previewElement,this.previewsContainer.appendChild(e.previewElement),d=e.previewElement.querySelectorAll("[data-dz-name]"),o=0,l=d.length;l>o;o++)i=d[o],i.textContent=e.name;for(h=e.previewElement.querySelectorAll("[data-dz-size]"),r=0,u=h.length;u>r;r++)i=h[r],i.innerHTML=this.filesize(e.size);for(this.options.addRemoveLinks&&(e._removeLink=t.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>"),e.previewElement.appendChild(e._removeLink)),n=function(i){return function(n){return n.preventDefault(),n.stopPropagation(),e.status===t.UPLOADING?t.confirm(i.options.dictCancelUploadConfirmation,function(){return i.removeFile(e)}):i.options.dictRemoveFileConfirmation?t.confirm(i.options.dictRemoveFileConfirmation,function(){return i.removeFile(e)}):i.removeFile(e)}}(this),p=e.previewElement.querySelectorAll("[data-dz-remove]"),f=[],a=0,c=p.length;c>a;a++)s=p[a],f.push(s.addEventListener("click",n));return f}},removedfile:function(e){var t;return e.previewElement&&null!=(t=e.previewElement)&&t.parentNode.removeChild(e.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(e,t){var i,n,s,o;if(e.previewElement){for(e.previewElement.classList.remove("dz-file-preview"),o=e.previewElement.querySelectorAll("[data-dz-thumbnail]"),n=0,s=o.length;s>n;n++)i=o[n],i.alt=e.name,i.src=t;return setTimeout(function(t){return function(){return e.previewElement.classList.add("dz-image-preview")}}(this),1)}},error:function(e,t){var i,n,s,o,r;if(e.previewElement){for(e.previewElement.classList.add("dz-error"),"String"!=typeof t&&t.error&&(t=t.error),o=e.previewElement.querySelectorAll("[data-dz-errormessage]"),r=[],n=0,s=o.length;s>n;n++)i=o[n],r.push(i.textContent=t);return r}},errormultiple:l,processing:function(e){return e.previewElement&&(e.previewElement.classList.add("dz-processing"),e._removeLink)?e._removeLink.textContent=this.options.dictCancelUpload:void 0;
},processingmultiple:l,uploadprogress:function(e,t,i){var n,s,o,r,a;if(e.previewElement){for(r=e.previewElement.querySelectorAll("[data-dz-uploadprogress]"),a=[],s=0,o=r.length;o>s;s++)n=r[s],"PROGRESS"===n.nodeName?a.push(n.value=t):a.push(n.style.width=""+t+"%");return a}},totaluploadprogress:l,sending:l,sendingmultiple:l,success:function(e){return e.previewElement?e.previewElement.classList.add("dz-success"):void 0},successmultiple:l,canceled:function(e){return this.emit("error",e,"Upload canceled.")},canceledmultiple:l,complete:function(e){return e._removeLink&&(e._removeLink.textContent=this.options.dictRemoveFile),e.previewElement?e.previewElement.classList.add("dz-complete"):void 0},completemultiple:l,maxfilesexceeded:l,maxfilesreached:l,queuecomplete:l,previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-image"><img data-dz-thumbnail /></div>\n  <div class="dz-details">\n    <div class="dz-size"><span data-dz-size></span></div>\n    <div class="dz-filename"><span data-dz-name></span></div>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-success-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Check</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <path d="M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" stroke-opacity="0.198794158" stroke="#747474" fill-opacity="0.816519475" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>\n      </g>\n    </svg>\n  </div>\n  <div class="dz-error-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Error</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <g id="Check-+-Oval-2" sketch:type="MSLayerGroup" stroke="#747474" stroke-opacity="0.198794158" fill="#FFFFFF" fill-opacity="0.816519475">\n          <path d="M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" sketch:type="MSShapeGroup"></path>\n        </g>\n      </g>\n    </svg>\n  </div>\n</div>'},i=function(){var e,t,i,n,s,o,r;for(n=arguments[0],i=2<=arguments.length?c.call(arguments,1):[],o=0,r=i.length;r>o;o++){t=i[o];for(e in t)s=t[e],n[e]=s}return n},t.prototype.getAcceptedFiles=function(){var e,t,i,n,s;for(n=this.files,s=[],t=0,i=n.length;i>t;t++)e=n[t],e.accepted&&s.push(e);return s},t.prototype.getRejectedFiles=function(){var e,t,i,n,s;for(n=this.files,s=[],t=0,i=n.length;i>t;t++)e=n[t],e.accepted||s.push(e);return s},t.prototype.getFilesWithStatus=function(e){var t,i,n,s,o;for(s=this.files,o=[],i=0,n=s.length;n>i;i++)t=s[i],t.status===e&&o.push(t);return o},t.prototype.getQueuedFiles=function(){return this.getFilesWithStatus(t.QUEUED)},t.prototype.getUploadingFiles=function(){return this.getFilesWithStatus(t.UPLOADING)},t.prototype.getActiveFiles=function(){var e,i,n,s,o;for(s=this.files,o=[],i=0,n=s.length;n>i;i++)e=s[i],(e.status===t.UPLOADING||e.status===t.QUEUED)&&o.push(e);return o},t.prototype.init=function(){var e,i,n,s,o,r,a;for("form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(t.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&(n=function(e){return function(){return e.hiddenFileInput&&document.body.removeChild(e.hiddenFileInput),e.hiddenFileInput=document.createElement("input"),e.hiddenFileInput.setAttribute("type","file"),(null==e.options.maxFiles||e.options.maxFiles>1)&&e.hiddenFileInput.setAttribute("multiple","multiple"),e.hiddenFileInput.className="dz-hidden-input",null!=e.options.acceptedFiles&&e.hiddenFileInput.setAttribute("accept",e.options.acceptedFiles),null!=e.options.capture&&e.hiddenFileInput.setAttribute("capture",e.options.capture),e.hiddenFileInput.style.visibility="hidden",e.hiddenFileInput.style.position="absolute",e.hiddenFileInput.style.top="0",e.hiddenFileInput.style.left="0",e.hiddenFileInput.style.height="0",e.hiddenFileInput.style.width="0",document.body.appendChild(e.hiddenFileInput),e.hiddenFileInput.addEventListener("change",function(){var t,i,s,o;if(i=e.hiddenFileInput.files,i.length)for(s=0,o=i.length;o>s;s++)t=i[s],e.addFile(t);return n()})}}(this))(),this.URL=null!=(r=window.URL)?r:window.webkitURL,a=this.events,s=0,o=a.length;o>s;s++)e=a[s],this.on(e,this.options[e]);return this.on("uploadprogress",function(e){return function(){return e.updateTotalUploadProgress()}}(this)),this.on("removedfile",function(e){return function(){return e.updateTotalUploadProgress()}}(this)),this.on("canceled",function(e){return function(t){return e.emit("complete",t)}}(this)),this.on("complete",function(e){return function(t){return 0===e.getUploadingFiles().length&&0===e.getQueuedFiles().length?setTimeout(function(){return e.emit("queuecomplete")},0):void 0}}(this)),i=function(e){return e.stopPropagation(),e.preventDefault?e.preventDefault():e.returnValue=!1},this.listeners=[{element:this.element,events:{dragstart:function(e){return function(t){return e.emit("dragstart",t)}}(this),dragenter:function(e){return function(t){return i(t),e.emit("dragenter",t)}}(this),dragover:function(e){return function(t){var n;try{n=t.dataTransfer.effectAllowed}catch(s){}return t.dataTransfer.dropEffect="move"===n||"linkMove"===n?"move":"copy",i(t),e.emit("dragover",t)}}(this),dragleave:function(e){return function(t){return e.emit("dragleave",t)}}(this),drop:function(e){return function(t){return i(t),e.drop(t)}}(this),dragend:function(e){return function(t){return e.emit("dragend",t)}}(this)}}],this.clickableElements.forEach(function(e){return function(i){return e.listeners.push({element:i,events:{click:function(n){return i!==e.element||n.target===e.element||t.elementInside(n.target,e.element.querySelector(".dz-message"))?e.hiddenFileInput.click():void 0}}})}}(this)),this.enable(),this.options.init.call(this)},t.prototype.destroy=function(){var e;return this.disable(),this.removeAllFiles(!0),(null!=(e=this.hiddenFileInput)?e.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,t.instances.splice(t.instances.indexOf(this),1)},t.prototype.updateTotalUploadProgress=function(){var e,t,i,n,s,o,r,a;if(n=0,i=0,e=this.getActiveFiles(),e.length){for(a=this.getActiveFiles(),o=0,r=a.length;r>o;o++)t=a[o],n+=t.upload.bytesSent,i+=t.upload.total;s=100*n/i}else s=100;return this.emit("totaluploadprogress",s,i,n)},t.prototype._getParamName=function(e){return"function"==typeof this.options.paramName?this.options.paramName(e):""+this.options.paramName+(this.options.uploadMultiple?"["+e+"]":"")},t.prototype.getFallbackForm=function(){var e,i,n,s;return(e=this.getExistingFallback())?e:(n='<div class="dz-fallback">',this.options.dictFallbackText&&(n+="<p>"+this.options.dictFallbackText+"</p>"),n+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>',i=t.createElement(n),"FORM"!==this.element.tagName?(s=t.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>'),s.appendChild(i)):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=s?s:i)},t.prototype.getExistingFallback=function(){var e,t,i,n,s,o;for(t=function(e){var t,i,n;for(i=0,n=e.length;n>i;i++)if(t=e[i],/(^| )fallback($| )/.test(t.className))return t},o=["div","form"],n=0,s=o.length;s>n;n++)if(i=o[n],e=t(this.element.getElementsByTagName(i)))return e},t.prototype.setupEventListeners=function(){var e,t,i,n,s,o,r;for(o=this.listeners,r=[],n=0,s=o.length;s>n;n++)e=o[n],r.push(function(){var n,s;n=e.events,s=[];for(t in n)i=n[t],s.push(e.element.addEventListener(t,i,!1));return s}());return r},t.prototype.removeEventListeners=function(){var e,t,i,n,s,o,r;for(o=this.listeners,r=[],n=0,s=o.length;s>n;n++)e=o[n],r.push(function(){var n,s;n=e.events,s=[];for(t in n)i=n[t],s.push(e.element.removeEventListener(t,i,!1));return s}());return r},t.prototype.disable=function(){var e,t,i,n,s;for(this.clickableElements.forEach(function(e){return e.classList.remove("dz-clickable")}),this.removeEventListeners(),n=this.files,s=[],t=0,i=n.length;i>t;t++)e=n[t],s.push(this.cancelUpload(e));return s},t.prototype.enable=function(){return this.clickableElements.forEach(function(e){return e.classList.add("dz-clickable")}),this.setupEventListeners()},t.prototype.filesize=function(e){var t,i,n,s,o,r,a,l;for(r=["TB","GB","MB","KB","b"],n=s=null,i=a=0,l=r.length;l>a;i=++a)if(o=r[i],t=Math.pow(this.options.filesizeBase,4-i)/10,e>=t){n=e/Math.pow(this.options.filesizeBase,4-i),s=o;break}return n=Math.round(10*n)/10,"<strong>"+n+"</strong> "+s},t.prototype._updateMaxFilesReachedClass=function(){return null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")},t.prototype.drop=function(e){var t,i;e.dataTransfer&&(this.emit("drop",e),t=e.dataTransfer.files,t.length&&(i=e.dataTransfer.items,i&&i.length&&null!=i[0].webkitGetAsEntry?this._addFilesFromItems(i):this.handleFiles(t)))},t.prototype.paste=function(e){var t,i;if(null!=(null!=e&&null!=(i=e.clipboardData)?i.items:void 0))return this.emit("paste",e),t=e.clipboardData.items,t.length?this._addFilesFromItems(t):void 0},t.prototype.handleFiles=function(e){var t,i,n,s;for(s=[],i=0,n=e.length;n>i;i++)t=e[i],s.push(this.addFile(t));return s},t.prototype._addFilesFromItems=function(e){var t,i,n,s,o;for(o=[],n=0,s=e.length;s>n;n++)i=e[n],null!=i.webkitGetAsEntry&&(t=i.webkitGetAsEntry())?t.isFile?o.push(this.addFile(i.getAsFile())):t.isDirectory?o.push(this._addFilesFromDirectory(t,t.name)):o.push(void 0):null!=i.getAsFile&&(null==i.kind||"file"===i.kind)?o.push(this.addFile(i.getAsFile())):o.push(void 0);return o},t.prototype._addFilesFromDirectory=function(e,t){var i,n;return i=e.createReader(),n=function(e){return function(i){var n,s,o;for(s=0,o=i.length;o>s;s++)n=i[s],n.isFile?n.file(function(i){return e.options.ignoreHiddenFiles&&"."===i.name.substring(0,1)?void 0:(i.fullPath=""+t+"/"+i.name,e.addFile(i))}):n.isDirectory&&e._addFilesFromDirectory(n,""+t+"/"+n.name)}}(this),i.readEntries(n,function(e){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log(e):void 0})},t.prototype.accept=function(e,i){return e.size>1024*this.options.maxFilesize*1024?i(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(e.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):t.isValidFile(e,this.options.acceptedFiles)?null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(i(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",e)):this.options.accept.call(this,e,i):i(this.options.dictInvalidFileType)},t.prototype.addFile=function(e){return e.upload={progress:0,total:e.size,bytesSent:0},this.files.push(e),e.status=t.ADDED,this.emit("addedfile",e),this._enqueueThumbnail(e),this.accept(e,function(t){return function(i){return i?(e.accepted=!1,t._errorProcessing([e],i)):(e.accepted=!0,t.options.autoQueue&&t.enqueueFile(e)),t._updateMaxFilesReachedClass()}}(this))},t.prototype.enqueueFiles=function(e){var t,i,n;for(i=0,n=e.length;n>i;i++)t=e[i],this.enqueueFile(t);return null},t.prototype.enqueueFile=function(e){if(e.status!==t.ADDED||e.accepted!==!0)throw new Error("This file can't be queued because it has already been processed or was rejected.");return e.status=t.QUEUED,this.options.autoProcessQueue?setTimeout(function(e){return function(){return e.processQueue()}}(this),0):void 0},t.prototype._thumbnailQueue=[],t.prototype._processingThumbnail=!1,t.prototype._enqueueThumbnail=function(e){return this.options.createImageThumbnails&&e.type.match(/image.*/)&&e.size<=1024*this.options.maxThumbnailFilesize*1024?(this._thumbnailQueue.push(e),setTimeout(function(e){return function(){return e._processThumbnailQueue()}}(this),0)):void 0},t.prototype._processThumbnailQueue=function(){return this._processingThumbnail||0===this._thumbnailQueue.length?void 0:(this._processingThumbnail=!0,this.createThumbnail(this._thumbnailQueue.shift(),function(e){return function(){return e._processingThumbnail=!1,e._processThumbnailQueue()}}(this)))},t.prototype.removeFile=function(e){return e.status===t.UPLOADING&&this.cancelUpload(e),this.files=u(this.files,e),this.emit("removedfile",e),0===this.files.length?this.emit("reset"):void 0},t.prototype.removeAllFiles=function(e){var i,n,s,o;for(null==e&&(e=!1),o=this.files.slice(),n=0,s=o.length;s>n;n++)i=o[n],(i.status!==t.UPLOADING||e)&&this.removeFile(i);return null},t.prototype.createThumbnail=function(e,t){var i;return i=new FileReader,i.onload=function(n){return function(){return"image/svg+xml"===e.type?(n.emit("thumbnail",e,i.result),void(null!=t&&t())):n.createThumbnailFromUrl(e,i.result,t)}}(this),i.readAsDataURL(e)},t.prototype.createThumbnailFromUrl=function(e,t,i){var n;return n=document.createElement("img"),n.onload=function(t){return function(){var s,o,r,l,u,c,d,h;return e.width=n.width,e.height=n.height,r=t.options.resize.call(t,e),null==r.trgWidth&&(r.trgWidth=r.optWidth),null==r.trgHeight&&(r.trgHeight=r.optHeight),s=document.createElement("canvas"),o=s.getContext("2d"),s.width=r.trgWidth,s.height=r.trgHeight,a(o,n,null!=(u=r.srcX)?u:0,null!=(c=r.srcY)?c:0,r.srcWidth,r.srcHeight,null!=(d=r.trgX)?d:0,null!=(h=r.trgY)?h:0,r.trgWidth,r.trgHeight),l=s.toDataURL("image/png"),t.emit("thumbnail",e,l),null!=i?i():void 0}}(this),null!=i&&(n.onerror=i),n.src=t},t.prototype.processQueue=function(){var e,t,i,n;if(t=this.options.parallelUploads,i=this.getUploadingFiles().length,e=i,!(i>=t)&&(n=this.getQueuedFiles(),n.length>0)){if(this.options.uploadMultiple)return this.processFiles(n.slice(0,t-i));for(;t>e;){if(!n.length)return;this.processFile(n.shift()),e++}}},t.prototype.processFile=function(e){return this.processFiles([e])},t.prototype.processFiles=function(e){var i,n,s;for(n=0,s=e.length;s>n;n++)i=e[n],i.processing=!0,i.status=t.UPLOADING,this.emit("processing",i);return this.options.uploadMultiple&&this.emit("processingmultiple",e),this.uploadFiles(e)},t.prototype._getFilesWithXhr=function(e){var t,i;return i=function(){var i,n,s,o;for(s=this.files,o=[],i=0,n=s.length;n>i;i++)t=s[i],t.xhr===e&&o.push(t);return o}.call(this)},t.prototype.cancelUpload=function(e){var i,n,s,o,r,a,l;if(e.status===t.UPLOADING){for(n=this._getFilesWithXhr(e.xhr),s=0,r=n.length;r>s;s++)i=n[s],i.status=t.CANCELED;for(e.xhr.abort(),o=0,a=n.length;a>o;o++)i=n[o],this.emit("canceled",i);this.options.uploadMultiple&&this.emit("canceledmultiple",n)}else((l=e.status)===t.ADDED||l===t.QUEUED)&&(e.status=t.CANCELED,this.emit("canceled",e),this.options.uploadMultiple&&this.emit("canceledmultiple",[e]));return this.options.autoProcessQueue?this.processQueue():void 0},s=function(){var e,t;return t=arguments[0],e=2<=arguments.length?c.call(arguments,1):[],"function"==typeof t?t.apply(this,e):t},t.prototype.uploadFile=function(e){return this.uploadFiles([e])},t.prototype.uploadFiles=function(e){var n,o,r,a,l,u,c,d,h,p,f,m,g,v,_,b,y,w,x,k,C,S,T,j,E,q,A,P,F,D,R,O,$,I;for(x=new XMLHttpRequest,k=0,j=e.length;j>k;k++)n=e[k],n.xhr=x;m=s(this.options.method,e),y=s(this.options.url,e),x.open(m,y,!0),x.withCredentials=!!this.options.withCredentials,_=null,r=function(t){return function(){var i,s,o;for(o=[],i=0,s=e.length;s>i;i++)n=e[i],o.push(t._errorProcessing(e,_||t.options.dictResponseError.replace("{{statusCode}}",x.status),x));return o}}(this),b=function(t){return function(i){var s,o,r,a,l,u,c,d,h;if(null!=i)for(o=100*i.loaded/i.total,r=0,u=e.length;u>r;r++)n=e[r],n.upload={progress:o,total:i.total,bytesSent:i.loaded};else{for(s=!0,o=100,a=0,c=e.length;c>a;a++)n=e[a],(100!==n.upload.progress||n.upload.bytesSent!==n.upload.total)&&(s=!1),n.upload.progress=o,n.upload.bytesSent=n.upload.total;if(s)return}for(h=[],l=0,d=e.length;d>l;l++)n=e[l],h.push(t.emit("uploadprogress",n,o,n.upload.bytesSent));return h}}(this),x.onload=function(i){return function(n){var s;if(e[0].status!==t.CANCELED&&4===x.readyState){if(_=x.responseText,x.getResponseHeader("content-type")&&~x.getResponseHeader("content-type").indexOf("application/json"))try{_=JSON.parse(_)}catch(o){n=o,_="Invalid JSON response from server."}return b(),200<=(s=x.status)&&300>s?i._finished(e,_,n):r()}}}(this),x.onerror=function(i){return function(){return e[0].status!==t.CANCELED?r():void 0}}(this),v=null!=(F=x.upload)?F:x,v.onprogress=b,u={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"},this.options.headers&&i(u,this.options.headers);for(a in u)l=u[a],x.setRequestHeader(a,l);if(o=new FormData,this.options.params){D=this.options.params;for(f in D)w=D[f],o.append(f,w)}for(C=0,E=e.length;E>C;C++)n=e[C],this.emit("sending",n,x,o);if(this.options.uploadMultiple&&this.emit("sendingmultiple",e,x,o),"FORM"===this.element.tagName)for(R=this.element.querySelectorAll("input, textarea, select, button"),S=0,q=R.length;q>S;S++)if(d=R[S],h=d.getAttribute("name"),p=d.getAttribute("type"),"SELECT"===d.tagName&&d.hasAttribute("multiple"))for(O=d.options,T=0,A=O.length;A>T;T++)g=O[T],g.selected&&o.append(h,g.value);else(!p||"checkbox"!==($=p.toLowerCase())&&"radio"!==$||d.checked)&&o.append(h,d.value);for(c=P=0,I=e.length-1;I>=0?I>=P:P>=I;c=I>=0?++P:--P)o.append(this._getParamName(c),e[c],e[c].name);return x.send(o)},t.prototype._finished=function(e,i,n){var s,o,r;for(o=0,r=e.length;r>o;o++)s=e[o],s.status=t.SUCCESS,this.emit("success",s,i,n),this.emit("complete",s);return this.options.uploadMultiple&&(this.emit("successmultiple",e,i,n),this.emit("completemultiple",e)),this.options.autoProcessQueue?this.processQueue():void 0},t.prototype._errorProcessing=function(e,i,n){var s,o,r;for(o=0,r=e.length;r>o;o++)s=e[o],s.status=t.ERROR,this.emit("error",s,i,n),this.emit("complete",s);return this.options.uploadMultiple&&(this.emit("errormultiple",e,i,n),this.emit("completemultiple",e)),this.options.autoProcessQueue?this.processQueue():void 0},t}(n),i.version="4.0.1",i.options={},i.optionsForElement=function(e){return e.getAttribute("id")?i.options[s(e.getAttribute("id"))]:void 0},i.instances=[],i.forElement=function(e){if("string"==typeof e&&(e=document.querySelector(e)),null==(null!=e?e.dropzone:void 0))throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return e.dropzone},i.autoDiscover=!0,i.discover=function(){var e,t,n,s,o,r;for(document.querySelectorAll?n=document.querySelectorAll(".dropzone"):(n=[],e=function(e){var t,i,s,o;for(o=[],i=0,s=e.length;s>i;i++)t=e[i],/(^| )dropzone($| )/.test(t.className)?o.push(n.push(t)):o.push(void 0);return o},e(document.getElementsByTagName("div")),e(document.getElementsByTagName("form"))),r=[],s=0,o=n.length;o>s;s++)t=n[s],i.optionsForElement(t)!==!1?r.push(new i(t)):r.push(void 0);return r},i.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i],i.isBrowserSupported=function(){var e,t,n,s,o;if(e=!0,window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a"))for(o=i.blacklistedBrowsers,n=0,s=o.length;s>n;n++)t=o[n],t.test(navigator.userAgent)&&(e=!1);else e=!1;else e=!1;return e},u=function(e,t){var i,n,s,o;for(o=[],n=0,s=e.length;s>n;n++)i=e[n],i!==t&&o.push(i);return o},s=function(e){return e.replace(/[\-_](\w)/g,function(e){return e.charAt(1).toUpperCase()})},i.createElement=function(e){var t;return t=document.createElement("div"),t.innerHTML=e,t.childNodes[0]},i.elementInside=function(e,t){if(e===t)return!0;for(;e=e.parentNode;)if(e===t)return!0;return!1},i.getElement=function(e,t){var i;if("string"==typeof e?i=document.querySelector(e):null!=e.nodeType&&(i=e),null==i)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector or a plain HTML element.");return i},i.getElements=function(e,t){var i,n,s,o,r,a,l,u;if(e instanceof Array){s=[];try{for(o=0,a=e.length;a>o;o++)n=e[o],s.push(this.getElement(n,t))}catch(c){i=c,s=null}}else if("string"==typeof e)for(s=[],u=document.querySelectorAll(e),r=0,l=u.length;l>r;r++)n=u[r],s.push(n);else null!=e.nodeType&&(s=[e]);if(null==s||!s.length)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return s},i.confirm=function(e,t,i){return window.confirm(e)?t():null!=i?i():void 0},i.isValidFile=function(e,t){var i,n,s,o,r;if(!t)return!0;for(t=t.split(","),n=e.type,i=n.replace(/\/.*$/,""),o=0,r=t.length;r>o;o++)if(s=t[o],s=s.trim(),"."===s.charAt(0)){if(-1!==e.name.toLowerCase().indexOf(s.toLowerCase(),e.name.length-s.length))return!0}else if(/\/\*$/.test(s)){if(i===s.replace(/\/.*$/,""))return!0}else if(n===s)return!0;return!1},"undefined"!=typeof e&&null!==e&&(e.fn.dropzone=function(e){return this.each(function(){return new i(this,e)})}),"undefined"!=typeof t&&null!==t?t.exports=i:window.Dropzone=i,i.ADDED="added",i.QUEUED="queued",i.ACCEPTED=i.QUEUED,i.UPLOADING="uploading",i.PROCESSING=i.UPLOADING,i.CANCELED="canceled",i.ERROR="error",i.SUCCESS="success",r=function(e){var t,i,n,s,o,r,a,l,u,c;for(a=e.naturalWidth,r=e.naturalHeight,i=document.createElement("canvas"),i.width=1,i.height=r,n=i.getContext("2d"),n.drawImage(e,0,0),s=n.getImageData(0,0,1,r).data,c=0,o=r,l=r;l>c;)t=s[4*(l-1)+3],0===t?o=l:c=l,l=o+c>>1;return u=l/r,0===u?1:u},a=function(e,t,i,n,s,o,a,l,u,c){var d;return d=r(t),e.drawImage(t,i,n,s,o,a,l,u,c/d)},o=function(e,t){var i,n,s,o,r,a,l,u,c;if(s=!1,c=!0,n=e.document,u=n.documentElement,i=n.addEventListener?"addEventListener":"attachEvent",l=n.addEventListener?"removeEventListener":"detachEvent",a=n.addEventListener?"":"on",o=function(i){return"readystatechange"!==i.type||"complete"===n.readyState?(("load"===i.type?e:n)[l](a+i.type,o,!1),!s&&(s=!0)?t.call(e,i.type||i):void 0):void 0},r=function(){var e;try{u.doScroll("left")}catch(t){return e=t,void setTimeout(r,50)}return o("poll")},"complete"!==n.readyState){if(n.createEventObject&&u.doScroll){try{c=!e.frameElement}catch(d){}c&&r()}return n[i](a+"DOMContentLoaded",o,!1),n[i](a+"readystatechange",o,!1),e[i](a+"load",o,!1)}},i._autoDiscoverFunction=function(){return i.autoDiscover?i.discover():void 0},o(window,i._autoDiscoverFunction)}.call(this),t.exports}),define("apps/tutors/edit/views/pic",["base","events","dropzone","entities/user"],function(e,t,i,n){return e.ItemView.extend({template:!1,ui:{img:".js-img",preview:".js-preview",clickable:".js-click"},initialize:function(){this.bindUIElements(),this.user=n.current(),this.$el.dropzone({url:"/api/users/"+this.user.id+"/profile-picture",headers:{"X-CSRF-Token":_.config("csrf_token")},maxFilesize:4,acceptedFiles:"image/jpeg,image/png,image/bmp,image/gif,image/svg",paramName:"picture",clickable:this.ui.clickable.selector,addedfile:_.bind(this.onAddedFile,this),thumbnail:_.bind(this.onThumbnail,this),uploadprogress:_.bind(this.onUploadProgress,this),complete:_.bind(this.onComplete,this),success:_.bind(this.onSync,this),error:_.bind(this.onError,this)}),this.listenTo(t,"tutor.profile.picture:edit",function(){this.ui.clickable.click()})},onAddedFile:function(e){_.progress().start(),t.trigger("requirement:pending",{section:"profile",name:"profile_picture"})},onThumbnail:function(e,t){"error"!==e.status&&this.ui.preview.html('<img src="'+t+'">')},onUploadProgress:function(e,t,i){},onComplete:function(){_.progress().done()},onSync:function(e,t){if(_.has(t,"data")&&_.has(t.data,"large")){var i=new Image;i.onload=_.bind(function(){this.ui.preview.find("img").remove(),this.ui.img.find("img").attr("src",i.src)},this),i.src=t.data.large+"?cache-breaker="+(new Date).getTime()}_.toast("Uploaded and saved!","success")},onError:function(e,i,n){if(t.trigger("requirement:incompleted",{section:"profile",name:"profile_picture"}),n)switch(json=JSON.parse(n.responseText),n.status){case 413:case"413":i="File is too big. Max filesize: 2MiB.";break;case 400:case"400":i=json.errors[0].detail;break;default:i="An unexpected error has occured. Please try again later."}this.ui.preview.find("img").remove(),_.toast(i,"error")}})}),define("apps/tutors/edit/views/rate",["base"],function(e){return e.ItemView.extend({template:!1,initialize:function(){this.listenTo(this.model,"sync",this.rateChanged)},rateChanged:function(){var e=this.model.profile.get("rate");e&&this.$el.html(e)}})}),define("apps/tutors/edit/views/bio",["base"],function(e){return e.ItemView.extend({template:!1,initialize:function(){this.listenTo(this.model,"sync",this.bioChanged)},bioChanged:function(){var e=this.model.profile.get("bio");e&&this.$el.html(_.pe(e))}})}),define("apps/tutors/edit/views/subjects",["base"],function(e){return e.ItemView.extend({template:!1,initialize:function(){this.listenTo(this.collection,"sync",this.subjectsChanged)},subjectsChanged:function(){var e={},t=[];this.collection.isEmpty()?t.push('<dd class="dl__dd">You haven&#39;t added any subjects yet.</dd>'):(this.collection.each(function(t){var i=t.get("path").split(" / "),n=i.splice(0,2).join("."),s=object_get(e,n,[]);i.length>0&&(s=s.concat(i)),object_set(e,n,s)}),_.each(e,function(e,i){t=t.concat(['<dt class="dl__dt">',i,"</dt>"]);var n=[];_.each(e,function(e,t){t="<strong>"+t+"</strong>",e.length>0&&(t=t+" ("+e.join(", ")+")"),n.push(t)}),t=t.concat(['<dd class="dl__dd">',n.join(", "),"</dd>"])})),this.$el.html(t.join(""))}})}),define("requirejs-text!apps/tutors/edit/templates/dt.html",[],function(){return'<dt class="dl__dt"><%= heading %></dt>'}),define("requirejs-text!apps/tutors/edit/templates/dd.html",[],function(){return'<dd class="dl__dd">\n    <%= subject %> <% if(still_studying) { print(\'*\'); } %>\n\n    <div class="dl__meta">\n        <span class="dl__meta__left"><%= location %></span>\n        <span class="dl__meta__right"><%= level %></span>\n    </div>\n</dd>'}),define("apps/tutors/edit/views/qualifications",["base","requirejs-text!apps/tutors/edit/templates/dt.html","requirejs-text!apps/tutors/edit/templates/dd.html"],function(e,t,i){return e.ItemView.extend({template:!1,initialize:function(){this.listenTo(this.model,"sync",this.qualificationsChanged)},qualificationsChanged:function(){var e="";this.model.universities.length<1&&this.model.alevels.length<1&&this.model.others.length<1?e+='<dd class="dl__dd">You haven&#39;t added any qualifications yet.</dd>':(this.model.universities.length>0&&(e+=_.template(t,{heading:"University"}),this.model.universities.each(function(t){e+=_.template(i,{subject:t.get("subject"),location:t.get("university"),still_studying:t.get("still_studying"),level:_.lang("qualifications.university.levels."+t.get("level"))})})),this.model.alevels.length>0&&(e+=_.template(t,{heading:"College"}),this.model.alevels.each(function(t){e+=_.template(i,{subject:t.get("subject"),location:t.get("college"),still_studying:t.get("still_studying"),level:_.lang("qualifications.alevel.grades."+t.get("grade"))})})),this.model.others.length>0&&(e+=_.template(t,{heading:"College"}),this.model.others.each(function(t){e+=_.template(i,{subject:t.get("subject"),location:t.get("location"),still_studying:t.get("still_studying"),level:t.get("grade")})}))),this.$el.html(e)}})}),define("requirejs-text!apps/tutors/edit/templates/distance.html",[],function(){return"<span class=\"profile-details__title\"><%= profile.travel_radius === null ? '-' : 0 %></span>\n<div>\n    <a href=\"<%= laroute.route('tutor.profile.show', {\n        'uuid'    : uuid,\n        'section' : 'travel_policy'\n    }) %>\" data-js class=\"edit-link\">Edit</a> \n</div>"}),define("apps/tutors/edit/views/distance",["base","requirejs-text!apps/tutors/edit/templates/distance.html"],function(e,t){return e.ItemView.extend({template:_.template(t),initialize:function(){this.listenTo(this.model.profile,"parsed",this.render)}})}),define("requirejs-text!apps/tutors/edit/templates/travel_policy.html",[],function(){return'<h4 class="heading">\n    Travel Policy <span class="edit-link edit-link--light r">Edit</span></h4>\n<p class="u-m0"><%= _.lang(\'user_profiles.travel_radius.\' + profile.travel_radius) %></p>'}),define("apps/tutors/edit/views/travel_policy",["base","requirejs-text!apps/tutors/edit/templates/travel_policy.html"],function(e,t){return e.ItemView.extend({template:_.template(t),initialize:function(){this.listenTo(this.model.profile,"parsed",this.render)}})}),define("requirejs-text!apps/tutors/edit/templates/badges.html",[],function(){return'<% _.each(badges, function (badge) { %>\n    <div class="tutor-stats__stat tutor-stats__stat--large">\n        <span class="icon icon--fancy-tick u-vam"></span><span class="text-aligned"><%= badge %></span>\n    </div>        \n<% }) %>\n\n\n<a href="<%= laroute.route(\'tutor.profile.show\', {\n    \'uuid\'    : uuid,\n    \'section\' : \'qts\'\n}) %>" data-js class="edit-link">Edit Qualified Teacher Status</a>\n<br>\n<a href="mailto:support@tutora.co.uk" class="edit-link">Have a DBS Check? Send it to us</a> \n'}),define("apps/tutors/edit/views/badges",["base","requirejs-text!apps/tutors/edit/templates/badges.html"],function(e,t){return e.ItemView.extend({template:_.template(t),templateHelpers:function(){var e=[],t=this.model.qts;t&&"no"!==t.get("level")&&null!==t.get("level")&&e.push(_.lang("qualifications.teacher_status.levels."+t.get("level")));var i=this.model.background_check;return i&&(i.get("dbs")===!0&&e.push(_.lang("background_check.dbs")),i.get("enhanced_dbs")===!0&&e.push(_.lang("background_check.enhanced_dbs"))),{badges:e}},initialize:function(){this.listenTo(this.model.qts,"sync",this.render);
}})}),define("apps/tutors/edit/controller",["base","entities/user","apps/tutors/edit/views/tagline","apps/tutors/edit/views/pic","apps/tutors/edit/views/rate","apps/tutors/edit/views/bio","apps/tutors/edit/views/subjects","apps/tutors/edit/views/qualifications","apps/tutors/edit/views/distance","apps/tutors/edit/views/travel_policy","apps/tutors/edit/views/badges"],function(e,t,i,n,s,o,r,a,l,u,c){return e.Controller.extend({initialize:function(e){this.app.addRegions({taglineRegion:".js-tagline",picRegion:".js-pic",rateRegion:".js-rate",bioRegion:".js-bio",subjectsRegion:".js-subjects",qualificationsRegion:".js-qualifications",distanceRegion:".js-distance",travelPolicyRegion:".js-travel-policy",badgesRegion:".js-badges"}),this.user=t.current(),this.attachTagline(),this.attachPic(),this.attachRate(),this.attachBio(),this.attachSubjects(),this.attachQualifications(),this.renderDistance(),this.renderTravelPolicy(),this.renderBadges()},attachTagline:function(){var e=new i({el:this.app.taglineRegion.$el,model:this.user});this.app.taglineRegion.attachView(e)},attachPic:function(){var e=new n({el:this.app.picRegion.$el,model:this.user});this.app.picRegion.attachView(e)},attachRate:function(){var e=new s({el:this.app.rateRegion.$el,model:this.user});this.app.taglineRegion.attachView(e)},attachBio:function(){var e=new o({el:this.app.bioRegion.$el,model:this.user});this.app.bioRegion.attachView(e)},attachSubjects:function(){var e=new r({el:this.app.subjectsRegion.$el,collection:this.user.subjects});this.app.subjectsRegion.attachView(e)},attachQualifications:function(){var e=new a({el:this.app.qualificationsRegion.$el,model:this.user.qualifications});this.app.qualificationsRegion.attachView(e)},renderDistance:function(){var e=new l({model:this.user});this.app.distanceRegion.show(e)},renderTravelPolicy:function(){var e=new u({model:this.user});this.app.travelPolicyRegion.show(e)},renderBadges:function(){var e=new c({model:this.user});this.app.badgesRegion.show(e)}})}),define("apps/tutors/controller",["base","apps/tutors/edit/controller"],function(e,t){return e.Controller.extend({edit:function(){return new t({app:this.app})}})}),define("apps/tutors/router",["base","entities/user"],function(e,t){return e.Router.extend({routes:{pic:laroute.route("tutor.profile.show",{uuid:":uuid",section:"pic"})},initialize:function(){"tutors.edit"===_.config("load")&&this.controller.edit()},pic:function(){var e=laroute.route("tutor.profile.show",{uuid:t.current().id});this.app.history.back(e),$(".js-pic .js-click").click()}})}),define("apps/tutors/app",["apps/tutors/controller","apps/tutors/router"],function(e,t){return function(){var i=new e({app:this});return new t({controller:i})}}),define("requirejs-text!apps/tagline/edit/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container dialogue__container--tiny">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.profile.tagline.edit.heading\') %></h4>\n                    <a href="#" class="close icon icon--cross [ js-close ]"></a>\n                </header>\n\n                <p><%= _.lang(\'dialogue.profile.tagline.edit.introduction\') %></p>\n\n                <form class="layout js-form" novalidate><!--\n                    --><div class="layout__item field">\n                        <input type="text" class="field__input input input--full input--squared input--bordered js-tagline" name="tagline" placeholder="Tagline" value="<%= profile.tagline %>">\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item tar">\n                        <a href="#" class="u-mr [ js-close ]">Cancel</a>\n                        <button class="btn">Save</button>\n                    </div><!--\n                --></form>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay [ js-close ]"></div>'}),define("apps/tagline/edit/views/layout",["base","requirejs-text!apps/tagline/edit/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(t),ui:{"profile.tagline":".js-tagline"},fields:["profile.tagline"]}))}),define("apps/tagline/edit/controller",["base","events","entities/user","apps/tagline/edit/views/layout"],function(e,t,i,n){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.region=e.region,this.user=i.current(),this.view=new n({model:this.user}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){t.trigger("requirement:pending",{section:"profile",name:"tagline"}),this.user.save(object_undot(e),{patch:!0})},onSyncSuccess:function(e,t){_.toast("Saved!","success"),this.view.destroy()},onSyncError:function(e,i){t.trigger("requirement:incompleted",{section:"profile",name:"tagline"})},onDestroy:function(){var e=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid")});this.app.history.back(e)}}))}),define("apps/tagline/controller",["base","apps/tagline/edit/controller"],function(e,t){return e.Controller.extend({edit:function(e){return e=_.isObject(e)?e:{},new t(_.extend({app:this.app,region:this.app.dialogueRegion},e))}})}),define("apps/tagline/router",["base"],function(e){return e.Router.extend({routes:{edit:laroute.route("tutor.profile.show",{uuid:":uuid",section:"tagline"})},edit:function(){this.controller.edit()}})}),define("apps/tagline/app",["apps/tagline/controller","apps/tagline/router"],function(e,t){return function(){var i=new e({app:this});return new t({controller:i})}}),define("requirejs-text!apps/rate/edit/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container dialogue__container--tiny">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.profile.rate.edit.heading\') %></h4>\n                    <a href="#" class="close icon icon--cross [ js-close ]"></a>\n                </header>\n\n                <p><%= _.lang(\'dialogue.profile.rate.edit.introduction\') %></p>\n\n                <form class="layout js-form" novalidate><!--\n                    --><div class="layout__item field field--group">\n                        <span class="field__prefix input input--squared input--bordered input--disabled">&pound;</span>\n                        <input type="text" name="rate" placeholder="Rate" value="<%= profile.rate %>"\n                          class="field__input input input--full input--squared input--bordered js-rate">\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item tar">\n                        <a href="#" class="u-mr [ js-close ]">Cancel</a>\n                        <button class="btn">Save</button>\n                    </div><!--\n                --></form>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay [ js-close ]"></div>\n'}),define("apps/rate/edit/views/layout",["base","requirejs-text!apps/rate/edit/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(t),ui:{"profile.rate":".js-rate"},fields:["profile.rate"]}))}),define("apps/rate/edit/controller",["base","events","entities/user","apps/rate/edit/views/layout"],function(e,t,i,n){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.region=e.region,this.user=i.current(),this.view=new n({model:this.user}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){t.trigger("requirement:pending",{section:"profile",name:"rate"}),this.user.save(object_undot(e),{patch:!0})},onSyncSuccess:function(e,t){_.toast("Saved!","success"),this.view.destroy()},onSyncError:function(){t.trigger("requirement:incompleted",{section:"profile",name:"rate"})},onDestroy:function(){var e=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid")});this.app.history.back(e)}}))}),define("apps/rate/controller",["base","apps/rate/edit/controller"],function(e,t){return e.Controller.extend({edit:function(e){return e=_.isObject(e)?e:{},new t(_.extend({app:this.app,region:this.app.dialogueRegion},e))}})}),define("apps/rate/router",["base"],function(e){return e.Router.extend({routes:{edit:laroute.route("tutor.profile.show",{uuid:":uuid",section:"rate"})},edit:function(){this.controller.edit()}})}),define("apps/rate/app",["apps/rate/controller","apps/rate/router"],function(e,t){return function(){var i=new e({app:this});return new t({controller:i})}}),define("requirejs-text!apps/live/show/templates/new.html",[],function(){return'<button class="[ btn btn--full btn--disabled ]" disabled>\n    Go live\n</button>'}),define("requirejs-text!apps/live/show/templates/submittable.html",[],function(){return"<a href=\"<%= laroute.route('tutor.profile.show', {\n    'uuid'    : uuid,\n    'section' : 'review'\n  }) %>\"\n  class=\"[ btn btn--full btn--success ]\" data-js\n  >\n    Go live\n</a>"}),define("requirejs-text!apps/live/show/templates/rejected.html",[],function(){return'<button class="[ btn btn--full btn--error ]" disabled>\n    Changes required\n</button>'}),define("requirejs-text!apps/live/show/templates/live.html",[],function(){return"<a href=\"<%= laroute.route('tutor.profile.show', {\n    'uuid'    : uuid,\n    'section' : 'go-offline'\n  }) %>\"\n  class=\"btn btn--full btn--success [ js-offline ]\" data-js\n  >\n    Live\n</a>"}),define("requirejs-text!apps/live/show/templates/offline.html",[],function(){return"<a href=\"<%= laroute.route('tutor.profile.show', {\n    'uuid'    : uuid,\n    'section' : 'go-live'\n  }) %>\"\n  class=\"btn btn--full btn--error\" data-js\n  >\n    Offline\n</a>"}),define("requirejs-text!apps/live/show/templates/expired.html",[],function(){return'<button class="[ btn btn--full btn--disabled ]" disabled>\n    Go live\n</button>'}),define("requirejs-text!apps/live/show/templates/pending.html",[],function(){return'<button class="[ btn btn--full btn--disabled ]" disabled>\n    Pending review\n</button>'}),define("apps/live/show/views/layout",["base","requirejs-text!apps/live/show/templates/new.html","requirejs-text!apps/live/show/templates/submittable.html","requirejs-text!apps/live/show/templates/rejected.html","requirejs-text!apps/live/show/templates/live.html","requirejs-text!apps/live/show/templates/offline.html","requirejs-text!apps/live/show/templates/expired.html","requirejs-text!apps/live/show/templates/pending.html"],function(e,t,i,n,s,o,r,a){return _.patch(e.LayoutView.extend({onBeforeRender:function(){var e={"new":t,submittable:i,rejected:n,live:s,offline:o,expired:r,pending:a};this.template=_.template(e[this.model.profile.get("status")])}}))}),define("apps/live/show/controller",["base","events","entities/user","apps/live/show/views/layout"],function(e,t,i,n){return _.patch(e.Controller.extend({initialize:function(e){this.region=e.region,this.user=i.current(),this.view=new n({model:this.user}),this.listenTo(this.user.profile,"change:status",function(){"review"!==this.user.profile.get("status")&&this.view.render()}),this.listenTo(t,"requirement:completed",function(e,t){this.user.profile.set("status",t.profile.status),this.view.render()}),this.region.show(this.view)}}))}),define("requirejs-text!apps/live/create/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.profile.live.create.heading\') %></h4>\n                    <a href="#" class="close icon icon--cross [ js-close ]"></a>\n                </header>\n\n                <p><%= _.lang(\'dialogue.profile.live.create.introduction\') %></p>\n\n                <form class="js-form" novalidate>\n                    <fieldset class="fieldset">\n                        <div class="fieldset__content box u-m0">\n                            <h4 class="delta">Going Live on the Site</h4>\n\n                            <p>We thoroughly vet every tutor\'s application before they can join our site. Once we have verified your ID and reviewed your profile, we will let you know if you have been successful in your application.</p> \n                            <p>If you have a DBS check, please email us a copy and we will add the DBS-checked status to your profile.</p>\n\n                            <h4 class="epsilon u-mt">Matching you with New Students</h4>\n                            <p>We work hard to match you with new students. Sometimes they will message you directly through the site but they also come directly to us. Either way, they will message you through the site - let them know how, when and where you can help them.</p>\n                            <p>Sometimes it\'s not a good match between you and a student, so we don\'t let you exchange phone numbers or email addresses until a lesson is booked and confirmed (you will sometimes see them starred out so please explain this to students). That way, we can see who needs more help and match them with another tutor.</p>\n\n                            <h4 class="epsilon u-mt">Booking Sessions</h4>\n                            <p>Once you have agreed a time and location for your lessons, go to the \'Book a Lesson\' tab and book it in. The student will then get an email asking them to confirm the session by entering their payment details. We will follow-up with students to make sure everything goes smoothly and you will receive a confirmation email when they have confirmed the lesson.</p>\n\n                            <h4 class="epsilon u-mt">Getting Paid</h4>\n                            <p>Students pay you through the Tutora payment system. Please do not accept payments in cash. We take payment 24 hours after each session you teach and will pay you directly into your account 7 days later. If you haven\'t already done so, be sure to enter your payment details on the account tab.</p>\n\n                            <p>For students you find through Tutora, we keep a commission of 15%-25% on each lesson you\n                                have together. The more hours you teach, the lower our commission falls and the more\n                                money you\'ll take home.</p>\n\n                            <p>Students pay you through the Tutora payment system. Please do not accept payments in cash.</p>\n                            \n                            <h4 class="epsilon u-mt">Your Relationship with Us</h4>\n                            <p>We strongly believe Tutors should have full control of their own business - we are not an agency. You have full responsibility and flexibility for setting up appointments with students, selecting which opportunities to pursue and how much to charge. We are always here to help.</p>\n                            \n                            <h4 class="epsilon u-mt">DBS Checks</h4>\n                            <p>We do a lot of work with post-16 and adult learners so we do not require a DBS (Disclosure and Barring Service) check for you to join our site. Many parents, however, seek a tutor with one and for this purpose we add a DBS-checked status badge to tutors who have one. If you have one and have not done so already, please email us a copy of your DBS certificate or your DBS update service details (full name, number and date of birth).</p>\n                        </div>\n                    </fieldset>\n\n                    <div class="tar">\n                        <a href="#" class="u-mr [ js-close ]">Cancel</a>\n                        <button class="btn">Accept &amp; Submit</button>\n                    </div>\n                </form>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay [ js-close ]"></div>\n'}),define("apps/live/create/views/layout",["base","requirejs-text!apps/live/create/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(t)}))}),define("apps/live/create/controller",["base","entities/user","apps/live/create/views/layout"],function(e,t,i){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.region=e.region,this.user=t.current(),this.view=new i({model:this.user}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){this.user.save({profile:{status:"submit"}},{patch:!0})},onSyncSuccess:function(e,t){_.toast(["Thank you for applying to join the Tutora team. We will contact ","you soon to discuss how we can help to grow your tuition business.","<br><br>","Until then, your profile will appear as 'Pending', but you can ","continue to edit your details."].join(""),"success",15e3),this.view.destroy()},onDestroy:function(){var e=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid")});this.app.history.back(e)}}))}),define("requirejs-text!apps/live/edit/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.profile.live.edit.heading\') %></h4>\n                    <a href="#" class="close icon icon--cross [ js-close ]"></a>\n                </header>\n\n                <p><%= _.lang(\'dialogue.profile.live.edit.introduction\') %></p>\n\n                <form class="js-form" novalidate>\n                    <div class="tar">\n                        <a href="#" class="u-mr [ js-close ]">Cancel</a>\n                        <button class="btn btn--success">Go live</button>\n                    </div>\n                </form>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay [ js-close ]"></div>\n'}),define("apps/live/edit/views/layout",["base","requirejs-text!apps/live/edit/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout"],template:_.template(t)}))}),define("apps/live/edit/controller",["base","entities/user","apps/live/edit/views/layout"],function(e,t,i){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.region=e.region,this.user=t.current(),this.view=new i({model:this.user}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){this.user.save({profile:{status:"live"}},{patch:!0})},onSyncSuccess:function(e,t){_.toast("Saved!","success"),this.view.destroy()},onDestroy:function(){var e=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid")});this.app.history.back(e)}}))}),define("requirejs-text!apps/live/destroy/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.profile.live.destroy.heading\') %></h4>\n                    <a href="#" class="close icon icon--cross [ js-close ]"></a>\n                </header>\n\n                <p><%= _.lang(\'dialogue.profile.live.destroy.introduction\') %></p>\n\n                <form class="js-form" novalidate>\n                    <div class="tar">\n                        <a href="#" class="u-mr [ js-close ]">Cancel</a>\n                        <button class="btn btn--error">Go Offline</button>\n                    </div>\n                </form>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay [ js-close ]"></div>\n'}),define("apps/live/destroy/views/layout",["base","requirejs-text!apps/live/destroy/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout"],template:_.template(t)}))}),define("apps/live/destroy/controller",["base","entities/user","apps/live/destroy/views/layout"],function(e,t,i){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.region=e.region,this.user=t.current(),this.view=new i({model:this.user}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){this.user.save({profile:{status:"offline"}},{patch:!0})},onSyncSuccess:function(e,t){_.toast("Saved!","success"),this.view.destroy()},onDestroy:function(){var e=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid")});this.app.history.back(e)}}))}),define("apps/live/controller",["base","apps/live/show/controller","apps/live/create/controller","apps/live/edit/controller","apps/live/destroy/controller"],function(e,t,i,n,s){return e.Controller.extend({show:function(e){return e=_.isObject(e)?e:{},new t(_.extend({app:this.app,region:this.app.liveRegion}))},create:function(e){return e=_.isObject(e)?e:{},new i(_.extend({app:this.app,region:this.app.dialogueRegion},e))},edit:function(e){return e=_.isObject(e)?e:{},new n(_.extend({app:this.app,region:this.app.dialogueRegion},e))},destroy:function(e){return e=_.isObject(e)?e:{},new s(_.extend({app:this.app,region:this.app.dialogueRegion},e))}})}),define("apps/live/router",["base"],function(e){return e.Router.extend({routes:{create:laroute.route("tutor.profile.show",{uuid:":uuid",section:"review"}),edit:laroute.route("tutor.profile.show",{uuid:":uuid",section:"go-live"}),destroy:laroute.route("tutor.profile.show",{uuid:":uuid",section:"go-offline"})},initialize:function(){var e=$(".js-live-region");e.length>0&&(this.app.addRegions({liveRegion:".js-live-region"}),this.show())},show:function(){this.controller.show()},create:function(){this.controller.create()},edit:function(){this.controller.edit()},destroy:function(){this.controller.destroy()}})}),define("apps/live/app",["apps/live/controller","apps/live/router"],function(e,t){return function(){var i=new e({app:this});return new t({controller:i})}}),define("requirejs-text!apps/travel_policy/edit/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container dialogue__container--tiny">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.profile.travel_policy.edit.heading\') %></h4>\n                    <a href="#" class="close icon icon--cross [ js-close ]"></a>\n                </header>\n\n                <p><%= _.lang(\'dialogue.profile.travel_policy.edit.introduction\') %></p>\n\n                <form class="layout js-form" novalidate><!--\n                    --><div class="layout__item field">\n                        <label for="travel_radius" class="field__label">Distance*</label>\n                        <div class="field__input select select--full select--squared select--bordered <%= profile.travel_radius >= 0 ? \'select--show\' : \'\' %>">\n                            <span class="select__placeholder">Radius</span>\n                            <span class="select__value"><%= profile.travel_radius >= 0 ? policies[profile.travel_radius] : \'\' %></span>\n                            <select name="travel_radius" class="select__field js-travel-radius">\n                                <option value="">Please select one:</option>\n                                <% _.each(policies, function (title, key) { %>\n                                    <% if (key >= 0) { %>\n                                        <option value="<%= key %>" <%= profile.travel_radius == key ? \'selected\' : \'\' %>>\n                                            <%= title %>\n                                        </option>\n                                    <% } %>\n                                <% }) %>\n                            </select>\n                        </div>\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item field">\n                        <label for="duration" class="field__label">Address*</label>\n                        <input type="text" name="address_street" placeholder="Street" value="<%= addresses.default.line_1 %>"\n                          class="field__input input input--full input--squared input--bordered js-address-line-1">\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item field">\n                        <input type="text" name="address_town" placeholder="Town" value="<%= addresses.default.line_2 %>"\n                          class="field__input input input--full input--squared input--bordered js-address-line-2">\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item field">\n                        <input type="text" name="address_county" placeholder="County" value="<%= addresses.default.line_3 %>"\n                          class="field__input input input--full input--squared input--bordered js-address-line-3">\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item field">\n                        <input type="text" name="address_postcode" placeholder="Postcode" value="<%= addresses.default.postcode %>"\n                          class="field__input input input--full input--squared input--bordered js-address-postcode">\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item u-mt- tar">\n                        <a href="#" class="u-mr [ js-close ]">Cancel</a>\n                        <button class="btn">Save</button>\n                    </div><!--\n                --></form>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay [ js-close ]"></div>\n'}),define("apps/travel_policy/edit/views/layout",["base","requirejs-text!apps/travel_policy/edit/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(t),templateHelpers:function(){return{policies:_.lang("user_profiles.travel_radius")}},ui:{"profile.travel_radius":".js-travel-radius","addresses.default.line_1":".js-address-line-1","addresses.default.line_2":".js-address-line-2","addresses.default.line_3":".js-address-line-3","addresses.default.postcode":".js-address-postcode"},fields:["profile.travel_radius","addresses.default.line_1","addresses.default.line_2","addresses.default.line_3","addresses.default.postcode"]}))}),define("apps/travel_policy/edit/controller",["base","events","entities/user","apps/travel_policy/edit/views/layout"],function(e,t,i,n){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.region=e.region,this.user=i.current(),this.view=new n({model:this.user}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){t.trigger("requirement:pending",{section:"profile",name:"travel_policy"}),this.user.save(object_undot(e),{patch:!0})},onSyncSuccess:function(e,t){_.toast("Saved!","success"),this.view.destroy()},onSyncError:function(){t.trigger("requirement:incompleted",{section:"profile",name:"travel_policy"})},onDestroy:function(){var e=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid")});this.app.history.back(e)}}))}),define("apps/travel_policy/controller",["base","apps/travel_policy/edit/controller"],function(e,t){return e.Controller.extend({edit:function(e){return e=_.isObject(e)?e:{},new t(_.extend({app:this.app,region:this.app.dialogueRegion},e))}})}),define("apps/travel_policy/router",["base"],function(e){return e.Router.extend({routes:{edit:laroute.route("tutor.profile.show",{uuid:":uuid",section:"travel_policy"})},edit:function(){this.controller.edit()}})}),define("apps/travel_policy/app",["apps/travel_policy/controller","apps/travel_policy/router"],function(e,t){return function(){var i=new e({app:this});return new t({controller:i})}}),define("requirejs-text!apps/bio/edit/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.profile.bio.edit.heading\') %></h4>\n                    <a href="#" class="close icon icon--cross [ js-close ]"></a>\n                </header>\n\n                <p><%= _.lang(\'dialogue.profile.bio.edit.introduction\') %></p>\n\n                <form class="js-form" novalidate>\n                    <fieldset class="fieldset">\n                        <div class="[ tabs tabs--bordered ] fieldset__tabs">\n                            <ul class="tabs__list">\n                                <li class="tabs__item">\n                                    <a href="#" data-tab-group="bio" data-tab-name="bio" class="tabs__link tabs__link--active">Bio</a>\n                                </li>\n                                <li class="tabs__item">\n                                    <a href="#" data-tab-group="bio" data-tab-name="short_bio" class="tabs__link">Short Bio</a>\n                                </li>\n                            </ul>\n                        </div>\n\n                        <div class="fieldset__content">\n                            <div class="tab-content tab-content--active" data-tab-group="bio" data-tab-name="bio">\n                                <div class="field">\n                                    <textarea rows="10" class="field__textarea input input--full input--squared js-bio" name="bio" placeholder="Bio"><%= profile.bio %></textarea>\n                                    <div class="field__error"></div>\n                                </div>\n                            </div>\n                            <div class="tab-content" data-tab-group="bio" data-tab-name="short_bio">\n                                <div class="field">\n                                    <textarea class="field__textarea input input--full input--squared js-short-bio" name="short-bio" placeholder="The short bio is what clients will see on the search results. If you leave it blank, we\'ll use the first few lines from your main bio."><%= profile.short_bio %></textarea>\n                                    <div class="field__error"></div>\n                                </div>\n                            </div>\n                        </div>\n                    </fieldset>\n\n                    <div class="tar">\n                        <a href="#" class="u-mr [ js-close ]">Cancel</a>\n                        <button class="btn">Save</button>\n                    </div>\n                </form>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay [ js-close ]"></div>\n';
}),define("apps/bio/edit/views/layout",["base","requirejs-text!apps/bio/edit/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(t),ui:{"profile.bio":".js-bio","profile.short_bio":".js-short-bio"},fields:["profile.bio",["profile.short_bio",function(){var e=_.val(this.ui["profile.short_bio"]);return e?e:null}]]}))}),define("apps/bio/edit/controller",["base","events","entities/user","apps/bio/edit/views/layout"],function(e,t,i,n){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.region=e.region,this.user=i.current(),this.view=new n({model:this.user}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){t.trigger("requirement:pending",{section:"profile",name:"bio"}),this.user.save(object_undot(e),{patch:!0})},onSyncSuccess:function(e,t){_.toast("Saved!","success"),this.view.destroy()},onSyncError:function(){t.trigger("requirement:incompleted",{section:"profile",name:"bio"})},onDestroy:function(){var e=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid")});this.app.history.back(e)}}))}),define("apps/bio/controller",["base","apps/bio/edit/controller"],function(e,t){return e.Controller.extend({edit:function(e){return e=_.isObject(e)?e:{},new t(_.extend({app:this.app,region:this.app.dialogueRegion},e))}})}),define("apps/bio/router",["base"],function(e){return e.Router.extend({routes:{edit:laroute.route("tutor.profile.show",{uuid:":uuid",section:"bio"})},edit:function(){this.controller.edit()}})}),define("apps/bio/app",["apps/bio/controller","apps/bio/router"],function(e,t){return function(){var i=new e({app:this});return new t({controller:i})}}),define("requirejs-text!apps/subjects/edit/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.profile.subjects.edit.heading\') %></h4>\n                    <a href="#" class="close icon icon--cross js-close"></a>\n                </header>\n\n                <p><%= _.lang(\'dialogue.profile.subjects.edit.introduction\') %></p>\n\n                <form class="js-form" novalidate>\n                    <% if (collection.length > 0) { %>\n                        <div class="field">\n                            <fieldset class="fieldset field__input">\n                                <div class="scrollable--arrows--wrapper">\n                                    <div class="arrow arrow--left"></div>\n                                    <div class="arrow arrow--right"></div>\n                                    <div class="[ tabs tabs--bordered tabs--scrollable tabs--scrollable-right ] fieldset__tabs">\n                                        <ul class="tabs__list" style="width: 2400px;">\n                                            <% _.each(collection, function (model) { %>\n                                            <li class="tabs__item">\n                                                <a href="#" data-tab-group="subjects" data-tab-name="<%= model.id %>" class="tabs__link [ js-tab ]">\n                                                    <%= model.name %>\n                                                </a>\n                                            </li>\n                                            <% }) %>\n                                        </ul>\n                                    </div>\n                                </div>\n\n                                <div class="field">\n                                <div class="fieldset__content [ js-subjects ]">\n                                    <% _.each(collection, function (model) { %>\n                                        <div class="tab-content" data-tab-group="subjects" data-tab-name="<%= model.id %>">\n                                            <%\n                                                var r = function (subjects) {\n                                                    return _.reduce(subjects, function (memo, subject) {\n                                                        if (_.has(subject, \'children\')  === true &&\n                                                            _.isArray(subject.children) === true &&\n                                                            _.isEmpty(subject.children) === false\n                                                        ) {\n                                                            return memo +\n                                                                \'<h4 class="zeta u-mb--">\' +\n                                                                    subject.name +\n                                                                \'</h4>\' +\n                                                                \'<div class="fields u-mb-">\' +\n                                                                    r(subject.children) +\n                                                                \'</div>\';\n                                                        }\n\n                                                        return memo + \n                                                            \'<div class="field field--inline u-mb--">\' +\n                                                                \'<div class="checkbox checkbox--pill \' + (userHasSubject(subject.id) ? \'checkbox--checked\' : \'\') + \'">\' +\n                                                                    \'<div class="checkbox__box">\' +\n                                                                        \'<div class="checkbox__tick"></div>\' +\n                                                                        \'<input type="checkbox" name="subjects" id="_subject_\' + subject.id + \'" value="\' + subject.id + \'" class="checkbox__input js-subject" \' + (userHasSubject(subject.id) ? \'checked="checked"\' : \'\') + \'>\' +\n                                                                    \'</div>\' +\n                                                                    \'<label class="checkbox__label" for="_subject_\' + subject.id + \'">\' + subject.name + \'</label>\' +\n                                                                \'</div>\' +\n                                                            \'</div>\';\n                                                    }, \'\');\n                                                }\n                                            %>\n\n                                            <div class="box u-mb0">\n                                                <%= r(model.children) %>\n                                            </div>\n                                        </div>\n                                    <% }) %>\n                                </div>\n                                <div class="field__error"></div>\n                            </fieldset>\n                            \n                        </div>\n                    <% } else { %>\n                        <strong>Loading...</strong>\n                    <% } %>\n\n                    <div class="tar">\n                        <a href="#" class="u-mr js-close">Cancel</a>\n                        <button class="btn js-save" disabled>Save</button>\n                    </div>\n                </form>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay js-close"></div>\n'}),define("apps/subjects/edit/views/layout",["base","entities/user","requirejs-text!apps/subjects/edit/templates/layout.html"],function(e,t,i){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(i),templateHelpers:function(){var e=t.current();return{collection:this.collection.toJSON(),userHasSubject:function(t){return!_.isUndefined(e.subjects.get(t))}}},ui:{submit:".js-save",subject:".js-subject",subjects:".js-subjects",tabs:".js-tab"},collectionEvents:{sync:"render"},fields:[["subjects",function(){var e=$(this.ui.subject.selector+":checked");return _.map(e,function(e){return new this.collection.model({id:e.value})},this)}]],onRender:function(){this.ui.tabs.length>0&&(this.ui.tabs.first().click(),this.ui.submit.removeAttr("disabled"))}}))}),define("apps/subjects/edit/controller",["base","events","entities/user","entities/subject","apps/subjects/edit/views/layout"],function(e,t,i,n,s){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.region=e.region,this.user=i.current(),this.subjects=n.collection(),this.view=new s({collection:this.subjects}),this.listenTo(this.view,"show",this.onShow),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user.subjects,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user.subjects,"sync",this.onSyncSuccess),this.listenTo(this.user.subjects,"error",this.onSyncError),this.listenTo(this.user.subjects,"invalid",this.onInvalid),this.region.show(this.view)},onShow:function(){_.progress().start(),this.listenToOnce(this.subjects,"sync",function(){_.progress().done()}),this.subjects.fetch()},save:function(e){t.trigger("requirement:pending",{section:"profile",name:"subjects"}),this.user.subjects.reset(e.subjects),this.user.subjects.save()},onSyncSuccess:function(e,t){_.toast("Saved!","success"),this.view.destroy()},onSyncError:function(e,i){t.trigger("requirement:incompleted",{section:"profile",name:"subjects"})},onDestroy:function(){var e=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid")});this.app.history.back(e)}}))}),define("apps/subjects/controller",["base","apps/subjects/edit/controller"],function(e,t){return e.Controller.extend({edit:function(e){return e=_.isObject(e)?e:{},new t(_.extend({app:this.app,region:this.app.dialogueRegion},e))}})}),define("apps/subjects/router",["base"],function(e){return e.Router.extend({routes:{edit:laroute.route("tutor.profile.show",{uuid:":uuid",section:"subjects"})},edit:function(){this.controller.edit()}})}),define("apps/subjects/app",["apps/subjects/controller","apps/subjects/router"],function(e,t){return function(){var i=new e({app:this});return new t({controller:i})}}),define("requirejs-text!apps/qualifications/edit/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.profile.qualifications.edit.heading\') %></h4>\n                    <a href="#" class="close icon icon--cross js-close"></a>\n                </header>\n\n                <p><%= _.lang(\'dialogue.profile.qualifications.edit.introduction\') %></p>\n\n                <form class="js-form" novalidate>\n                    <div class="field">\n                        <fieldset class="fieldset u-mb0">\n                            <div class="[ tabs tabs--bordered tabs--scrollable tabs--scrollable-right ] fieldset__tabs">\n                                <ul class="tabs__list">\n                                    <li class="tabs__item">\n                                        <a href="<%= laroute.route(\'tutor.profile.show\', { \'uuid\' : uuid , \'section\' : \'qualifications\', \'tab\' : \'university\' }) %>" class="tabs__link js-tab-university" data-tab-group="qualifications" data-tab-name="university">\n                                            University\n                                        </a>\n                                    </li>\n                                    <li class="tabs__item">\n                                        <a href="<%= laroute.route(\'tutor.profile.show\', { \'uuid\' : uuid , \'section\' : \'qualifications\', \'tab\' : \'college\' }) %>" class="tabs__link js-tab-college" data-tab-group="qualifications" data-tab-name="alevels">\n                                            College\n                                        </a>\n                                    </li>\n                                    <li class="tabs__item">\n                                        <a href="<%= laroute.route(\'tutor.profile.show\', { \'uuid\' : uuid , \'section\' : \'qualifications\', \'tab\' : \'other\' }) %>" class="tabs__link js-tab-other" data-tab-group="qualifications" data-tab-name="other">\n                                            Other\n                                        </a>\n                                    </li>\n                                </ul>\n                            </div>\n\n                            <div class="[ box box--fill box--bordered ] dialogue__body u-mb0">\n                                <div class="tab-content" data-tab-group="qualifications" data-tab-name="university">\n                                    <div class="js-universities"></div>\n                                </div>\n\n                                <div class="tab-content" data-tab-group="qualifications" data-tab-name="alevels">\n                                    <div class="js-alevels"></div>\n                                </div>\n\n                                <div class="tab-content" data-tab-group="qualifications" data-tab-name="other">\n                                    <div class="js-others"></div>\n                                </div>\n                            </div>\n                        </fieldset>\n                        <div class="field__error [ js-qualifications-error ]"></div>\n                    </div>\n\n                    <div class="tar">\n                        <a href="#" class="u-mr [ js-close ]">Cancel</a>\n                        <button class="btn">Save</button>\n                    </div>\n                </form>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay js-close"></div>\n'}),define("apps/qualifications/edit/views/layout",["base","requirejs-text!apps/qualifications/edit/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout"],className:"dialogue dialogue--qualifications",template:_.template(t),regions:{universitiesRegion:".js-universities",alevelsRegion:".js-alevels",othersRegion:".js-others"},ui:{university_tab:".js-tab-university",college_tab:".js-tab-college",other_tab:".js-tab-other",error:".js-qualifications-error"},onShow:function(){var e=this.ui[this.options.tab+"_tab"];e&&e.length>0&&e.click()},getData:function(){var e={universities:[],alevels:[],others:[]};return _.each(e,function(t,i){var n=this[i+"Region"].currentView;n&&_.isFunction(n.getData)&&(e[i]=n.getData())},this),e},showErrors:function(e){return _.has(e,"qualifications")&&(this.ui.error.text(e.qualifications),this.ui.error.show()),_.each(object_undot(e),function(e,t){var i=this[t+"Region"];i&&i.currentView&&(i=i.currentView,_.each(e,function(e,t){var n=i.children.findByIndex(t);n&&n.showErrors(e)},this))},this),!0}}))}),define("requirejs-text!apps/qualifications/edit/templates/composite.html",[],function(){return'<div class="js-fields"></div>\n\n<a href="#" class="js-add">Add another</a>'}),define("apps/qualifications/edit/views/composite",["base","requirejs-text!apps/qualifications/edit/templates/composite.html"],function(e,t){return e.CompositeView.extend({template:_.template(t),childViewContainer:".js-fields",ui:{add:".js-add"},events:{"click @ui.add":"onClickAdd"},childEvents:{remove:"removeModel"},initialize:function(){this.addModelIfEmpty()},onClickAdd:function(e){return e.preventDefault&&e.preventDefault(),this.addModel(),!1},getData:function(){return this.children.map(function(e){return e.getFieldsData()})},addModel:function(){var e=this.collection.model;this.collection.add(e)},addModelIfEmpty:function(){this.collection.isEmpty()&&this.addModel()},removeModel:function(e,t){this.collection.remove(t),this.addModelIfEmpty()}})}),define("apps/qualifications/edit/views/child",["base"],function(e){return _.patch(e.ItemView.extend({mixins:["FieldsLayout"],className:"[ layout ]",ui:{remove:".js-remove"},events:{"click @ui.remove":"onClickRemove"},onClickRemove:function(e){return e.preventDefault&&e.preventDefault(),this.removeSelf(),!1},removeSelf:function(){this.trigger("remove",this.model)}}))}),define("requirejs-text!apps/qualifications/edit/templates/university.html",[],function(){return'<div class="[ layout__item layout__item--location ] field">\n    <input type="text" name="university" placeholder="University*" value="<%= university %>" class="[ input input--full input--squared input--bordered ] field__input  [ js-university ]">\n    <div class="field__error"></div>\n</div><!--\n\n--><div class="[ layout__item layout__item--level ] field">\n    <div class="field__input select select--full select--squared select--bordered <%= level ? \'select--show\' : \'\' %>">\n        <span class="select__placeholder">Level*</span>\n        <span class="select__value"><%= level ? _level(level) : \'\' %></span>\n        <select name="level" class="select__field js-level">\n            <option value="">Please select one:</option>\n            <% _.each(_levels, function (value, key) { %>\n                <option value="<%= key %>" <%= level === key ? \'selected\' : \'\' %>>\n                    <%= value %>\n                </option>\n            <% }) %>\n        </select>\n    </div>\n\n    <div class="field__error"></div>\n</div><!--\n\n--><div class="[ layout__item layout__item--subject ] field">\n    <input type="text" name="subject" placeholder="Subject*" value="<%= subject %>" class="[ input input--full input--squared input--bordered ] field__input  [ js-subject ]">\n    <div class="field__error"></div>\n</div><!--\n\n\n--><div class="[ layout__item layout__item--still-studying ] field">\n    <div class="field__checkbox checkbox">\n        <div class="checkbox__box">\n            <div class="checkbox__tick"></div>\n            <input type="checkbox" name="still_studying" id="still_studying" value="1" class="checkbox__input [ js-still-studying ]">\n        </div>\n        <label class="checkbox__label">Still studying</label>\n    </div>\n    <div class="field__error"></div>\n</div><!--\n\n--><div class="[ layout__item ] tar">\n    <a href="#" class="js-remove">Remove</a>\n</div><!--\n\n--><div class="[ layout__item ]">\n    <hr class="hr u-mt-">\n</div>'}),define("apps/qualifications/edit/views/university",["base","apps/qualifications/edit/views/child","requirejs-text!apps/qualifications/edit/templates/university.html"],function(e,t,i){return t.extend({template:_.template(i),templateHelpers:function(){return{_level:function(e){return _.lang("qualifications.university.levels."+e)},_levels:_.lang("qualifications.university.levels")}},ui:{university:".js-university",subject:".js-subject",level:".js-level",still_studying:".js-still-studying",remove:".js-remove"},fields:["university","subject","level","still_studying"]})}),define("apps/qualifications/edit/views/universities",["base","apps/qualifications/edit/views/composite","apps/qualifications/edit/views/university"],function(e,t,i){return t.extend({childView:i})}),define("requirejs-text!apps/qualifications/edit/templates/alevel.html",[],function(){return'<div class="[ layout__item layout__item--location ] field">\n    <input type="text" name="college" placeholder="College*" value="<%= college %>" class="[ input input--full input--squared input--bordered ] field__input  [ js-college ]">\n    <div class="field__error"></div>\n</div><!--\n\n--><div class="[ layout__item layout__item--level ] field">\n    <div class="field__input select select--full select--squared select--bordered <%= grade ? \'select--show\' : \'\' %>">\n        <span class="select__placeholder">Grade*</span>\n        <span class="select__value"><%= grade ? _grade(grade) : \'\' %></span>\n        <select name="grade" class="select__field js-grade">\n            <option value="">Please select one:</option>\n            <% _.each(_grades, function (value, key) { %>\n                <option value="<%= key %>" <%= grade === key ? \'selected\' : \'\' %>>\n                    <%= value %>\n                </option>\n            <% }) %>\n        </select>\n    </div>\n\n    <div class="field__error"></div>\n</div><!--\n\n--><div class="[ layout__item layout__item--subject ] field">\n    <input type="text" name="subject" placeholder="Subject*" value="<%= subject %>" class="[ input input--full input--squared input--bordered ] field__input  [ js-subject ]">\n    <div class="field__error"></div>\n</div><!--\n\n\n--><div class="[ layout__item layout__item--still-studying ] field">\n    <div class="field__checkbox checkbox">\n        <div class="checkbox__box">\n            <div class="checkbox__tick"></div>\n            <input type="checkbox" name="still_studying" id="still_studying" value="1" class="checkbox__input [ js-still-studying ]">\n        </div>\n        <label class="checkbox__label">Still studying</label>\n    </div>\n    <div class="field__error"></div>\n</div><!--\n\n--><div class="[ layout__item ] tar">\n    <a href="#" class="js-remove">Remove</a>\n</div><!--\n\n--><div class="[ layout__item ]">\n    <hr class="hr u-mt-">\n</div>'}),define("apps/qualifications/edit/views/alevel",["base","apps/qualifications/edit/views/child","requirejs-text!apps/qualifications/edit/templates/alevel.html"],function(e,t,i){return t.extend({template:_.template(i),templateHelpers:function(){return{_grade:function(e){return _.lang("qualifications.alevel.grades."+e)},_grades:_.lang("qualifications.alevel.grades")}},ui:{college:".js-college",subject:".js-subject",grade:".js-grade",still_studying:".js-still-studying",remove:".js-remove"},fields:["college","subject","grade","still_studying"]})}),define("apps/qualifications/edit/views/alevels",["base","apps/qualifications/edit/views/composite","apps/qualifications/edit/views/alevel"],function(e,t,i){return t.extend({childView:i})}),define("requirejs-text!apps/qualifications/edit/templates/other.html",[],function(){return'<div class="[ layout__item layout__item--location ] field">\n    <input type="text" name="location" placeholder="Location*" value="<%= location %>" class="[ input input--full input--squared input--bordered ] field__input  [ js-location ]">\n    <div class="field__error"></div>\n</div><!--\n\n--><div class="[ layout__item layout__item--level ] field">\n    <input type="text" name="grade" placeholder="Grade" value="<%= grade %>" class="[ input input--full input--squared input--bordered ] field__input  [ js-grade ]">\n    <div class="field__error"></div>\n</div><!--\n\n--><div class="[ layout__item layout__item--subject ] field">\n    <input type="text" name="subject" placeholder="Subject*" value="<%= subject %>" class="[ input input--full input--squared input--bordered ] field__input  [ js-subject ]">\n    <div class="field__error"></div>\n</div><!--\n\n\n--><div class="[ layout__item layout__item--still-studying ] field">\n    <div class="field__checkbox checkbox">\n        <div class="checkbox__box">\n            <div class="checkbox__tick"></div>\n            <input type="checkbox" name="still_studying" id="still_studying" value="1" class="checkbox__input [ js-still-studying ]">\n        </div>\n        <label class="checkbox__label">Still studying</label>\n    </div>\n    <div class="field__error"></div>\n</div><!--\n\n--><div class="[ layout__item ] tar">\n    <a href="#" class="js-remove">Remove</a>\n</div><!--\n\n--><div class="[ layout__item ]">\n    <hr class="hr u-mt">\n</div>'}),define("apps/qualifications/edit/views/other",["base","apps/qualifications/edit/views/child","requirejs-text!apps/qualifications/edit/templates/other.html"],function(e,t,i){return t.extend({template:_.template(i),ui:{location:".js-location",subject:".js-subject",grade:".js-grade",still_studying:".js-still-studying",remove:".js-remove"},fields:["location","subject","grade","still_studying"]})}),define("apps/qualifications/edit/views/others",["base","apps/qualifications/edit/views/composite","apps/qualifications/edit/views/other"],function(e,t,i){return t.extend({childView:i})}),define("apps/qualifications/edit/controller",["base","events","entities/user","apps/qualifications/edit/views/layout","apps/qualifications/edit/views/universities","apps/qualifications/edit/views/alevels","apps/qualifications/edit/views/others"],function(e,t,i,n,s,o,r){return _.patch(e.Controller.extend({mixins:["DialogueController","FormController"],initialize:function(e){this.region=e.region,this.user=i.current(),this.view=new n({tab:this.options.tab,model:this.user}),this.listenTo(this.view,"show",this.onShow),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user.qualifications,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user.qualifications,"sync",this.onSyncSuccess),this.listenTo(this.user.qualifications,"error",this.onSyncError),this.listenTo(this.user.qualifications,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){t.trigger("requirement:pending",{section:"profile",name:"qualifications"}),_.each(["universities","alevels","others"],function(t){var i=this.user.qualifications[t];i&&i.reset(e[t])},this),this.user.qualifications.save()},onSyncSuccess:function(e,t){_.toast("Saved!","success"),this.view.destroy()},onSyncError:function(){t.trigger("requirement:incompleted",{section:"profile",name:"qualifications"})},onDestroy:function(){var e=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid")});this.app.history.back(e)},onShow:function(){this.renderUniversities(),this.renderAlevels(),this.renderOthers()},renderUniversities:function(){var e=new s({collection:this.user.qualifications.universities});this.view.universitiesRegion.show(e)},renderAlevels:function(){var e=new o({collection:this.user.qualifications.alevels});this.view.alevelsRegion.show(e)},renderOthers:function(){var e=new r({collection:this.user.qualifications.others});this.view.othersRegion.show(e)}}))}),define("apps/qualifications/controller",["base","apps/qualifications/edit/controller"],function(e,t){return e.Controller.extend({edit:function(e){return e=_.isObject(e)?e:{},new t(_.extend({app:this.app,region:this.app.dialogueRegion},e))}})}),define("apps/qualifications/router",["base"],function(e){return e.Router.extend({routes:{edit:laroute.route("tutor.profile.show",{uuid:":id",section:"qualifications"})+"(/:tab)"},edit:function(e,t){this.controller.edit({tab:t||"university"})}})}),define("apps/qualifications/app",["apps/qualifications/controller","apps/qualifications/router"],function(e,t){return function(){var i=new e({app:this});return new t({controller:i})}}),define("entities/user_dialogue_interaction",["base"],function(e){var t=Backbone.Model.extend({idAttribute:"id",urlRoot:"/api/user_dialogue_interaction",defaults:{duration:null}});return function(e,i){return new t(e,i)}}),define("requirejs-text!apps/quiz/introduction/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper quiz quiz__introduction">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n        <div class="dialogue__window">\n            <header class="dialogue__header">\n                <a href="#" class="close icon icon--cross [ js-close ]"></a>\n                <h4 class="heading">You\'re almost ready to go live!</h4>\n            </header>\n\n            <p>Thank you for completing your profile. We want to make sure that you know how it all works so you get the best experience possible on Tutora! Read through the following details and then complete the quiz. Don\'t worry, it only takes a few minutes and will make sure that you get the most from tutoring with us.</p>\n\n            <form class="js-form" novalidate>\n                <div class="tar">\n                    <button class="btn">Get started</button>\n                </div>\n            </form>\n        </div>\n    </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay [ js-close ]"></div>\n'}),define("apps/quiz/introduction/views/layout",["base","entities/user","requirejs-text!apps/quiz/introduction/templates/layout.html"],function(e,t,i){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(i),templateHelpers:function(){var e=t.current();return{user:e.toJSON()}}}))}),define("apps/quiz/introduction/controller",["base","events","entities/user","entities/user_dialogue_interaction","apps/quiz/introduction/views/layout"],function(e,t,i,n,s){return _.patch(e.Controller.extend({mixins:["DialogueController"],initialize:function(e){this.region=e.region,this.user=i.current(),this.view=new s({model:this.user}),this.listenTo(this.view,"show",this.recordInteraction),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},recordInteraction:function(){this.timestamp=Date.now(),this.interaction=new n({uuid:this.user.id,name:"quiz_intro"}),this.interaction.save({},{async:!1})},onFormSubmit:function(){this.view.destroy(),this.interaction&&this.timestamp&&this.interaction.save({duration:Date.now()-this.timestamp},{patch:!0});var e=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid"),section:"quiz_prep",tab:"1"});this.app.history.navigate(e,{trigger:!0})},onDestroy:function(){var e=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid")});this.app.history.back(e)}}))}),define("entities/quiz_prep",["base"],function(e){var t=e.Model.extend({urlRoot:"/api/quiz_prep"}),i=e.Model.extend({idAttribute:"key",defaults:{title:"",image:null,text:""}}),n=e.Collection.extend({model:i,url:"/api/quiz_prep",parse:function(e){return _.has(e,"data")?data=e.data:data=e}});return{model:function(e,i){return new t(e,i)},collection:function(e,t){return new n(e,t)}}}),define("requirejs-text!apps/quiz/prep/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper quiz quiz__introduction">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n        <div class="dialogue__window">\n            <header class="dialogue__header">\n                <a href="#" class="close icon icon--cross [ js-close ]"></a>\n                <h4 class="heading"><%= title %></h4>\n            </header>\n\n            <p><%= text %></p>\n\n            <form class="js-form" novalidate>\n                <div class="tal block-50 dialog-buttons-top-padding-1">\n                    <button type="button" class="btn btn--back">Back</button>\n                </div>\n                <div class="tar block-50 dialog-buttons-top-padding-1">\n                    <button class="btn">Next</button>\n                </div>\n            </form>\n        </div>\n    </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay [ js-close ]"></div>\n'}),define("apps/quiz/prep/views/layout",["base","entities/user","entities/quiz_prep","requirejs-text!apps/quiz/prep/templates/layout.html"],function(e,t,i,n){
return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(n),templateHelpers:function(){var e=t.current();return _.has(window,"quiz_prep_items")||(window.quiz_prep_items=i.collection(),window.quiz_prep_items.fetch({async:!1})),prep_item=window.quiz_prep_items.models[this.options.tab-1],{user:e.toJSON(),title:prep_item.get("title"),text:prep_item.get("text")}},events:{"click .btn--back":"back"},back:function(){this.trigger("back")}}))}),define("apps/quiz/prep/controller",["base","events","entities/user","entities/quiz_prep","entities/user_dialogue_interaction","apps/quiz/prep/views/layout"],function(e,t,i,n,s,o){return _.patch(e.Controller.extend({mixins:["DialogueController"],initialize:function(e){this.region=e.region,this.user=i.current(),this.tab=e.tab,this.view=new o({model:this.user,tab:this.tab}),this.recordInteraction(),this.listenTo(this.view,"back",this.onFormBack),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},recordInteraction:function(){this.timestamp=Date.now(),this.interaction=new s({uuid:this.user.id,name:"quiz_prep",data:this.tab}),this.interaction.save({},{async:!1})},onFormBack:function(){this.interaction&&this.timestamp&&this.interaction.save({duration:Date.now()-this.timestamp},{patch:!0}),this.view.destroy();var e=null,t=parseInt(this.tab);e=isNaN(t)||1>=t?laroute.route("tutor.profile.show",{uuid:this.user.get("uuid"),section:"quiz_intro"}):laroute.route("tutor.profile.show",{uuid:this.user.get("uuid"),section:"quiz_prep",tab:t-1}),this.app.history.navigate(e,{trigger:!0})},onFormSubmit:function(){this.interaction&&this.timestamp&&this.interaction.save({duration:Date.now()-this.timestamp},{patch:!0}),this.view.destroy();var e=window.quiz_prep_items.length,t=parseInt(this.tab),i=null;i=isNaN(t)||t>=e?laroute.route("tutor.profile.show",{uuid:this.user.get("uuid"),section:"quiz_questions"}):laroute.route("tutor.profile.show",{uuid:this.user.get("uuid"),section:"quiz_prep",tab:t+1}),this.app.history.navigate(i,{trigger:!0})},onDestroy:function(){var e=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid")});this.app.history.back(e)}}))}),define("requirejs-text!apps/quiz/edit/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper quiz quiz__questions">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.profile.quiz.edit.heading\') %></h4>\n                    <a href="#" class="close icon icon--cross [ js-close ]"></a>\n                </header>\n\n                <form class="js-form" novalidate>\n                    <div class="fieldset__content field">\n                        <div class="[ js-questions ]"></div>\n                    </div>\n\n                    <form class="js-form" novalidate>\n                        <div class="tal block-50 dialog-buttons-top-padding-1">\n                            <button type="button" class="btn btn--back">Back</button>\n                        </div>\n                        <div class="tar block-50 dialog-buttons-top-padding-1">\n                            <button class="btn">Submit Answers.</button>\n                        </div>\n                    </form>\n                </form>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay [ js-close ]"></div>\n'}),define("apps/quiz/edit/views/layout",["base","requirejs-text!apps/quiz/edit/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],initialize:function(e){this.questions=e.questions,this.listenTo(this.questions,"sync",this.onQuestionsChanged)},onQuestionsChanged:function(){this.fields=_.map(this.questions.models,this.getField,this)},getAnswers:function(){return $("form",this.$el)},getField:function(e){var t=e.get("key"),i=$(".js-answer",this.$el);return[t,function(){return _.val(i.filter(".js-"+t+":checked"))}]},showErrors:function(e){return _.each(object_undot(e),function(e,t){var i=this.questionsRegion;_.each(e,function(e,t){var n=this.questions.get(t),s=i.currentView.children.findByModel(n);if(s){var o=s.$el.find(this.fieldErrorSelector),r=s.$el.find(".radios__item--checked > input").val(),a=null;if(_.isUndefined(r))a="You have not answered this question!";else{var l=n.get("answers");_.every(l.models,function(e){return e.get("key")==r?(a=e.get("if_wrong")?e.get("if_wrong"):"Wrong answer, please try again.",!1):!0})}o.text(a),s.$el.addClass(this.fieldParentHasErrorClassName)}},this)},this),this.showSuccessFields(),!0},showSuccessFields:function(){var e=this.$el.find(this.fieldErrorSelector).filter(":empty");e.text(_.lang("validation.custom.quiz.correct_answer")),e.addClass("correct")},hideErrors:function(){var e=this.$el.find(this.fieldErrorSelector);e.removeClass(this.fieldParentHasErrorClassName),e.removeClass("correct"),e.text("")},template:_.template(t),regions:{questionsRegion:".js-questions"},events:{"click .btn--back":"back"},back:function(){this.trigger("back")}}))}),define("requirejs-text!apps/quiz/edit/templates/answer.html",[],function(){return'<div class="radios__item full-width rounded js-<%= parentKey %>-<%= key %><% if (checked) { %> radios__item--checked<% } %>">\n    <%= title %>\n    <input type="radio" name="<%= parentKey %>-answer" value="<%= key %>" class="radios__input js-answer js-<%= parentKey %>"<% if (checked) { %> checked="checked"<% } %>>\n</div>'}),define("apps/quiz/edit/views/answer",["base","requirejs-text!apps/quiz/edit/templates/answer.html"],function(e,t){return e.ItemView.extend({initialize:function(e){this.model.set("parentKey",e.parentKey)},template:_.template(t),templateHelpers:function(){var e=!1,t=this.options.parentKey,i=this.model.get("key");return _.has(window,"quiz_answers")&&_.each(window.quiz_answers,function(n){n.name==t+"-answer"&&n.value==i&&(e=!0)}),{checked:e}}})}),define("requirejs-text!apps/quiz/edit/templates/question.html",[],function(){return'<div class="layout__item layout__item--<%= key %> field">\n    <label class="field__label"><%= question %></label>\n    <div class="radios"></div>\n    <div class="field__error"></div>\n</div>'}),define("apps/quiz/edit/views/question",["base","apps/quiz/edit/views/answer","requirejs-text!apps/quiz/edit/templates/question.html"],function(e,t,i){return e.CompositeView.extend({initialize:function(){this.collection=this.model.get("answers")},childViewContainer:".radios",template:_.template(i),childView:t,childViewOptions:function(){return{parentKey:this.model.get("key")}}})}),define("apps/quiz/edit/views/questions",["base","apps/quiz/edit/views/question"],function(e,t){return e.CollectionView.extend({childView:t})}),define("apps/quiz/edit/controller",["base","events","entities/user","entities/quiz","entities/quiz_prep","apps/quiz/edit/views/layout","entities/user_dialogue_interaction","apps/quiz/edit/views/questions"],function(e,t,i,n,s,o,r,a){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.region=e.region,this.user=i.current(),this.questions=n.collection(),this.quiz=n.model(),this.view=new o({questions:this.questions}),this.listenTo(this.view,"back",this.onFormBack),this.listenTo(this.view,"show",this.onShow),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user.quiz,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user.quiz,"sync",this.onSyncSuccess),this.listenTo(this.user.quiz,"error",this.onSyncError),this.listenTo(this.user.quiz,"invalid",this.onInvalid),this.region.show(this.view)},onShow:function(){_.progress().start(),this.listenToOnce(this.questions,"sync",function(){_.progress().done()}),this.questions.fetch(),this.renderQuestionList(),this.recordInteraction()},recordInteraction:function(){this.timestamp=Date.now(),this.interaction=new r({uuid:this.user.id,name:"quiz_questions",data:"incomplete"}),this.interaction.save({},{async:!1})},renderQuestionList:function(){var e=new a({collection:this.questions});this.view.questionsRegion.show(e)},save:function(e){t.trigger("requirement:pending",{section:"quiz",name:"questions"}),this.user.quiz.save({answers:e})},onSyncSuccess:function(e,t){_.toast("Thank you for the completing of our quiz!","success"),this.interaction&&this.timestamp&&this.interaction.save({duration:Date.now()-this.timestamp,data:"complete"},{patch:!0}),delete window.quiz_answers,this.view.destroy();var i=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid"),section:"review_notification"});this.app.history.navigate(i,{trigger:!0})},onSyncError:function(){t.trigger("requirement:incompleted",{section:"quiz",name:"questions"})},onDestroy:function(){var e=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid")});this.app.history.navigate(e,{trigger:!0})},onFormBack:function(){this.interaction&&this.timestamp&&this.interaction.save({duration:Date.now()-this.timestamp,data:"back"},{patch:!0}),window.quiz_answers=this.view.getAnswers().serializeArray(),this.view.destroy(),_.has(window,"quiz_prep_items")||(window.quiz_prep_items=s.collection(),window.quiz_prep_items.fetch({async:!1}));var e=window.quiz_prep_items.length,t=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid"),section:"quiz_prep",tab:e});this.app.history.navigate(t,{trigger:!0})}}))}),define("apps/quiz/controller",["base","apps/quiz/introduction/controller","apps/quiz/prep/controller","apps/quiz/edit/controller"],function(e,t,i,n){return e.Controller.extend({introduction:function(e){return e=_.isObject(e)?e:{},new t(_.extend({app:this.app,region:this.app.dialogueRegion},e))},quiz_prep:function(e,t,n){return e=_.isObject(e)?e:{},new i(_.extend({tab:n,app:this.app,region:this.app.dialogueRegion},e))},edit:function(e){return e=_.isObject(e)?e:{},new n(_.extend({app:this.app,region:this.app.dialogueRegion},e))}})}),define("apps/quiz/router",["base"],function(e){return e.Router.extend({routes:{introduction:laroute.route("tutor.profile.show",{uuid:":id",section:"quiz_intro"}),quiz_prep:laroute.route("tutor.profile.show",{uuid:":id",section:"quiz_prep",tab:":tab"}),edit:laroute.route("tutor.profile.show",{uuid:":id",section:"quiz_questions"})},introduction:function(){this.controller.introduction()},quiz_prep:function(e,t){this.controller.quiz_prep({},e,t)},edit:function(){this.controller.edit()}})}),define("apps/quiz/app",["apps/quiz/controller","apps/quiz/router"],function(e,t){return function(){var i=new e({app:this});return new t({controller:i})}}),define("requirejs-text!apps/qts/edit/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container dialogue__container--tiny">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.profile.qts.edit.heading\') %></h4>\n                    <a href="#" class="close icon icon--cross [ js-close ]"></a>\n                </header>\n\n                <p><%= _.lang(\'dialogue.profile.qts.edit.introduction\') %></p>\n\n                <form class="[ layout ] [ js-form ]" novalidate><!--\n                    --><div class="[ layout__item ] field">\n                        <div class="field__input [ select select--full select--squared select--bordered <%= qts.level ? \'select--show\' : \'\' %> ]">\n                            <span class="select__placeholder">Level*</span>\n                            <span class="select__value"><%= _.lang(\'qualifications.teacher_status.levels.\' + qts.level) %></span>\n                            <select name="student" class="select__field [ js-qts ]">\n                                <option value="">Please select one:</option>\n                                <% _.each(_.lang(\'qualifications.teacher_status.levels\'), function (title, value) { %>\n                                    <option value="<%= value %>" <%= qts.level === value ? \'selected\' : \'\' %>>\n                                        <%= title %>\n                                    </option>\n                                <% }) %>\n                            </select>\n                        </div>\n\n                        <div class="field__error"></div>\n                    </div><!--\n\n                    --><div class="layout__item tar">\n                        <a href="#" class="u-mr [ js-close ]">Cancel</a>\n                        <button class="btn">Save</button>\n                    </div><!--\n                --></form>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay [ js-close ]"></div>\n'}),define("apps/qts/edit/views/layout",["base","requirejs-text!apps/qts/edit/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(t),ui:{level:".js-qts"},fields:["level"]}))}),define("apps/qts/edit/controller",["base","events","entities/user","apps/qts/edit/views/layout"],function(e,t,i,n){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.region=e.region,this.user=i.current(),this.view=new n({model:this.user}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user.qts,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user.qts,"sync",this.onSyncSuccess),this.listenTo(this.user.qts,"error",this.onSyncError),this.listenTo(this.user.qts,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){t.trigger("requirement:pending",{section:"profile",name:"qualified_teacher_status"}),this.user.qts.save(e)},onSyncSuccess:function(e,t){_.toast("Saved!","success"),this.view.destroy()},onSyncError:function(){t.trigger("requirement:incompleted",{section:"profile",name:"qualified_teacher_status"})},onDestroy:function(){var e=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid")});this.app.history.back(e)}}))}),define("apps/qts/controller",["base","apps/qts/edit/controller"],function(e,t){return e.Controller.extend({edit:function(e){return e=_.isObject(e)?e:{},new t(_.extend({app:this.app,region:this.app.dialogueRegion},e))}})}),define("apps/qts/router",["base"],function(e){return e.Router.extend({routes:{edit:laroute.route("tutor.profile.show",{uuid:":uuid",section:"qts"})},edit:function(){this.controller.edit()}})}),define("apps/qts/app",["apps/qts/controller","apps/qts/router"],function(e,t){return function(){var i=new e({app:this});return new t({controller:i})}}),define("entities/booking",["base","entities/user","entities/subject"],function(e,t,i){var n=e.Model.extend({}),s=e.Model.extend({urlRoot:"/api/bookings",idAttribute:"uuid",defaults:{tutorId:null,student:null,subject:null,location:null,date:null,time:null,duration:null,rate:null,tutor_rate:null},nested:{models:["schedule","student","subject"]},validation:{date:[{required:!0,msg:_.lang("validation.required",{attribute:"date"})}],time:[{required:!0,msg:_.lang("validation.required",{attribute:"time"})}],duration:[{required:!0,msg:_.lang("validation.required",{attribute:"duration"})}],rate:"validateRate"},validateRate:function(e,t,i){var n=parseInt(e),s=parseInt(.5*this.tutor_rate),o=parseInt(2*this.tutor_rate);return s>n||n>o?"You can only set the hourly rate between "+s+" - "+o:void 0},constructor:function(e,s){e=e||{};e[this.idAttribute];return this.tutor_rate=e.tutor_rate,this.schedule=new n,this.student=t.model(),this.subject=i.model(),Backbone.Model.apply(this,arguments)},cancel:function(e){var t=this.url;this.url=this.urlRoot+"/"+this.id+"/cancel",this.save(e),this.url=t},confirm:function(e){var t=this.url;this.url=this.urlRoot+"/"+this.id+"/confirm",this.save(e),this.url=t},saveForTutor:function(e,t){var i=this.url;this.url=laroute.route("api.tutors.lessons.book",{uuid:e}),this.save(t),this.url=i},refund:function(e){var t=this.url;this.url=this.urlRoot+"/"+this.id+"/refund",this.save(e),this.url=t}});return{model:function(e,t){return new s(e,t)}}}),define("requirejs-text!apps/booking/create_for_tutor/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.booking.create.heading\') %></h4>\n                    <a href="#" class="close icon icon--cross js-close"></a>\n                </header>\n\n                <p><%= _.lang(\'dialogue.booking.create_for_tutor.introduction\') %></p>\n\n                <form class="js-form">\n\n                    <div class="dialogue__body box box--fill box--bordered">\n                        <div class="layout"><!--\n                            --><div class="layout__item layout__item--student field">\n                            <div class="field__input select select--full select--squared select--bordered <%= student ? \'select--show\' : \'\' %>">\n                                <span class="select__placeholder">Student*</span>\n                                <span class="select__value"><%= student ? student.title : \'\' %></span>\n                                <select name="student" class="select__field js-student">\n                                    <option value="">Please select one:</option>\n                                    <% _.each(students, function (student) { %>\n                                    <option value="<%= student.value %>" data-rate="<%= student.rate %>" <%= student.selected ? \'selected\' : \'\' %>>\n                                    <%= student.title %>\n                                    </option>\n                                    <% }) %>\n                                </select>\n                            </div>\n\n                            <div class="field__error"></div>\n                        </div><!--\n\n                            --><div class="layout__item layout__item--subject field">\n                            <div class="field__input select select--full select--squared select--bordered <%= subject ? \'select--show\' : \'\' %>">\n                                <span class="select__placeholder">Subject*</span>\n                                <span class="select__value"><%= subject ? subject.title : \'\' %></span>\n                                <select  name="subject" class="select__field js-subject">\n                                    <option value="">Please select one:</option>\n                                    <% _.each(subjects, function (subject) { %>\n                                    <option value="<%= subject.value %>" <%= subject.selected ? \'selected\' : \'\' %>>\n                                    <%= subject.title %>\n                                    </option>\n                                    <% }) %>\n                                </select>\n                            </div>\n\n                            <div class="field__error"></div>\n                        </div><!--\n\n                            --><div class="layout__item layout__item--location field">\n                            <input type="text" name="location" placeholder="Location*" class="field__input input input--full input--squared input--bordered js-location">\n                            <div class="field__error"></div>\n                        </div>\n\n                            <div>\n                                <div class="layout__item layout__item--start l">\n                                    <div class="layout"><!--\n                                        --><div class="layout__item layout__item--date field js-date-container">\n                                        <label for="date" class="field__label">Date*</label>\n                                        <input type="text" name="date" placeholder="d/m/y" class="field__input input input--full input--squared input--bordered js-date">\n                                        <div class="field__error"></div>\n                                    </div><!--\n\n                                        --><div class="layout__item layout__item--time field">\n                                        <label for="time" class="field__label">Start time*</label>\n                                        <div class="field__input select select--full select--squared select--bordered">\n                                            <span class="select__placeholder">00:00*</span>\n                                            <span class="select__value"></span>\n                                            <select name="time" class="select__field js-time">\n                                                <option value="">Please select one:</option>\n                                                <% for (var hour = 0; hour < 24; hour++) { %>\n                                                <% for (var minute = 0; minute < 60; minute = minute + 30) { %>\n                                                <option><%= _.lpad(hour, 2, \'0\') %>:<%= _.lpad(minute, 2, \'0\') %></option>\n                                                <% } %>\n                                                <% } %>\n                                            </select>\n                                        </div>\n                                        <div class="field__error"></div>\n                                    </div><!--\n\n                                            --><div class="layout__item layout__item--time field">\n                                        <label for="duration" class="field__label">Duration*</label>\n                                        <div class="field__input select select--full select--squared select--bordered">\n                                            <span class="select__placeholder">00:00*</span>\n                                            <span class="select__value"></span>\n                                            <select name="duration" class="select__field js-duration">\n                                                <option value="">Please select one:</option>\n                                                <option>0:30</option>\n                                                <option>0:45</option>\n                                                <option>1:00</option>\n                                                <option>1:15</option>\n                                                <option>1:30</option>\n                                                <option>1:45</option>\n                                                <option>2:00</option>\n                                                <option>2:15</option>\n                                                <option>2:30</option>\n                                                <option>2:45</option>\n                                                <option>3:00</option>\n                                            </select>\n                                        </div>\n                                        <div class="field__error"></div>\n                                    </div><!--\n\n                                            --><div class="layout__item layout__item--rate field">\n                                        <label for="rate" class="field__label">Rate (&pound;<%= profile_rate %>)</label>\n                                        <input type="text" name="rate" placeholder="" class="field__input input input--full input--squared input--bordered js-rate">\n                                        <div class="field__error"></div>\n                                    </div><!--\n                                    --></div>\n\n                                    <div class="field">\n                                        <div class="field__error js-start"></div>\n                                    </div>\n                                </div>\n\n                                <div class="layout__item--total-price r">\n                                    <div class="layout__item layout__item--price field">\n                                        <label for="rate" class="field__label">Lesson Price</label>\n                                        <div class="box box--fill box--bordered">\n                                            <span class="total-price">0.00</span>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <div class="layout__item layout__item--repeat field">\n                                <label class="field__label">Lesson Repeat<sup>1</sup></label>\n                                <div class="radios">\n                                    <div class="radios__item js-repeat-never">\n                                        Never\n                                        <input type="radio" name="repeat" value="never" class="radios__input js-repeat">\n                                    </div>\n                                    <div class="radios__item radios__item--checked js-repeat-weekly">\n                                        Weekly\n                                        <input type="radio" name="repeat" value="weekly" class="radios__input js-repeat" checked="checked">\n                                    </div>\n                                    <div class="radios__item js-repeat-fortnightly">\n                                        Fortnightly\n                                        <input type="radio" name="repeat" value="fortnightly" class="radios__input js-repeat">\n                                    </div>\n                                </div>\n                                <div class="field__error"></div>\n                            </div><!--\n\n                            --><div class="layout__item">\n                                <p class="tiny"><sup>1</sup> Most of our tutors and students prefer to book either weekly or fortnightly\n                                    sessions, which allows students and tutors to plan their week around regular sessions. Students\n                                    or tutors can cancel sessions at any point and times can be altered where necessary.</p>\n                            </div><!--\n                        --></div>\n                    </div>\n\n                    <div class="layout"><!--\n                        --><div class="layout__item layout__item--actions tar">\n                        <a href="#" class="u-mr js-close">Cancel</a>\n                        <button class="btn btn js-submit">Create booking</button>\n                    </div><!--\n                    --></div>\n                </form>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay"></div>'}),define("apps/booking/create_for_tutor/views/layout",["base","requirejs-text!apps/booking/create_for_tutor/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(t),className:"dialogue dialogue--booking",initialize:function(){this.rate=this.options.user.get("rate"),this.duration=0},templateHelpers:function(){var e=this.options.user.students.map(function(e){return{value:e.get("uuid"),title:e.get("first_name")+" "+e.get("last_name"),rate:e.get("rate"),selected:_.queryString("student")==e.get("uuid")}}),t=_.findWhere(e,{selected:!0}),i=this.options.user.subjects.map(function(e){return{value:e.get("id"),title:e.get("title"),selected:_.queryString("subject")==e.get("id")}}),n=_.findWhere(i,{selected:!0}),s=this.options.user.get("rate");return{json:this.model.toJSON(),subjects:i,student:t,students:e,subject:n,profile_rate:s}},ui:{student:".js-student",subject:".js-subject",location:".js-location",date:".js-date",time:".js-time",duration:".js-duration",rate:".js-rate",repeat:".js-repeat",start:".js-start"},events:{"change @ui.student":"onStudentChange","change @ui.duration":"onDurationChange","keyup @ui.rate":"onRateChange"},fields:[["student",function(){return this.options.user.students.get(_.val(this.ui.student))}],["subject",function(){return this.options.user.subjects.get(_.val(this.ui.subject))}],"location","date","time","duration","rate",["repeat",function(){return _.val(this.ui.repeat.filter(":checked"))}]],onRender:function(){_.datepicker(this.ui.date)},onStudentChange:function(e){var t=parseInt($(e.target).find(":selected").data("rate"));t?($('input[name="rate"]').val(t),this.rate=t):($('input[name="rate"]').val(""),this.rate=this.options.user.get("rate")),this.calculateLessonPrice()},onDurationChange:function(e){var t=e.target.value,i=t.split(":"),n=60*+i[0]+ +i[1];this.duration=parseInt(n)/60,this.calculateLessonPrice()},onRateChange:function(e){e.target.value?this.rate=parseInt(e.target.value):this.rate=this.options.user.get("rate"),this.calculateLessonPrice()},calculateLessonPrice:function(){var e=this.rate*this.duration;$(".total-price").html(e.toFixed(2))}}))}),define("apps/booking/create_for_tutor/controller",["base","entities/user","entities/booking","apps/booking/create_for_tutor/views/layout"],function(e,t,i,n){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.region=e.region,this.tutorId=e.uuid||null,this.user=this.getUser(),_.progress().start(),this.listenTo(this.user,"sync",this.showLayout),this.listenTo(this.user,"error",this.destroy),this.user.fetch()},getUser:function(){var e=t.model({uuid:this.tutorId});return e},showLayout:function(){this.booking=i.model({tutor_rate:this.user.get("rate")}),_.progress().done(),this.stopListening(this.booking),this.view=new n({model:this.booking,user:this.user}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.booking,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.booking,"sync",this.onSyncSuccess),this.listenTo(this.booking,"error",this.onSyncError),this.listenTo(this.booking,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){this.booking.student=e.student,this.booking.subject=e.subject,this.booking.saveForTutor(this.tutorId,e)},onSyncSuccess:function(e,t){_.toast("Booking created!","success"),this.view.destroy()},onDestroy:function(){var e=laroute.route("admin.tutors.lessons.index",{uuid:this.tutorId});this.app.history.back(e)}}))}),define("requirejs-text!apps/booking/create/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.booking.create.heading\') %></h4>\n                    <a href="#" class="close icon icon--cross js-close"></a>\n                </header>\n\n                <p><%= _.lang(\'dialogue.booking.create.introduction\') %></p>\n\n                <form class="js-form">\n\n                    <div class="dialogue__body box box--fill box--bordered">\n                        <div class="layout"><!--\n                            --><div class="layout__item layout__item--student field">\n                                <div class="field__input select select--full select--squared select--bordered <%= student ? \'select--show\' : \'\' %>">\n                                    <span class="select__placeholder">Student</span>\n                                    <span class="select__value"><%= student ? student.title : \'\' %></span>\n                                    <select name="student" class="select__field js-student">\n                                        <option value="">Please select one:</option>\n                                        <% _.each(students, function (student) { %>\n                                            <option value="<%= student.value %>" data-rate="<%= student.rate %>" <%= student.selected ? \'selected\' : \'\' %>>\n                                                <%= student.title %>\n                                            </option>\n                                        <% }) %>\n                                    </select>\n                                </div>\n\n                                <div class="field__error"></div>\n                            </div><!--\n\n                            --><div class="layout__item layout__item--subject field">\n                                <div class="field__input select select--full select--squared select--bordered <%= subject ? \'select--show\' : \'\' %>">\n                                    <span class="select__placeholder">Subject</span>\n                                    <span class="select__value"><%= subject ? subject.title : \'\' %></span>\n                                    <select  name="subject" class="select__field js-subject">\n                                        <option value="">Please select one:</option>\n                                        <% _.each(subjects, function (subject) { %>\n                                            <option value="<%= subject.value %>" <%= subject.selected ? \'selected\' : \'\' %>>\n                                                <%= subject.title %>\n                                            </option>\n                                        <% }) %>\n                                    </select>\n                                </div>\n\n                                <div class="field__error"></div>\n                            </div><!--\n\n                            --><div class="layout__item layout__item--location field">\n                                <input type="text" name="location" placeholder="Location*" class="field__input input input--full input--squared input--bordered js-location">\n                                <div class="field__error"></div>\n                            </div>\n\n                            <div class="layout__item layout__item--repeat field">\n                                <label class="field__label">Lesson Repeat<sup>1</sup></label>\n                                <div class="radios">\n                                    <div class="radios__item js-repeat-never">\n                                        Never\n                                        <input type="radio" name="repeat" value="never" class="radios__input js-repeat">\n                                    </div>\n                                    <div class="radios__item radios__item--checked js-repeat-weekly">\n                                        Weekly\n                                        <input type="radio" name="repeat" value="weekly" class="radios__input js-repeat" checked="checked">\n                                    </div>\n                                    <div class="radios__item js-repeat-fortnightly">\n                                        Fortnightly\n                                        <input type="radio" name="repeat" value="fortnightly" class="radios__input js-repeat">\n                                    </div>\n                                </div>\n                                <div class="field__error"></div>\n                            </div>\n\n                            <div>\n                                <div class="layout__item layout__item--start l">\n                                    <div class="layout"><!--\n                                        --><div class="layout__item layout__item--date field js-date-container">\n                                                <label for="date" class="field__label">Date</label>\n                                                <input type="text" name="date" placeholder="d/m/y" class="field__input input input--full input--squared input--bordered js-date">\n                                                <div class="field__error"></div>\n                                            </div><!--\n\n                                        --><div class="layout__item layout__item--time field">\n                                                <label for="time" class="field__label">Start time</label>\n                                                <div class="field__input select select--full select--squared select--bordered">\n                                                    <span class="select__placeholder">00:00</span>\n                                                    <span class="select__value"></span>\n                                                    <select name="time" class="select__field js-time">\n                                                        <option value="">Please select one:</option>\n                                                        <% for (var hour = 0; hour < 24; hour++) { %>\n                                                            <% for (var minute = 0; minute < 60; minute = minute + 30) { %>\n                                                                <option><%= _.lpad(hour, 2, \'0\') %>:<%= _.lpad(minute, 2, \'0\') %></option>\n                                                            <% } %>\n                                                        <% } %>\n                                                    </select>\n                                                </div>\n                                                <div class="field__error"></div>\n                                            </div><!--\n\n                                            --><div class="layout__item layout__item--time field">\n                                                <label for="duration" class="field__label">Duration</label>\n                                                <div class="field__input select select--full select--squared select--bordered">\n                                                    <span class="select__placeholder">00:00</span>\n                                                    <span class="select__value"></span>\n                                                    <select name="duration" class="select__field js-duration">\n                                                        <option value="">Please select one:</option>\n                                                        <option>0:30</option>\n                                                        <option>0:45</option>\n                                                        <option>1:00</option>\n                                                        <option>1:15</option>\n                                                        <option>1:30</option>\n                                                        <option>1:45</option>\n                                                        <option>2:00</option>\n                                                        <option>2:15</option>\n                                                        <option>2:30</option>\n                                                        <option>2:45</option>\n                                                        <option>3:00</option>\n                                                    </select>\n                                                </div>\n                                                <div class="field__error"></div>\n                                            </div><!--\n\n                                            --><div class="layout__item layout__item--rate field">\n                                                <label for="rate" class="field__label">Hourly Rate (Default &pound;<%= profile_rate %>)</label>\n                                                <input type="text" name="rate" placeholder="" class="field__input input input--full input--squared input--bordered js-rate">\n                                                <div class="field__error"></div>\n                                            </div><!--\n                                    --></div>\n\n                                    <div class="field">\n                                        <div class="field__error js-start"></div>\n                                    </div>\n                                </div>\n\n                                <div class="layout__item--total-price r">\n                                    <div class="layout__item layout__item--price field">\n                                        <label for="rate" class="field__label">Lesson Price</label>\n                                        <div class="box box--fill box--bordered">\n                                            <span class="total-price">0.00</span>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <div class="layout__item">\n                                <p class="tiny"><sup>1</sup> Most of our tutors and students prefer to book either weekly or fortnightly\n                                    sessions, which allows students and tutors to plan their week around regular sessions. Students\n                                    or tutors can cancel sessions at any point and times can be altered where necessary.</p>\n                            </div><!--\n                        --></div>\n                    </div>\n\n                    <div class="layout"><!--\n                        --><div class="layout__item layout__item--actions tar">\n                            <a href="#" class="u-mr js-close">Cancel</a>\n                            <button class="btn btn js-submit">Create booking</button>\n                        </div><!--\n                    --></div>\n                </form>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay"></div>\n';
}),define("apps/booking/create/views/layout",["base","requirejs-text!apps/booking/create/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(t),className:"dialogue dialogue--booking",initialize:function(){this.rate=this.options.user.get("rate"),this.duration=0},templateHelpers:function(){var e=this.options.user.students.map(function(e){return{value:e.get("uuid"),title:e.get("first_name")+" "+e.get("last_name").charAt(0),rate:e.get("rate"),selected:_.queryString("student")==e.get("uuid")}}),t=_.findWhere(e,{selected:!0}),i=this.options.user.subjects.map(function(e){return{value:e.get("id"),title:e.get("title"),selected:_.queryString("subject")==e.get("id")}}),n=_.findWhere(i,{selected:!0}),s=this.options.user.get("rate");return{json:this.model.toJSON(),subjects:i,student:t,students:e,subject:n,profile_rate:s}},ui:{student:".js-student",subject:".js-subject",location:".js-location",date:".js-date",time:".js-time",duration:".js-duration",rate:".js-rate",repeat:".js-repeat",start:".js-start"},events:{"change @ui.student":"onStudentChange","change @ui.duration":"onDurationChange","keyup @ui.rate":"onRateChange"},fields:[["student",function(){return this.options.user.students.get(_.val(this.ui.student))}],["subject",function(){return this.options.user.subjects.get(_.val(this.ui.subject))}],"location","date","time","duration","rate",["repeat",function(){return _.val(this.ui.repeat.filter(":checked"))}]],onRender:function(){_.datepicker(this.ui.date)},onStudentChange:function(e){var t=parseInt($(e.target).find(":selected").data("rate"));t?($('input[name="rate"]').val(t),this.rate=t):($('input[name="rate"]').val(""),this.rate=this.options.user.get("rate")),this.calculateLessonPrice()},onDurationChange:function(e){var t=e.target.value,i=t.split(":"),n=60*+i[0]+ +i[1];this.duration=parseInt(n)/60,this.calculateLessonPrice()},onRateChange:function(e){e.target.value?this.rate=parseInt(e.target.value):this.rate=this.options.user.get("rate"),this.calculateLessonPrice()},calculateLessonPrice:function(){var e=this.rate*this.duration;$(".total-price").html(e.toFixed(2))}}))}),define("apps/booking/create/controller",["base","entities/user","entities/booking","apps/booking/create/views/layout"],function(e,t,i,n){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.region=e.region,this.user=t.current(),this.booking=i.model({tutor_rate:this.user.get("rate")}),this.view=new n({model:this.booking,user:this.user}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.booking,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.booking,"sync",this.onSyncSuccess),this.listenTo(this.booking,"error",this.onSyncError),this.listenTo(this.booking,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){this.booking.student=e.student,this.booking.subject=e.subject,this.booking.save(e)},onSyncSuccess:function(e,t){_.toast("Booking created!","success"),window.location=laroute.route("tutor.lessons.index")},onDestroy:function(){var e=laroute.route("tutor.lessons.index");this.app.history.back(e)}}))}),define("requirejs-text!apps/booking/edit/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.booking.edit.heading\') %></h4>\n                    <a href="#" class="close icon icon--cross js-close"></a>\n                </header>\n\n                <p><%= _.lang(\'dialogue.booking.edit.introduction\') %></p>\n\n                <form class="js-form">\n                    <div class="dialogue__body box box--fill box--bordered u-mb-">\n                        <div class="layout"><!--\n                            --><div class="layout__item layout__item--student field">\n                                <div class="field__input select select--full select--squared select--bordered select--show select--disabled">\n                                    <span class="select__value"><%= student.first_name + \' \' + student.last_name %></span>\n                                </div>\n                            </div><!--\n\n                            --><div class="layout__item layout__item--subject field">\n                                <div class="field__input select select--full select--squared select--bordered select--show select--disabled">\n                                    <span class="select__value"><%= subject.title %></span>\n                                </div>\n                            </div><!--\n\n                            --><div class="layout__item layout__item--location field">\n                                <input type="text" name="location" placeholder="Location*" value="<%= location %>" class="field__input input input--full input--squared input--bordered js-location">\n                                <div class="field__error"></div>\n                            </div><!--\n\n\n                            --><div>\n                                    <div class="layout__item layout__item--start l">\n                                        <div class="layout"><!--\n                                            --><div class="layout__item layout__item--date field">\n                                                <label for="date" class="field__label">Date*</label>\n                                                <input type="text" name="date" value="<%= date %>" placeholder="d/m/y" class="field__input input input--full input--squared input--bordered js-date">\n                                                <div class="field__error"></div>\n                                            </div><!--\n\n                                            --><div class="layout__item layout__item--time field">\n                                                <label for="time" class="field__label">Start time*</label>\n                                                <div class="field__input select select--full select--squared select--bordered <%= time ? \'select--show\' : \'\' %>">\n                                                    <span class="select__placeholder">00:00*</span>\n                                                    <span class="select__value"><%= time %></span>\n                                                    <select  name="time" class="select__field js-time">\n                                                        <option value="">Please select one:</option>\n                                                        <% for (var hour = 0; hour < 24; hour++) { %>\n                                                            <% for (var minute = 0; minute < 60; minute = minute + 30) { %>\n                                                                <% var value = _.lpad(hour, 2, \'0\') + \':\' + _.lpad(minute, 2, \'0\'); %>\n                                                                <option <%= value === time ? \'selected="selected"\' : \'\' %>><%= value %></option>\n                                                            <% } %>\n                                                        <% } %>\n                                                    </select>\n                                                </div>\n                                                <div class="field__error"></div>\n                                            </div><!--\n                                            --><div class="layout__item layout__item--duration field">\n                                                    <label for="time" class="field__label">Duration</label>\n                                                    <div class="field__input select select--full select--squared select--bordered select--show">\n                                                        <span class="select__value"><%= duration %></span>\n                                                        <select name="duration" class="select__field js-duration">\n                                                            <option value="">Please select one:</option>\n                                                            <% for (var hour = 0; hour < 4; hour++) { %>\n                                                            <% for (var minute = 0; minute < 60; minute = minute + 15) { %>\n                                                            <% var value = _.lpad(hour, 2, \'0\') + \':\' + _.lpad(minute, 2, \'0\'); %>\n                                                            <option <%= value === duration ? \'selected="selected"\' : \'\' %>><%= value %></option>\n                                                            <% } %>\n                                                            <% } %>\n                                                        </select>\n                                                    </div>\n                                                    <div class="field__error"></div>\n                                                </div><!--\n\n                                                --><div class="layout__item layout__item--rate field">\n                                            <label for="rate" class="field__label">Rate (&pound;<%= tutor_rate %>)</label>\n                                            <input type="text" name="rate" value="<%= rate %>" placeholder="" class="field__input input input--full input--squared input--bordered js-rate">\n                                            <div class="field__error"></div>\n                                        </div><!--\n                                        --></div>\n\n                                    <div class="field">\n                                        <div class="field__error js-start"></div>\n                                    </div>\n                                </div>\n\n                                <div class="layout__item--total-price r">\n                                    <div class="layout__item layout__item--price field">\n                                        <label for="rate" class="field__label">Lesson Price</label>\n                                        <div class="box box--fill box--bordered">\n                                            <span class="total-price"></span>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div><!--\n\n                            <% if (schedule.repeat === \'weekly\' || schedule.repeat === \'fortnightly\') { %>\n                                --><div class="layout__item field layout__item--future">\n                                    <label class="field__label">This lesson repeats <strong><%= schedule.repeat %></strong>. Would you like to edit <strong>this and future</strong> bookings?</label>\n                                    <div class="field__checkbox checkbox">\n                                        <div class="checkbox__box">\n                                            <div class="checkbox__tick"></div>\n                                            <input type="checkbox" name="future" id="future" value="1" class="checkbox__input js-future">\n                                        </div>\n                                        <label class="checkbox__label">Yes, edit <strong>this and future</strong> bookings.</label>\n                                    </div>\n                                    <div class="field__error"></div>\n                                </div><!--\n\n                            <% } %>\n                        --></div>\n                    </div>\n\n                    <div class="layout"><!--\n                        --><div class="layout__item layout__item--actions tar">\n                            <a href="#" class="u-mr js-close">Cancel</a>\n                        <button class="btn btn js-submit">Save changes</button>\n                        </div><!--\n                    --></div>\n                </form>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay"></div>'}),define("apps/booking/edit/views/layout",["base","requirejs-text!apps/booking/edit/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(t),className:"dialogue dialogue--booking",initialize:function(){this.rate=this.options.model.get("rate"),this.tutor_rate=this.options.model.get("tutor_rate"),this.duration=this.calculateDuration(this.options.model.get("duration"))},ui:{location:".js-location",date:".js-date",time:".js-time",future:".js-future",start:".js-start",duration:".js-duration",rate:".js-rate"},events:{"change @ui.duration":"onDurationChange","keyup @ui.rate":"onRateChange"},fields:["location","date","time","duration","rate","tutor_rate",["future",function(){return this.ui.future.length>0?_.val(this.ui.future):!1}]],onRender:function(){_.datepicker(this.ui.date)},onShow:function(){this.calculateLessonPrice()},calculateDuration:function(e){var t=e.split(":"),i=60*+t[0]+ +t[1];return parseInt(i)/60},onDurationChange:function(e){this.duration=this.calculateDuration(e.target.value),this.calculateLessonPrice()},onRateChange:function(e){e.target.value?this.rate=parseInt(e.target.value):this.rate=this.tutor_rate,this.calculateLessonPrice()},calculateLessonPrice:function(){var e=this.rate*this.duration;$(".total-price").html(e.toFixed(2))}}))}),define("apps/booking/edit/controller",["base","entities/user","entities/booking","apps/booking/edit/views/layout"],function(e,t,i,n){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.region=e.region,this.booking=i.model({uuid:e.uuid}),_.progress().start(),this.listenTo(this.booking,"sync",this.showLayout),this.listenTo(this.booking,"error",this.destroy),this.booking.fetch()},showLayout:function(){_.progress().done(),this.stopListening(this.booking),this.view=new n({model:this.booking}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.booking,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.booking,"sync",this.onSyncSuccess),this.listenTo(this.booking,"error",this.onSyncError),this.listenTo(this.booking,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){this.booking.save(e)},onSyncSuccess:function(e,t){_.toast("Booking updated!","success"),window.location=this.getRedirectUrl()},onDestroy:function(){_.progress().done();laroute.route("tutor.lessons.index");this.app.history.back(this.getRedirectUrl())},getRedirectUrl:function(){var e=t.current();return"tutor"===e.get("account")?laroute.route("tutor.lessons.index"):"student"===e.get("account")?laroute.route("student.lessons.index"):laroute.route("admin.lessons.index")}}))}),define("requirejs-text!apps/booking/cancel/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.booking.cancel.heading\') %></h4>\n                    <a href="#" class="close icon icon--cross js-close"></a>\n                </header>\n\n                <p><%= _.lang(\'dialogue.booking.cancel.introduction\') %></p>\n\n                <form class="js-form">\n                    <% if (schedule.repeat === \'weekly\' || schedule.repeat === \'fortnightly\') { %>\n                        <div class="dialogue__body box box--fill box--bordered">\n                            <div class="layout"><!--\n                                --><div class="layout__item field layout__item--future">\n                                    <label class="field__label">This lesson repeats <strong><%= schedule.repeat %></strong>. Would you like to cancel <strong>this and future</strong> lessons? </label>\n                                    <div class="field__checkbox checkbox">\n                                        <div class="checkbox__box">\n                                            <div class="checkbox__tick"></div>\n                                            <input type="checkbox" name="future" id="future" value="1" class="checkbox__input js-future">\n                                        </div>\n                                        <label class="checkbox__label">Yes, cancel <strong>this and future</strong> lessons</label>\n                                    </div>\n                                    <div class="field__error"></div>\n                                </div><!--\n                            --></div>\n                        </div>\n                    <% } %>\n\n                    <div class="layout"><!--\n                        --><div class="layout__item layout__item--actions tar">\n                            <a href="#" class="u-mr js-close">Cancel</a>\n                            <button class="btn btn js-submit">Cancel booking</button>\n                        </div><!--\n                    --></div>\n                </form>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay"></div>'}),define("apps/booking/cancel/views/layout",["base","requirejs-text!apps/booking/cancel/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(t),className:"dialogue dialogue--booking",template:_.template(t),ui:{future:".js-future"},fields:[["future",function(){return this.ui.future.length>0?_.val(this.ui.future):!1}]]}))}),define("apps/booking/cancel/controller",["base","entities/user","entities/booking","apps/booking/cancel/views/layout"],function(e,t,i,n){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.region=e.region,this.booking=i.model({uuid:e.uuid}),_.progress().start(),this.listenTo(this.booking,"sync",this.showLayout),this.listenTo(this.booking,"error",this.destroy),this.booking.fetch()},showLayout:function(){_.progress().done(),this.stopListening(this.booking),this.view=new n({model:this.booking}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.booking,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.booking,"sync",this.onSyncSuccess),this.listenTo(this.booking,"error",this.onSyncError),this.listenTo(this.booking,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){this.booking.cancel(e)},onSyncSuccess:function(e,t){_.toast("Booking cancelled!","success"),window.location=this.getRedirectUrl()},onDestroy:function(){_.progress().done(),this.app.history.back(this.getRedirectUrl())},getRedirectUrl:function(){var e=t.current();return"tutor"===e.get("account")?laroute.route("tutor.lessons.index"):"student"===e.get("account")?laroute.route("student.lessons.index"):laroute.route("admin.lessons.index")}}))}),define("entities/bank_card",["base"],function(e){var t=e.Model.extend({defaults:{number:null,cvc:null,exp_month:null,exp_year:null},validation:{number:[{required:!0,msg:"The card number field is required."}],cvc:[{required:!0,msg:"The card cvc field is required."}],exp_month:[{required:!0,msg:"The card expiry month field is required."}],exp_year:[{required:!0,msg:"The card expiry year field is required."}]}});return{model:function(e,i){return new t(e,i)}}}),define("apps/booking/confirm/views/layout",["base"],function(e){return _.patch(e.ItemView.extend({mixins:["FormLayout","FieldsLayout"],template:!1,ui:{"card.number":".js-card-number","card.cvc":".js-card-cvc","card.exp_month":".js-card-expiry-month","card.exp_year":".js-card-expiry-year","card.exists":".js-card-exists"},fields:["card.number","card.cvc","card.exp_month","card.exp_year",["card.exists",function(){return"1"===_.val(this.ui["card.exists"])?!0:!1}]],initialize:function(){this.bindUIElements()}}))}),define("apps/booking/confirm/controller",["base","entities/booking","entities/bank_card","apps/booking/confirm/views/layout"],function(e,t,i,n){return _.patch(e.Controller.extend({mixins:["FormController"],initialize:function(e){this.app.addRegions({confirmRegion:".js-confirm"}),this.booking=function(){var e=_.clone(_.config("booking"));return t.model(e,{parse:!0})}(),this.view=new n({el:this.app.confirmRegion.$el,model:this.booking}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.booking,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.booking,"sync",this.onSyncSuccess),this.listenTo(this.booking,"error",this.onSyncError),this.listenTo(this.booking,"invalid",this.onInvalid),this.app.confirmRegion.attachView(this.view)},save:function(e){e=object_undot(e);var t=e.card&&(""!==e.card.number||""!==e.card.cvc||""!==e.card.exp_month||""!==e.card.exp_year);!t&&e.card&&e.card.exists?(e.card=null,this.saveWithTutora(e)):this.saveWithStripe(e)},saveWithStripe:function(e){var t=i.model(e.card),n=t.validate();if(_.isEmpty(n))Stripe.card.createToken(_.pick(t.toJSON(),["number","cvc","exp_month","exp_year"]),_.bind(this.onStripeResponse,this,e));else{var s={};_.each(n,function(e,t){s["card."+t]=e}),this.onSyncErrorOrInvalid(),this.onInvalid(this.user,s)}},onStripeResponse:function(e,t,i){i.error?this.onStripeError(i.error):this.onStripeSync(e,t,i)},onStripeSync:function(e,t,i){_.progress().set(.5),e.card=i.id,this.saveWithTutora(e)},onStripeError:function(e){_.progress().done(),this.view.enableSubmit(),_.toast(e.message,"error")},saveWithTutora:function(e){this.booking.confirm(e)},onSyncSuccess:function(e,t){return window.location=t.meta.redirect}}))}),define("requirejs-text!apps/booking/pay/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.booking.pay.heading\') %></h4>\n                    <a href="#" class="close icon icon--cross js-close"></a>\n                </header>\n\n                <p><%= _.lang(\'dialogue.booking.pay.introduction\') %></p>\n\n                <form class="js-form">\n                    <div class="dialogue__body box box--fill box--bordered">\n                        <div class="layout"><!--    \n                            <% if (last_four) { %>\n                                --><div class="layout__item">\n                                    <div class="flag flag--small u-mb--">\n                                        <div class="flag__img">\n                                            <span class="icon icon--fancy-tick"></span>\n                                        </div>\n                                        <div class="flag__body">\n                                            <p class="brand">Card already exists.</p>\n                                        </div>\n                                    </div>\n\n                                    <p class="u-m0">You can update your card or retry with the existing one</p>\n                                </div><!--\n                            <% } %>\n\n                            Name\n                            --><div class="[ layout__item ][ field field--label ]">\n                                <label for="card_number" class="field__label">Card</label>\n                            </div><!--\n\n                            --><div class="[ layout__item ][ field field--card-number]">\n                                <input type="text" id="card_number"\n                                  placeholder="<%= last_four ? \'XXXX XXXX XXXX \' + last_four : \'Card Number\' %>"\n                                  class="[ input input--full input--squared input--bordered ] field__input [ js-card-number ]">\n                                <div class="field__error"></div>\n                            </div><!--\n\n                            --><div class="[ layout__item ][ field field--card-cvc ]">\n                                <input type="text" id="card_cvc"\n                                  placeholder="<%= last_four ? \'XXX\' : \'CVC\' %>"\n                                  class="[ input input--full input--squared input--bordered ] field__input [ js-card-cvc ]">\n                                <div class="field__error"></div>\n                            </div><!--\n\n                            --><div class="[ layout__item ][ field field--card-exp-month ]">\n                                <div class="[ field__select ][ select select--full select--squared select--bordered ]">\n                                    <span class="select__placeholder"><%= last_four ? \'XX\' : \'Exp month\' %></span>\n                                    <span class="select__value"></span>\n                                    <select class="select__field [ js-card-exp-month ]">\n                                        <option value="">Please select one:</option>\n                                        <% _.each(months, function (title, value) { %>\n                                            <option value="<%= _.pad(value, 2, "0") %>"><%= _.pad(value, 2, "0") %> - <%= title %></option>\n                                        <% }) %>\n                                    </select>\n                                </div>\n                                <div class="field__error"></div>\n                            </div><!--\n\n                            --><div class="[ layout__item ][ field field--card-exp-year ]">\n                                <div class="[ field__select ][ select select--full select--squared select--bordered ]">\n                                    <span class="select__placeholder"><%= last_four ? \'XX\' : \'Exp year\' %></span>\n                                    <span class="select__value"></span>\n                                    <select class="select__field [ js-card-exp-year ]">\n                                        <option value="">Please select one:</option>\n                                        <% _.each(years, function (value) { %>\n                                            <option value="<%= value %>"><%= value %></option>\n                                        <% }) %>\n                                    </select>\n                                </div>\n                                <div class="field__error"></div>\n                            </div><!--\n\n                                    Billing Address\n                                    --><div class="[ layout__item field field--label ]">\n                                        <label for="address_street" class="field__label">Billing Address</label>\n                                    </div><!--\n\n                                    --><div class="[ layout__item field field--address-street ]">\n                                        <input type="text" name="address_street" id="address_street"\n                                          value="<%= addresses.billing.line_1 %>" placeholder="Street"\n                                          class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-1 ]">\n                                        <div class="field__error"></div>\n                                    </div><!--\n\n                                    --><div class="[ layout__item field field--address-town ]">\n                                        <input type="text" name="address_town" id="address_town"\n                                          value="<%= addresses.billing.line_2 %>" placeholder="Town"\n                                          class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-2 ]">\n                                        <div class="field__error"></div>\n                                    </div><!--\n\n                                    --><div class="[ layout__item field field--address-city ]">\n                                        <input type="text" name="address_city" id="address_city"\n                                          value="<%= addresses.billing.line_3 %>" placeholder="County"\n                                          class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-3 ]">\n                                        <div class="field__error"></div>\n                                    </div><!--\n\n                                    --><div class="[ layout__item field field--postcode ]">\n                                        <input type="text" name="address_postcode" id="address_postcode"\n                                          value="<%= addresses.billing.postcode %>" placeholder="Postcode"\n                                          class="[ input input--full input--squared input--bordered ] field__input [ js-address-postcode ]">\n                                        <div class="field__error"></div>\n                                    </div><!--\n                        --></div>\n                    </div>\n\n                    <div class="layout"><!--\n                        --><div class="layout__item layout__item--actions tar">\n                            <a href="#" class="u-mr js-close">Cancel</a>\n                            <button class="btn [ js-submit ]">Retry payment</button>\n                        </div><!--\n                    --></div>\n                </form>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay"></div>'}),define("apps/booking/pay/views/layout",["base","requirejs-text!apps/booking/pay/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(t),className:"dialogue dialogue--pay",template:_.template(t),templateHelpers:function(){for(var e={1:"January",2:"Febuary",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"},t=[],i=(new Date).getFullYear(),n=i+15;n>i;i++)t.push(i);return{months:e,years:t}},ui:{"card.number":".js-card-number","card.cvc":".js-card-cvc","card.exp_month":".js-card-exp-month","card.exp_year":".js-card-exp-year","addresses.billing.line_1":".js-address-line-1","addresses.billing.line_2":".js-address-line-2","addresses.billing.line_3":".js-address-line-3","addresses.billing.postcode":".js-address-postcode"},fields:["card.number","card.cvc","card.exp_month","card.exp_year","addresses.billing.line_1","addresses.billing.line_2","addresses.billing.line_3","addresses.billing.postcode"]}))}),define("apps/booking/pay/controller",["base","entities/user","entities/bank_card","apps/booking/pay/views/layout"],function(e,t,i,n){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.user=t.current(),this.view=new n({model:this.user}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){
e=object_undot(e);var t=e.card&&(""!==e.card.number||""!==e.card.cvc||""!==e.card.exp_month||""!==e.card.exp_year);t||_.isNull(this.user.get("last_four"))?this.saveWithStripe(e):(e.card="",this.saveWithTutora(e))},saveWithStripe:function(e){var t=i.model(e.card),n=t.validate();if(_.isEmpty(n))Stripe.card.createToken(t.toJSON(),_.bind(this.onStripeResponse,this,e));else{var s={};_.each(n,function(e,t){s["card."+t]=e}),this.onSyncErrorOrInvalid(),this.onInvalid(this.user,s)}},onStripeResponse:function(e,t,i){i.error?this.onStripeError(i.error):this.onStripeSync(e,t,i)},onStripeSync:function(e,t,i){_.progress().set(.5),e.card=i.id,this.saveWithTutora(e)},onStripeError:function(e){_.progress().done();var t={};t["card."+e.param]=e.message,this.showErrors("ERR_INVALID",t),this.view.enableSubmit()},saveWithTutora:function(e){this.user.save(e,{patch:!0})},onSyncSuccess:function(e,t){_.toast("Retrying payments. We'll keep you posted...","warning"),this.destroy(),this.onDestroy()},onDestroy:function(){_.progress().done();var e=laroute.route("student.lessons.index");this.app.history.back(e)}}))}),define("requirejs-text!apps/booking/refund/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.booking.refund.heading\') %></h4>\n                    <a href="#" class="close icon icon--cross js-close"></a>\n                </header>\n\n                <p><%= _.lang(\'dialogue.booking.refund.introduction\') %></p>\n\n                <form class="js-form">\n\n                    <div class="layout">\n\n                        <div class="layout__item field layout__item--reverse_transfer">\n                            \n                            <div class="field__checkbox checkbox checkbox--checked">\n                                <div class="checkbox__box">\n                                    <div class="checkbox__tick"></div>\n                                    <input type="checkbox" name="reverse_transfer" id="reverse_transfer" value="1" class="checkbox__input js-reverse_transfer" checked="checked">\n                                </div>\n                                <label class="checkbox__label">Take Funds From Tutor?</label>\n                            </div>\n                            <div class="field__error"></div>\n                        </div>\n\n                        <div class="layout__item layout__item--amount field field--group">\n                            <label for="amount" class="field__label">Refund Amount (Leave blank for full amount)</label>\n                            <span class="field__prefix input input--squared input--bordered input--disabled">&pound;</span>\n                            <input type="text" name="amount" placeholder="" class="field__input input input--full input--squared input--bordered js-amount">\n                            <div class="field__error"></div>\n                        </div>\n\n                        <div class="layout__item layout__item--actions tar">\n                            <a href="#" class="u-mr js-close">Cancel</a>\n                            <button class="btn btn js-submit">Refund booking</button>\n                        </div>\n                        \n                    </div>\n                </form>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay"></div>'}),define("apps/booking/refund/views/layout",["base","requirejs-text!apps/booking/refund/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(t),className:"dialogue dialogue--booking",template:_.template(t),ui:{reverse_transfer:".js-reverse_transfer",amount:".js-amount"},fields:[["reverse_transfer",function(){return this.ui.reverse_transfer.length>0?_.val(this.ui.reverse_transfer):!1}],"amount"]}))}),define("apps/booking/refund/controller",["base","entities/user","entities/booking","apps/booking/refund/views/layout"],function(e,t,i,n){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.region=e.region,this.booking=i.model({uuid:e.uuid}),_.progress().start(),this.listenTo(this.booking,"sync",this.showLayout),this.listenTo(this.booking,"error",this.destroy),this.booking.fetch()},showLayout:function(){_.progress().done(),this.stopListening(this.booking),this.view=new n({model:this.booking}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.booking,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.booking,"sync",this.onSyncSuccess),this.listenTo(this.booking,"error",this.onSyncError),this.listenTo(this.booking,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){this.booking.refund(e)},onSyncSuccess:function(e,t){_.toast("Booking refunded!","success"),window.location=this.getRedirectUrl()},onDestroy:function(){_.progress().done(),this.app.history.back(this.getRedirectUrl())},getRedirectUrl:function(){var e=t.current();return"tutor"===e.get("account")?laroute.route("tutor.lessons.index"):"student"===e.get("account")?laroute.route("student.lessons.index"):laroute.route("admin.lessons.index")}}))}),define("apps/booking/controller",["base","apps/booking/create_for_tutor/controller","apps/booking/create/controller","apps/booking/edit/controller","apps/booking/cancel/controller","apps/booking/confirm/controller","apps/booking/pay/controller","apps/booking/refund/controller"],function(e,t,i,n,s,o,r,a){return e.Controller.extend({createForTutor:function(e){return e=_.isObject(e)?e:{},new t(_.extend({app:this.app,region:this.app.dialogueRegion},e))},create:function(e){return e=_.isObject(e)?e:{},new i(_.extend({app:this.app,region:this.app.dialogueRegion},e))},edit:function(e){return e=_.isObject(e)?e:{},new n(_.extend({app:this.app,region:this.app.dialogueRegion},e))},cancel:function(e){return _.isObject(e)?e:{},new s(_.extend({app:this.app,region:this.app.dialogueRegion},e))},confirm:function(e){return _.isObject(e)?e:{},new o(_.extend({app:this.app},e))},pay:function(e){return _.isObject(e)?e:{},new r(_.extend({app:this.app,region:this.app.dialogueRegion},e))},refund:function(e){return _.isObject(e)?e:{},new a(_.extend({app:this.app,region:this.app.dialogueRegion},e))}})}),define("apps/booking/router",["base"],function(e){return e.Router.extend({routes:{tutor_create:laroute.route("tutor.lessons.create"),tutor_edit:laroute.route("tutor.lessons.edit"),tutor_cancel:laroute.route("tutor.lessons.cancel"),student_cancel:laroute.route("student.lessons.cancel"),student_confirm:laroute.route("student.lessons.confirm"),student_pay:laroute.route("student.lessons.pay"),admin_create:laroute.route("admin.tutors.lessons.create"),admin_cancel:laroute.route("admin.lessons.cancel"),admin_edit:laroute.route("admin.lessons.edit"),admin_refund:laroute.route("admin.lessons.refund"),admin_retry:laroute.route("admin.students.lessons.retry")},tutor_create:function(){this.controller.create()},tutor_edit:function(e){this.controller.edit({uuid:e})},tutor_cancel:function(e){this.cancel(e)},student_cancel:function(e){this.cancel(e)},cancel:function(e){this.controller.cancel({uuid:e})},student_confirm:function(e){this.controller.confirm({uuid:e})},student_pay:function(e){this.controller.pay({uuid:e})},admin_create:function(e){this.controller.createForTutor({uuid:e})},admin_edit:function(e){this.controller.edit({uuid:e})},admin_cancel:function(e){this.controller.cancel({uuid:e})},admin_refund:function(e){this.controller.refund({uuid:e})},admin_retry:function(e){this.controller.retry({uuid:e})}})}),define("apps/booking/app",["apps/booking/controller","apps/booking/router"],function(e,t){return function(){var i=new e({app:this});return new t({controller:i})}}),define("entities/review",["base"],function(e){var t=e.Model.extend({urlRoot:function(){return laroute.route("api.users.reviews.create",{uuid:this.options.tutor})},defaults:{rating:null,body:null},validation:{rating:[{required:!0,msg:_.lang("validation.required",{attribute:"rating"})}],body:[{required:!0,msg:_.lang("validation.required",{attribute:"body"})}]},initialize:function(e,t){this.options=t}});return{model:function(e,i){return new t(e,i)}}}),define("requirejs-text!apps/review/create/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.booking.review.heading\') %></h4>\n                    <a href="#" class="close icon icon--cross js-close"></a>\n                </header>\n\n                <p><%= _.lang(\'dialogue.booking.review.introduction\') %></p>\n\n                <form class="js-form" no-validate>\n                    <div class="field">\n                        <div class="field__rating"><!--\n                            --><span class="field__rating__item">\n                                <input type="radio" name="rating" value="1" class="field__rating__input js-rating">\n                                <span class="graphic graphic--stars"></span>\n                            </span><!--\n                            --><span class="field__rating__item">\n                                <input type="radio" name="rating" value="2\'" class="field__rating__input js-rating">\n                                <span class="graphic graphic--stars"></span>\n                            </span><!--\n                            --><span class="field__rating__item">\n                                <input type="radio" name="rating" value="3" class="field__rating__input js-rating" checked="checked">\n                                <span class="graphic graphic--stars"></span>\n                            </span><!--\n                            --><span class="field__rating__item">\n                                <input type="radio" name="rating" value="4" class="field__rating__input js-rating">\n                                <span class="graphic graphic--stars"></span>\n                            </span><!--\n                            --><span class="[ field__rating__item field__rating__item--checked ]">\n                                <input type="radio" name="rating" value="5" class="field__rating__input js-rating" checked="checked">\n                                <span class="graphic graphic--stars"></span>\n                            </span><!--\n                        --></div>\n                    </div>\n\n\n                    <div class="field">\n                        <textarea name="body" placeholder="Write your review here..."\n                          class="[ input input--full input--squared input--bordered ] field__textarea [ js-body ]" ></textarea>\n                        <div class="field__error"></div>\n                    </div>\n\n                    <div class="layout"><!--\n                        --><div class="layout__item layout__item--actions tar">\n                            <a href="#" class="u-mr js-close">Cancel</a>\n                            <button class="btn btn js-submit">Review booking</button>\n                        </div><!--\n                    --></div>\n                </form>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay"></div>\n'}),define("apps/review/create/views/layout",["base","requirejs-text!apps/review/create/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(t),className:"dialogue dialogue--review",ui:{rating:".js-rating",body:".js-body"},fields:["body",["rating",function(){return this.ui.rating.filter(":checked").val()}]]}))}),define("apps/review/create/controller",["base","entities/user","entities/review","apps/review/create/views/layout"],function(e,t,i,n){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.region=e.region,this.user=t.current(),this.review=i.model(null,{tutor:e.tutor}),this.view=new n({user:this.user}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.review,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.review,"sync",this.onSyncSuccess),this.listenTo(this.review,"error",this.onSyncError),this.listenTo(this.review,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){this.review.save(e)},onSyncSuccess:function(e,t){_.toast("Review sent!","success"),this.view.destroy()},onDestroy:function(){var e=laroute.route("student.lessons.index");this.app.history.back(e)}}))}),define("apps/review/controller",["base","apps/review/create/controller"],function(e,t){return e.Controller.extend({create:function(e){return e=_.isObject(e)?e:{},new t(_.extend({app:this.app,region:this.app.dialogueRegion},e))}})}),define("apps/review/router",["base"],function(e){return e.Router.extend({routes:{create:laroute.route("review.create",{tutor:":tutor"})},create:function(e){this.controller.create({tutor:e})}})}),define("apps/review/app",["apps/review/controller","apps/review/router"],function(e,t){return function(){var i=new e({app:this});return new t({controller:i})}}),define("entities/message",["base","entities/user"],function(e,t){var i=t.current(),n=e.Model.extend({urlRoot:"/api/messages",idAttribute:"uuid",defaults:{body:null,action:"none",to:null},validation:{body:[{required:!0,msg:"Please enter a message to send."}],to:[{required:!0,msg:"A recipient is required."}],"register.first_name":[{required:function(){return i.isNew()&&"register"===this.get("action")},msg:"The first name field is required."}],"register.last_name":[{required:function(){return i.isNew()&&"register"===this.get("action")},msg:"The last name field is required."}],"register.email":[{required:function(){return i.isNew()&&"register"===this.get("action")},msg:"The email field is required."}],"register.telephone":[{required:function(){return i.isNew()&&"register"===this.get("action")},msg:"The telephone field is required."}],"register.password":[{required:function(){return i.isNew()&&"register"===this.get("action")},msg:"The password field is required."}],"login.email":[{required:function(){return i.isNew()&&"login"===this.get("action")},msg:"The email field is required."}],"login.password":[{required:function(){return i.isNew()&&"login"===this.get("action")},msg:"The password field is required."}],"login.remember me":[{required:function(){return i.isNew()&&"login"===this.get("action")},msg:"The remember me field is required."}]},parse:function(e){return _.has(e,"data")?e.data:e}});return{model:function(e,t){return new n(e,t)}}}),define("requirejs-text!apps/messages/create/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n            <div class="dialogue__window">\n                <header class="dialogue__header">\n                    <h4 class="heading"><%= _.lang(\'dialogue.message.create.title\') %></h4>\n                    <a href="#" class="close icon icon--cross js-close"></a>\n                </header>\n\n                <p><%= _.lang(\'dialogue.message.create.introduction\') %></p>\n\n                <form class="js-form" novalidate>\n                    <fieldset class="fieldset">\n                        <div class="field">\n                            <textarea name="body"\n                              placeholder="Write your message here...\n\nBe sure to include:\n- Where you live\n- What you want to learn\n- When you\'re available"\n                              class="[ input input--full input--squared input--bordered ] field__textarea [ js-body ]" ></textarea>\n                            <div class="field__error"></div>\n                        </div>\n                    </fieldset>\n\n                    <% if (action === \'register\' || action === \'login\') { %>\n                        <div class="[ tab-content tab-content--active ] js-register-form">\n                            <div class="layout"><!--\n                                --><div class="layout__item u-1/2-tablet-and-up field">\n                                    <input type="text" name="first_name" placeholder="First Name"\n                                      class="field__input input input--full input--squared input--bordered js-register-first-name">\n                                    <div class="field__error"></div>\n                                </div><!--\n\n                                --><div class="layout__item u-1/2-tablet-and-up field">\n                                    <input type="text" name="last_name" placeholder="Last Name"\n                                      class="field__input input input--full input--squared input--bordered js-register-last-name">\n                                    <div class="field__error"></div>\n                                </div><!--\n\n                                --><div class="layout__item u-1/2-tablet-and-up field">\n                                    <input type="email" name="email" placeholder="Email"\n                                      class="field__input input input--full input--squared input--bordered js-register-email">\n                                    <div class="field__error"></div>\n                                </div><!--\n\n                                --><div class="layout__item u-1/2-tablet-and-up field">\n                                    <input type="tel" name="telephone" placeholder="Telephone"\n                                      class="field__input input input--full input--squared input--bordered js-register-telephone">\n                                    <div class="field__error"></div>\n                                </div><!--\n\n                                --><div class="layout__item u-1/2-tablet-and-up field">\n                                    <input type="password" name="password" placeholder="Create password"\n                                      class="field__input input input--full input--squared input--bordered js-register-password">\n                                    <div class="field__error"></div>\n                                </div><!--\n                            --></div>\n                        </div>\n\n                        <div class="tab-content js-login-form">\n                            <div class="layout"><!--\n                                --><div class="layout__item u-1/2-tablet-and-up field">\n                                    <input type="email" name="email" placeholder="Email"\n                                      class="field__input input input--full input--squared input--bordered js-login-email">\n                                    <div class="field__error"></div>\n                                </div><!--\n\n                                --><div class="layout__item u-1/2-tablet-and-up field">\n                                    <input type="password" name="password" placeholder="Password"\n                                      class="field__input input input--full input--squared input--bordered js-login-password">\n                                    <div class="field__error"></div>\n                                </div><!--\n                                --><div class="layout__item field">\n                                    <div class="field__checkbox checkbox checkbox--checked">\n                                        <div class="checkbox__box">\n                                            <div class="checkbox__tick"></div>\n                                            <input type="checkbox" name="remember_me" id="remember_me" value="1" class="checkbox__input js-login-remember-me" checked="checked">\n                                        </div>\n                                        <label class="checkbox__label">Remember me</label>\n                                    </div>\n                                    <div class="field__error"></div>\n                                </div><!--\n                            --></div>\n                        </div>\n                    <% } %>\n\n                    <div class="layout"><!--\n                        --><div class="layout__item u-1/3-phone u-1/3-tablet-and-up">\n                            <% if (action === \'register\' || action === \'login\') { %>\n                                <div class="u-mt-">\n                                    <a href="#" class="js-login-button">Login?</a>\n                                    <a href="#" class="js-register-button" style="display: none;">Sign up?</a>\n                                </div>\n                            <% } %>\n                        </div><!--\n\n                        --><div class="layout__item u-2/3-phone u-2/3-tablet-and-up tar">\n                            <button class="btn js-submit">Send message</button>\n                        </div>\n\n                        <div class="layout__item u-mt- tac">\n                            <p class="tiny">By clicking this button you\'re agreeing to our <a href="/terms">Terms &amp; Conditions</a></p>\n                        </div>\n                    </div>\n                </form>\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay"></div>\n'}),define("apps/messages/create/views/layout",["base","entities/user","requirejs-text!apps/messages/create/templates/layout.html"],function(e,t,i){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(i),ui:{body:".js-body",action:".js-action",register_button:".js-register-button",register_form:".js-register-form","register.first_name":".js-register-first-name","register.last_name":".js-register-last-name","register.email":".js-register-email","register.telephone":".js-register-telephone","register.password":".js-register-password",login_button:".js-login-button",login_form:".js-login-form","login.email":".js-login-email","login.password":".js-login-password","login.remember_me":".js-login-remember-me"},fields:["body","register.first_name","register.last_name","register.email","register.telephone","register.password","login.email","login.password","login.remember_me"],events:{"click @ui.login_button":"showLoginForm","click @ui.register_button":"showRegistrationForm"},initialize:function(){var e=t.current();e.isNew()&&this.model.set({action:"register"})},showLoginForm:function(e){return e.prevenDefault&&e.prevenDefault(),this.ui.login_form.css("display","block"),this.ui.register_form.css("display","none"),this.ui.register_button.css("display","block"),this.ui.login_button.css("display","none"),this.model.set({action:"login"}),!1},showRegistrationForm:function(e){return e.prevenDefault&&e.prevenDefault(),this.ui.register_form.css("display","block"),this.ui.login_form.css("display","none"),this.ui.login_button.css("display","block"),this.ui.register_button.css("display","none"),this.model.set({action:"register"}),!1}}))}),define("apps/messages/create/controller",["base","events","entities/message","entities/user","apps/messages/create/views/layout"],function(e,t,i,n,s){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.region=e.region,this.message=new i.model,this.view=new s({model:this.message}),this.listenToView(this.view),this.listenToMessage(this.message),this.region.show(this.view)},listenToView:function(e){e._listenId&&this._listeningTo[message._listenId]||(this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy))},listenToMessage:function(e){e._listenId&&this._listeningTo[e._listenId]||(this.listenTo(e,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(e,"sync",this.onSyncSuccess),this.listenTo(e,"error",this.onSyncError),this.listenTo(e,"invalid",this.onInvalid))},save:function(e){this.listenToMessage(this.message);n.current();e=object_undot(_.extend({to:this.options.uuid},e)),this.message.save(e)},onSyncSuccess:function(e,t){_.config("live")!==!0||_.isUndefined(window.ga)?window.location=t.meta.redirect:(ga("send","event","message","send","new_enquiry",10),fbq("track","Lead"),window.setTimeout(function(){window.location=t.meta.redirect},250))},onDestroy:function(){var e=laroute.route("tutor.profile.show",{uuid:this.options.uuid});this.app.history.back(e)}}))}),define("apps/messages/controller",["base","entities/user","apps/messages/create/controller"],function(e,t,i){return e.Controller.extend({create:function(e){return e=_.isObject(e)?e:{},console.log("messages created"),new i(_.extend({app:this.app,region:this.app.dialogueRegion},e))},openMessageForm:function(){$("#intent").val(1),$("#reason").val(""),$('textarea[name="body"]').val(""),$("form.message-form").addClass("message-form--active"),$(".tutor-intent").removeClass("tutor-intent--active"),$(".can-help").show(),$(".cannot-help").hide(),$(".tar .help-yes").hide(),$(".tar .help-no").show(),$(".tar .change-reason").hide(),$(".popover").removeClass("popover--open")},openReasonDialogue:function(){var e=$("#reason-dialogue");$(e).addClass("dialogue--open"),$("#reason").val(""),$("#reason-dialogue input:radio").removeAttr("checked"),$("#reason-dialogue .radios__item--checked").removeClass("radios__item--checked"),$("#reason-dialogue button").addClass("btn--disabled").attr("disabled"),$(".radios__item").on("click",function(){$(".btn-reason").removeAttr("disabled").removeClass("btn--disabled")}),$('textarea[name="body"]').on("keyup",function(){$(".popover").removeClass("popover--open")})},closeReasonDialogue:function(){$("#reason-dialogue input:radio").removeAttr("checked"),$("#reason-dialogue .btn-reason").addClass("btn--disabled").attr("disabled"),$("#intent").val(1),$("#reason").val(""),$(".dialogue").removeClass("dialogue--open"),$(".tar .change-reason").hide(),$(".tar .help-yes").hide()},setReason:function(e){var t=$(e).data("message");t?$(".popover").addClass("popover--open"):$(".popover").removeClass("popover--open"),$(".popover").on("click",function(){$(".popover").removeClass("popover--open")}),$('textarea[name="body"]').val(t),$("#reason").val($(e).val()),$("#intent").val(0),$(".dialogue").removeClass("dialogue--open"),$("form.message-form").addClass("message-form--active"),$(".tutor-intent").removeClass("tutor-intent--active"),$(".can-help").show(),$(".cannot-help").hide(),$(".tar .help-no").hide(),$(".tar .change-reason").show(),$(".tar .help-yes").show()},show:function(){var e=$(".messages");if(console.log("in show"),e.length>0){var i=$(window),n=$(".messages__list"),s=_.reduce([$(".page-head"),$(".message-head"),$(".message-form")],function(e,t){return e+t.outerHeight()},48),o=function(){if(!$(document.activeElement).is("input")&&!$(document.activeElement).is("textarea")){var t=i.height()-s;190>t&&(t=190),e.css("height",t),e.scrollTop(n.prop("scrollHeight"))}};i.on("resize",o),o()}var r=this;$(".help-yes").on("click",function(e){console.log("clicked yes"),e.preventDefault(),r.openMessageForm()}),$(".help-no").on("click",function(e){console.log("clicked no"),e.preventDefault(),r.openReasonDialogue()}),$("#reason-dialogue .btn-reason").on("click",function(e){e.preventDefault();var t=$('input[name="reason_select"]:checked');r.setReason(t)}),$(".js-close").on("click",function(e){r.closeReasonDialogue()}),$("#dialogue .go-offline").on("click",function(e){e.preventDefault(),user=t.current(),user.save({profile:{status:"offline"}},{patch:!0}),$(".dialogue").removeClass("dialogue--open"),_.toast("You are now offline","error")})}})}),define("apps/messages/router",["base"],function(e){return e.Router.extend({routes:{create:laroute.route("message.create",{uuid:":uuid"}),tutor:laroute.route("tutor.messages.show",{id:":id"}),student:laroute.route("student.messages.show",{id:":id"}),admin:laroute.route("admin.relationships.messages.show",{id:":id"})},create:function(e){this.controller.create({uuid:e})},tutor:function(e){this.controller.show({id:e})},student:function(e){this.controller.show({id:e})},admin:function(e){this.controller.show({id:e})}})}),define("apps/messages/app",["apps/messages/controller","apps/messages/router"],function(e,t){return function(){var i=new e({app:this});return new t({controller:i})}}),define("requirejs-text!apps/tutor_account/personal/templates/layout.html",[],function(){return'<h4 class="delta">Personal Details</h4>\n\n<% if (showIntro) { %>\n    <div class="[ box box--small box--ui ] u-mt [ js-dismissable ]" data-dismissable-id="tutor_account_personal_introduction">\n        <span class="box__close [ icon icon--cancel ] [ js-close ]"></span>\n        <p><%= _.lang(\'dashboard.tutor.account.personal.introduction\') %></p>\n    </div>\n<% } %>\n\n<form class="[ layout ] [ js-form ]"><!--\n    Name\n    --><div class="[ layout__item field field--label ]">\n        <label for="first_name" class="field__label">Name</label>\n    </div><!--\n\n    --><div class="[ layout__item field field--first-name ]">\n        <input type="text" name="first_name" id="first_name"\n            value="<%= first_name %>" placeholder="First Name"\n            class="[ input input--full input--squared input--bordered ] field__input [ js-first-name ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--last-name ]">\n        <input type="text" name="last_name" id="last_name"\n            value="<%= last_name %>" placeholder="Last Name"\n            class="[ input input--full input--squared input--bordered ] field__input [ js-last-name ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    Contact\n    --><div class="[ layout__item field field--label ]">\n        <label for="first_name" class="field__label">Contact</label>\n    </div><!--\n\n    --><div class="[ layout__item field field--email ]">\n        <input type="text" name="email" id="email"\n            value="<%= email %>" placeholder="Email"\n            class="[ input input--full input--squared input--bordered ] field__input [ js-email ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--telephone ]">\n        <input type="text" name="telephone" id="telephone"\n            value="<%= telephone %>" placeholder="Telephone"\n            class="[ input input--full input--squared input--bordered ] field__input [ js-telephone ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    Address\n    --><div class="[ layout__item field field--label ]">\n        <label for="address_street" class="field__label">\n            <abbr title="You will be found by students by distance from this address. It will never been shown to them, though.">\n                Address\n            </abbr>\n        </label>\n    </div><!--\n\n    --><div class="[ layout__item field field--address-street ]">\n        <input type="text" name="address_street" id="address_street"\n            value="<%= addresses.default.line_1 %>" placeholder="Street"\n            class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-1 ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--address-town ]">\n        <input type="text" name="address_town" id="address_town"\n            value="<%= addresses.default.line_2 %>" placeholder="Town"\n            class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-2 ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--address-city ]">\n        <input type="text" name="address_city" id="address_city"\n            value="<%= addresses.default.line_3 %>" placeholder="County"\n            class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-3 ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--postcode ]">\n        <input type="text" name="address_postcode" id="address_postcode"\n            value="<%= addresses.default.postcode %>" placeholder="Postcode"\n            class="[ input input--full input--squared input--bordered ] field__input [ js-address-postcode ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item ] tar u-mt u-mb">\n        <button class="btn [ js-submit ]">Save</button>\n    </div><!--\n--></form>\n';
}),define("apps/tutor_account/personal/views/layout",["base","requirejs-text!apps/tutor_account/personal/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["FormLayout","FieldsLayout"],template:_.template(t),templateHelpers:function(){return{showIntro:_.indexOf(_.config("cookies"),"dismissable_tutor_account_personal_introduction")>=0}},modelEvents:{sync:"render"},ui:{first_name:".js-first-name",last_name:".js-last-name",email:".js-email",telephone:".js-telephone","addresses.default.line_1":".js-address-line-1","addresses.default.line_2":".js-address-line-2","addresses.default.line_3":".js-address-line-3","addresses.default.postcode":".js-address-postcode"},fields:["first_name","last_name","email","telephone","addresses.default.line_1","addresses.default.line_2","addresses.default.line_3","addresses.default.postcode"]}))}),define("apps/tutor_account/personal/controller",["base","entities/user","apps/tutor_account/personal/views/layout"],function(e,t,i){return _.patch(e.Controller.extend({mixins:["FormController"],initialize:function(e){this.user=t.current(),this.view=new i({model:this.user}),this.listenTo(this.view,"render",this.onRender),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){this.user.save(object_undot(e),{patch:!0})},onSyncSuccess:function(e,t){_.toast("Saved!","success"),this.view.enableSubmit()}}))}),define("entities/bank_account",["base"],function(e){var t=e.Model.extend({defaults:{account_number:null,routing_number:null,country:"GB",currency:"GBP"},validation:{account_number:[{required:!0,msg:"The bank account field is required."}],routing_number:[{required:!0,msg:"The sort code field is required."}]}});return{model:function(e,i){return new t(e,i)}}}),define("requirejs-text!apps/tutor_account/payment/templates/layout.html",[],function(){return'<h4 class="delta">Payment Details</h4>\n\n<% if (showIntro) { %>\n    <div class="[ box box--small box--ui ] u-mt [ js-dismissable ]" data-dismissable-id="tutor_account_payment_introduction">\n        <span class="box__close [ icon icon--cancel ] [ js-close ]"></span>\n        <p><%= _.lang(\'dashboard.tutor.account.payment.introduction\') %></p>\n    </div>\n<% } %>\n\n<form class="[ layout ] [ js-form ]"><!--\n    Bank Account\n    --><div class="[ layout__item field field--label ]">\n        <label for="bank_account_number" class="field__label">Bank Account</label>\n    </div><!--\n\n    --><div class="[ layout__item field field--first-name ]">\n        <input type="text" id="bank_account_number"\n          placeholder="<%= last_four ? \'XXXX \' + last_four : \'Account Number\' %>"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-bank-account-number ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--last-name ]">\n        <input type="text" id="bank_sort_code"\n          placeholder="<%= last_four ? \'XXX\' : \'Sort Code\' %>"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-bank-sort-code ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field ] u--mt-">\n        <div class="field__error js-bank"></div>\n    </div><!--\n\n    Billing Address\n    --><div class="[ layout__item field field--label ]">\n        <label for="address_street" class="field__label">Billing Address</label>\n    </div><!--\n\n    --><div class="[ layout__item field field--address-street ]">\n        <input type="text" name="address_street" id="address_street"\n          value="<%= addresses.billing.line_1 %>" placeholder="Street"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-1 ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--address-town ]">\n        <input type="text" name="address_town" id="address_town"\n          value="<%= addresses.billing.line_2 %>" placeholder="Town"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-2 ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--address-city ]">\n        <input type="text" name="address_city" id="address_city"\n          value="<%= addresses.billing.line_3 %>" placeholder="County"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-3 ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--postcode ]">\n        <input type="text" name="address_postcode" id="address_postcode"\n          value="<%= addresses.billing.postcode %>" placeholder="Postcode"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-address-postcode ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item ] tar u-mt u-mb">\n        <button class="btn [ js-submit ]">Save</button>\n    </div><!--\n--></form>\n'}),define("apps/tutor_account/payment/views/layout",["base","requirejs-text!apps/tutor_account/payment/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["FormLayout","FieldsLayout"],template:_.template(t),templateHelpers:function(){return{showIntro:_.indexOf(_.config("cookies"),"dismissable_tutor_account_payment_introduction")>=0}},modelEvents:{sync:"render"},ui:{bank:".js-bank","bank.account_number":".js-bank-account-number","bank.routing_number":".js-bank-sort-code","addresses.billing.line_1":".js-address-line-1","addresses.billing.line_2":".js-address-line-2","addresses.billing.line_3":".js-address-line-3","addresses.billing.postcode":".js-address-postcode"},fields:[["bank",function(){return null}],"bank.account_number","bank.routing_number","addresses.billing.line_1","addresses.billing.line_2","addresses.billing.line_3","addresses.billing.postcode"]}))}),define("apps/tutor_account/payment/controller",["base","events","entities/user","entities/bank_account","apps/tutor_account/payment/views/layout"],function(e,t,i,n,s){return _.patch(e.Controller.extend({mixins:["FormController"],initialize:function(e){this.user=i.current(),this.view=new s({model:this.user}),this.listenTo(this.view,"render",this.onRender),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){t.trigger("requirement:pending",{section:"account",name:"payment_details"}),e=object_undot(e);var i=e.bank&&(""!==e.bank.account_number||""!==e.bank.routing_number);i?this.saveWithStripe(e):(e.bank=null,this.saveWithTutora(e))},saveWithStripe:function(e){var t=n.model(e.bank),i=t.validate();if(_.isEmpty(i))Stripe.bankAccount.createToken(t.toJSON(),_.bind(this.onStripeResponse,this,e));else{var s={};_.each(i,function(e,t){s["bank."+t]=e}),this.onSyncErrorOrInvalid(),this.onInvalid(this.user,s)}},onStripeResponse:function(e,t,i){i.error?this.onStripeError(i.error):this.onStripeSync(e,t,i)},onStripeSync:function(e,t,i){_.progress().set(.5),e.bank=i.id,this.user.save(e,{patch:!0})},onStripeError:function(e){_.progress().done(),this.view.enableSubmit(),_.toast(e.message,"error"),t.trigger("requirement:incompleted",{section:"account",name:"payment_details"})},saveWithTutora:function(e){e.bank="",this.user.save(e,{patch:!0})},onSyncSuccess:function(e,t){_.toast("Saved!","success"),this.view.enableSubmit()},onSyncError:function(){t.trigger("requirement:incompleted",{section:"account",name:"payment_details"})}}))}),define("requirejs-text!apps/tutor_account/identification/templates/layout.html",[],function(){return'<h4 class="delta">Identification</h4>\n\n<!-- Introduction -->\n<% if (showIntro) { %>\n    <div class="[ box box--small box--ui ] u-mt [ js-dismissable ]" data-dismissable-id="tutor_account_identification_introduction">\n        <span class="box__close [ icon icon--cancel ] [ js-close ]"></span>\n        <p><%= _.lang(\'dashboard.tutor.account.identification.introduction\') %></p>\n    </div>\n<% } %>\n\n<!-- Verified -->\n<% if (identity_document.status == \'verified\' && showVerified) { %>\n    <div class="[ box box--small box--bordered ] u-mt [ js-dismissable ]" data-dismissable-id="tutor_account_identification_verified">\n        <span class="box__close [ icon icon--cancel ] [ js-close ]"></span>\n        <h5 class="zeta heading heading--iconed u-mb">\n            <span class="icon icon--success"></span>\n            <%= _.lang(\'dashboard.tutor.account.identification.verification.verified.heading\') %>\n        </h5>\n        <p><%= _.lang(\'dashboard.tutor.account.identification.verification.verified.details\') %></p>\n    </div>\n<% } else if (identity_document.status != \'verified\') { %>\n    <!-- Pending -->\n    <% if (lockFields) { %>\n        <div class="[ box box--small box--bordered ] u-mt">\n            <h5 class="zeta heading heading--iconed u-mb">\n                <span class="icon icon--warn"></span>\n                <%= _.lang(\'dashboard.tutor.account.identification.verification.pending.heading\') %>\n            </h5>\n            <p><%= _.lang(\'dashboard.tutor.account.identification.verification.pending.details\') %></p>\n        </div>\n    <!-- Unverified -->\n    <% } else if (identity_document.status == \'unverified\') { %>\n        <div class="[ box box--small box--bordered ] u-mt">\n            <h5 class="zeta heading heading--iconed u-mb">\n                <span class="icon icon--error"></span>\n                <%= _.lang(\'dashboard.tutor.account.identification.verification.unverified.heading\') %>\n            </h5>\n            <p><%= _.lang(\'dashboard.tutor.account.identification.verification.unverified.details\') %></p>\n            <% if (identity_document.details) { %>\n                <p>We were given the following details on why the check failed:<br>\n                    <strong>"<%= identity_document.details %></strong>"</p>\n            <% } %>\n            <p>If you\'re struggling, <a href="<%= laroute.route(\'about.contact\') %>#contact-us">get in touch</a>, we\'re happy to help.</p>\n        </div>\n    <!-- Not attempted -->\n    <% } else if ( _.isUndefined(identity_document.status)) { %>\n        <div class="[ box box--small box--info ] u-mt">\n            <h5 class="zeta heading heading--iconed u-mb">\n                <span class="icon icon--warn"></span>\n                <%= _.lang(\'dashboard.tutor.account.identification.verification.not-attempted.heading\') %>\n            </h5>\n            <p><%= _.lang(\'dashboard.tutor.account.identification.verification.not-attempted.details\') %></p>\n        </div>\n    <% } %>\n<% } %>\n\n<form class="[ layout ] [ js-form ]"><!--\n    Name\n    --><div class="[ layout__item field field--label ]">\n        <label for="first_name" class="field__label">Legal name (required)</label>\n    </div><!--\n\n    --><div class="[ layout__item field field--first-name ]">\n        <input type="text" name="first_name" id="first_name" required\n            <%= lockFields ? \'\' : \'\' %>\n            value="<%= legal_first_name %>" placeholder="First Name"\n            class="[ input input--full input--squared input--bordered <%= lockFields ? \'input\' : \'\' %> ] field__input [ js-legal-first-name ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--last-name ]">\n        <input type="text" name="last_name" id="last_name"\n            value="<%= legal_last_name %>" placeholder="Last Name" required\n            <%= lockFields ? \'\' : \'\' %>\n            class="[ input input--full input--squared input--bordered <%= lockFields ? \'input\' : \'\' %> ] field__input [ js-legal-last-name ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    DOB\n    --><div class="[ layout__item field field--label ]">\n        <label for="first_name" class="field__label">Date of Birth (required)</label>\n    </div><!--\n\n    --><div class="[ layout__item field field--dob-day ]">\n        <input type="text" name="dob_day" id="dob_day"\n            value="<%= dob.day %>" placeholder="Day" required\n            <%= lockFields ? \'\' : \'\' %>\n            class="[ input input--full input--squared input--bordered <%= lockFields ? \'input\' : \'\' %> ] field__input [ js-dob-day ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--dob-month ]">\n        <input type="text" name="dob_month" id="dob_month"\n            value="<%= dob.month %>" placeholder="Month" required\n            <%= lockFields ? \'\' : \'\' %>\n            class="[ input input--full input--squared input--bordered <%= lockFields ? \'input\' : \'\' %> ] field__input [ js-dob-month ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--dob-year ]">\n        <input type="text" name="dob_year" id="dob_year"\n            value="<%= dob.year %>" placeholder="Year" required\n            <%= lockFields ? \'\' : \'\' %>\n            class="[ input input--full input--squared input--bordered <%= lockFields ? \'input\' : \'\' %> ] field__input [ js-dob-year ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    ID\n    --><div class="[ layout__item field field--label ]">\n        <label for="identity_document" class="field__label">Identification Document</label>\n        <p>Please ensure that your ID matches the requirements below, otherwise the ID check will fail and this will delay your application:</p>\n        <ul>\n            <li>Upload a picture of your passport or driving license. National ID cards or residence permits will not be accepted.</li>\n            <li>Ensure that your ID is in colour, not black and white.</li>\n            <li>Files must be less than 4mb in size and in photographic format (either JPG, JPEG or PNG). If you have a scanned copy such as a PDF, convert it to a JPG using <a target="_blank" href="http://image.online-convert.com/convert-to-jpg">this free service</a>.</li>\n        </ul>\n    </div><!--\n\n    --><div class="[ layout__item ] [ field field--identity-document ]">\n        <div class="[ box box--bordered <%= lockFields ? \'box\' : \'box--clickable\' %> ] u-mb0 tac [ js-document ]">\n            <div class="[ js-document-preview ]">\n                <% if (identity_document.src) { %>\n                    <img src="<%= identity_document.src %>" height="150">\n                <% } else { %>\n                    <p>Drop a file here or click to upload your ID</p>\n                <% } %>\n            </div>\n        </div>\n        <div class="field__error"></div>\n    </div><!--\n\n    \n        --><div class="[ layout__item ] tar u-mt u-mb">\n            <button class="btn [ js-submit ]">Upload &amp; Save</button>\n        </div><!--\n    \n--></form>\n'}),define("apps/tutor_account/identification/views/layout",["dropzone","base","requirejs-text!apps/tutor_account/identification/templates/layout.html"],function(e,t,i){return _.patch(t.LayoutView.extend({mixins:["FormLayout","FieldsLayout"],template:_.template(i),templateHelpers:function(){var e=this.model.identity_document.get("status");return{showIntro:_.indexOf(_.config("cookies"),"dismissable_tutor_account_identification_introduction")>=0,showVerified:_.indexOf(_.config("cookies"),"dismissable_tutor_account_identification_verified")>=0,lockFields:e&&"unverified"!==e}},modelEvents:{sync:"render"},ui:{legal_first_name:".js-legal-first-name",legal_last_name:".js-legal-last-name","dob.day":".js-dob-day","dob.month":".js-dob-month","dob.year":".js-dob-year",document:".js-document",document_preview:".js-document-preview"},fields:["legal_first_name","legal_last_name","dob.day","dob.month","dob.year","document"],initialize:function(){this.listenTo(this.model.identity_document,"change",this.render)},showDocumentPreview:function(e,t){this.ui.document_preview.html('<img src="'+t+'">')}}))}),define("apps/tutor_account/identification/controller",["base","dropzone","events","entities/user","apps/tutor_account/identification/views/layout"],function(e,t,i,n,s){return _.patch(e.Controller.extend({mixins:["FormController"],initialize:function(e){this.user=n.current(),this.view=new s({model:this.user}),this.listenTo(this.view,"render",this.onRender),this.listenTo(this.view,"show",this.onShow),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.listenTo(i,"requirement:completed",function(e,t){"identification"==e.name&&(this.user.identity_document.set(t.identity_document),this.region.currentView.render())},this),this.listenTo(i,"requirement:incompleted",function(e,t){"identification"==e.name&&(this.user.identity_document.set(t.identity_document),this.region.currentView.render())},this),this.region.show(this.view)},onRender:function(){this.user.identity_document.get("status");this.dropzone=new t(this.view.ui.document[0],{url:laroute.route("api.users.identity-document.create",{uuid:this.user.id}),headers:{"X-CSRF-Token":_.config("csrf_token")},thumbnailWidth:null,thumbnailHeight:150,acceptedFiles:".jpeg,.jpg,.png",autoProcessQueue:!1,maxFiles:1,paramName:"file",clickable:[this.view.ui.document[0],this.view.ui.document_preview[0]],addedfile:_.bind(this.onDropzoneAddedFile,this),thumbnail:_.bind(this.view.showDocumentPreview,this.view),success:_.bind(this.onDropzoneSync,this),error:_.bind(this.onDropzoneError,this)})},save:function(e){this.view.hideErrors();var e=object_undot(e),t=this.validate(e);t.length>0?(this.onSyncErrorOrInvalid(),this.onSyncError(null,{status:400,responseJSON:{message:"ERR_INVALID",errors:t}})):(this.attributes=object_undot(e),this.dropzone.files.length>0?this.dropzone.processQueue():(this.attributes.identity_document=this.user.identity_document.toJSON(),this.saveUser()))},onDropzoneAddedFile:function(e){this.dropzone.files.length>1&&this.dropzone.removeFile(this.dropzone.files[0])},onDropzoneSync:function(e,t){_.progress().inc(.25),this.attributes.identity_document=t,this.saveUser()},saveUser:function(){this.user.save(this.attributes,{patch:!0})},onDropzoneError:function(e,t,i){if(this.onSyncErrorOrInvalid(),!i&&!e.accepted){var n="ERR_IMAGE_WRONGFORMAT";"application/pdf"==e.type&&(n="ERR_IMAGE_NOPDF");var i={status:400,responseJSON:{message:n}}}this.onSyncError(null,i)},onSyncSuccess:function(e,t){"new"===e.profile.get("status")&&(_.toast("Uploaded &amp; saved!","success"),_.delay(function(){i.trigger("requirement:pending",{section:"account",name:"identification"}),_.toast("Checking identification...","warning")},1e3)),this.view.enableSubmit()},validate:function(e){var t=[];return 0!==this.dropzone.files.length||this.user.identity_document.get("uuid")||t.push({field:"document",detail:"An identification document is required."}),_.isEmpty(e.legal_first_name)&&t.push({field:"legal_first_name",detail:"The first name field is required"}),_.isEmpty(e.legal_last_name)&&t.push({field:"legal_last_name",detail:"The last name field is required"}),_.isEmpty(e.dob.day)&&t.push({field:"dob.day",detail:"The day field is required"}),_.isEmpty(e.dob.month)&&t.push({field:"dob.month",detail:"The month field is required"}),_.isEmpty(e.dob.year)&&t.push({field:"dob.year",detail:"The year field is required"}),t}}))}),define("requirejs-text!apps/tutor_account/admin_identification/templates/layout.html",[],function(){return'<h4 class="delta">Identification</h4>\n\n<!-- Introduction -->\n<% if (showIntro) { %>\n    <div class="[ box box--small box--ui ] u-mt [ js-dismissable ]" data-dismissable-id="tutor_account_identification_introduction">\n        <span class="box__close [ icon icon--cancel ] [ js-close ]"></span>\n        <p><%= _.lang(\'dashboard.tutor.account.identification.introduction\') %></p>\n    </div>\n<% } %>\n\n<!-- Verified -->\n<% if (identity_document.status == \'verified\' && showVerified) { %>\n    <div class="[ box box--small box--bordered ] u-mt [ js-dismissable ]" data-dismissable-id="tutor_account_identification_verified">\n        <span class="box__close [ icon icon--cancel ] [ js-close ]"></span>\n        <h5 class="zeta heading heading--iconed u-mb">\n            <span class="icon icon--success"></span>\n            <%= _.lang(\'dashboard.tutor.account.identification.verification.verified.heading\') %>\n        </h5>\n        <p><%= _.lang(\'dashboard.tutor.account.identification.verification.verified.details\') %></p>\n    </div>\n<% } else if (identity_document.status != \'verified\') { %>\n    <!-- Pending -->\n    <% if (lockFields) { %>\n        <div class="[ box box--small box--bordered ] u-mt">\n            <h5 class="zeta heading heading--iconed u-mb">\n                <span class="icon icon--warn"></span>\n                <%= _.lang(\'dashboard.tutor.account.identification.verification.pending.heading\') %>\n            </h5>\n            <p><%= _.lang(\'dashboard.tutor.account.identification.verification.pending.details\') %></p>\n        </div>\n    <!-- Unverified -->\n    <% } else if (identity_document.status == \'unverified\') { %>\n        <div class="[ box box--small box--bordered ] u-mt">\n            <h5 class="zeta heading heading--iconed u-mb">\n                <span class="icon icon--error"></span>\n                <%= _.lang(\'dashboard.tutor.account.identification.verification.unverified.heading\') %>\n            </h5>\n            <p><%= _.lang(\'dashboard.tutor.account.identification.verification.unverified.details\') %></p>\n            <% if (identity_document.details) { %>\n                <p>We were given the following details on why the check failed:<br>\n                    <strong>"<%= identity_document.details %></strong>"</p>\n            <% } %>\n            <p>If you\'re struggling, <a href="<%= laroute.route(\'about.contact\') %>#contact-us">get in touch</a>, we\'re happy to help.</p>\n        </div>\n    <!-- Not attempted -->\n    <% } else if ( _.isUndefined(identity_document.status)) { %>\n        <div class="[ box box--small box--info ] u-mt">\n            <h5 class="zeta heading heading--iconed u-mb">\n                <span class="icon icon--warn"></span>\n                <%= _.lang(\'dashboard.tutor.account.identification.verification.not-attempted.heading\') %>\n            </h5>\n            <p><%= _.lang(\'dashboard.tutor.account.identification.verification.not-attempted.details\') %></p>\n        </div>\n    <% } %>\n<% } %>\n\n<form class="[ layout ] [ js-form ]"><!--\n    Name\n    --><div class="[ layout__item field field--label ]">\n        <label for="first_name" class="field__label">Legal name (required)</label>\n    </div><!--\n\n    --><div class="[ layout__item field field--first-name ]">\n        <input type="text" name="first_name" id="first_name" required\n            <%= lockFields ? \'\' : \'\' %>\n            value="<%= legal_first_name %>" placeholder="First Name"\n            class="[ input input--full input--squared input--bordered <%= lockFields ? \'input\' : \'\' %> ] field__input [ js-legal-first-name ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--last-name ]">\n        <input type="text" name="last_name" id="last_name"\n            value="<%= legal_last_name %>" placeholder="Last Name" required\n            <%= lockFields ? \'\' : \'\' %>\n            class="[ input input--full input--squared input--bordered <%= lockFields ? \'input\' : \'\' %> ] field__input [ js-legal-last-name ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    DOB\n    --><div class="[ layout__item field field--label ]">\n        <label for="first_name" class="field__label">Date of Birth (required)</label>\n    </div><!--\n\n    --><div class="[ layout__item field field--dob-day ]">\n        <input type="text" name="dob_day" id="dob_day"\n            value="<%= dob.day %>" placeholder="Day" required\n            <%= lockFields ? \'\' : \'\' %>\n            class="[ input input--full input--squared input--bordered <%= lockFields ? \'input\' : \'\' %> ] field__input [ js-dob-day ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--dob-month ]">\n        <input type="text" name="dob_month" id="dob_month"\n            value="<%= dob.month %>" placeholder="Month" required\n            <%= lockFields ? \'\' : \'\' %>\n            class="[ input input--full input--squared input--bordered <%= lockFields ? \'input\' : \'\' %> ] field__input [ js-dob-month ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--dob-year ]">\n        <input type="text" name="dob_year" id="dob_year"\n            value="<%= dob.year %>" placeholder="Year" required\n            <%= lockFields ? \'\' : \'\' %>\n            class="[ input input--full input--squared input--bordered <%= lockFields ? \'input\' : \'\' %> ] field__input [ js-dob-year ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    ID\n    --><div class="[ layout__item field field--label ]">\n        <label for="identity_document" class="field__label">Identification Document</label>\n        <p>Please ensure that your ID matches the requirements below, otherwise the ID check will fail and this will delay your application:</p>\n        <ul>\n            <li>Upload a picture of your passport or driving license. National ID cards or residence permits will not be accepted.</li>\n            <li>Ensure that your ID is in colour, not black and white.</li>\n            <li>Files must be less than 4mb in size and in photographic format (either JPG, JPEG or PNG). If you have a scanned copy such as a PDF, convert it to a JPG using <a target="_blank" href="http://image.online-convert.com/convert-to-jpg">this free service</a>.</li>\n        </ul>\n    </div><!--\n\n    --><div class="[ layout__item ] [ field field--identity-document ]">\n        <div class="[ box box--bordered <%= lockFields ? \'box\' : \'box--clickable\' %> ] u-mb0 tac [ js-document ]">\n            <div class="[ js-document-preview ]">\n                <% if (identity_document.src) { %>\n                    <img src="<%= identity_document.src %>" height="150">\n                <% } else { %>\n                    <p>Drop a file here or click to upload your ID</p>\n                <% } %>\n            </div>\n        </div>\n        <div class="field__error"></div>\n    </div><!--\n\n    \n        --><div class="[ layout__item ] tar u-mt u-mb">\n            <button class="btn [ js-submit ]">Upload &amp; Save</button>\n        </div><!--\n    \n--></form>\n'}),define("apps/tutor_account/admin_identification/views/layout",["dropzone","base","requirejs-text!apps/tutor_account/admin_identification/templates/layout.html"],function(e,t,i){return _.patch(t.LayoutView.extend({mixins:["FormLayout","FieldsLayout"],template:_.template(i),templateHelpers:function(){var e=this.model.identity_document.get("status");return{showIntro:_.indexOf(_.config("cookies"),"dismissable_tutor_account_identification_introduction")>=0,showVerified:_.indexOf(_.config("cookies"),"dismissable_tutor_account_identification_verified")>=0,lockFields:e&&"unverified"!==e}},modelEvents:{sync:"render"},ui:{legal_first_name:".js-legal-first-name",legal_last_name:".js-legal-last-name","dob.day":".js-dob-day","dob.month":".js-dob-month","dob.year":".js-dob-year",document:".js-document",document_preview:".js-document-preview"},fields:["legal_first_name","legal_last_name","dob.day","dob.month","dob.year","document"],initialize:function(){this.listenTo(this.model.identity_document,"change",this.render)},showDocumentPreview:function(e,t){this.ui.document_preview.html('<img src="'+t+'">')}}))}),define("apps/tutor_account/admin_identification/controller",["base","dropzone","events","entities/user","apps/tutor_account/admin_identification/views/layout"],function(e,t,i,n,s){return _.patch(e.Controller.extend({mixins:["FormController"],initialize:function(e){this.user=e.user,this.showLayout()},showLayout:function(){_.progress().done(),this.stopListening(this.user),this.view=new s({model:this.user}),this.listenTo(this.view,"render",this.onRender),this.listenTo(this.view,"show",this.onShow),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.listenTo(i,"requirement:completed",function(e,t){"identification"==e.name&&(this.user.identity_document.set(t.identity_document),this.region.currentView.render())},this),this.listenTo(i,"requirement:incompleted",function(e,t){"identification"==e.name&&(this.user.identity_document.set(t.identity_document),this.region.currentView.render())},this),this.region.show(this.view)},onRender:function(){this.user.identity_document.get("status");this.dropzone=new t(this.view.ui.document[0],{url:laroute.route("api.users.identity-document.create",{uuid:this.user.id}),headers:{"X-CSRF-Token":_.config("csrf_token")},thumbnailWidth:null,thumbnailHeight:150,acceptedFiles:".jpeg,.jpg,.png",autoProcessQueue:!1,maxFiles:1,paramName:"file",clickable:[this.view.ui.document[0],this.view.ui.document_preview[0]],addedfile:_.bind(this.onDropzoneAddedFile,this),thumbnail:_.bind(this.view.showDocumentPreview,this.view),success:_.bind(this.onDropzoneSync,this),error:_.bind(this.onDropzoneError,this)})},save:function(e){this.view.hideErrors();var e=object_undot(e),t=this.validate(e);t.length>0?(this.onSyncErrorOrInvalid(),this.onSyncError(null,{status:400,responseJSON:{message:"ERR_INVALID",errors:t}})):(this.attributes=object_undot(e),this.dropzone.files.length>0?this.dropzone.processQueue():(this.attributes.identity_document=this.user.identity_document.toJSON(),this.saveUser()))},onDropzoneAddedFile:function(e){this.dropzone.files.length>1&&this.dropzone.removeFile(this.dropzone.files[0])},onDropzoneSync:function(e,t){_.progress().inc(.25),this.attributes.identity_document=t,this.saveUser()},saveUser:function(){this.user.save(this.attributes,{patch:!0})},onDropzoneError:function(e,t,i){if(this.onSyncErrorOrInvalid(),!i&&!e.accepted){var n="ERR_IMAGE_WRONGFORMAT";"application/pdf"==e.type&&(n="ERR_IMAGE_NOPDF");var i={status:400,responseJSON:{message:n}}}this.onSyncError(null,i)},onSyncSuccess:function(e,t){"new"===e.profile.get("status")&&(_.toast("Uploaded &amp; saved!","success"),_.delay(function(){i.trigger("requirement:pending",{section:"account",name:"identification"}),_.toast("Checking identification...","warning")},1e3)),this.view.enableSubmit()},validate:function(e){var t=[];return 0!==this.dropzone.files.length||this.user.identity_document.get("uuid")||t.push({field:"document",detail:"An identification document is required."}),_.isEmpty(e.legal_first_name)&&t.push({field:"legal_first_name",detail:"The first name field is required"}),_.isEmpty(e.legal_last_name)&&t.push({field:"legal_last_name",detail:"The last name field is required"
}),_.isEmpty(e.dob.day)&&t.push({field:"dob.day",detail:"The day field is required"}),_.isEmpty(e.dob.month)&&t.push({field:"dob.month",detail:"The month field is required"}),_.isEmpty(e.dob.year)&&t.push({field:"dob.year",detail:"The year field is required"}),t}}))}),define("requirejs-text!apps/tutor_account/admin_payment/templates/layout.html",[],function(){return'<h4 class="delta">Payment Details</h4>\n\n<% if (showIntro) { %>\n    <div class="[ box box--small box--ui ] u-mt [ js-dismissable ]" data-dismissable-id="tutor_account_payment_introduction">\n        <span class="box__close [ icon icon--cancel ] [ js-close ]"></span>\n        <p><%= _.lang(\'dashboard.tutor.account.payment.introduction\') %></p>\n    </div>\n<% } %>\n\n<form class="[ layout ] [ js-form ]"><!--\n    Bank Account\n    --><div class="[ layout__item field field--label ]">\n        <label for="bank_account_number" class="field__label">Bank Account</label>\n    </div><!--\n\n    --><div class="[ layout__item field field--first-name ]">\n        <input type="text" id="bank_account_number"\n          placeholder="<%= last_four ? \'XXXX \' + last_four : \'Account Number\' %>"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-bank-account-number ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--last-name ]">\n        <input type="text" id="bank_sort_code"\n          placeholder="<%= last_four ? \'XXX\' : \'Sort Code\' %>"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-bank-sort-code ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field ] u--mt-">\n        <div class="field__error js-bank"></div>\n    </div><!--\n\n    Billing Address\n    --><div class="[ layout__item field field--label ]">\n        <label for="address_street" class="field__label">Billing Address</label>\n    </div><!--\n\n    --><div class="[ layout__item field field--address-street ]">\n        <input type="text" name="address_street" id="address_street"\n          value="<%= addresses.billing.line_1 %>" placeholder="Street"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-1 ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--address-town ]">\n        <input type="text" name="address_town" id="address_town"\n          value="<%= addresses.billing.line_2 %>" placeholder="Town"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-2 ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--address-city ]">\n        <input type="text" name="address_city" id="address_city"\n          value="<%= addresses.billing.line_3 %>" placeholder="County"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-3 ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--postcode ]">\n        <input type="text" name="address_postcode" id="address_postcode"\n          value="<%= addresses.billing.postcode %>" placeholder="Postcode"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-address-postcode ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item ] tar u-mt u-mb">\n        <button class="btn [ js-submit ]">Save</button>\n    </div><!--\n--></form>\n'}),define("apps/tutor_account/admin_payment/views/layout",["base","requirejs-text!apps/tutor_account/admin_payment/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["FormLayout","FieldsLayout"],template:_.template(t),templateHelpers:function(){return{showIntro:_.indexOf(_.config("cookies"),"dismissable_tutor_account_payment_introduction")>=0}},modelEvents:{sync:"render"},ui:{bank:".js-bank","bank.account_number":".js-bank-account-number","bank.routing_number":".js-bank-sort-code","addresses.billing.line_1":".js-address-line-1","addresses.billing.line_2":".js-address-line-2","addresses.billing.line_3":".js-address-line-3","addresses.billing.postcode":".js-address-postcode"},fields:[["bank",function(){return null}],"bank.account_number","bank.routing_number","addresses.billing.line_1","addresses.billing.line_2","addresses.billing.line_3","addresses.billing.postcode"]}))}),define("apps/tutor_account/admin_payment/controller",["base","events","entities/user","entities/bank_account","apps/tutor_account/admin_payment/views/layout"],function(e,t,i,n,s){return _.patch(e.Controller.extend({mixins:["FormController"],initialize:function(e){this.user=e.user,this.view=new s({model:this.user}),this.listenTo(this.view,"render",this.onRender),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){t.trigger("requirement:pending",{section:"account",name:"payment_details"}),e=object_undot(e);var i=e.bank&&(""!==e.bank.account_number||""!==e.bank.routing_number);i?this.saveWithStripe(e):(e.bank=null,this.saveWithTutora(e))},saveWithStripe:function(e){var t=n.model(e.bank),i=t.validate();if(_.isEmpty(i))Stripe.bankAccount.createToken(t.toJSON(),_.bind(this.onStripeResponse,this,e));else{var s={};_.each(i,function(e,t){s["bank."+t]=e}),this.onSyncErrorOrInvalid(),this.onInvalid(this.user,s)}},onStripeResponse:function(e,t,i){i.error?this.onStripeError(i.error):this.onStripeSync(e,t,i)},onStripeSync:function(e,t,i){_.progress().set(.5),e.bank=i.id,this.user.save(e,{patch:!0})},onStripeError:function(e){_.progress().done(),this.view.enableSubmit(),_.toast(e.message,"error"),t.trigger("requirement:incompleted",{section:"account",name:"payment_details"})},saveWithTutora:function(e){e.bank="",this.user.save(e,{patch:!0})},onSyncSuccess:function(e,t){_.toast("Saved!","success"),this.view.enableSubmit()},onSyncError:function(){t.trigger("requirement:incompleted",{section:"account",name:"payment_details"})}}))}),define("apps/tutor_account/admin_billing/controller",["base","dropzone","events","entities/user","apps/tutor_account/admin_identification/controller","apps/tutor_account/admin_payment/controller"],function(e,t,i,n,s,o){return _.patch(e.Controller.extend({initialize:function(e){this.tutorId=e.uuid,this.user=this.getUser(),_.progress().start(),this.listenTo(this.user,"sync",this.triggerSubviews),this.user.fetch()},getUser:function(){var e=n.model({uuid:this.tutorId});return e},triggerSubviews:function(){_.progress().done(),this.stopListening(this.user),new s({app:this.app,user:this.user,region:this.app.identificationRegion}),new o({app:this.app,user:this.user,region:this.app.paymentRegion})}}))}),define("apps/tutor_account/controller",["base","entities/user","apps/tutor_account/personal/controller","apps/tutor_account/payment/controller","apps/tutor_account/identification/controller","apps/tutor_account/admin_billing/controller"],function(e,t,i,n,s,o){return e.Controller.extend({personal:function(e){return e=_.isObject(e)?e:{},new i(_.extend({app:this.app,region:this.app.accountRegion},e))},payment:function(e){return e=_.isObject(e)?e:{},new n(_.extend({app:this.app,region:this.app.accountRegion},e))},identification:function(e){return e=_.isObject(e)?e:{},new s(_.extend({app:this.app,region:this.app.accountRegion},e))},adminBilling:function(e){return e=_.isObject(e)?e:{},new o(_.extend({app:this.app},e))}})}),define("apps/tutor_account/router",["base"],function(e){return e.Router.extend({routes:{personal:laroute.route("tutor.account.personal.index"),payment:laroute.route("tutor.account.payment.index"),identification:laroute.route("tutor.account.identification.index"),admin_billing:laroute.route("admin.tutors.billing.index")},personal:function(){this.tab("personal"),this.controller.personal()},payment:function(){this.tab("payment"),this.controller.payment()},identification:function(){this.tab("identification"),this.controller.identification()},admin_billing:function(e){this.controller.adminBilling({uuid:e})},tab:function(e){$(".js-tab").removeClass("tabs__link--active"),$('[data-tab-name="'+e+'"]').addClass("tabs__link--active")}})}),define("apps/tutor_account/app",["apps/tutor_account/controller","apps/tutor_account/router"],function(e,t){return function(){var i=$(".js-account-region");if(1===i.length){this.addRegions({accountRegion:i,requirementsRegion:".js-requirements",identificationRegion:".js-identification-region",paymentRegion:".js-payment-region"});var n=new e({app:this});return new t({controller:n})}}}),define("requirejs-text!apps/student_account/personal/templates/layout.html",[],function(){return'<h4 class="delta">Personal Details</h4>\n\n<% if (showIntro) { %>\n    <div class="[ box box--small box--ui ] u-mt [ js-dismissable ]" data-dismissable-id="student_account_personal_introduction">\n        <span class="box__close [ icon icon--cancel ] [ js-close ]"></span>\n        <p><%= _.lang(\'dashboard.student.account.personal.introduction\') %></p>\n    </div>\n<% } %>\n\n<form class="[ layout ] [ js-form ]"><!--\n    Name\n    --><div class="[ layout__item field field--label ]">\n        <label for="first_name" class="field__label">Name</label>\n    </div><!--\n\n    --><div class="[ layout__item field field--first-name ]">\n        <input type="text" name="first_name" id="first_name"\n            value="<%= first_name %>" placeholder="First Name"\n            class="[ input input--full input--squared input--bordered ] field__input [ js-first-name ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--last-name ]">\n        <input type="text" name="last_name" id="last_name"\n            value="<%= last_name %>" placeholder="Last Name"\n            class="[ input input--full input--squared input--bordered ] field__input [ js-last-name ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    Contact\n    --><div class="[ layout__item field field--label ]">\n        <label for="first_name" class="field__label">Contact</label>\n    </div><!--\n\n    --><div class="[ layout__item field field--email ]">\n        <input type="text" name="email" id="email"\n            value="<%= email %>" placeholder="Email"\n            class="[ input input--full input--squared input--bordered ] field__input [ js-email ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--telephone ]">\n        <input type="text" name="telephone" id="telephone"\n            value="<%= telephone %>" placeholder="Telephone"\n            class="[ input input--full input--squared input--bordered ] field__input [ js-telephone ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    Address\n    --><div class="[ layout__item field field--label ]">\n        <label for="address_street" class="field__label">Address</label>\n    </div><!--\n\n    --><div class="[ layout__item field field--address-street ]">\n        <input type="text" name="address_street" id="address_street"\n            value="<%= addresses.default.line_1 %>" placeholder="Street"\n            class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-1 ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--address-town ]">\n        <input type="text" name="address_town" id="address_town"\n            value="<%= addresses.default.line_2 %>" placeholder="Town"\n            class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-2 ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--address-city ]">\n        <input type="text" name="address_city" id="address_city"\n            value="<%= addresses.default.line_3 %>" placeholder="County"\n            class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-3 ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--postcode ]">\n        <input type="text" name="address_postcode" id="address_postcode"\n            value="<%= addresses.default.postcode %>" placeholder="Postcode"\n            class="[ input input--full input--squared input--bordered ] field__input [ js-address-postcode ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item ] tar u-mt u-mb">\n        <button class="btn [ js-submit ]">Save</button>\n    </div><!--\n--></form>\n'}),define("apps/student_account/personal/views/layout",["base","requirejs-text!apps/student_account/personal/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["FormLayout","FieldsLayout"],template:_.template(t),templateHelpers:function(){return{showIntro:_.indexOf(_.config("cookies"),"dismissable_student_account_personal_introduction")>=0}},modelEvents:{sync:"render"},ui:{first_name:".js-first-name",last_name:".js-last-name",email:".js-email",telephone:".js-telephone","addresses.default.line_1":".js-address-line-1","addresses.default.line_2":".js-address-line-2","addresses.default.line_3":".js-address-line-3","addresses.default.postcode":".js-address-postcode"},fields:["first_name","last_name","email","telephone","addresses.default.line_1","addresses.default.line_2","addresses.default.line_3","addresses.default.postcode"]}))}),define("apps/student_account/personal/controller",["base","entities/user","apps/student_account/personal/views/layout"],function(e,t,i){return _.patch(e.Controller.extend({mixins:["FormController"],initialize:function(e){this.user=t.current(),this.view=new i({model:this.user}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){this.user.save(object_undot(e),{patch:!0})},onSyncSuccess:function(e,t){_.toast("Saved!","success"),this.view.enableSubmit()}}))}),define("requirejs-text!apps/student_account/payment/templates/layout.html",[],function(){return'<h4 class="delta">Payment Details</h4>\n\n<% if (showIntro) { %>\n    <div class="[ box box--small box--ui ] u-mt [ js-dismissable ]" data-dismissable-id="student_account_payment_introduction">\n        <span class="box__close [ icon icon--cancel ] [ js-close ]"></span>\n        <p><%= _.lang(\'dashboard.student.account.payment.introduction\') %></p>\n    </div>\n<% } %>\n\n<form class="[ layout ] [ js-form ]"><!--\n    Name\n    --><div class="[ layout__item ][ field field--label ]">\n        <label for="card_number" class="field__label">Card</label>\n    </div><!--\n\n    --><div class="[ layout__item ][ field field--card-number]">\n        <input type="text" id="card_number"\n          placeholder="<%= last_four ? \'XXXX XXXX XXXX \' + last_four : \'Card Number\' %>"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-card-number ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item ][ field field--card-cvc ]">\n        <input type="text" id="card_cvc"\n          placeholder="<%= last_four ? \'XXX\' : \'CVC\' %>"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-card-cvc ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item ][ field field--card-exp-month ]">\n        <div class="[ field__select ][ select select--full select--squared select--bordered ]">\n            <span class="select__placeholder"><%= last_four ? \'XX\' : \'Exp month\' %></span>\n            <span class="select__value"></span>\n            <select class="select__field [ js-card-exp-month ]">\n                <option value="">Please select one:</option>\n                <% _.each(months, function (title, value) { %>\n                    <option value="<%= _.pad(value, 2, "0") %>"><%= _.pad(value, 2, "0") %> - <%= title %></option>\n                <% }) %>\n            </select>\n        </div>\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item ][ field field--card-exp-year ]">\n        <div class="[ field__select ][ select select--full select--squared select--bordered ]">\n            <span class="select__placeholder"><%= last_four ? \'XX\' : \'Exp year\' %></span>\n            <span class="select__value"></span>\n            <select class="select__field [ js-card-exp-year ]">\n                <option value="">Please select one:</option>\n                <% _.each(years, function (value) { %>\n                    <option value="<%= value %>"><%= value %></option>\n                <% }) %>\n            </select>\n        </div>\n        <div class="field__error"></div>\n    </div><!--\n\n    Billing Address\n    --><div class="[ layout__item field field--label ]">\n        <label for="address_street" class="field__label">Billing Address</label>\n    </div><!--\n\n    --><div class="[ layout__item field field--address-street ]">\n        <input type="text" name="address_street" id="address_street"\n          value="<%= addresses.billing.line_1 %>" placeholder="Street"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-1 ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--address-town ]">\n        <input type="text" name="address_town" id="address_town"\n          value="<%= addresses.billing.line_2 %>" placeholder="Town"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-2 ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--address-city ]">\n        <input type="text" name="address_city" id="address_city"\n          value="<%= addresses.billing.line_3 %>" placeholder="County"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-3 ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--postcode ]">\n        <input type="text" name="address_postcode" id="address_postcode"\n          value="<%= addresses.billing.postcode %>" placeholder="Postcode"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-address-postcode ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item ] tar u-mt u-mb">\n        <button class="btn [ js-submit ]">Save</button>\n    </div><!--\n--></form>'}),define("apps/student_account/payment/views/layout",["base","requirejs-text!apps/student_account/payment/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["FormLayout","FieldsLayout"],template:_.template(t),templateHelpers:function(){for(var e={1:"January",2:"Febuary",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"},t=[],i=(new Date).getFullYear(),n=i+15;n>i;i++)t.push(i);return{months:e,years:t,showIntro:_.indexOf(_.config("cookies"),"dismissable_student_account_payment_introduction")>=0}},modelEvents:{sync:"render"},ui:{"card.number":".js-card-number","card.cvc":".js-card-cvc","card.exp_month":".js-card-exp-month","card.exp_year":".js-card-exp-year","addresses.billing.line_1":".js-address-line-1","addresses.billing.line_2":".js-address-line-2","addresses.billing.line_3":".js-address-line-3","addresses.billing.postcode":".js-address-postcode"},fields:["card.number","card.cvc","card.exp_month","card.exp_year","addresses.billing.line_1","addresses.billing.line_2","addresses.billing.line_3","addresses.billing.postcode"]}))}),define("apps/student_account/payment/controller",["base","entities/user","entities/bank_card","apps/student_account/payment/views/layout"],function(e,t,i,n){return _.patch(e.Controller.extend({mixins:["FormController"],initialize:function(e){this.user=t.current(),this.view=new n({model:this.user}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){e=object_undot(e);var t=e.card&&(""!==e.card.number||""!==e.card.cvc||""!==e.card.exp_month||""!==e.card.exp_year);t||_.isNull(this.user.get("last_four"))?this.saveWithStripe(e):(e.card="",this.saveWithTutora(e))},saveWithStripe:function(e){var t=i.model(e.card),n=t.validate();if(_.isEmpty(n))Stripe.card.createToken(t.toJSON(),_.bind(this.onStripeResponse,this,e));else{var s={};_.each(n,function(e,t){s["card."+t]=e}),this.onSyncErrorOrInvalid(),this.onInvalid(this.user,s)}},onStripeResponse:function(e,t,i){i.error?this.onStripeError(i.error):this.onStripeSync(e,t,i)},onStripeSync:function(e,t,i){_.progress().set(.5),e.card=i.id,this.user.save(e,{patch:!0})},onStripeError:function(e){_.progress().done();var t={};t["card."+e.param]=e.message,this.showErrors("ERR_INVALID",t),this.view.enableSubmit()},saveWithTutora:function(e){this.user.save(e,{patch:!0})},onSyncSuccess:function(e,t){_.toast("Saved!","success"),this.view.enableSubmit()}}))}),define("requirejs-text!apps/student_account/admin_payment/templates/layout.html",[],function(){return'<h4 class="delta">Payment Details</h4>\n\n<% if (showIntro) { %>\n    <div class="[ box box--small box--ui ] u-mt [ js-dismissable ]" data-dismissable-id="student_account_payment_introduction">\n        <span class="box__close [ icon icon--cancel ] [ js-close ]"></span>\n        <p><%= _.lang(\'dashboard.student.account.payment.introduction\') %></p>\n    </div>\n<% } %>\n\n<form class="[ layout ] [ js-form ]"><!--\n    Name\n    --><div class="[ layout__item ][ field field--label ]">\n        <label for="card_number" class="field__label">Card</label>\n    </div><!--\n\n    --><div class="[ layout__item ][ field field--card-number]">\n        <input type="text" id="card_number"\n          placeholder="<%= last_four ? \'XXXX XXXX XXXX \' + last_four : \'Card Number\' %>"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-card-number ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item ][ field field--card-cvc ]">\n        <input type="text" id="card_cvc"\n          placeholder="<%= last_four ? \'XXX\' : \'CVC\' %>"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-card-cvc ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item ][ field field--card-exp-month ]">\n        <div class="[ field__select ][ select select--full select--squared select--bordered ]">\n            <span class="select__placeholder"><%= last_four ? \'XX\' : \'Exp month\' %></span>\n            <span class="select__value"></span>\n            <select class="select__field [ js-card-exp-month ]">\n                <option value="">Please select one:</option>\n                <% _.each(months, function (title, value) { %>\n                    <option value="<%= _.pad(value, 2, "0") %>"><%= _.pad(value, 2, "0") %> - <%= title %></option>\n                <% }) %>\n            </select>\n        </div>\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item ][ field field--card-exp-year ]">\n        <div class="[ field__select ][ select select--full select--squared select--bordered ]">\n            <span class="select__placeholder"><%= last_four ? \'XX\' : \'Exp year\' %></span>\n            <span class="select__value"></span>\n            <select class="select__field [ js-card-exp-year ]">\n                <option value="">Please select one:</option>\n                <% _.each(years, function (value) { %>\n                    <option value="<%= value %>"><%= value %></option>\n                <% }) %>\n            </select>\n        </div>\n        <div class="field__error"></div>\n    </div><!--\n\n    Billing Address\n    --><div class="[ layout__item field field--label ]">\n        <label for="address_street" class="field__label">Billing Address</label>\n    </div><!--\n\n    --><div class="[ layout__item field field--address-street ]">\n        <input type="text" name="address_street" id="address_street"\n          value="<%= addresses.billing.line_1 %>" placeholder="Street"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-1 ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--address-town ]">\n        <input type="text" name="address_town" id="address_town"\n          value="<%= addresses.billing.line_2 %>" placeholder="Town"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-2 ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--address-city ]">\n        <input type="text" name="address_city" id="address_city"\n          value="<%= addresses.billing.line_3 %>" placeholder="County"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-address-line-3 ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item field field--postcode ]">\n        <input type="text" name="address_postcode" id="address_postcode"\n          value="<%= addresses.billing.postcode %>" placeholder="Postcode"\n          class="[ input input--full input--squared input--bordered ] field__input [ js-address-postcode ]">\n        <div class="field__error"></div>\n    </div><!--\n\n    --><div class="[ layout__item ] tar u-mt u-mb">\n        <button class="btn [ js-submit ]">Save</button>\n    </div><!--\n--></form>'}),define("apps/student_account/admin_payment/views/layout",["base","requirejs-text!apps/student_account/admin_payment/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["FormLayout","FieldsLayout"],template:_.template(t),templateHelpers:function(){for(var e={1:"January",2:"Febuary",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"},t=[],i=(new Date).getFullYear(),n=i+15;n>i;i++)t.push(i);return{months:e,years:t,showIntro:_.indexOf(_.config("cookies"),"dismissable_student_account_payment_introduction")>=0}},modelEvents:{sync:"render"},ui:{"card.number":".js-card-number","card.cvc":".js-card-cvc","card.exp_month":".js-card-exp-month","card.exp_year":".js-card-exp-year","addresses.billing.line_1":".js-address-line-1","addresses.billing.line_2":".js-address-line-2","addresses.billing.line_3":".js-address-line-3","addresses.billing.postcode":".js-address-postcode"},fields:["card.number","card.cvc","card.exp_month","card.exp_year","addresses.billing.line_1","addresses.billing.line_2","addresses.billing.line_3","addresses.billing.postcode"]}))}),define("apps/student_account/admin_payment/controller",["base","entities/user","entities/bank_card","apps/student_account/admin_payment/views/layout"],function(e,t,i,n){return _.patch(e.Controller.extend({mixins:["FormController"],initialize:function(e){this.user=t.model({uuid:e.uuid}),_.progress().start(),this.listenTo(this.user,"sync",this.renderLayout),this.user.fetch()},renderLayout:function(){_.progress().done(),this.stopListening(this.user),this.view=new n({model:this.user}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},save:function(e){e=object_undot(e);var t=e.card&&(""!==e.card.number||""!==e.card.cvc||""!==e.card.exp_month||""!==e.card.exp_year);t||_.isNull(this.user.get("last_four"))?this.saveWithStripe(e):(e.card="",this.saveWithTutora(e))},saveWithStripe:function(e){var t=i.model(e.card),n=t.validate();if(_.isEmpty(n))Stripe.card.createToken(t.toJSON(),_.bind(this.onStripeResponse,this,e));else{var s={};_.each(n,function(e,t){s["card."+t]=e}),this.onSyncErrorOrInvalid(),this.onInvalid(this.user,s)}},onStripeResponse:function(e,t,i){i.error?this.onStripeError(i.error):this.onStripeSync(e,t,i)},onStripeSync:function(e,t,i){_.progress().set(.5),e.card=i.id,this.user.save(e,{patch:!0})},onStripeError:function(e){_.progress().done();var t={};t["card."+e.param]=e.message,this.showErrors("ERR_INVALID",t),this.view.enableSubmit()},saveWithTutora:function(e){this.user.save(e,{patch:!0})},onSyncSuccess:function(e,t){_.toast("Saved!","success"),this.view.enableSubmit()}}))}),define("apps/student_account/controller",["base","apps/student_account/personal/controller","apps/student_account/payment/controller","apps/student_account/admin_payment/controller"],function(e,t,i,n){return e.Controller.extend({personal:function(e){return e=_.isObject(e)?e:{},new t(_.extend({app:this.app,region:this.app.accountRegion},e))},payment:function(e){return e=_.isObject(e)?e:{},new i(_.extend({app:this.app,region:this.app.accountRegion},e))},adminPayment:function(e){return e=_.isObject(e)?e:{},new n(_.extend({app:this.app,region:this.app.accountRegion},e))}})}),define("apps/student_account/router",["base"],function(e){return e.Router.extend({routes:{personal:laroute.route("student.account.personal.index"),payment:laroute.route("student.account.payment.index"),admin_payment:laroute.route("admin.students.payment.index")},personal:function(){this.tab("personal"),this.controller.personal()},payment:function(){this.tab("payment"),this.controller.payment()},admin_payment:function(e){this.controller.adminPayment({uuid:e})},tab:function(e){$(".js-tab").removeClass("tabs__link--active"),$('[data-tab-name="'+e+'"]').addClass("tabs__link--active")}})}),define("apps/student_account/app",["apps/student_account/controller","apps/student_account/router"],function(e,t){return function(){var i=$(".js-account-region");if(1===i.length){this.addRegions({accountRegion:i});var n=new e({app:this});return new t({controller:n})}}}),define("requirejs-text!apps/user_delete/tutor/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n        <div class="dialogue__window">\n            <header class="dialogue__header">\n                <h4 class="heading"><%= _.lang(\'dialogue.tutors.delete.heading\') %></h4>\n                <a href="#" class="close icon icon--cross [ js-close ]"></a>\n            </header>\n\n            <p><%= _.lang(\'dialogue.tutors.delete.description\') %></p>\n\n            <form class="js-form" novalidate>\n                <div class="tar">\n                    <a href="#" class="u-mr [ js-close ]">Cancel</a>\n                    <button class="btn btn--error">Confirm Delete</button>\n                </div>\n            </form>\n        </div>\n    </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay [ js-close ]"></div>\n';
}),define("apps/user_delete/tutor/views/layout",["base","requirejs-text!apps/user_delete/tutor/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout"],template:_.template(t)}))}),define("apps/user_delete/tutor/controller",["base","entities/user","apps/user_delete/tutor/views/layout"],function(e,t,i){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.tutorId=e.uuid,this.region=e.region,this.user=this.getUser(),this.view=new i({model:this.user}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},getUser:function(){var e=t.model({uuid:this.tutorId});return e},save:function(e){this.user.destroy()},onSyncSuccess:function(e){_.toast("Tutor Deleted!","success"),this.view.destroy()},onDestroy:function(){this.app.history.back(-1)}}))}),define("requirejs-text!apps/user_delete/student/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n        <div class="dialogue__window">\n            <header class="dialogue__header">\n                <h4 class="heading"><%= _.lang(\'dialogue.students.delete.heading\') %></h4>\n                <a href="#" class="close icon icon--cross [ js-close ]"></a>\n            </header>\n\n            <p><%= _.lang(\'dialogue.students.delete.description\') %></p>\n\n            <form class="js-form" novalidate>\n                <div class="tar">\n                    <a href="#" class="u-mr [ js-close ]">Cancel</a>\n                    <button class="btn btn--error">Confirm Delete</button>\n                </div>\n            </form>\n        </div>\n    </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay [ js-close ]"></div>\n'}),define("apps/user_delete/student/views/layout",["base","requirejs-text!apps/user_delete/student/templates/layout.html"],function(e,t){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout"],template:_.template(t)}))}),define("apps/user_delete/student/controller",["base","entities/user","apps/user_delete/student/views/layout"],function(e,t,i){return _.patch(e.Controller.extend({mixins:["FormController","DialogueController"],initialize:function(e){this.studentId=e.uuid,this.region=e.region,this.user=this.getUser(),this.view=new i({model:this.user}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},getUser:function(){var e=t.model({uuid:this.studentId});return e},save:function(e){this.user.destroy()},onSyncSuccess:function(e){_.toast("Student Deleted!","success"),this.view.destroy()},onDestroy:function(){this.app.history.back(-1)}}))}),define("apps/user_delete/controller",["base","apps/user_delete/tutor/controller","apps/user_delete/student/controller"],function(e,t,i){return e.Controller.extend({tutor:function(e){return e=_.isObject(e)?e:{},new t(_.extend({app:this.app,region:this.app.dialogueRegion},e))},student:function(e){return e=_.isObject(e)?e:{},new i(_.extend({app:this.app,region:this.app.dialogueRegion},e))}})}),define("apps/user_delete/router",["base"],function(e){return e.Router.extend({routes:{tutor:laroute.route("admin.tutors.delete"),student:laroute.route("admin.students.delete")},tutor:function(e){this.controller.tutor({uuid:e})},student:function(e){this.controller.student({uuid:e})}})}),define("apps/user_delete/app",["apps/user_delete/controller","apps/user_delete/router"],function(e,t){return function(){var i=new e({app:this});return new t({controller:i})}}),define("requirejs-text!apps/welcome/stage1/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper welcome welcome__stage1">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n            <div class="dialogue__window">\n\n                <header class="dialogue__header">\n                    <a href="#" class="close icon icon--cross [ js-close ]"></a>\n                    <h4 class="heading">Welcome to Tutora!</h4>\n                </header>\n\n                <p>Were delighted that youve decided to tutor with us.</p>\n                <p>To get started as a tutor, please complete your profile, which is your chance to tell parents and students why you would be the ideal tutor for them or their child.</p>\n                <p>All of the sections which need to be completed are listed on the left of the page (you can click on them as you go). Please write your bio in the first person (I, my, etc.). Make sure that your photo is clear and professional, whilst your bio should mention all the experience and expertise you have in your chosen subjects.</p>\n\n                <form class="js-form" novalidate>\n                    <div class="tar">\n                        <button class="btn">Next</button>\n                    </div>\n                </form>\n\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay [ js-close ]"></div>\n'}),define("apps/welcome/stage1/views/layout",["base","entities/user","requirejs-text!apps/welcome/stage1/templates/layout.html"],function(e,t,i){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(i),templateHelpers:function(){var e=t.current();return{user:e.toJSON()}}}))}),define("apps/welcome/stage1/controller",["base","events","entities/user","entities/user_dialogue_interaction","apps/welcome/stage1/views/layout"],function(e,t,i,n,s){return _.patch(e.Controller.extend({mixins:["DialogueController"],initialize:function(e){this.region=e.region,this.user=i.current(),this.view=new s({model:this.user}),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.view,"show",this.recordInteraction),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},recordInteraction:function(){this.timestamp=Date.now(),this.interaction=new n({uuid:this.user.id,name:"welcome"}),this.interaction.save({},{async:!1})},onFormSubmit:function(){this.view.destroy();var e=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid"),section:"welcome/2"});this.interaction&&this.timestamp&&this.interaction.save({duration:Date.now()-this.timestamp},{patch:!0}),this.app.history.navigate(e,{trigger:!0})},onDestroy:function(){var e=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid")});this.app.history.back(e)}}))}),define("requirejs-text!apps/welcome/stage2/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper welcome welcome__stage2">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n            <div class="dialogue__window">\n\n                <header class="dialogue__header">\n                    <a href="#" class="close icon icon--cross [ js-close ]"></a>\n                    <h4 class="heading">Welcome to Tutora!</h4>\n                </header>\n\n                <p>The details on the account page are just as important, but wont be shared with students.</p>\n                <p>As you can imagine, its important that we verify the identity of every tutor, which is why we ask you to upload a copy of your ID - either a driving licence or passport. Make sure that the image is clear and in colour.</p>\n                <p>If you have a DBS check, great. Use the link on your profile page to send it to us. You dont have to have one to tutor with us, but we can help you get one for 50 if youd like one.</p>\n                <p>You dont have to add your bank details now, and its completely free to have a profile. We need your account details so that we can pay you. Most tutors prefer to enter them now in case they forget later, but its up to you.</p>\n                <p>Once youve completed the profile, take the quiz and well then get you up and running!</p>\n\n                <form class="js-form" novalidate>\n                    <div class="tal block-50 dialog-buttons-top-padding-1">\n                        <button type="button" class="btn btn--back">Back</button>\n                    </div>\n                    <div class="tar block-50 dialog-buttons-top-padding-1">\n                        <button class="btn">Create my profile</button>\n                    </div>\n                </form>\n\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay [ js-close ]"></div>\n'}),define("apps/welcome/stage2/views/layout",["base","entities/user","requirejs-text!apps/welcome/stage2/templates/layout.html"],function(e,t,i){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(i),templateHelpers:function(){var e=t.current();return{user:e.toJSON()}},events:{"click .btn--back":"back"},back:function(){this.trigger("back")}}))}),define("apps/welcome/stage2/controller",["base","events","entities/user","apps/welcome/stage2/views/layout"],function(e,t,i,n){return _.patch(e.Controller.extend({mixins:["DialogueController"],initialize:function(e){this.region=e.region,this.user=i.current(),this.view=new n({model:this.user}),this.listenTo(this.view,"back",this.onFormBack),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.listenTo(this.user,"sync error invalid",this.onSyncErrorOrInvalid),this.listenTo(this.user,"sync",this.onSyncSuccess),this.listenTo(this.user,"error",this.onSyncError),this.listenTo(this.user,"invalid",this.onInvalid),this.region.show(this.view)},onFormBack:function(){this.view.destroy();var e=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid"),section:"welcome"});this.app.history.navigate(e,{trigger:!0})},onFormSubmit:function(){this.view.destroy();var e=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid")});this.app.history.navigate(e)},onDestroy:function(){var e=laroute.route("tutor.profile.show",{uuid:this.user.get("uuid")});this.app.history.navigate(e)}}))}),define("apps/welcome/controller",["base","apps/welcome/stage1/controller","apps/welcome/stage2/controller"],function(e,t,i){return e.Controller.extend({stage1:function(e){return e=_.isObject(e)?e:{},new t(_.extend({app:this.app,region:this.app.dialogueRegion},e))},stage2:function(e){return e=_.isObject(e)?e:{},new i(_.extend({app:this.app,region:this.app.dialogueRegion},e))}})}),define("apps/welcome/router",["base"],function(e){return e.Router.extend({routes:{stage1:laroute.route("tutor.profile.show",{uuid:":id",section:"welcome"}),stage2:laroute.route("tutor.profile.show",{uuid:":id",section:"welcome"})+"/2"},stage1:function(){this.controller.stage1()},stage2:function(){this.controller.stage2()}})}),define("apps/welcome/app",["apps/welcome/controller","apps/welcome/router"],function(e,t){return function(){var i=new e({app:this});return new t({controller:i})}}),define("entities/basic_user_dialogue",["base"],function(e){var t=Backbone.Model.extend({idAttribute:"name",urlRoot:"/api/basic_user_dialogue"});return function(e,i){return new t(e,i)}}),define("requirejs-text!apps/basic_user_dialogue/show/templates/layout.html",[],function(){return'<div class="dialogue__wrapper wrapper basic_user_dialogue basic_user_dialogue__show">\n    <div class="layout layout--center"><!--\n        --><div class="layout__item dialogue__container">\n            <div class="dialogue__window">\n\n                <header class="dialogue__header">\n                    <a href="#" class="close icon icon--cross [ js-close ]"></a>\n                    <h4 class="heading"><%= title %></h4>\n                </header>\n\n                <p><%= body %></p>\n\n                <form class="js-form" novalidate>\n                    <div class="tar">\n                        <button class="btn"><%= submit %></button>\n                    </div>\n                </form>\n\n            </div>\n        </div><!--\n    --></div>\n</div>\n\n<div class="dialogue__overlay [ js-close ]"></div>\n'}),define("apps/basic_user_dialogue/show/views/layout",["base","entities/basic_user_dialogue","requirejs-text!apps/basic_user_dialogue/show/templates/layout.html"],function(e,t,i){return _.patch(e.LayoutView.extend({mixins:["DialogueLayout","FormLayout","FieldsLayout"],template:_.template(i),templateHelpers:function(){var e=new t({name:this.options.name});return e.fetch({async:!1}),{title:e.attributes.title,body:e.attributes.body,submit:e.attributes.submit}}}))}),define("apps/basic_user_dialogue/show/controller",["base","events","entities/user","entities/user_dialogue_interaction","apps/basic_user_dialogue/show/views/layout"],function(e,t,i,n,s){return _.patch(e.Controller.extend({mixins:["DialogueController"],initialize:function(e){this.region=e.region,this.user=i.current(),this.dialogue_route_name=e.dialogue_route_name,this.return_route=e.return_route,this.view=new s({name:this.dialogue_route_name,user:this.user}),this.listenTo(this.view,"show",this.recordInteraction),this.listenTo(this.view,"form:submit",this.onFormSubmit),this.listenTo(this.view,"destroy",this.destroy),this.region.show(this.view)},recordInteraction:function(){this.timestamp=Date.now(),this.interaction=new n({uuid:this.user.id,name:this.dialogue_route_name}),this.interaction.save({},{async:!1})},onFormSubmit:function(){this.interaction&&this.timestamp&&this.interaction.save({duration:Date.now()-this.timestamp},{patch:!0}),this.view.destroy()},onDestroy:function(){this.return_route&&(this.app.history.navigate(this.return_route),location.reload())}}))}),define("apps/basic_user_dialogue/controller",["base","apps/basic_user_dialogue/show/controller"],function(e,t){return e.Controller.extend({basic_dialogue:function(e,i,n){return e=_.isObject(e)?e:{},new t(_.extend({app:this.app,region:this.app.dialogueRegion,dialogue_route_name:i,return_route:n},e))}})}),define("apps/basic_user_dialogue/router",["base"],function(e){var t=Backbone.Model.extend({url:"/api/dialogue_routes"}),i=new t;i.fetch({async:!1}),raw_dialogue_routes=i.attributes;var n={};_.each(raw_dialogue_routes,function(e){n[e.name]=e.route_string+"(?return=*return_route)"});var s={routes:n};return _.each(n,function(e,t){s[t]=function(){var e=null;arguments.length>=2&&(e=arguments[arguments.length-2]),this.controller.basic_dialogue({},t,e)}}),e.Router.extend(s)}),define("apps/basic_user_dialogue/app",["apps/basic_user_dialogue/controller","apps/basic_user_dialogue/router"],function(e,t){return function(){var i=new e({app:this});return new t({controller:i})}}),define("app",["backbone.marionette","config","mixins","base","entities/user","components/requirements/component","components/autocomplete/component","components/scrolltabs/component","apps/autocomplete/app","apps/toasts/app","apps/auth/app","apps/register/app","apps/search/app","apps/tutors/app","apps/tagline/app","apps/rate/app","apps/live/app","apps/travel_policy/app","apps/bio/app","apps/subjects/app","apps/qualifications/app","apps/quiz/app","apps/qts/app","apps/booking/app","apps/review/app","apps/messages/app","apps/tutor_account/app","apps/student_account/app","apps/user_delete/app","apps/welcome/app","apps/basic_user_dialogue/app"],function(e,t,i,n,s,o,r,a,l,u,c,d,h,p,f,m,g,v,b,y,w,x,k,C,S,T,j,E,q,A,P){var F=s.current(),D=new(e.Application.extend({callbacks:{}}));return D.addRegions({dialogueRegion:".dialogue-region",toastRegion:".toast-region"}),D.addInitializer(o),D.addInitializer(r),D.addInitializer(a),D.addInitializer(l),D.addInitializer(u),D.addInitializer(c),D.addInitializer(d),D.addInitializer(h),D.addInitializer(T),D.addInitializer(P),F.isNew()||(D.addInitializer(p),D.addInitializer(S),D.addInitializer(C),D.addInitializer(f),D.addInitializer(m),D.addInitializer(v),D.addInitializer(b),D.addInitializer(g),D.addInitializer(y),D.addInitializer(w),D.addInitializer(x),D.addInitializer(k),D.addInitializer(j),D.addInitializer(E),D.addInitializer(q),D.addInitializer(A)),D.on("start",function(){Stripe.setPublishableKey(_.config("services.stripe.publishable")),$.ajaxPrefilter(function(e,t,i){return e.xhrFields={withCredentials:!0},i.setRequestHeader("X-CSRF-Token",_.config("csrf_token"))}),this.history=new n.History({app:this}),this.history.start({pushState:!0}),$(document).on("click","a[data-js]",_.bind(function(e){var t=$(e.currentTarget).attr("href");return t?(e.preventDefault(),this.history.navigate(t,{trigger:!0}),!1):void 0},this))}),D}),define("ui",["backbone.marionette","nprogress"],function(e,t){var i=$(window),n=$(document);$("html");t.configure({showSpinner:!1}),function(){var e=$(".page"),t=$(".page__footer"),n=function(){e.css("marginBottom",t.outerHeight())};i.on("resize",n),n()}.call(this),function(){var e=$(".site-nav");e.on("click",".site-nav__burger",function(){e.addClass("site-nav--open")}),e.on("click",".site-nav__cross",function(){e.removeClass("site-nav--open")})}.call(this),function(){var e=$(".page-drawer"),t="page-drawer--open";n.on("click","a.js-how-it-works",function(i){return i.preventDefault&&i.preventDefault(),e.hasClass(t)?e.removeClass(t):($("html, body").animate({scrollTop:0},500),e.addClass(t)),!1})}.call(this),function(){$(document).on("click",".radios__item",function(e){var t=$(e.currentTarget),i=t.parents(".radios"),n=t.find(".radios__input");n.is(":checked")||(i.find(".radios__item").removeClass("radios__item--checked"),i.find(".radios__input").removeAttr("checked"),i.find(".radios__input").prop("checked",!1),t.addClass("radios__item--checked"),n.attr("checked",!0),n.prop("checked",!0))})}.call(this),function(){$(document).on("click",".field__rating__item",function(e){var t=$(e.currentTarget),i=t.parents(".field"),n=t.find(".field__rating__input");i.find(".field__rating__item").removeClass("field__rating__item--checked"),i.find(".field__rating__input").removeAttr("checked"),i.find(".field__rating__input").prop("checked",!1),t.addClass("field__rating__item--checked"),n.attr("checked",!0),n.prop("checked",!0)})}.call(this),function(){$(document).on("click",".checkbox__box, .checkbox__label",function(e){var t=$(e.currentTarget),i=t.parents(".checkbox"),n=i.find(".checkbox__input");n.is(":checked")?(i.removeClass("checkbox--checked"),n.removeAttr("checked"),n.prop("checked",!1),n.trigger("changed")):(i.addClass("checkbox--checked"),n.attr("checked",!0),n.prop("checked",!0),n.trigger("changed"))})}.call(this),function(){$(document).on("change",".select .select__field",function(e){var t=$(e.currentTarget),i=t.parents(".select"),n=i.find(".select__value"),s="select--show";""===t.val()?(i.removeClass(s),n.html("")):(i.addClass(s),n.html(t.find(":selected").text()))})}.call(this),function(){$(document).on("click",".tabs__link",function(e){var t=$(e.currentTarget),i=t.data("tab-group"),n=t.data("tab-name");if(i&&n){e.preventDefault&&e.preventDefault();var s=$('.tabs__link[data-tab-group="'+i+'"]');s.removeClass("tabs__link--active"),t.addClass("tabs__link--active");var o=$('.tab-content[data-tab-group="'+i+'"]'),r=$('.tab-content[data-tab-group="'+i+'"][data-tab-name="'+n+'"]');o.removeClass("tab-content--active"),r.addClass("tab-content--active");var a=t.attr("href");return"#"!==a&&Backbone.history.navigate(a),!1}})}.call(this),function(){$(document).on("click",".js-dismissable .js-close",function(e){var t=$(e.currentTarget),i=t.parents(".js-dismissable");i.css("display","none"),$.post("/api/cookies",{key:"dismissable_"+i.data("dismissable-id"),value:!0})})}.call(this)}),require.config({paths:{autocomplete:"../vendor/devbridge-autocomplete/dist/jquery.autocomplete",backbone:"../vendor/backbone/backbone","backbone.babysitter":"../vendor/backbone.babysitter/lib/backbone.babysitter","backbone.marionette":"../vendor/marionette/lib/core/backbone.marionette","backbone.wreqr":"../vendor/backbone.wreqr/lib/backbone.wreqr","backbone.validation":"../vendor/backbone-validation/dist/backbone-validation-amd",cocktail:"../vendor/cocktail/Cocktail",dropzone:"../vendor/dropzone/dist/dropzone-amd-module",laroute:"laroute",jquery:"../vendor/jquery/dist/jquery",nprogress:"../vendor/nprogress/nprogress","requirejs-text":"../vendor/requirejs-text/text",picker:"../vendor/pickadate/lib/picker","picker.date":"../vendor/pickadate/lib/picker.date",pusher:"../vendor/pusher/dist/pusher.min",underscore:"../vendor/underscore/underscore","underscore.string":"underscore.string.min",tipped:"../vendor/tipped/js/tipped"},shim:{underscore:{deps:["laroute"]},backbone:{deps:["jquery","underscore","underscore.string","picker","picker.date"]},"backbone.validation":{deps:["backbone"]},"backbone.marionette":{deps:["backbone.validation"]},autocomplete:{deps:["jquery"]}},urlArgs:"bust=v2"}),require(["app","ui"],function(e){window.App=e,window.App.start()}),define("main",function(){});